<!DOCTYPE html>
<html>

<head>
    <title>Viewer 3D Demo</title>
    <meta name="viewport" content="width=device-width, target-densityDpi=device-dpi, minimum-scale=1.0, maximum-scale=1.0" />
    <meta charset="utf-8">

    <link rel="stylesheet" href="https://viewing-dev.api.autodesk.com/viewingservice/v1/viewers/style.css" type="text/css">
    <script src="https://viewing-dev.api.autodesk.com/viewingservice/v1/viewers/viewer3D.min.cp.js"></script>
    <script src="https://viewing-dev.api.autodesk.com/viewingservice/v1/viewers/main.js"></script>

    <script>
        function initializeViewer() {
            var options = {};
            // Environment controls service end points viewer uses.
            // Development, Staging, and Production are valid values.
            options.env = "Development";
            // Access token required for authentication and authorization.
            // It is for now a 3 legged oauth 1 access token.
            // Here we have a hardcoded token for testing purpose.
            // In practice you need to obtain a valid access token and pass it to viewer, instead of using this token.
            options.accessToken = getParameterByName("accessToken") ? getParameterByName("accessToken") : "oymeRrb0fgMsILcsU6h8SS0pKvq8";

            // Initialize env, service end points, and authentication.
            initializeEnvironmentVariable(options);
            initializeServiceEndPoints();
            var auth = initializeAuth(options);

            // 'document' input parameter specify the URN of bubble.
            var documentId = getParameterByName("document");
            if(!documentId)
                documentId = "urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9BbGV4X0JpY2FsaG8vZHJhZ29uLnppcA";

            // Use 3D viewer.
            viewer = new Autodesk.GuiViewer3D('viewer3d', {});
            viewer.initialize();

            // Load model.
            loadDocument(viewer, auth, documentId);
        }

        function loadDocument(viewer, auth, documentId) {
            var path = VIEWING_URL + '/bubbles/' + documentId.substr(4);

            Autodesk.Document.load(path, auth,
                function(document) {
                    var svfItems = Autodesk.Document.getSubItemsWithProperties(document.getRootItem(),
                            {'mime':'application/autodesk-svf'}, true);
                    if(svfItems.length > 0) {
                        viewer.load(svfItems[0].urn);
                    }
                }, onErrorLoadModel
            );
        }

        function onErrorLoadModel() {
            var container = document.getElementById('viewer2d');
            if (container) {
                AlertBox.displayError(container, "LOAD Error: " + msg);
            }
        }
    </script>
</head>

<body onload="initializeViewer();" oncontextmenu="return false;">
    <div id="viewer3d" style="position:absolute; width:100%; height:100%; overflow: hidden;"></div>
</body>

</html>
