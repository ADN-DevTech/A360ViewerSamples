var IS_CONCAT_BUILD=!0,BUILD_LMV_WORKER_URL="viewer3D.min.cp.js",LMV_WORKER_URL=BUILD_LMV_WORKER_URL,ENABLE_DEBUG=!1,ENABLE_TRACE=!1,ENABLE_INLINE_WORKER=!0;AutodeskNamespace=function(a){var b=this;a=a.split(".");for(var c=0;c<a.length;++c)b[a[c]]=b[a[c]]||{},b=b[a[c]];return b};var _isIE11=!!navigator.userAgent.match(/Trident\/7\./);"undefined"!==typeof window&&_isIE11&&function(){function a(a,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");e.initCustomEvent(a,c.bubbles,c.cancelable,c.detail);return e}a.prototype=window.CustomEvent.prototype;window.CustomEvent=a}();
ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){!b||b>this.byteLength?b=this.byteLength:0>b&&(b=this.byteLength+b,0>b&&(b=0));0>a&&(a=this.byteLength+a,0>a&&(a=0));if(b<=a)return new ArrayBuffer;for(var c=b-a,e=new Uint8Array(this,a,c),d=new Uint8Array(c),g=0;g<c;g++)d[g]=e[g];return d.buffer});"undefined"!==typeof window&&(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);
function launchFullscreen(a){a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()}function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}
function inFullscreen(){return document.fullscreenEnabled||document.mozFullScreenElement||document.webkitIsFullScreen||document.msFullscreenElement?!0:!1}function fullscreenElement(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function isFullscreenAvailable(a){return a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.ESCAPE_EVENT="escape";Autodesk.Viewing.PROGRESS_UPDATE_EVENT="progress";Autodesk.Viewing.FULLSCREEN_MODE_EVENT="fullScreenMode";Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT="navmode";
Autodesk.Viewing.Viewer=function(a,b){this.clientContainer=a;this.container=document.createElement("div");this.container.className="viewer";this.container.style.height="100%";this.container.style.width="100%";this.container.style.overflow="hidden";this.clientContainer.appendChild(this.container);this.listeners={};this.dockingPanels=[];this.config=b;this.screenModeDelegate=null;b&&b.screenModeDelegate&&(this.screenModeDelegate=new b.screenModeDelegate(this))};
Autodesk.Viewing.Viewer.prototype={load:function(a,b){throw"bool load(urn, function(void)) must be implemented.  For more details, read the Viewer class documentation.";}};Autodesk.Viewing.Viewer.prototype.initialize=function(){var a=this;this.onResizeCallback=function(b){a.resize()};window.addEventListener("resize",this.onResizeCallback,!1)};
Autodesk.Viewing.Viewer.prototype.uninitialize=function(){this.container.parentNode.removeChild(this.container);this.container=null;this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null);this.config=this.clientContainer=null;this.listeners={};this.dockingPanels=[];window.removeEventListener("resize",this.onResizeCallback,!1)};Autodesk.Viewing.Viewer.prototype.addEventListener=function(a,b){"undefined"==typeof this.listeners[a]&&(this.listeners[a]=[]);this.listeners[a].push(b)};
Autodesk.Viewing.Viewer.prototype.removeEventListener=function(a,b){if(this.listeners[a]instanceof Array)for(var c=this.listeners[a],e=0,d=c.length;e<d;e++)if(c[e]===b){c.splice(e,1);break}};Autodesk.Viewing.Viewer.prototype.fireEvent=function(a){"string"==typeof a&&(a={type:a});a.target||(a.target=this);if(!a.type)throw Error("event type unknown.");if(this.listeners[a.type]instanceof Array)for(var b=0,c=this.listeners[a.type].length;b<c;b++)this.listeners[a.type][b].call(this,a)};
Autodesk.Viewing.Viewer.prototype.getDimensions=function(){if(this.container){var a={};this.getScreenMode()===this.ScreenMode.kFullScreen?(a.width=screen.width,a.height=screen.height):a=this.container.getBoundingClientRect();return{width:a.width,height:a.height}}return null};Autodesk.Viewing.Viewer.prototype.setViewFromArray=function(a){};Autodesk.Viewing.Viewer.prototype.setViewFromFile=function(){};Autodesk.Viewing.Viewer.prototype.resize=function(){this.resizePanels()};
Autodesk.Viewing.Viewer.prototype.addPanel=function(a){return-1===this.dockingPanels.indexOf(a)?(this.dockingPanels.push(a),!0):!1};Autodesk.Viewing.Viewer.prototype.removePanel=function(a){a=this.dockingPanels.indexOf(a);return-1<a?(this.dockingPanels.splice(a,1),!0):!1};
Autodesk.Viewing.Viewer.prototype.resizePanels=function(a){var b=a?a.viewer:null;b||(b=this);var c=a?a.dockingPanels:null;c||(c=b.dockingPanels);(a=a?a.dimensions:null)||(a=b.getDimensions());for(b=0;b<c.length;b++){var e=c[b].container,d=parseInt(e.style.top),g=parseInt(e.style.left),f=""===e.style.minWidth?100:parseInt(e.style.minWidth),h=""===e.style.minHeight?100:parseInt(e.style.minHeight),k=parseInt(e.style.width),l=parseInt(e.style.height);isNaN(k)&&(k=e.getBoundingClientRect().width);isNaN(l)&&
(l=e.getBoundingClientRect().height);k=f>k?f:k;l=h>l?h:l;if(k&&l){g+=k;d+l>a.height&&(h>a.height-d?e.style.top=a.height-l+"px":e.style.height=a.height-d+"px");if(g>a.width-5||e.dock)d=a.width-k,e.style.left=(0>d?0:d)+"px";e.style.maxWidth=a.width-parseInt(e.style.left)+"px";e.style.maxHeight=a.height-parseInt(e.style.top)+"px"}}};Autodesk.Viewing.Viewer.prototype.search=function(a,b,c){};Autodesk.Viewing.Viewer.prototype.ScreenMode={kNormal:0,kFullBrowser:1,kFullScreen:2};
Autodesk.Viewing.Viewer.prototype.setScreenModeDelegate=function(a){this.screenModeDelegate&&this.screenModeDelegate.uninitialize();this.screenModeDelegate=a};Autodesk.Viewing.Viewer.prototype.getScreenModeDelegate=function(){this.screenModeDelegate||(this.screenModeDelegate=new Autodesk.Viewing.ViewerScreenModeDelegate(this));return this.screenModeDelegate};Autodesk.Viewing.Viewer.prototype.isScreenModeSupported=function(a){return this.getScreenModeDelegate().isModeSupported(a)};
Autodesk.Viewing.Viewer.prototype.canChangeScreenMode=function(){return this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.kNormal)};Autodesk.Viewing.Viewer.prototype.setScreenMode=function(a){return this.getScreenModeDelegate().setMode(a)};Autodesk.Viewing.Viewer.prototype.getScreenMode=function(){return this.getScreenModeDelegate().getMode()};
Autodesk.Viewing.Viewer.prototype.nextScreenMode=function(){var a=this.getScreenModeDelegate().getNextMode();return void 0!==a?this.setScreenMode(a):!1};Autodesk.Viewing.Viewer.prototype.escapeScreenMode=function(){var a=this.getScreenModeDelegate().getEscapeMode();return void 0!==a?this.setScreenMode(a):!1};
Autodesk.Viewing.ScreenModeDelegate=function(a){this.viewer=a;this.bindFullscreenEventListener=this.fullscreenEventListener.bind(this);this.getMode()===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen&&(document.addEventListener("fullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("MSFullscreenChange",
this.bindFullscreenEventListener,!1))};Autodesk.Viewing.ScreenModeDelegate.prototype.uninitialize=function(){document.removeEventListener("fullscreenchange",this.bindFullscreenEventListener,!1);document.removeEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1);document.removeEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1);document.removeEventListener("MSFullscreenChange",this.bindFullscreenEventListener,!1);this.viewer=null};
Autodesk.Viewing.ScreenModeDelegate.prototype.isModeSupported=function(a){return!0};Autodesk.Viewing.ScreenModeDelegate.prototype.setMode=function(a){var b=this.getMode();if(a!==b&&this.isModeSupported(a)){this.doScreenModeChange(b,a);if(b!==Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)this.onScreenModeChanged(b,a);return!0}return!1};Autodesk.Viewing.ScreenModeDelegate.prototype.getMode=function(){throw"Implement getMode() in derived class";};
Autodesk.Viewing.ScreenModeDelegate.prototype.getNextMode=function(){var a=this.getMode(),b;a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal&&this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser)?b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal&&this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)?b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser&&
this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)?b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser&&this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal)?b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen&&this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal)?b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:
a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen&&this.isModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser)&&(b=Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser);return b};Autodesk.Viewing.ScreenModeDelegate.prototype.getEscapeMode=function(){return this.getMode()!==Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal?Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:void 0};
Autodesk.Viewing.ScreenModeDelegate.prototype.fullscreenEventListener=function(){if(!inFullscreen()){var a=Autodesk.Viewing.Viewer.prototype.ScreenMode;this.doScreenModeChange(a.kFullScreen,a.kNormal);this.onScreenModeChanged(a.kFullScreen,a.kNormal)}};Autodesk.Viewing.ScreenModeDelegate.prototype.doScreenModeChange=function(a,b){throw"Implement doScreenModeChange() in derived class";};
Autodesk.Viewing.ScreenModeDelegate.prototype.onScreenModeChanged=function(a,b){a===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen?(document.removeEventListener("fullscreenchange",this.bindFullscreenEventListener,!1),document.removeEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1),document.removeEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1),document.removeEventListener("MSFullscreenChange",this.bindFullscreenEventListener,!1)):b===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen&&
(document.addEventListener("fullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("mozfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("webkitfullscreenchange",this.bindFullscreenEventListener,!1),document.addEventListener("MSFullscreenChange",this.bindFullscreenEventListener,!1));this.viewer.resize();this.viewer.fireEvent({type:Autodesk.Viewing.FULLSCREEN_MODE_EVENT,mode:b})};
Autodesk.Viewing.ViewerScreenModeDelegate=function(a){Autodesk.Viewing.ScreenModeDelegate.call(this,a)};Autodesk.Viewing.ViewerScreenModeDelegate.prototype=Object.create(Autodesk.Viewing.ScreenModeDelegate.prototype);Autodesk.Viewing.ViewerScreenModeDelegate.prototype.constructor=Autodesk.Viewing.ViewerScreenModeDelegate;
Autodesk.Viewing.ViewerScreenModeDelegate.prototype.getMode=function(){return inFullscreen()&&fullscreenElement()===this.viewer.container?Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:this.viewer.container.classList.contains("viewer-fill-browser")?Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal};
Autodesk.Viewing.ViewerScreenModeDelegate.prototype.doScreenModeChange=function(a,b){var c=this.viewer.container;switch(b){case Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:c.classList.remove("viewer-fill-browser");exitFullscreen();break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:c.classList.add("viewer-fill-browser");break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:c.classList.add("viewer-fill-browser"),launchFullscreen(c)}};
Autodesk.Viewing.ApplicationScreenModeDelegate=function(a){Autodesk.Viewing.ScreenModeDelegate.call(this,a)};Autodesk.Viewing.ApplicationScreenModeDelegate.prototype=Object.create(Autodesk.Viewing.ScreenModeDelegate.prototype);Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.constructor=Autodesk.Viewing.ApplicationScreenModeDelegate;Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.isModeSupported=function(a){return a!==Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser};
Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.getMode=function(){return inFullscreen()&&fullscreenElement()===document.documentElement?Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal};Autodesk.Viewing.ApplicationScreenModeDelegate.prototype.doScreenModeChange=function(a,b){b===Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal?exitFullscreen():b===Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen&&launchFullscreen(document.documentElement)};var THREE={REVISION:"66"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!self.requestAnimationFrame;++c)self.requestAnimationFrame=self[b[c]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[b[c]+"CancelAnimationFrame"]||self[b[c]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(b){var d=Date.now(),c=Math.max(0,16-(d-a)),f=self.setTimeout(function(){b(d+c)},c);a=d+c;return f});void 0===self.cancelAnimationFrame&&void 0!==
self.clearTimeout&&(self.cancelAnimationFrame=function(a){self.clearTimeout(a)})})();THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;
THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;
THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1E3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;
THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.HalfFloatType=1099;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;
THREE.LuminanceAlphaFormat=1023;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.Color=function(a){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(a)};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(a){a instanceof THREE.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(a,b,c){if(0===b)this.r=this.g=this.b=c;else{var e=function(a,b,f){0>f&&(f+=1);1<f&&(f-=1);return f<1/6?a+6*(b-a)*
f:0.5>f?b:f<2/3?a+6*(b-a)*(2/3-f):a};b=0.5>=c?c*(1+b):c+b-c*b;c=2*c-b;this.r=e(c,b,a+1/3);this.g=e(c,b,a);this.b=e(c,b,a-1/3)}return this},setStyle:function(a){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(a))return a=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(a),this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,this;if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(a))return a=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(a),this.r=
Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(a))return a=/^\#([0-9a-f]{6})$/i.exec(a),this.setHex(parseInt(a[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a))return a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.setHex(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this;if(/^(\w+)$/i.test(a))return this.setHex(THREE.ColorKeywords[a]),this},copy:function(a){this.r=a.r;this.g=
a.g;this.b=a.b;return this},copyGammaToLinear:function(a){this.r=a.r*a.r;this.g=a.g*a.g;this.b=a.b*a.b;return this},copyLinearToGamma:function(a){this.r=Math.sqrt(a.r);this.g=Math.sqrt(a.g);this.b=Math.sqrt(a.b);return this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<
8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){a=a||{h:0,s:0,l:0};var b=this.r,c=this.g,e=this.b,d=Math.max(b,c,e),g=Math.min(b,c,e),f,h=(g+d)/2;if(g===d)g=f=0;else{var k=d-g,g=0.5>=h?k/(d+g):k/(2-d-g);switch(d){case b:f=(c-e)/k+(c<e?6:0);break;case c:f=(e-b)/k+2;break;case e:f=(b-c)/k+4}f/=6}a.h=f;a.s=g;a.l=h;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,
b,c){var e=this.getHSL();e.h+=a;e.s+=b;e.l+=c;this.setHSL(e.h,e.s,e.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;
this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a){this.r=a[0];this.g=a[1];this.b=a[2];return this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};
THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,
tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(a,b,c,e){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==e?e:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:void 0,_updateEuler:function(a){void 0!==this._euler&&this._euler.setFromQuaternion(this,void 0,!1)},get x(){return this._x},set x(a){this._x=a;this._updateEuler()},get y(){return this._y},set y(a){this._y=a;this._updateEuler()},get z(){return this._z},set z(a){this._z=a;this._updateEuler()},get w(){return this._w},set w(a){this._w=a;this._updateEuler()},set:function(a,b,c,e){this._x=a;this._y=b;this._z=c;this._w=
e;this._updateEuler();return this},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._w=a._w;this._updateEuler();return this},setFromEuler:function(a,b){if(!1===a instanceof THREE.Euler)throw Error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var c=Math.cos(a._x/2),e=Math.cos(a._y/2),d=Math.cos(a._z/2),g=Math.sin(a._x/2),f=Math.sin(a._y/2),h=Math.sin(a._z/2);"XYZ"===a.order?(this._x=g*e*d+c*f*h,this._y=c*
f*d-g*e*h,this._z=c*e*h+g*f*d,this._w=c*e*d-g*f*h):"YXZ"===a.order?(this._x=g*e*d+c*f*h,this._y=c*f*d-g*e*h,this._z=c*e*h-g*f*d,this._w=c*e*d+g*f*h):"ZXY"===a.order?(this._x=g*e*d-c*f*h,this._y=c*f*d+g*e*h,this._z=c*e*h+g*f*d,this._w=c*e*d-g*f*h):"ZYX"===a.order?(this._x=g*e*d-c*f*h,this._y=c*f*d+g*e*h,this._z=c*e*h-g*f*d,this._w=c*e*d+g*f*h):"YZX"===a.order?(this._x=g*e*d+c*f*h,this._y=c*f*d+g*e*h,this._z=c*e*h-g*f*d,this._w=c*e*d-g*f*h):"XZY"===a.order&&(this._x=g*e*d-c*f*h,this._y=c*f*d-g*e*h,
this._z=c*e*h+g*f*d,this._w=c*e*d+g*f*h);!1!==b&&this._updateEuler();return this},setFromAxisAngle:function(a,b){var c=b/2,e=Math.sin(c);this._x=a.x*e;this._y=a.y*e;this._z=a.z*e;this._w=Math.cos(c);this._updateEuler();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var e=b[8],d=b[1],g=b[5],f=b[9],h=b[2],k=b[6],b=b[10],l=c+g+b;0<l?(c=0.5/Math.sqrt(l+1),this._w=0.25/c,this._x=(k-f)*c,this._y=(e-h)*c,this._z=(d-a)*c):c>g&&c>b?(c=2*Math.sqrt(1+c-g-b),this._w=(k-f)/c,this._x=
0.25*c,this._y=(a+d)/c,this._z=(e+h)/c):g>b?(c=2*Math.sqrt(1+g-c-b),this._w=(e-h)/c,this._x=(a+d)/c,this._y=0.25*c,this._z=(f+k)/c):(c=2*Math.sqrt(1+b-c-g),this._w=(d-a)/c,this._x=(e+h)/c,this._y=(f+k)/c,this._z=0.25*c);this._updateEuler();return this},inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this._updateEuler();return this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*
this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);return this},multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a._x,e=a._y,d=a._z,g=
a._w,f=b._x,h=b._y,k=b._z,l=b._w;this._x=c*l+g*f+e*k-d*h;this._y=e*l+g*h+d*f-c*k;this._z=d*l+g*k+c*h-e*f;this._w=g*l-c*f-e*h-d*k;this._updateEuler();return this},multiplyVector3:function(a){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)},slerp:function(a,b){var c=this._x,e=this._y,d=this._z,g=this._w,f=g*a._w+c*a._x+e*a._y+d*a._z;0>f?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=
-a._z,f=-f):this.copy(a);if(1<=f)return this._w=g,this._x=c,this._y=e,this._z=d,this;var h=Math.acos(f),k=Math.sqrt(1-f*f);if(0.001>Math.abs(k))return this._w=0.5*(g+this._w),this._x=0.5*(c+this._x),this._y=0.5*(e+this._y),this._z=0.5*(d+this._z),this;f=Math.sin((1-b)*h)/k;h=Math.sin(b*h)/k;this._w=g*f+this._w*h;this._x=c*f+this._x*h;this._y=e*f+this._y*h;this._z=d*f+this._z*h;this._updateEuler();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},
fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];this._w=a[3];this._updateEuler();return this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}};THREE.Quaternion.slerp=function(a,b,c,e){return c.copy(a).slerp(b,e)};THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,
b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=
a.y;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);
return this},clampScalar:function(){var a,b;return function(c,e){void 0===a&&(a=new THREE.Vector2,b=new THREE.Vector2);a.set(c,c);b.set(e,e);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?
Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){var b=
this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a){this.x=a[0];this.y=a[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+
a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*
b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a;return function(b){!1===b instanceof THREE.Euler&&console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromEuler(b));return this}}(),applyAxisAngle:function(){var a;return function(b,c){void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromAxisAngle(b,c));return this}}(),
applyMatrix3:function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*e;this.y=a[1]*b+a[4]*c+a[7]*e;this.z=a[2]*b+a[5]*c+a[8]*e;return this},applyMatrix4:function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*e+a[12];this.y=a[1]*b+a[5]*c+a[9]*e+a[13];this.z=a[2]*b+a[6]*c+a[10]*e+a[14];return this},applyProjection:function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;var d=1/(a[3]*b+a[7]*c+a[11]*e+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*e+a[12])*d;this.y=
(a[1]*b+a[5]*c+a[9]*e+a[13])*d;this.z=(a[2]*b+a[6]*c+a[10]*e+a[14])*d;return this},applyQuaternion:function(a){var b=this.x,c=this.y,e=this.z,d=a.x,g=a.y,f=a.z;a=a.w;var h=a*b+g*e-f*c,k=a*c+f*b-d*e,l=a*e+d*c-g*b,b=-d*b-g*c-f*e;this.x=h*a+b*-d+k*-f-l*-g;this.y=k*a+b*-g+l*-d-h*-f;this.z=l*a+b*-f+h*-g-k*-d;return this},transformDirection:function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*e;this.y=a[1]*b+a[5]*c+a[9]*e;this.z=a[2]*b+a[6]*c+a[10]*e;this.normalize();return this},
divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<
a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);return this},clampScalar:function(){var a,b;return function(c,e){void 0===a&&(a=new THREE.Vector3,b=new THREE.Vector3);a.set(c,c,c);b.set(e,e,e);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);
return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+
Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},cross:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var c=this.x,e=this.y,d=this.z;this.x=
e*a.z-d*a.y;this.y=d*a.x-c*a.z;this.z=c*a.y-e*a.x;return this},crossVectors:function(a,b){var c=a.x,e=a.y,d=a.z,g=b.x,f=b.y,h=b.z;this.x=e*h-d*f;this.y=d*g-c*h;this.z=c*f-e*g;return this},projectOnVector:function(){var a,b;return function(c){void 0===a&&(a=new THREE.Vector3);a.copy(c).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a;return function(b){void 0===a&&(a=new THREE.Vector3);a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a;
return function(b){void 0===a&&(a=new THREE.Vector3);return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/(this.length()*a.length());return Math.acos(THREE.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},setEulerFromRotationMatrix:function(a,b){console.error("REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code.")},
setEulerFromQuaternion:function(a,b){console.error("REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code.")},getPositionFromMatrix:function(a){console.warn("DEPRECATED: Vector3's .getPositionFromMatrix() has been renamed to .setFromMatrixPosition(). Please update your code.");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("DEPRECATED: Vector3's .getScaleFromMatrix() has been renamed to .setFromMatrixScale(). Please update your code.");
return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){console.warn("DEPRECATED: Vector3's .getColumnFromMatrix() has been renamed to .setFromMatrixColumn(). Please update your code.");return this.setFromMatrixColumn(a,b)},setFromMatrixPosition:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},setFromMatrixScale:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length();
a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){var c=4*a,e=b.elements;this.x=e[c];this.y=e[c+1];this.z=e[c+2];return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];return this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};
THREE.Vector4=function(a,b,c,e){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==e?e:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,e){this.x=a;this.y=b;this.z=c;this.w=e;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},
addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},sub:function(a,b){if(void 0!==b)return console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},
applyMatrix4:function(a){var b=this.x,c=this.y,e=this.z,d=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*e+a[12]*d;this.y=a[1]*b+a[5]*c+a[9]*e+a[13]*d;this.z=a[2]*b+a[6]*c+a[10]*e+a[14]*d;this.w=a[3]*b+a[7]*c+a[11]*e+a[15]*d;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,
this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){var b,c,e;a=a.elements;var d=a[0];e=a[4];var g=a[8],f=a[1],h=a[5],k=a[9];c=a[2];b=a[6];var l=a[10];if(0.01>Math.abs(e-f)&&0.01>Math.abs(g-c)&&0.01>Math.abs(k-b)){if(0.1>Math.abs(e+f)&&0.1>Math.abs(g+c)&&0.1>Math.abs(k+b)&&0.1>Math.abs(d+h+l-3))return this.set(1,0,0,0),this;a=Math.PI;d=(d+1)/2;h=(h+1)/2;l=(l+1)/2;e=(e+f)/4;g=(g+c)/4;k=(k+b)/4;d>h&&d>l?0.01>d?(b=0,e=c=0.707106781):(b=Math.sqrt(d),c=e/b,e=g/b):h>l?0.01>
h?(b=0.707106781,c=0,e=0.707106781):(c=Math.sqrt(h),b=e/c,e=k/c):0.01>l?(c=b=0.707106781,e=0):(e=Math.sqrt(l),b=g/e,c=k/e);this.set(b,c,e,a);return this}a=Math.sqrt((b-k)*(b-k)+(g-c)*(g-c)+(f-e)*(f-e));0.001>Math.abs(a)&&(a=1);this.x=(b-k)/a;this.y=(g-c)/a;this.z=(f-e)/a;this.w=Math.acos((d+h+l-1)/2);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.w>a.w&&(this.w=a.w);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=
a.y);this.z<a.z&&(this.z=a.z);this.w<a.w&&(this.w=a.w);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w);return this},clampScalar:function(){var a,b;return function(c,e){void 0===a&&(a=new THREE.Vector4,b=new THREE.Vector4);a.set(c,c,c,c);b.set(e,e,e,e);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=
Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):
Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},
setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];this.w=a[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,
this.w)}};THREE.Euler=function(a,b,c,e){this._x=a||0;this._y=b||0;this._z=c||0;this._order=e||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");THREE.Euler.DefaultOrder="XYZ";
THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,_quaternion:void 0,_updateQuaternion:function(){void 0!==this._quaternion&&this._quaternion.setFromEuler(this,!1)},get x(){return this._x},set x(a){this._x=a;this._updateQuaternion()},get y(){return this._y},set y(a){this._y=a;this._updateQuaternion()},get z(){return this._z},set z(a){this._z=a;this._updateQuaternion()},get order(){return this._order},set order(a){this._order=a;this._updateQuaternion()},
set:function(a,b,c,e){this._x=a;this._y=b;this._z=c;this._order=e||this._order;this._updateQuaternion();return this},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this._updateQuaternion();return this},setFromRotationMatrix:function(a,b){function c(a){return Math.min(Math.max(a,-1),1)}var e=a.elements,d=e[0],g=e[4],f=e[8],h=e[1],k=e[5],l=e[9],m=e[2],n=e[6],e=e[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(c(f)),0.99999>Math.abs(f)?(this._x=Math.atan2(-l,e),this._z=
Math.atan2(-g,d)):(this._x=Math.atan2(n,k),this._z=0)):"YXZ"===b?(this._x=Math.asin(-c(l)),0.99999>Math.abs(l)?(this._y=Math.atan2(f,e),this._z=Math.atan2(h,k)):(this._y=Math.atan2(-m,d),this._z=0)):"ZXY"===b?(this._x=Math.asin(c(n)),0.99999>Math.abs(n)?(this._y=Math.atan2(-m,e),this._z=Math.atan2(-g,k)):(this._y=0,this._z=Math.atan2(h,d))):"ZYX"===b?(this._y=Math.asin(-c(m)),0.99999>Math.abs(m)?(this._x=Math.atan2(n,e),this._z=Math.atan2(h,d)):(this._x=0,this._z=Math.atan2(-g,k))):"YZX"===b?(this._z=
Math.asin(c(h)),0.99999>Math.abs(h)?(this._x=Math.atan2(-l,k),this._y=Math.atan2(-m,d)):(this._x=0,this._y=Math.atan2(f,e))):"XZY"===b?(this._z=Math.asin(-c(g)),0.99999>Math.abs(g)?(this._x=Math.atan2(n,k),this._y=Math.atan2(f,d)):(this._x=Math.atan2(-l,e),this._y=0)):console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+b);this._order=b;this._updateQuaternion();return this},setFromQuaternion:function(a,b,c){function e(a){return Math.min(Math.max(a,-1),1)}var d=a.x*a.x,g=
a.y*a.y,f=a.z*a.z,h=a.w*a.w;b=b||this._order;"XYZ"===b?(this._x=Math.atan2(2*(a.x*a.w-a.y*a.z),h-d-g+f),this._y=Math.asin(e(2*(a.x*a.z+a.y*a.w))),this._z=Math.atan2(2*(a.z*a.w-a.x*a.y),h+d-g-f)):"YXZ"===b?(this._x=Math.asin(e(2*(a.x*a.w-a.y*a.z))),this._y=Math.atan2(2*(a.x*a.z+a.y*a.w),h-d-g+f),this._z=Math.atan2(2*(a.x*a.y+a.z*a.w),h-d+g-f)):"ZXY"===b?(this._x=Math.asin(e(2*(a.x*a.w+a.y*a.z))),this._y=Math.atan2(2*(a.y*a.w-a.z*a.x),h-d-g+f),this._z=Math.atan2(2*(a.z*a.w-a.x*a.y),h-d+g-f)):"ZYX"===
b?(this._x=Math.atan2(2*(a.x*a.w+a.z*a.y),h-d-g+f),this._y=Math.asin(e(2*(a.y*a.w-a.x*a.z))),this._z=Math.atan2(2*(a.x*a.y+a.z*a.w),h+d-g-f)):"YZX"===b?(this._x=Math.atan2(2*(a.x*a.w-a.z*a.y),h-d+g-f),this._y=Math.atan2(2*(a.y*a.w-a.x*a.z),h+d-g-f),this._z=Math.asin(e(2*(a.x*a.y+a.z*a.w)))):"XZY"===b?(this._x=Math.atan2(2*(a.x*a.w+a.y*a.z),h-d+g-f),this._y=Math.atan2(2*(a.x*a.z+a.y*a.w),h+d-g-f),this._z=Math.asin(e(2*(a.z*a.w-a.x*a.y)))):console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+
b);this._order=b;!1!==c&&this._updateQuaternion();return this},reorder:function(){var a=new THREE.Quaternion;return function(b){a.setFromEuler(this);this.setFromQuaternion(a,b)}}(),fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this._updateQuaternion();return this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},clone:function(){return new THREE.Euler(this._x,
this._y,this._z,this._order)}};THREE.Line3=function(a,b){this.start=void 0!==a?a:new THREE.Vector3;this.end=void 0!==b?b:new THREE.Vector3};
THREE.Line3.prototype={constructor:THREE.Line3,set:function(a,b){this.start.copy(a);this.end.copy(b);return this},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},center:function(a){return(a||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(a){return(a||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,
b){var c=b||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,e){a.subVectors(c,this.start);b.subVectors(this.end,this.start);var d=b.dot(b),d=b.dot(a)/d;e&&(d=THREE.Math.clamp(d,0,1));return d}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);c=c||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);
this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}};THREE.Box2=function(a,b){this.min=void 0!==a?a:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector2(-Infinity,-Infinity)};
THREE.Box2.prototype={constructor:THREE.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var c=1,e=a.length;c<e;c++)b=a[c],b.x<this.min.x?this.min.x=b.x:b.x>this.max.x&&(this.max.x=b.x),b.y<this.min.y?this.min.y=b.y:b.y>this.max.y&&(this.max.y=b.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=new THREE.Vector2;return function(b,c){var e=a.copy(c).multiplyScalar(0.5);
this.min.copy(b).sub(e);this.max.copy(b).add(e);return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);
this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector2).set((a.x-this.min.x)/(this.max.x-this.min.x),
(a.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);
return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};THREE.Box3=function(a,b){this.min=void 0!==a?a:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.Box3.prototype={constructor:THREE.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},addPoint:function(a){a.x<this.min.x?this.min.x=a.x:a.x>this.max.x&&(this.max.x=a.x);a.y<this.min.y?this.min.y=a.y:a.y>this.max.y&&(this.max.y=a.y);a.z<this.min.z?this.min.z=a.z:a.z>this.max.z&&(this.max.z=a.z)},setFromPoints:function(a){if(0<a.length){var b=a[0];this.min.copy(b);this.max.copy(b);for(var b=1,c=a.length;b<c;b++)this.addPoint(a[b])}else this.makeEmpty();return this},setFromCenterAndSize:function(){var a=
new THREE.Vector3;return function(b,c){var e=a.copy(c).multiplyScalar(0.5);this.min.copy(b).sub(e);this.max.copy(b).add(e);return this}}(),setFromObject:function(){var a=new THREE.Vector3;return function(b){var c=this;b.updateMatrixWorld(!0);this.makeEmpty();b.traverse(function(b){if(void 0!==b.geometry&&void 0!==b.geometry.vertices)for(var d=b.geometry.vertices,g=0,f=d.length;g<f;g++)a.copy(d[g]),a.applyMatrix4(b.matrixWorld),c.expandByPoint(a)});return this}}(),copy:function(a){this.min.copy(a.min);
this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(a){return(a||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);
this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector3).set((a.x-this.min.x)/(this.max.x-
this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=
new THREE.Vector3;return function(b){b=b||new THREE.Sphere;b.center=this.center();b.radius=0.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(b){a[0].set(this.min.x,this.min.y,
this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),getTransformedBox:function(a,
b){function c(a,b,d){var c=g[0]*a+g[4]*b+g[8]*d+g[12],e=g[1]*a+g[5]*b+g[9]*d+g[13];a=g[2]*a+g[6]*b+g[10]*d+g[14];c<f&&(f=c);e<h&&(h=e);a<k&&(k=a);c>l&&(l=c);e>m&&(m=e);a>n&&(n=a)}var e=this.min,d=this.max,g=a.elements,f=Infinity,h=Infinity,k=Infinity,l=-Infinity,m=-Infinity,n=-Infinity;c(e.x,e.y,e.z);c(e.x,e.y,d.z);c(e.x,d.y,e.z);c(e.x,d.y,d.z);c(d.x,e.y,e.z);c(d.x,e.y,d.z);c(d.x,d.y,e.z);c(d.x,d.y,d.z);b.min.set(f,h,k);b.max.set(l,m,n)},translate:function(a){this.min.add(a);this.max.add(a);return this},
equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};THREE.Matrix3=function(a,b,c,e,d,g,f,h,k){this.elements=new Float32Array(9);this.set(void 0!==a?a:1,b||0,c||0,e||0,void 0!==d?d:1,g||0,f||0,h||0,void 0!==k?k:1)};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(a,b,c,e,d,g,f,h,k){var l=this.elements;l[0]=a;l[3]=b;l[6]=c;l[1]=e;l[4]=d;l[7]=g;l[2]=f;l[5]=h;l[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},
multiplyVector3Array:function(){var a=new THREE.Vector3;return function(b){for(var c=0,e=b.length;c<e;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix3(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],e=a[2],d=a[3],g=a[4],f=a[5],h=a[6],k=a[7],a=a[8];return b*g*a-b*f*k-c*d*a+c*f*h+e*d*k-e*g*h},getInverse:function(a,
b){var c=a.elements,e=this.elements;e[0]=c[10]*c[5]-c[6]*c[9];e[1]=-c[10]*c[1]+c[2]*c[9];e[2]=c[6]*c[1]-c[2]*c[5];e[3]=-c[10]*c[4]+c[6]*c[8];e[4]=c[10]*c[0]-c[2]*c[8];e[5]=-c[6]*c[0]+c[2]*c[4];e[6]=c[9]*c[4]-c[5]*c[8];e[7]=-c[9]*c[0]+c[1]*c[8];e[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*e[0]+c[1]*e[3]+c[2]*e[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/
c);return this},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],
a[6],a[7],a[8]]},clone:function(){var a=this.elements;return new THREE.Matrix3(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}};THREE.Matrix4=function(a,b,c,e,d,g,f,h,k,l,m,n,r,p,t,s){var u=this.elements=new Float32Array(16);u[0]=void 0!==a?a:1;u[4]=b||0;u[8]=c||0;u[12]=e||0;u[1]=d||0;u[5]=void 0!==g?g:1;u[9]=f||0;u[13]=h||0;u[2]=k||0;u[6]=l||0;u[10]=void 0!==m?m:1;u[14]=n||0;u[3]=r||0;u[7]=p||0;u[11]=t||0;u[15]=void 0!==s?s:1};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,e,d,g,f,h,k,l,m,n,r,p,t,s){var u=this.elements;u[0]=a;u[4]=b;u[8]=c;u[12]=e;u[1]=d;u[5]=g;u[9]=f;u[13]=h;u[2]=k;u[6]=l;u[10]=m;u[14]=n;u[3]=r;u[7]=p;u[11]=t;u[15]=s;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){this.elements.set(a.elements);return this},extractPosition:function(a){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");
return this.copyPosition(a)},copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractRotation:function(){var a=new THREE.Vector3;return function(b){var c=this.elements;b=b.elements;var e=1/a.set(b[0],b[1],b[2]).length(),d=1/a.set(b[4],b[5],b[6]).length(),g=1/a.set(b[8],b[9],b[10]).length();c[0]=b[0]*e;c[1]=b[1]*e;c[2]=b[2]*e;c[4]=b[4]*d;c[5]=b[5]*d;c[6]=b[6]*d;c[8]=b[8]*g;c[9]=b[9]*g;c[10]=b[10]*g;return this}}(),makeRotationFromEuler:function(a){!1===
a instanceof THREE.Euler&&console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var b=this.elements,c=a.x,e=a.y,d=a.z,g=Math.cos(c),c=Math.sin(c),f=Math.cos(e),e=Math.sin(e),h=Math.cos(d),d=Math.sin(d);if("XYZ"===a.order){a=g*h;var k=g*d,l=c*h,m=c*d;b[0]=f*h;b[4]=-f*d;b[8]=e;b[1]=k+l*e;b[5]=a-m*e;b[9]=-c*f;b[2]=m-a*e;b[6]=l+k*e;b[10]=g*f}else"YXZ"===a.order?(a=f*h,k=f*d,l=e*h,m=e*d,b[0]=a+m*c,b[4]=l*c-k,b[8]=
g*e,b[1]=g*d,b[5]=g*h,b[9]=-c,b[2]=k*c-l,b[6]=m+a*c,b[10]=g*f):"ZXY"===a.order?(a=f*h,k=f*d,l=e*h,m=e*d,b[0]=a-m*c,b[4]=-g*d,b[8]=l+k*c,b[1]=k+l*c,b[5]=g*h,b[9]=m-a*c,b[2]=-g*e,b[6]=c,b[10]=g*f):"ZYX"===a.order?(a=g*h,k=g*d,l=c*h,m=c*d,b[0]=f*h,b[4]=l*e-k,b[8]=a*e+m,b[1]=f*d,b[5]=m*e+a,b[9]=k*e-l,b[2]=-e,b[6]=c*f,b[10]=g*f):"YZX"===a.order?(a=g*f,k=g*e,l=c*f,m=c*e,b[0]=f*h,b[4]=m-a*d,b[8]=l*d+k,b[1]=d,b[5]=g*h,b[9]=-c*h,b[2]=-e*h,b[6]=k*d+l,b[10]=a-m*d):"XZY"===a.order&&(a=g*f,k=g*e,l=c*f,m=c*e,b[0]=
f*h,b[4]=-d,b[8]=e*h,b[1]=a*d+m,b[5]=g*h,b[9]=k*d-l,b[2]=l*d-k,b[6]=c*h,b[10]=m*d+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},setRotationFromQuaternion:function(a){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(a)},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,e=a.y,d=a.z,g=a.w,f=c+c,h=e+e,k=d+d;a=c*f;var l=c*
h,c=c*k,m=e*h,e=e*k,d=d*k,f=g*f,h=g*h,g=g*k;b[0]=1-(m+d);b[4]=l-g;b[8]=c+h;b[1]=l+g;b[5]=1-(a+d);b[9]=e-f;b[2]=c-h;b[6]=e+f;b[10]=1-(a+m);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(e,d,g){var f=this.elements;c.subVectors(e,d).normalize();0===c.length()&&(c.z=1);a.crossVectors(g,c).normalize();0===a.length()&&(c.x+=1E-4,a.crossVectors(g,c).normalize());b.crossVectors(c,a);f[0]=
a.x;f[4]=b.x;f[8]=c.x;f[1]=a.y;f[5]=b.y;f[9]=c.y;f[2]=a.z;f[6]=b.z;f[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,e=b.elements,d=this.elements,g=c[0],f=c[4],h=c[8],k=c[12],l=c[1],m=c[5],n=c[9],r=c[13],p=c[2],t=c[6],s=c[10],u=c[14],v=c[3],w=c[7],z=c[11],
c=c[15],x=e[0],y=e[4],C=e[8],B=e[12],D=e[1],F=e[5],O=e[9],H=e[13],I=e[2],E=e[6],P=e[10],T=e[14],S=e[3],U=e[7],N=e[11],e=e[15];d[0]=g*x+f*D+h*I+k*S;d[4]=g*y+f*F+h*E+k*U;d[8]=g*C+f*O+h*P+k*N;d[12]=g*B+f*H+h*T+k*e;d[1]=l*x+m*D+n*I+r*S;d[5]=l*y+m*F+n*E+r*U;d[9]=l*C+m*O+n*P+r*N;d[13]=l*B+m*H+n*T+r*e;d[2]=p*x+t*D+s*I+u*S;d[6]=p*y+t*F+s*E+u*U;d[10]=p*C+t*O+s*P+u*N;d[14]=p*B+t*H+s*T+u*e;d[3]=v*x+w*D+z*I+c*S;d[7]=v*y+w*F+z*E+c*U;d[11]=v*C+w*O+z*P+c*N;d[15]=v*B+w*H+z*T+c*e;return this},multiplyToArray:function(a,
b,c){var e=this.elements;this.multiplyMatrices(a,b);c[0]=e[0];c[1]=e[1];c[2]=e[2];c[3]=e[3];c[4]=e[4];c[5]=e[5];c[6]=e[6];c[7]=e[7];c[8]=e[8];c[9]=e[9];c[10]=e[10];c[11]=e[11];c[12]=e[12];c[13]=e[13];c[14]=e[14];c[15]=e[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");
return a.applyProjection(this)},multiplyVector4:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){var a=new THREE.Vector3;return function(b){for(var c=0,e=b.length;c<e;c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyProjection(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),rotateAxis:function(a){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");
a.transformDirection(this)},crossVector:function(a){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},determinant:function(){var a=this.elements,b=a[0],c=a[4],e=a[8],d=a[12],g=a[1],f=a[5],h=a[9],k=a[13],l=a[2],m=a[6],n=a[10],r=a[14];return a[3]*(+d*h*m-e*k*m-d*f*n+c*k*n+e*f*r-c*h*r)+a[7]*(+b*h*r-b*k*n+d*g*n-e*g*r+e*k*l-d*h*l)+a[11]*(+b*k*m-b*f*r-d*g*m+c*g*r+d*f*l-c*k*l)+a[15]*(-e*f*l-b*h*m+b*f*n+e*g*m-c*g*
n+c*h*l)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},flattenToArrayOffset:function(a,b){var c=this.elements;
a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;
b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,e=a.elements,d=e[0],g=e[4],f=e[8],h=e[12],k=e[1],l=e[5],m=e[9],n=e[13],r=e[2],p=e[6],t=e[10],s=e[14],u=e[3],v=e[7],w=e[11],e=e[15];c[0]=m*s*v-n*t*v+n*p*w-l*s*w-m*p*e+l*t*e;c[4]=h*t*v-f*s*v-h*p*w+g*s*w+f*p*e-g*t*e;c[8]=f*n*v-h*m*v+h*l*w-g*n*w-f*l*e+g*m*e;c[12]=h*m*p-f*n*p-h*l*t+g*n*t+f*l*s-g*m*s;c[1]=n*t*u-m*s*u-n*r*w+k*s*w+m*r*e-k*t*e;c[5]=f*s*u-h*t*u+h*r*w-d*s*w-f*r*e+d*t*e;c[9]=h*m*u-f*n*u-h*k*w+d*n*w+f*k*e-
d*m*e;c[13]=f*n*r-h*m*r+h*k*t-d*n*t-f*k*s+d*m*s;c[2]=l*s*u-n*p*u+n*r*v-k*s*v-l*r*e+k*p*e;c[6]=h*p*u-g*s*u-h*r*v+d*s*v+g*r*e-d*p*e;c[10]=g*n*u-h*l*u+h*k*v-d*n*v-g*k*e+d*l*e;c[14]=h*l*r-g*n*r-h*k*p+d*n*p+g*k*s-d*l*s;c[3]=m*p*u-l*t*u-m*r*v+k*t*v+l*r*w-k*p*w;c[7]=g*t*u-f*p*u+f*r*v-d*t*v-g*r*w+d*p*w;c[11]=f*l*u-g*m*u-f*k*v+d*m*v+g*k*w-d*l*w;c[15]=g*m*r-f*l*r+f*k*p-d*m*p-g*k*t+d*l*t;c=d*c[0]+k*c[4]+r*c[8]+u*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");
this.identity();return this}this.multiplyScalar(1/c);return this},translate:function(a){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(a){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(a){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(a){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(a,b){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},
scale:function(a){var b=this.elements,c=a.x,e=a.y;a=a.z;b[0]*=c;b[4]*=e;b[8]*=a;b[1]*=c;b[5]*=e;b[9]*=a;b[2]*=c;b[6]*=e;b[10]*=a;b[3]*=c;b[7]*=e;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,
0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),e=Math.sin(b),d=1-c,g=a.x,f=a.y,h=a.z,k=d*g,l=d*f;this.set(k*g+c,k*f-e*h,k*h+e*f,0,k*f+e*h,l*f+c,l*h-e*g,0,k*h-e*f,l*h+e*g,d*h*h+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,
0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a=new THREE.Vector3,b=new THREE.Matrix4;return function(c,e,d){var g=this.elements,f=a.set(g[0],g[1],g[2]).length(),h=a.set(g[4],g[5],g[6]).length(),k=a.set(g[8],g[9],g[10]).length();0>this.determinant()&&(f=-f);c.x=g[12];c.y=g[13];c.z=g[14];b.elements.set(this.elements);c=1/f;var g=1/h,l=1/k;b.elements[0]*=c;b.elements[1]*=
c;b.elements[2]*=c;b.elements[4]*=g;b.elements[5]*=g;b.elements[6]*=g;b.elements[8]*=l;b.elements[9]*=l;b.elements[10]*=l;e.setFromRotationMatrix(b);d.x=f;d.y=h;d.z=k;return this}}(),makeFrustum:function(a,b,c,e,d,g){var f=this.elements;f[0]=2*d/(b-a);f[4]=0;f[8]=(b+a)/(b-a);f[12]=0;f[1]=0;f[5]=2*d/(e-c);f[9]=(e+c)/(e-c);f[13]=0;f[2]=0;f[6]=0;f[10]=-(g+d)/(g-d);f[14]=-2*g*d/(g-d);f[3]=0;f[7]=0;f[11]=-1;f[15]=0;return this},makePerspective:function(a,b,c,e){a=c*Math.tan(THREE.Math.degToRad(0.5*a));
var d=-a;return this.makeFrustum(d*b,a*b,d,a,c,e)},makeOrthographic:function(a,b,c,e,d,g){var f=this.elements,h=b-a,k=c-e,l=g-d;f[0]=2/h;f[4]=0;f[8]=0;f[12]=-((b+a)/h);f[1]=0;f[5]=2/k;f[9]=0;f[13]=-((c+e)/k);f[2]=0;f[6]=0;f[10]=-2/l;f[14]=-((g+d)/l);f[3]=0;f[7]=0;f[11]=0;f[15]=1;return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){var a=
this.elements;return new THREE.Matrix4(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};THREE.Ray=function(a,b){this.origin=void 0!==a?a:new THREE.Vector3;this.direction=void 0!==b?b:new THREE.Vector3};
THREE.Ray.prototype={constructor:THREE.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new THREE.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new THREE.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var c=b||new THREE.Vector3;c.subVectors(a,this.origin);
var e=c.dot(this.direction);return 0>e?c.copy(this.origin):c.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceTo(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceTo(b)}}(),distanceSqToSegment:function(a,b,c,e){var d=a.clone().add(b).multiplyScalar(0.5),g=b.clone().sub(a).normalize(),f=0.5*a.distanceTo(b),
h=this.origin.clone().sub(d);a=-this.direction.dot(g);b=h.dot(this.direction);var k=-h.dot(g),l=h.lengthSq(),m=Math.abs(1-a*a),n,r;0<=m?(h=a*k-b,n=a*b-k,r=f*m,0<=h?n>=-r?n<=r?(f=1/m,h*=f,n*=f,a=h*(h+a*n+2*b)+n*(a*h+n+2*k)+l):(n=f,h=Math.max(0,-(a*n+b)),a=-h*h+n*(n+2*k)+l):(n=-f,h=Math.max(0,-(a*n+b)),a=-h*h+n*(n+2*k)+l):n<=-r?(h=Math.max(0,-(-a*f+b)),n=0<h?-f:Math.min(Math.max(-f,-k),f),a=-h*h+n*(n+2*k)+l):n<=r?(h=0,n=Math.min(Math.max(-f,-k),f),a=n*(n+2*k)+l):(h=Math.max(0,-(a*f+b)),n=0<h?f:Math.min(Math.max(-f,
-k),f),a=-h*h+n*(n+2*k)+l)):(n=0<a?-f:f,h=Math.max(0,-(a*n+b)),a=-h*h+n*(n+2*k)+l);c&&c.copy(this.direction.clone().multiplyScalar(h).add(this.origin));e&&e.copy(g.clone().multiplyScalar(n).add(d));return a},isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},isIntersectionPlane:function(a){var b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0==b)return 0==a.distanceToPoint(this.origin)?
0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return null===c?null:this.at(c,b)},isIntersectionBox:function(){var a=new THREE.Vector3;return function(b){return null!==this.intersectBox(b,a)}}(),intersectBox:function(a,b){var c,e,d,g,f;e=1/this.direction.x;g=1/this.direction.y;f=1/this.direction.z;var h=this.origin;0<=e?(c=(a.min.x-h.x)*e,e*=a.max.x-h.x):(c=(a.max.x-h.x)*e,e*=a.min.x-h.x);0<=g?(d=(a.min.y-h.y)*g,g*=
a.max.y-h.y):(d=(a.max.y-h.y)*g,g*=a.min.y-h.y);if(c>g||d>e)return null;if(d>c||c!==c)c=d;if(g<e||e!==e)e=g;0<=f?(d=(a.min.z-h.z)*f,f*=a.max.z-h.z):(d=(a.max.z-h.z)*f,f*=a.min.z-h.z);if(c>f||d>e)return null;if(d>c||c!==c)c=d;if(f<e||e!==e)e=f;return 0>e?null:this.at(0<=c?c:e,b)},intersectTriangle:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,e=new THREE.Vector3;return function(d,g,f,h,k){b.subVectors(g,d);c.subVectors(f,d);e.crossVectors(b,c);g=this.direction.dot(e);if(0<
g){if(h)return null;h=1}else if(0>g)h=-1,g=-g;else return null;a.subVectors(this.origin,d);d=h*this.direction.dot(c.crossVectors(a,c));if(0>d)return null;f=h*this.direction.dot(b.cross(a));if(0>f||d+f>g)return null;d=-h*a.dot(e);return 0>d?null:this.at(d/g,k)}}(),applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},
clone:function(){return(new THREE.Ray).copy(this)}};THREE.Sphere=function(a,b){this.center=void 0!==a?a:new THREE.Vector3;this.radius=void 0!==b?b:0};
THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new THREE.Box3;return function(b,c){var e=this.center;void 0!==c?e.copy(c):a.setFromPoints(b).center(e);for(var d=0,g=0,f=b.length;g<f;g++)d=Math.max(d,e.distanceToSquared(b[g]));this.radius=Math.sqrt(d);return this}}(),copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=
this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),e=b||new THREE.Vector3;e.copy(a);c>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center));return e},getBoundingBox:function(a){a=a||new THREE.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);
return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};
THREE.Frustum=function(a,b,c,e,d,g){this.planes=[void 0!==a?a:new THREE.Plane,void 0!==b?b:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==g?g:new THREE.Plane]};
THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(a,b,c,e,d,g){var f=this.planes;f[0].copy(a);f[1].copy(b);f[2].copy(c);f[3].copy(e);f[4].copy(d);f[5].copy(g);return this},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var e=c[1],d=c[2],g=c[3],f=c[4],h=c[5],k=c[6],l=c[7],m=c[8],n=c[9],r=c[10],p=c[11],t=c[12],s=c[13],u=c[14],c=c[15];b[0].setComponents(g-a,l-f,p-m,c-t).normalize();b[1].setComponents(g+
a,l+f,p+m,c+t).normalize();b[2].setComponents(g+e,l+h,p+n,c+s).normalize();b[3].setComponents(g-e,l-h,p-n,c-s).normalize();b[4].setComponents(g-d,l-k,p-r,c-u).normalize();b[5].setComponents(g+d,l+k,p+r,c+u).normalize();return this},intersectsObject:function(){var a=new THREE.Sphere;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere);a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,
c=a.center;a=-a.radius;for(var e=0;6>e;e++)if(b[e].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){for(var e=this.planes,d=0;6>d;d++){var g=e[d];a.x=0<g.normal.x?c.min.x:c.max.x;b.x=0<g.normal.x?c.max.x:c.min.x;a.y=0<g.normal.y?c.min.y:c.max.y;b.y=0<g.normal.y?c.max.y:c.min.y;a.z=0<g.normal.z?c.min.z:c.max.z;b.z=0<g.normal.z?c.max.z:c.min.z;var f=g.distanceToPoint(a),g=g.distanceToPoint(b);if(0>f&&0>g)return!1}return!0}}(),
containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Plane=function(a,b){this.normal=void 0!==a?a:new THREE.Vector3(1,0,0);this.constant=void 0!==b?b:0};
THREE.Plane.prototype={constructor:THREE.Plane,set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,e){this.normal.set(a,b,c);this.constant=e;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,e,d){e=a.subVectors(d,e).cross(b.subVectors(c,e)).normalize();this.setFromNormalAndCoplanarPoint(e,
c);return this}}(),copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,
b){var c=this.distanceToPoint(a);return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectLine:function(){var a=new THREE.Vector3;return function(b,c){var e=c||new THREE.Vector3,d=b.delta(a),g=this.normal.dot(d);if(0==g){if(0==this.distanceToPoint(b.start))return e.copy(b.start)}else return g=-(b.start.dot(this.normal)+this.constant)/g,0>g||1<g?void 0:e.copy(d).multiplyScalar(g).add(b.start)}}(),
coplanarPoint:function(a){return(a||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(e,d){var g=d||c.getNormalMatrix(e),g=a.copy(this.normal).applyMatrix3(g),f=this.coplanarPoint(b);f.applyMatrix4(e);this.setFromNormalAndCoplanarPoint(g,f);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&
a.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};
THREE.Math={PI2:2*Math.PI,generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,e;return function(){for(var d=0;36>d;d++)8==d||13==d||18==d||23==d?b[d]="-":14==d?b[d]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),e=c&15,c>>=4,b[d]=a[19==d?e&3|8:e]);return b.join("")}}(),clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},mapLinear:function(a,b,c,e,d){return e+(a-b)*(d-e)/(c-b)},smoothstep:function(a,
b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(0.5-Math.random())},sign:function(a){return 0>a?-1:0<a?1:0},degToRad:function(){var a=Math.PI/
180;return function(b){return b*a}}(),radToDeg:function(){var a=180/Math.PI;return function(b){return b*a}}(),isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a}};
THREE.Spline=function(a){function b(a,b,f,d,c,h,e){a=0.5*(f-a);d=0.5*(d-b);return(2*(b-f)+a+d)*e+(-3*(b-f)-2*a-d)*h+a*c+b}this.points=a;var c=[],e={x:0,y:0,z:0},d,g,f,h,k,l,m,n,r;this.initFromArray=function(a){this.points=[];for(var b=0;b<a.length;b++)this.points[b]={x:a[b][0],y:a[b][1],z:a[b][2]}};this.getPoint=function(a){d=(this.points.length-1)*a;g=Math.floor(d);f=d-g;c[0]=0===g?g:g-1;c[1]=g;c[2]=g>this.points.length-2?this.points.length-1:g+1;c[3]=g>this.points.length-3?this.points.length-1:
g+2;l=this.points[c[0]];m=this.points[c[1]];n=this.points[c[2]];r=this.points[c[3]];h=f*f;k=f*h;e.x=b(l.x,m.x,n.x,r.x,f,h,k);e.y=b(l.y,m.y,n.y,r.y,f,h,k);e.z=b(l.z,m.z,n.z,r.z,f,h,k);return e};this.getControlPointsArray=function(){var a,b,f=this.points.length,d=[];for(a=0;a<f;a++)b=this.points[a],d[a]=[b.x,b.y,b.z];return d};this.getLength=function(a){var b,f,d,c=0,h=new THREE.Vector3,e=new THREE.Vector3,k=[],g=0;k[0]=0;a||(a=100);f=this.points.length*a;h.copy(this.points[0]);for(a=1;a<f;a++)b=a/
f,d=this.getPoint(b),e.copy(d),g+=e.distanceTo(h),h.copy(d),b*=this.points.length-1,b=Math.floor(b),b!=c&&(k[b]=g,c=b);k[k.length]=g;return{chunks:k,total:g}};this.reparametrizeByArcLength=function(a){var b,f,d,c,h,e,k=[],g=new THREE.Vector3,l=this.getLength();k.push(g.copy(this.points[0]).clone());for(b=1;b<this.points.length;b++){f=l.chunks[b]-l.chunks[b-1];e=Math.ceil(a*f/l.total);c=(b-1)/(this.points.length-1);h=b/(this.points.length-1);for(f=1;f<e-1;f++)d=c+1/e*f*(h-c),d=this.getPoint(d),k.push(g.copy(d).clone());
k.push(g.copy(this.points[b]).clone())}this.points=k}};THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3;this.b=void 0!==b?b:new THREE.Vector3;this.c=void 0!==c?c:new THREE.Vector3};THREE.Triangle.normal=function(){var a=new THREE.Vector3;return function(b,c,e,d){d=d||new THREE.Vector3;d.subVectors(e,c);a.subVectors(b,c);d.cross(a);b=d.lengthSq();return 0<b?d.multiplyScalar(1/Math.sqrt(b)):d.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(e,d,g,f,h){a.subVectors(f,d);b.subVectors(g,d);c.subVectors(e,d);e=a.dot(a);d=a.dot(b);g=a.dot(c);var k=b.dot(b);f=b.dot(c);var l=e*k-d*d;h=h||new THREE.Vector3;if(0==l)return h.set(-2,-1,-1);l=1/l;k=(k*g-d*f)*l;e=(e*f-d*g)*l;return h.set(1-k-e,e,k)}}();
THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3;return function(b,c,e,d){b=THREE.Triangle.barycoordFromPoint(b,c,e,d,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();
THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,e){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[e]);return this},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return 0.5*a.cross(b).length()}}(),midpoint:function(a){return(a||
new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)},
clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Vertex=function(a){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return a};THREE.UV=function(a,b){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new THREE.Vector2(a,b)};THREE.Clock=function(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};
THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;this.autoStart&&!this.running&&this.start();if(this.running){var b=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),
a=0.001*(b-this.oldTime);this.oldTime=b;this.elapsedTime+=a}return a}};THREE.EventDispatcher=function(){};
THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(a){a.addEventListener=THREE.EventDispatcher.prototype.addEventListener;a.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;a.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;a.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&
c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners[a];if(void 0!==c){var e=c.indexOf(b);-1!==e&&c.splice(e,1)}}},dispatchEvent:function(){var a=[];return function(b){if(void 0!==this._listeners){var c=this._listeners[b.type];if(void 0!==c){b.target=this;for(var e=c.length,d=0;d<e;d++)a[d]=c[d];for(d=0;d<e;d++)a[d].call(this,
b)}}}}()};
(function(a){a.Raycaster=function(b,f,d,c){this.ray=new a.Ray(b,f);this.near=d||0;this.far=c||Infinity};var b=new a.Sphere,c=new a.Ray;new a.Plane;new a.Vector3;var e=new a.Vector3,d=new a.Matrix4,g=function(a,b){return a.distance-b.distance},f=new a.Vector3,h=new a.Vector3,k=new a.Vector3,l=function(g,m,p){if(g instanceof a.Sprite){e.setFromMatrixPosition(g.matrixWorld);var t=m.ray.distanceToPoint(e);if(t>g.scale.x)return p;p.push({distance:t,point:g.position,face:null,object:g})}else if(g instanceof a.LOD)e.setFromMatrixPosition(g.matrixWorld),
t=m.ray.origin.distanceTo(e),l(g.getObjectForDistance(t),m,p);else if(g instanceof a.Mesh){var s=g.geometry;null===s.boundingSphere&&s.computeBoundingSphere();b.copy(s.boundingSphere);b.applyMatrix4(g.matrixWorld);if(!1===m.ray.isIntersectionSphere(b))return p;d.getInverse(g.matrixWorld);c.copy(m.ray).applyMatrix4(d);if(null!==s.boundingBox&&!1===c.isIntersectionBox(s.boundingBox))return p;if(s instanceof a.BufferGeometry){var u=g.material;if(void 0===u)return p;var v=s.attributes,w,z,x=m.precision;
if(void 0!==v.index)for(var y=v.index.array,C=s.offsets||[{start:0,index:0,count:y.length}],B=s.vb?s.vb:v.position.array,D=s.vb?s.vbstride:3,F=0,O=C.length;F<O;++F)for(var v=C[F].start,H=C[F].index,s=v,I=v+C[F].count;s<I;s+=3){v=H+y[s];w=H+y[s+1];z=H+y[s+2];f.set(B[v*D],B[v*D+1],B[v*D+2]);h.set(B[w*D],B[w*D+1],B[w*D+2]);k.set(B[z*D],B[z*D+1],B[z*D+2]);var E=u.side===a.BackSide?c.intersectTriangle(k,h,f,!0):c.intersectTriangle(f,h,k,u.side!==a.DoubleSide);null!==E&&(E.applyMatrix4(g.matrixWorld),t=
m.ray.origin.distanceTo(E),t<x||t<m.near||t>m.far||p.push({distance:t,point:E,indices:[v,w,z],face:null,faceIndex:null,object:g}))}else for(B=s.vb?s.vb:v.position.array,D=s.vb?s.vbstride:3,s=0,I=v.position.array.length;s<I;s+=3)v=s,w=s+1,z=s+2,f.set(B[v*D],B[v*D+1],B[v*D+2]),h.set(B[w*D],B[w*D+1],B[w*D+2]),k.set(B[z*D],B[z*D+1],B[z*D+2]),E=u.side===a.BackSide?c.intersectTriangle(k,h,f,!0):c.intersectTriangle(f,h,k,u.side!==a.DoubleSide),null!==E&&(E.applyMatrix4(g.matrixWorld),t=m.ray.origin.distanceTo(E),
t<x||t<m.near||t>m.far||p.push({distance:t,point:E,indices:[v,w,z],face:null,faceIndex:null,object:g}))}else if(s instanceof a.Geometry)for(C=g.material instanceof a.MeshFaceMaterial,B=!0===C?g.material.materials:null,x=m.precision,y=s.vertices,D=0,F=s.faces.length;D<F;D++)if(O=s.faces[D],u=!0===C?B[O.materialIndex]:g.material,void 0!==u){v=y[O.a];w=y[O.b];z=y[O.c];if(!0===u.morphTargets){t=s.morphTargets;E=g.morphTargetInfluences;f.set(0,0,0);h.set(0,0,0);k.set(0,0,0);H=0;for(I=t.length;H<I;H++){var P=
E[H];if(0!==P){var T=t[H].vertices;f.x+=(T[O.a].x-v.x)*P;f.y+=(T[O.a].y-v.y)*P;f.z+=(T[O.a].z-v.z)*P;h.x+=(T[O.b].x-w.x)*P;h.y+=(T[O.b].y-w.y)*P;h.z+=(T[O.b].z-w.z)*P;k.x+=(T[O.c].x-z.x)*P;k.y+=(T[O.c].y-z.y)*P;k.z+=(T[O.c].z-z.z)*P}}f.add(v);h.add(w);k.add(z);v=f;w=h;z=k}E=u.side===a.BackSide?c.intersectTriangle(z,w,v,!0):c.intersectTriangle(v,w,z,u.side!==a.DoubleSide);null!==E&&(E.applyMatrix4(g.matrixWorld),t=m.ray.origin.distanceTo(E),t<x||t<m.near||t>m.far||p.push({distance:t,point:E,face:O,
faceIndex:D,object:g}))}}else if(g instanceof a.Line){x=m.linePrecision;u=x*x;s=g.geometry;null===s.boundingSphere&&s.computeBoundingSphere();b.copy(s.boundingSphere);b.applyMatrix4(g.matrixWorld);if(!1===m.ray.isIntersectionSphere(b))return p;d.getInverse(g.matrixWorld);c.copy(m.ray).applyMatrix4(d);if(s instanceof a.Geometry)for(y=s.vertices,x=y.length,v=new a.Vector3,w=new a.Vector3,z=g.type===a.LineStrip?1:2,s=0;s<x-1;s+=z)c.distanceSqToSegment(y[s],y[s+1],w,v)>u||(t=c.origin.distanceTo(w),t<
m.near||t>m.far||p.push({distance:t,point:v.clone().applyMatrix4(g.matrixWorld),face:null,faceIndex:null,object:g}))}},m=function(a,b,f){a=a.getDescendants();for(var d=0,c=a.length;d<c;d++)l(a[d],b,f)};a.Raycaster.prototype.precision=1E-4;a.Raycaster.prototype.linePrecision=1;a.Raycaster.prototype.set=function(a,b){this.ray.set(a,b)};a.Raycaster.prototype.intersectObject=function(a,b){var f=[];!0===b&&m(a,this,f);l(a,this,f);f.sort(g);return f};a.Raycaster.prototype.intersectObjects=function(a,b){for(var f=
[],d=0,c=a.length;d<c;d++)l(a[d],this,f),!0===b&&m(a[d],this,f);f.sort(g);return f}})(THREE);
THREE.Object3D=function(a){this.id=THREE.Object3DIdCount++;this.parent=void 0;a?(this.matrixAutoUpdate=!1,this.skipModTerms=!0):(this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this._rotation=new THREE.Euler,this._quaternion=new THREE.Quaternion,this.scale=new THREE.Vector3(1,1,1),this._rotation._quaternion=this.quaternion,this._quaternion._euler=this.rotation,this.matrixAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.skipModTerms=!1);this.renderDepth=null;this.rotationAutoUpdate=
!0;this.matrixWorld=new THREE.Matrix4;this.visible=this.matrixWorldNeedsUpdate=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0};
THREE.Object3D.prototype={constructor:THREE.Object3D,get rotation(){return this._rotation},set rotation(a){this._rotation=a;this._rotation._quaternion=this._quaternion;this._quaternion._euler=this._rotation;this._rotation._updateQuaternion()},get quaternion(){return this._quaternion},set quaternion(a){this._quaternion=a;this._quaternion._euler=this._rotation;this._rotation._quaternion=this._quaternion;this._quaternion._updateEuler()},get eulerOrder(){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");
return this.rotation.order},set eulerOrder(a){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");this.rotation.order=a},get useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(a){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);
this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new THREE.Quaternion;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateX:function(){var a=
new THREE.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new THREE.Vector3;return function(b,c){a.copy(b);a.applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));return this}}(),translate:function(a,b){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");
return this.translateOnAxis(b,a)},translateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new THREE.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),
lookAt:function(){var a=new THREE.Matrix4;return function(b){a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(a===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(a instanceof THREE.Object3D){void 0!==a.parent&&a.parent.remove(a);a.parent=this;a.dispatchEvent({type:"added"});this.children||(this.children=[]);this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&
b.__addObject(a)}},remove:function(a){if(this.children){var b=this.children.indexOf(a);if(-1!==b){a.parent=void 0;a.dispatchEvent({type:"removed"});this.children.splice(b,1);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__removeObject(a)}}},traverse:function(a){a(this);for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverse(a)},getObjectById:function(a,b){for(var c=0,e=this.children.length;c<e;c++){var d=this.children[c];if(d.id===a||!0===b&&(d=d.getObjectById(a,
b),void 0!==d))return d}},getObjectByName:function(a,b){for(var c=0,e=this.children.length;c<e;c++){var d=this.children[c];if(d.name===a||!0===b&&(d=d.getObjectByName(a,b),void 0!==d))return d}},getChildByName:function(a,b){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(a,b)},getDescendants:function(a){if(!this.children)return null;void 0===a&&(a=[]);Array.prototype.push.apply(a,this.children);for(var b=0,c=this.children.length;b<
c;b++)this.children[b].getDescendants(a);return a},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent&&this.matrix?this.matrixWorld.copy(this.matrix):this.matrix&&this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;if(this.children)for(var b=
0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},clone:function(a,b){void 0===a&&(a=new THREE.Object3D(this.skipModTerms));void 0===b&&(b=!0);this.name&&(a.name=this.name);this.skipModTerms||(a.up.copy(this.up),a.position.copy(this.position),a.quaternion.copy(this.quaternion),a.scale.copy(this.scale));a.renderDepth=this.renderDepth;a.rotationAutoUpdate=this.rotationAutoUpdate;this.matrix?a.matrix.copy(this.matrix):a.matrix=null;a.matrixWorld.copy(this.matrixWorld);a.matrixAutoUpdate=
this.matrixAutoUpdate;a.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;a.visible=this.visible;a.castShadow=this.castShadow;a.receiveShadow=this.receiveShadow;a.frustumCulled=this.frustumCulled;this.userData&&(a.userData=JSON.parse(JSON.stringify(this.userData)));if(!0===b&&this.children)for(var c=0;c<this.children.length;c++)a.add(this.children[c].clone());return a}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;
THREE.Projector=function(){function a(){if(m===r){var a=new THREE.RenderableVertex;n.push(a);r++;m++;return a}return n[m++]}function b(){if(t===u){var a=new THREE.RenderableFace;s.push(a);u++;t++;return a}return s[t++]}function c(){if(w===x){var a=new THREE.RenderableLine;z.push(a);x++;w++;return a}return z[w++]}function e(a,b){return a.z!==b.z?b.z-a.z:a.id!==b.id?a.id-b.id:0}function d(a,b){var f=0,d=1,c=a.z+a.w,h=b.z+b.w,e=-a.z+a.w,k=-b.z+b.w;if(0<=c&&0<=h&&0<=e&&0<=k)return!0;if(0>c&&0>h||0>e&&
0>k)return!1;0>c?f=Math.max(f,c/(c-h)):0>h&&(d=Math.min(d,c/(c-h)));0>e?f=Math.max(f,e/(e-k)):0>k&&(d=Math.min(d,e/(e-k)));if(d<f)return!1;a.lerp(b,f);b.lerp(a,1-d);return!0}var g,f,h=[],k=0,l,m,n=[],r=0,p,t,s=[],u=0,v,w,z=[],x=0,y,C,B=[],D=0,F={objects:[],lights:[],elements:[]},O=new THREE.Vector3,H=new THREE.Vector3,I=new THREE.Vector3,E=new THREE.Vector3,P=new THREE.Vector4,T=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),S=new THREE.Box3,U=Array(3),N=new THREE.Matrix4,aa=
new THREE.Matrix4,Q,R=new THREE.Matrix4,X=new THREE.Matrix3,ga=new THREE.Frustum,K=new THREE.Vector4,ia=new THREE.Vector4;this.projectVector=function(a,b){b.matrixWorldInverse.getInverse(b.matrixWorld);aa.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);return a.applyProjection(aa)};this.unprojectVector=function(){var a=new THREE.Matrix4;return function(b,f){a.getInverse(f.projectionMatrix);aa.multiplyMatrices(f.matrixWorld,a);return b.applyProjection(aa)}}();this.pickingRay=function(a,b){a.z=
-1;var f=new THREE.Vector3(a.x,a.y,1);this.unprojectVector(a,b);this.unprojectVector(f,b);f.sub(a).normalize();return new THREE.Raycaster(a,f)};var ha=function(a){if(!1!==a.visible){if(a instanceof THREE.Light)F.lights.push(a);else if(a instanceof THREE.Mesh||a instanceof THREE.Line||a instanceof THREE.Sprite)if(!1===a.frustumCulled||!0===ga.intersectsObject(a)){if(f===k){var b=new THREE.RenderableObject;h.push(b);k++;f++;g=b}else g=h[f++];g.id=a.id;g.object=a;null!==a.renderDepth?g.z=a.renderDepth:
(E.setFromMatrixPosition(a.matrixWorld),E.applyProjection(aa),g.z=E.z);F.objects.push(g)}for(var b=0,d=a.children.length;b<d;b++)ha(a.children[b])}},ea=new function(){var f=[],d=null,h=new THREE.Matrix3,e=function(a){var b=a.positionWorld,f=a.positionScreen;b.copy(a.position).applyMatrix4(Q);f.copy(b).applyMatrix4(aa);b=1/f.w;f.x*=b;f.y*=b;f.z*=b;a.visible=-1<=f.x&&1>=f.x&&-1<=f.y&&1>=f.y&&-1<=f.z&&1>=f.z},k=function(a,b,f){U[0]=a.positionScreen;U[1]=b.positionScreen;U[2]=f.positionScreen;return!0===
a.visible||!0===b.visible||!0===f.visible||T.isIntersectionBox(S.setFromPoints(U))?0>(f.positionScreen.x-a.positionScreen.x)*(b.positionScreen.y-a.positionScreen.y)-(f.positionScreen.y-a.positionScreen.y)*(b.positionScreen.x-a.positionScreen.x):!1};return{setObject:function(a){d=a;h.getNormalMatrix(d.matrixWorld);f.length=0},projectVertex:e,checkTriangleVisibility:k,pushVertex:function(b,f,d){l=a();l.position.set(b,f,d);e(l)},pushNormal:function(a,b,d){f.push(a,b,d)},pushLine:function(a,b){var f=
n[a],h=n[b];v=c();v.id=d.id;v.v1.copy(f);v.v2.copy(h);v.z=(f.positionScreen.z+h.positionScreen.z)/2;v.material=d.material;F.elements.push(v)},pushTriangle:function(a,c,e){var g=n[a],l=n[c],m=n[e];if(!0===k(g,l,m)){p=b();p.id=d.id;p.v1.copy(g);p.v2.copy(l);p.v3.copy(m);p.z=(g.positionScreen.z+l.positionScreen.z+m.positionScreen.z)/3;for(g=0;3>g;g++)l=3*arguments[g],m=p.vertexNormalsModel[g],m.set(f[l+0],f[l+1],f[l+2]),m.applyMatrix3(h).normalize();p.vertexNormalsLength=3;p.material=d.material;F.elements.push(p)}}}};
this.projectScene=function(h,k,g,l){var r,s,u,S,U,x,E,z,T;C=w=t=0;F.elements.length=0;!0===h.autoUpdate&&h.updateMatrixWorld();void 0===k.parent&&k.updateMatrixWorld();N.copy(k.matrixWorldInverse.getInverse(k.matrixWorld));aa.multiplyMatrices(k.projectionMatrix,N);ga.setFromMatrix(aa);f=0;F.objects.length=0;F.lights.length=0;ha(h);!0===g&&F.objects.sort(e);h=0;for(g=F.objects.length;h<g;h++)if(r=F.objects[h].object,s=r.geometry,ea.setObject(r),Q=r.matrixWorld,m=0,r instanceof THREE.Mesh)if(s instanceof
THREE.BufferGeometry){if(x=s.attributes,r=s.offsets,void 0!==x.position){z=x.position.array;s=0;for(S=z.length;s<S;s+=3)ea.pushVertex(z[s],z[s+1],z[s+2]);T=x.normal.array;s=0;for(S=T.length;s<S;s+=3)ea.pushNormal(T[s],T[s+1],T[s+2]);if(void 0!==x.index)if(x=x.index.array,0<r.length)for(h=0;h<r.length;h++)for(S=r[h],z=S.index,s=S.start,S=S.start+S.count;s<S;s+=3)ea.pushTriangle(x[s]+z,x[s+1]+z,x[s+2]+z);else for(s=0,S=x.length;s<S;s+=3)ea.pushTriangle(x[s],x[s+1],x[s+2]);else for(s=0,S=z.length/3;s<
S;s+=3)ea.pushTriangle(s,s+1,s+2)}}else{if(s instanceof THREE.Geometry){u=s.vertices;S=s.faces;x=s.faceVertexUvs;X.getNormalMatrix(Q);z=r.material instanceof THREE.MeshFaceMaterial;T=!0===z?r.material:null;for(var sa=0,pa=u.length;sa<pa;sa++){var Y=u[sa];ea.pushVertex(Y.x,Y.y,Y.z)}sa=0;for(pa=S.length;sa<pa;sa++){u=S[sa];var ya=!0===z?T.materials[u.materialIndex]:r.material;if(void 0!==ya){E=ya.side;var Y=n[u.a],xa=n[u.b],Ea=n[u.c];if(!0===ya.morphTargets){U=s.morphTargets;var va=r.morphTargetInfluences,
ta=Y.position,fa=xa.position,V=Ea.position;O.set(0,0,0);H.set(0,0,0);I.set(0,0,0);for(var za=0,la=U.length;za<la;za++){var ba=va[za];if(0!==ba){var Z=U[za].vertices;O.x+=(Z[u.a].x-ta.x)*ba;O.y+=(Z[u.a].y-ta.y)*ba;O.z+=(Z[u.a].z-ta.z)*ba;H.x+=(Z[u.b].x-fa.x)*ba;H.y+=(Z[u.b].y-fa.y)*ba;H.z+=(Z[u.b].z-fa.z)*ba;I.x+=(Z[u.c].x-V.x)*ba;I.y+=(Z[u.c].y-V.y)*ba;I.z+=(Z[u.c].z-V.z)*ba}}Y.position.add(O);xa.position.add(H);Ea.position.add(I);ea.projectVertex(Y);ea.projectVertex(xa);ea.projectVertex(Ea)}va=ea.checkTriangleVisibility(Y,
xa,Ea);if(!(!1===va&&E===THREE.FrontSide||!0===va&&E===THREE.BackSide)){p=b();p.id=r.id;p.v1.copy(Y);p.v2.copy(xa);p.v3.copy(Ea);p.normalModel.copy(u.normal);!1!==va||E!==THREE.BackSide&&E!==THREE.DoubleSide||p.normalModel.negate();p.normalModel.applyMatrix3(X).normalize();p.centroidModel.copy(u.centroid).applyMatrix4(Q);U=u.vertexNormals;ta=0;for(fa=Math.min(U.length,3);ta<fa;ta++)V=p.vertexNormalsModel[ta],V.copy(U[ta]),!1!==va||E!==THREE.BackSide&&E!==THREE.DoubleSide||V.negate(),V.applyMatrix3(X).normalize();
p.vertexNormalsLength=U.length;U=0;for(va=Math.min(x.length,3);U<va;U++)if(E=x[U][sa],void 0!==E)for(ta=0,fa=E.length;ta<fa;ta++)p.uvs[U][ta]=E[ta];p.color=u.color;p.material=ya;p.z=(Y.positionScreen.z+xa.positionScreen.z+Ea.positionScreen.z)/3;F.elements.push(p)}}}}}else if(r instanceof THREE.Line)if(s instanceof THREE.BufferGeometry){if(x=s.attributes,void 0!==x.position){z=x.position.array;s=0;for(S=z.length;s<S;s+=3)ea.pushVertex(z[s],z[s+1],z[s+2]);if(void 0!==x.index)for(x=x.index.array,s=0,
S=x.length;s<S;s+=2)ea.pushLine(x[s],x[s+1]);else for(s=0,S=z.length/3-1;s<S;s++)ea.pushLine(s,s+1)}}else{if(s instanceof THREE.Geometry&&(R.multiplyMatrices(aa,Q),u=r.geometry.vertices,0!==u.length))for(Y=a(),Y.positionScreen.copy(u[0]).applyMatrix4(R),s=r.type===THREE.LinePieces?2:1,sa=1,pa=u.length;sa<pa;sa++)Y=a(),Y.positionScreen.copy(u[sa]).applyMatrix4(R),0<(sa+1)%s||(xa=n[m-2],K.copy(Y.positionScreen),ia.copy(xa.positionScreen),!0===d(K,ia)&&(K.multiplyScalar(1/K.w),ia.multiplyScalar(1/ia.w),
v=c(),v.id=r.id,v.v1.positionScreen.copy(K),v.v2.positionScreen.copy(ia),v.z=Math.max(K.z,ia.z),v.material=r.material,r.material.vertexColors===THREE.VertexColors&&(v.vertexColors[0].copy(r.geometry.colors[sa]),v.vertexColors[1].copy(r.geometry.colors[sa-1])),F.elements.push(v)))}else r instanceof THREE.Sprite&&(P.set(Q.elements[12],Q.elements[13],Q.elements[14],1),P.applyMatrix4(aa),s=1/P.w,P.z*=s,-1<=P.z&&1>=P.z&&(C===D?(S=new THREE.RenderableSprite,B.push(S),D++,C++,y=S):y=B[C++],y.id=r.id,y.x=
P.x*s,y.y=P.y*s,y.z=P.z,y.object=r,y.rotation=r.rotation,y.scale.x=r.scale.x*Math.abs(y.x-(P.x+k.projectionMatrix.elements[0])/(P.w+k.projectionMatrix.elements[12])),y.scale.y=r.scale.y*Math.abs(y.y-(P.y+k.projectionMatrix.elements[5])/(P.w+k.projectionMatrix.elements[13])),y.material=r.material,F.elements.push(y)));!0===l&&F.elements.sort(e);return F}};
THREE.Face3=function(a,b,c,e,d,g){this.a=a;this.b=b;this.c=c;this.normal=e instanceof THREE.Vector3?e:new THREE.Vector3;this.vertexNormals=e instanceof Array?e:[];this.color=d instanceof THREE.Color?d:new THREE.Color;this.vertexColors=d instanceof Array?d:[];this.vertexTangents=[];this.materialIndex=void 0!==g?g:0;this.centroid=new THREE.Vector3};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var a=new THREE.Face3(this.a,this.b,this.c);a.normal.copy(this.normal);a.color.copy(this.color);a.centroid.copy(this.centroid);a.materialIndex=this.materialIndex;var b,c;b=0;for(c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();
return a}};THREE.Face4=function(a,b,c,e,d,g,f){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new THREE.Face3(a,b,c,d,g,f)};THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++;this.attributes={};this.boundingSphere=this.boundingBox=null};
THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(a,b,c,e){this.attributes[a]={array:new b(c*e),itemSize:e};return this.attributes[a]},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.multiplyVector3Array(b.array),b.needsUpdate=!0);b=this.attributes.normal;void 0!==b&&((new THREE.Matrix3).getNormalMatrix(a).multiplyVector3Array(b.array),b.needsUpdate=!0)},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);
var a=this.attributes.position.array;if(a){var b=this.boundingBox;3<=a.length&&(b.min.x=b.max.x=a[0],b.min.y=b.max.y=a[1],b.min.z=b.max.z=a[2]);for(var c=3,e=a.length;c<e;c+=3){var d=a[c],g=a[c+1],f=a[c+2];d<b.min.x?b.min.x=d:d>b.max.x&&(b.max.x=d);g<b.min.y?b.min.y=g:g>b.max.y&&(b.max.y=g);f<b.min.z?b.min.z=f:f>b.max.z&&(b.max.z=f)}}if(void 0===a||0===a.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)},computeBoundingSphere:function(){var a=new THREE.Box3,b=new THREE.Vector3;
return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var c=this.attributes.position.array;if(c){a.makeEmpty();for(var e=this.boundingSphere.center,d=0,g=c.length;d<g;d+=3)b.set(c[d],c[d+1],c[d+2]),a.addPoint(b);a.center(e);for(var f=0,d=0,g=c.length;d<g;d+=3)b.set(c[d],c[d+1],c[d+2]),f=Math.max(f,e.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(f)}}}(),computeVertexNormals:function(){if(this.attributes.position){var a,b,c,e;a=this.attributes.position.array.length;
if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(a)};else for(a=0,b=this.attributes.normal.array.length;a<b;a++)this.attributes.normal.array[a]=0;var d=this.attributes.position.array,g=this.attributes.normal.array,f,h,k,l,m,n,r=new THREE.Vector3,p=new THREE.Vector3,t=new THREE.Vector3,s=new THREE.Vector3,u=new THREE.Vector3;if(this.attributes.index){var v=this.attributes.index.array,w=this.offsets;c=0;for(e=w.length;c<e;++c){b=w[c].start;f=w[c].count;var z=
w[c].index;a=b;for(b+=f;a<b;a+=3)f=z+v[a],h=z+v[a+1],k=z+v[a+2],l=d[3*f],m=d[3*f+1],n=d[3*f+2],r.set(l,m,n),l=d[3*h],m=d[3*h+1],n=d[3*h+2],p.set(l,m,n),l=d[3*k],m=d[3*k+1],n=d[3*k+2],t.set(l,m,n),s.subVectors(t,p),u.subVectors(r,p),s.cross(u),g[3*f]+=s.x,g[3*f+1]+=s.y,g[3*f+2]+=s.z,g[3*h]+=s.x,g[3*h+1]+=s.y,g[3*h+2]+=s.z,g[3*k]+=s.x,g[3*k+1]+=s.y,g[3*k+2]+=s.z}}else for(a=0,b=d.length;a<b;a+=9)l=d[a],m=d[a+1],n=d[a+2],r.set(l,m,n),l=d[a+3],m=d[a+4],n=d[a+5],p.set(l,m,n),l=d[a+6],m=d[a+7],n=d[a+8],
t.set(l,m,n),s.subVectors(t,p),u.subVectors(r,p),s.cross(u),g[a]=s.x,g[a+1]=s.y,g[a+2]=s.z,g[a+3]=s.x,g[a+4]=s.y,g[a+5]=s.z,g[a+6]=s.x,g[a+7]=s.y,g[a+8]=s.z;this.normalizeNormals();this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var a=this.attributes.normal.array,b,c,e,d=0,g=a.length;d<g;d+=3)b=a[d],c=a[d+1],e=a[d+2],b=1/Math.sqrt(b*b+c*c+e*e),a[d]*=b,a[d+1]*=b,a[d+2]*=b},computeTangents:function(){function a(a,b,f){n=e[3*a];r=e[3*a+1];p=e[3*a+2];t=e[3*b];s=e[3*b+1];u=e[3*b+2];v=e[3*f];
w=e[3*f+1];z=e[3*f+2];x=g[2*a];y=g[2*a+1];C=g[2*b];B=g[2*b+1];D=g[2*f];F=g[2*f+1];O=t-n;H=v-n;I=s-r;E=w-r;P=u-p;T=z-p;S=C-x;U=D-x;N=B-y;aa=F-y;Q=1/(S*aa-U*N);R.set((aa*O-N*H)*Q,(aa*I-N*E)*Q,(aa*P-N*T)*Q);X.set((S*H-U*O)*Q,(S*E-U*I)*Q,(S*T-U*P)*Q);k[a].add(R);k[b].add(R);k[f].add(R);l[a].add(X);l[b].add(X);l[f].add(X)}function b(a){oa.x=d[3*a];oa.y=d[3*a+1];oa.z=d[3*a+2];Ma.copy(oa);Ha=k[a];Ba.copy(Ha);Ba.sub(oa.multiplyScalar(oa.dot(Ha))).normalize();Ga.crossVectors(Ma,Ha);ja=Ga.dot(l[a]);da=0>ja?
-1:1;h[4*a]=Ba.x;h[4*a+1]=Ba.y;h[4*a+2]=Ba.z;h[4*a+3]=da}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var c=this.attributes.index.array,e=this.attributes.position.array,d=this.attributes.normal.array,g=this.attributes.uv.array,f=e.length/3;void 0===this.attributes.tangent&&(this.attributes.tangent=
{itemSize:4,array:new Float32Array(4*f)});for(var h=this.attributes.tangent.array,k=[],l=[],m=0;m<f;m++)k[m]=new THREE.Vector3,l[m]=new THREE.Vector3;var n,r,p,t,s,u,v,w,z,x,y,C,B,D,F,O,H,I,E,P,T,S,U,N,aa,Q,R=new THREE.Vector3,X=new THREE.Vector3,ga,K,ia,ha,ea,Aa=this.offsets,m=0;for(K=Aa.length;m<K;++m){ga=Aa[m].start;ia=Aa[m].count;var Ca=Aa[m].index,f=ga;for(ga+=ia;f<ga;f+=3)ia=Ca+c[f],ha=Ca+c[f+1],ea=Ca+c[f+2],a(ia,ha,ea)}var Ba=new THREE.Vector3,Ga=new THREE.Vector3,oa=new THREE.Vector3,Ma=new THREE.Vector3,
da,Ha,ja,m=0;for(K=Aa.length;m<K;++m)for(ga=Aa[m].start,ia=Aa[m].count,Ca=Aa[m].index,f=ga,ga+=ia;f<ga;f+=3)ia=Ca+c[f],ha=Ca+c[f+1],ea=Ca+c[f+2],b(ia),b(ha),b(ea)}},computeOffsets:function(a){var b=a;void 0===a&&(b=65535);Date.now();a=this.attributes.index.array;for(var c=this.attributes.position.array,e=a.length/3,d=new Uint16Array(a.length),g=0,f=0,h=[{start:0,count:0,index:0}],k=h[0],l=0,m=0,n=new Int32Array(6),r=new Int32Array(c.length),p=new Int32Array(c.length),t=0;t<c.length;t++)r[t]=-1,p[t]=
-1;for(c=0;c<e;c++){for(var s=m=0;3>s;s++)t=a[3*c+s],-1==r[t]?(n[2*s]=t,n[2*s+1]=-1,m++):r[t]<k.index?(n[2*s]=t,n[2*s+1]=-1,l++):(n[2*s]=t,n[2*s+1]=r[t]);if(f+m>k.index+b)for(k={start:g,count:0,index:f},h.push(k),m=0;6>m;m+=2)s=n[m+1],-1<s&&s<k.index&&(n[m+1]=-1);for(m=0;6>m;m+=2)t=n[m],s=n[m+1],-1===s&&(s=f++),r[t]=s,p[s]=t,d[g++]=s-k.index,k.count++}this.reorderBuffers(d,p,f);return this.offsets=h},reorderBuffers:function(a,b,c){var e={},d=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,
Int32Array,Uint32Array,Float32Array,Float64Array],g;for(g in this.attributes)if("index"!=g)for(var f=this.attributes[g].array,h=0,k=d.length;h<k;h++){var l=d[h];if(f instanceof l){e[g]=new l(this.attributes[g].itemSize*c);break}}for(d=0;d<c;d++)for(g in f=b[d],this.attributes)if("index"!=g)for(var h=this.attributes[g].array,k=this.attributes[g].itemSize,l=e[g],m=0;m<k;m++)l[d*k+m]=h[f*k+m];this.attributes.index.array=a;for(g in this.attributes)"index"!=g&&(this.attributes[g].array=e[g],this.attributes[g].numItems=
this.attributes[g].itemSize*c)},clone:function(){var a=new THREE.BufferGeometry,b=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],c;for(c in this.attributes){for(var e=this.attributes[c],d=e.array,g={itemSize:e.itemSize,array:null},e=0,f=b.length;e<f;e++){var h=b[e];if(d instanceof h){g.array=new h(d);break}}a.attributes[c]=g}e=0;for(f=this.offsets.length;e<f;e++)b=this.offsets[e],a.offsets.push({start:b.start,index:b.index,count:b.count});
return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);
THREE.Geometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.dynamic=!0;this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=
this.elementsNeedUpdate=this.verticesNeedUpdate=!1};
THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(a){for(var b=(new THREE.Matrix3).getNormalMatrix(a),c=0,e=this.vertices.length;c<e;c++)this.vertices[c].applyMatrix4(a);c=0;for(e=this.faces.length;c<e;c++){var d=this.faces[c];d.normal.applyMatrix3(b).normalize();for(var g=0,f=d.vertexNormals.length;g<f;g++)d.vertexNormals[g].applyMatrix3(b).normalize();d.centroid.applyMatrix4(a)}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox();this.boundingSphere instanceof
THREE.Sphere&&this.computeBoundingSphere()},computeCentroids:function(){var a,b,c;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c.centroid.set(0,0,0),c.centroid.add(this.vertices[c.a]),c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.divideScalar(3)},computeFaceNormals:function(){for(var a=new THREE.Vector3,b=new THREE.Vector3,c=0,e=this.faces.length;c<e;c++){var d=this.faces[c],g=this.vertices[d.a],f=this.vertices[d.b];a.subVectors(this.vertices[d.c],f);b.subVectors(g,
f);a.cross(b);a.normalize();d.normal.copy(a)}},computeVertexNormals:function(a){var b,c,e;e=Array(this.vertices.length);b=0;for(c=this.vertices.length;b<c;b++)e[b]=new THREE.Vector3;if(a){var d,g,f,h=new THREE.Vector3,k=new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],d=this.vertices[c.a],g=this.vertices[c.b],f=this.vertices[c.c],h.subVectors(f,g),k.subVectors(d,g),h.cross(k),e[c.a].add(h),e[c.b].add(h),e[c.c].add(h)}else for(a=
0,b=this.faces.length;a<b;a++)c=this.faces[a],e[c.a].add(c.normal),e[c.b].add(c.normal),e[c.c].add(c.normal);b=0;for(c=this.vertices.length;b<c;b++)e[b].normalize();a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],c.vertexNormals[0]=e[c.a].clone(),c.vertexNormals[1]=e[c.b].clone(),c.vertexNormals[2]=e[c.c].clone()},computeMorphNormals:function(){var a,b,c,e,d;c=0;for(e=this.faces.length;c<e;c++)for(d=this.faces[c],d.__originalFaceNormal?d.__originalFaceNormal.copy(d.normal):d.__originalFaceNormal=
d.normal.clone(),d.__originalVertexNormals||(d.__originalVertexNormals=[]),a=0,b=d.vertexNormals.length;a<b;a++)d.__originalVertexNormals[a]?d.__originalVertexNormals[a].copy(d.vertexNormals[a]):d.__originalVertexNormals[a]=d.vertexNormals[a].clone();var g=new THREE.Geometry;g.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];d=this.morphNormals[a].faceNormals;var f=
this.morphNormals[a].vertexNormals,h,k;c=0;for(e=this.faces.length;c<e;c++)h=new THREE.Vector3,k={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},d.push(h),f.push(k)}f=this.morphNormals[a];g.vertices=this.morphTargets[a].vertices;g.computeFaceNormals();g.computeVertexNormals();c=0;for(e=this.faces.length;c<e;c++)d=this.faces[c],h=f.faceNormals[c],k=f.vertexNormals[c],h.copy(d.normal),k.a.copy(d.vertexNormals[0]),k.b.copy(d.vertexNormals[1]),k.c.copy(d.vertexNormals[2])}c=0;for(e=this.faces.length;c<
e;c++)d=this.faces[c],d.normal=d.__originalFaceNormal,d.vertexNormals=d.__originalVertexNormals},computeTangents:function(){var a,b,c,e,d,g,f,h,k,l,m,n,r,p,t,s,u,v=[],w=[];c=new THREE.Vector3;var z=new THREE.Vector3,x=new THREE.Vector3,y=new THREE.Vector3,C=new THREE.Vector3;a=0;for(b=this.vertices.length;a<b;a++)v[a]=new THREE.Vector3,w[a]=new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)d=this.faces[a],g=this.faceVertexUvs[0][a],e=d.a,u=d.b,d=d.c,f=this.vertices[e],h=this.vertices[u],k=this.vertices[d],
l=g[0],m=g[1],n=g[2],g=h.x-f.x,r=k.x-f.x,p=h.y-f.y,t=k.y-f.y,h=h.z-f.z,f=k.z-f.z,k=m.x-l.x,s=n.x-l.x,m=m.y-l.y,l=n.y-l.y,n=1/(k*l-s*m),c.set((l*g-m*r)*n,(l*p-m*t)*n,(l*h-m*f)*n),z.set((k*r-s*g)*n,(k*t-s*p)*n,(k*f-s*h)*n),v[e].add(c),v[u].add(c),v[d].add(c),w[e].add(z),w[u].add(z),w[d].add(z);z=["a","b","c","d"];a=0;for(b=this.faces.length;a<b;a++)for(d=this.faces[a],c=0;c<Math.min(d.vertexNormals.length,3);c++)C.copy(d.vertexNormals[c]),e=d[z[c]],u=v[e],x.copy(u),x.sub(C.multiplyScalar(C.dot(u))).normalize(),
y.crossVectors(d.vertexNormals[c],u),e=y.dot(w[e]),e=0>e?-1:1,d.vertexTangents[c]=new THREE.Vector4(x.x,x.y,x.z,e);this.hasTangents=!0},computeLineDistances:function(){for(var a=0,b=this.vertices,c=0,e=b.length;c<e;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);
this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){var a={},b=[],c=[],e,d=Math.pow(10,4),g,f;g=0;for(f=this.vertices.length;g<f;g++)e=this.vertices[g],e=Math.round(e.x*d)+"_"+Math.round(e.y*d)+"_"+Math.round(e.z*d),void 0===a[e]?(a[e]=g,b.push(this.vertices[g]),c[g]=b.length-1):c[g]=c[a[e]];a=[];g=0;for(f=this.faces.length;g<f;g++)for(d=this.faces[g],d.a=c[d.a],d.b=c[d.b],d.c=c[d.c],d=[d.a,d.b,d.c],e=0;3>e;e++)if(d[e]==d[(e+1)%3]){a.push(g);break}for(g=a.length-1;0<=g;g--)for(d=
a[g],this.faces.splice(d,1),c=0,f=this.faceVertexUvs.length;c<f;c++)this.faceVertexUvs[c].splice(d,1);g=this.vertices.length-b.length;this.vertices=b;return g},makeGroups:function(){var a=0;return function(b){var c,e,d,g,f={},h=this.morphTargets.length,k=this.morphNormals.length;this.geometryGroups={};c=0;for(e=this.faces.length;c<e;c++)d=this.faces[c],d=b?d.materialIndex:0,d in f||(f[d]={hash:d,counter:0}),g=f[d].hash+"_"+f[d].counter,g in this.geometryGroups||(this.geometryGroups[g]={faces3:[],
materialIndex:d,vertices:0,numMorphTargets:h,numMorphNormals:k}),65535<this.geometryGroups[g].vertices+3&&(f[d].counter+=1,g=f[d].hash+"_"+f[d].counter,g in this.geometryGroups||(this.geometryGroups[g]={faces3:[],materialIndex:d,vertices:0,numMorphTargets:h,numMorphNormals:k})),this.geometryGroups[g].faces3.push(c),this.geometryGroups[g].vertices+=3;this.geometryGroupsList=[];for(var l in this.geometryGroups)this.geometryGroups[l].id=a++,this.geometryGroupsList.push(this.geometryGroups[l])}}(),clone:function(){for(var a=
new THREE.Geometry,b=this.vertices,c=0,e=b.length;c<e;c++)a.vertices.push(b[c].clone());b=this.faces;c=0;for(e=b.length;c<e;c++)a.faces.push(b[c].clone());b=this.faceVertexUvs[0];c=0;for(e=b.length;c<e;c++){for(var d=b[c],g=[],f=0,h=d.length;f<h;f++)g.push(new THREE.Vector2(d[f].x,d[f].y));a.faceVertexUvs[0].push(g)}return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);THREE.GeometryIdCount=0;
THREE.Geometry2=function(a){THREE.BufferGeometry.call(this);this.vertices=this.addAttribute("position",Float32Array,a,3).array;this.normals=this.addAttribute("normal",Float32Array,a,3).array;this.uvs=this.addAttribute("uv",Float32Array,a,2).array;this.boundingSphere=this.boundingBox=null};THREE.Geometry2.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4};
THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.lookAt=function(){var a=new THREE.Matrix4;return function(b){a.lookAt(this.position,b,this.up);this.quaternion.setFromRotationMatrix(a)}}();THREE.Camera.prototype.clone=function(a){void 0===a&&(a=new THREE.Camera);THREE.Object3D.prototype.clone.call(this,a);a.matrixWorldInverse.copy(this.matrixWorldInverse);a.projectionMatrix.copy(this.projectionMatrix);return a};
THREE.OrthographicCamera=function(a,b,c,e,d,g){THREE.Camera.call(this);this.left=a;this.right=b;this.top=c;this.bottom=e;this.near=void 0!==d?d:0.1;this.far=void 0!==g?g:2E3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};
THREE.OrthographicCamera.prototype.clone=function(){var a=new THREE.OrthographicCamera;THREE.Camera.prototype.clone.call(this,a);a.left=this.left;a.right=this.right;a.top=this.top;a.bottom=this.bottom;a.near=this.near;a.far=this.far;return a};THREE.PerspectiveCamera=function(a,b,c,e){THREE.Camera.call(this);this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:0.1;this.far=void 0!==e?e:2E3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);
THREE.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);this.fov=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,e,d,g){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=e;this.width=d;this.height=g;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var a=this.fullWidth/this.fullHeight,b=Math.tan(THREE.Math.degToRad(0.5*this.fov))*this.near,c=-b,e=a*c,a=Math.abs(a*b-e),c=Math.abs(b-c);this.projectionMatrix.makeFrustum(e+this.x*a/this.fullWidth,e+(this.x+this.width)*a/this.fullWidth,b-(this.y+this.height)*c/this.fullHeight,b-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};
THREE.PerspectiveCamera.prototype.clone=function(){var a=new THREE.PerspectiveCamera;THREE.Camera.prototype.clone.call(this,a);a.fov=this.fov;a.aspect=this.aspect;a.near=this.near;a.far=this.far;return a};THREE.Light=function(a){THREE.Object3D.call(this);this.color=new THREE.Color(a)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.clone=function(a){void 0===a&&(a=new THREE.Light);THREE.Object3D.prototype.clone.call(this,a);a.color.copy(this.color);return a};
THREE.AmbientLight=function(a){THREE.Light.call(this,a)};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);THREE.AmbientLight.prototype.clone=function(){var a=new THREE.AmbientLight;THREE.Light.prototype.clone.call(this,a);return a};
THREE.AreaLight=function(a,b){THREE.Light.call(this,a);this.normal=new THREE.Vector3(0,-1,0);this.right=new THREE.Vector3(1,0,0);this.intensity=void 0!==b?b:1;this.height=this.width=1;this.constantAttenuation=1.5;this.linearAttenuation=0.5;this.quadraticAttenuation=0.1};THREE.AreaLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight=function(a,b){THREE.Light.call(this,a);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCascade=!1;this.shadowCascadeOffset=new THREE.Vector3(0,
0,-1E3);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight.prototype.clone=function(){var a=new THREE.DirectionalLight;THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;return a};THREE.HemisphereLight=function(a,b,c){THREE.Light.call(this,a);this.position.set(0,100,0);this.groundColor=new THREE.Color(b);this.intensity=void 0!==c?c:1};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);
THREE.HemisphereLight.prototype.clone=function(){var a=new THREE.HemisphereLight;THREE.Light.prototype.clone.call(this,a);a.groundColor.copy(this.groundColor);a.intensity=this.intensity;return a};THREE.PointLight=function(a,b,c){THREE.Light.call(this,a);this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);
THREE.PointLight.prototype.clone=function(){var a=new THREE.PointLight;THREE.Light.prototype.clone.call(this,a);a.intensity=this.intensity;a.distance=this.distance;return a};
THREE.SpotLight=function(a,b,c,e,d){THREE.Light.call(this,a);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0;this.angle=void 0!==e?e:Math.PI/3;this.exponent=void 0!==d?d:10;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=this.shadowCamera=this.shadowMapSize=
this.shadowMap=null};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.SpotLight.prototype.clone=function(){var a=new THREE.SpotLight;THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.distance=this.distance;a.angle=this.angle;a.exponent=this.exponent;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;return a};
THREE.Loader=function(a){this.statusDomElement=(this.showStatus=a)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,addStatusElement:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="0px";a.style.top="0px";a.style.fontSize="0.8em";a.style.textAlign="left";a.style.background="rgba(0,0,0,0.25)";a.style.color="#fff";a.style.width="120px";a.style.padding="0.5em 0.5em 0.5em 0.5em";a.style.zIndex=1E3;a.innerHTML="Loading ...";return a},updateProgress:function(a){var b="Loaded ",b=a.total?b+((100*a.loaded/a.total).toFixed(0)+
"%"):b+((a.loaded/1E3).toFixed(2)+" KB");this.statusDomElement.innerHTML=b},extractUrlBase:function(a){a=a.split("/");if(1===a.length)return"./";a.pop();return a.join("/")+"/"},initMaterials:function(a,b){for(var c=[],e=0;e<a.length;++e)c[e]=THREE.Loader.prototype.createMaterial(a[e],b);return c},needsTangents:function(a){for(var b=0,c=a.length;b<c;b++)if(a[b]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(a,b){function c(a){a=Math.log(a)/Math.LN2;return Math.floor(a)==
a}function e(a){a=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function d(a,b){var f=new Image;f.onload=function(){if(c(this.width)&&c(this.height))a.image=this;else{var b=e(this.width),f=e(this.height);a.image.width=b;a.image.height=f;a.image.getContext("2d").drawImage(this,0,0,b,f)}a.needsUpdate=!0};void 0!==h.crossOrigin&&(f.crossOrigin=h.crossOrigin);f.src=b}function g(a,f,c,h,e,k,g){var l=/\.dds$/i.test(c),m=b+c;if(l){var x=THREE.ImageUtils.loadCompressedTexture(m);a[f]=x}else x=document.createElement("canvas"),
a[f]=new THREE.Texture(x);a[f].sourceFile=c;h&&(a[f].repeat.set(h[0],h[1]),1!==h[0]&&(a[f].wrapS=THREE.RepeatWrapping),1!==h[1]&&(a[f].wrapT=THREE.RepeatWrapping));e&&a[f].offset.set(e[0],e[1]);k&&(c={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==c[k[0]]&&(a[f].wrapS=c[k[0]]),void 0!==c[k[1]]&&(a[f].wrapT=c[k[1]]));g&&(a[f].anisotropy=g);l||d(a[f],m)}function f(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var h=this,k="MeshLambertMaterial",l={color:15658734,opacity:1,
map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(a.shading){var m=a.shading.toLowerCase();"phong"===m?k="MeshPhongMaterial":"basic"===m&&(k="MeshBasicMaterial")}void 0!==a.blending&&void 0!==THREE[a.blending]&&(l.blending=THREE[a.blending]);if(void 0!==a.transparent||1>a.opacity)l.transparent=a.transparent;void 0!==a.depthTest&&(l.depthTest=a.depthTest);void 0!==a.depthWrite&&(l.depthWrite=a.depthWrite);void 0!==a.visible&&(l.visible=a.visible);void 0!==a.flipSided&&(l.side=THREE.BackSide);
void 0!==a.doubleSided&&(l.side=THREE.DoubleSide);void 0!==a.wireframe&&(l.wireframe=a.wireframe);void 0!==a.vertexColors&&("face"===a.vertexColors?l.vertexColors=THREE.FaceColors:a.vertexColors&&(l.vertexColors=THREE.VertexColors));a.colorDiffuse?l.color=f(a.colorDiffuse):a.DbgColor&&(l.color=a.DbgColor);a.colorSpecular&&(l.specular=f(a.colorSpecular));a.colorAmbient&&(l.ambient=f(a.colorAmbient));a.transparency&&(l.opacity=a.transparency);a.specularCoef&&(l.shininess=a.specularCoef);a.mapDiffuse&&
b&&g(l,"map",a.mapDiffuse,a.mapDiffuseRepeat,a.mapDiffuseOffset,a.mapDiffuseWrap,a.mapDiffuseAnisotropy);a.mapLight&&b&&g(l,"lightMap",a.mapLight,a.mapLightRepeat,a.mapLightOffset,a.mapLightWrap,a.mapLightAnisotropy);a.mapBump&&b&&g(l,"bumpMap",a.mapBump,a.mapBumpRepeat,a.mapBumpOffset,a.mapBumpWrap,a.mapBumpAnisotropy);a.mapNormal&&b&&g(l,"normalMap",a.mapNormal,a.mapNormalRepeat,a.mapNormalOffset,a.mapNormalWrap,a.mapNormalAnisotropy);a.mapSpecular&&b&&g(l,"specularMap",a.mapSpecular,a.mapSpecularRepeat,
a.mapSpecularOffset,a.mapSpecularWrap,a.mapSpecularAnisotropy);a.mapBumpScale&&(l.bumpScale=a.mapBumpScale);a.mapNormal?(k=THREE.ShaderLib.normalmap,m=THREE.UniformsUtils.clone(k.uniforms),m.tNormal.value=l.normalMap,a.mapNormalFactor&&m.uNormalScale.value.set(a.mapNormalFactor,a.mapNormalFactor),l.map&&(m.tDiffuse.value=l.map,m.enableDiffuse.value=!0),l.specularMap&&(m.tSpecular.value=l.specularMap,m.enableSpecular.value=!0),l.lightMap&&(m.tAO.value=l.lightMap,m.enableAO.value=!0),m.diffuse.value.setHex(l.color),
m.specular.value.setHex(l.specular),m.ambient.value.setHex(l.ambient),m.shininess.value=l.shininess,void 0!==l.opacity&&(m.opacity.value=l.opacity),k=new THREE.ShaderMaterial({fragmentShader:k.fragmentShader,vertexShader:k.vertexShader,uniforms:m,lights:!0,fog:!0}),l.transparent&&(k.transparent=!0)):k=new THREE[k](l);void 0!==a.DbgName&&(k.name=a.DbgName);return k}};THREE.XHRLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(a,b,c,e){var d=this,g=new XMLHttpRequest;void 0!==b&&g.addEventListener("load",function(f){b(f.target.responseText);d.manager.itemEnd(a)},!1);void 0!==c&&g.addEventListener("progress",function(a){c(a)},!1);void 0!==e&&g.addEventListener("error",function(a){e(a)},!1);void 0!==this.crossOrigin&&(g.crossOrigin=this.crossOrigin);g.open("GET",a,!0);g.send(null);d.manager.itemStart(a)},setCrossOrigin:function(a){this.crossOrigin=a}};
THREE.ImageLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(a,b,c,e){var d=this,g=document.createElement("img");void 0!==b&&g.addEventListener("load",function(f){d.manager.itemEnd(a);b(this)},!1);void 0!==c&&g.addEventListener("progress",function(a){c(a)},!1);void 0!==e&&g.addEventListener("error",function(a){e(a)},!1);void 0!==this.crossOrigin&&(g.crossOrigin=this.crossOrigin);g.src=a;d.manager.itemStart(a);return g},setCrossOrigin:function(a){this.crossOrigin=a}};
THREE.LoadingManager=function(a,b,c){var e=this,d=0,g=0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(a){g++};this.itemEnd=function(a){d++;if(void 0!==e.onProgress)e.onProgress(a,d,g);if(d===g&&void 0!==e.onLoad)e.onLoad()}};THREE.DefaultLoadingManager=new THREE.LoadingManager;THREE.TextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(a,b,c,e){c=new THREE.ImageLoader(this.manager);c.setCrossOrigin(this.crossOrigin);c.load(a,function(a){a=new THREE.Texture(a);a.needsUpdate=!0;void 0!==b&&b(a)})},setCrossOrigin:function(a){this.crossOrigin=a}};
THREE.Material=function(){this.id=THREE.MaterialIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.needsUpdate=this.visible=!0};
THREE.Material.prototype={constructor:THREE.Material,setValues:function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if(b in this){var e=this[b];e instanceof THREE.Color?e.set(c):e instanceof THREE.Vector3&&c instanceof THREE.Vector3?e.copy(c):this[b]="overdraw"==b?Number(c):c}}},clone:function(a){void 0===a&&(a=new THREE.Material);a.name=this.name;a.side=this.side;a.opacity=this.opacity;a.transparent=this.transparent;
a.blending=this.blending;a.blendSrc=this.blendSrc;a.blendDst=this.blendDst;a.blendEquation=this.blendEquation;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.polygonOffset=this.polygonOffset;a.polygonOffsetFactor=this.polygonOffsetFactor;a.polygonOffsetUnits=this.polygonOffsetUnits;a.alphaTest=this.alphaTest;a.overdraw=this.overdraw;a.visible=this.visible;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);
THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.LineBasicMaterial.prototype.clone=function(){var a=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.linecap=this.linecap;a.linejoin=this.linejoin;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.LineDashedMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.vertexColors=!1;this.fog=!0;this.setValues(a)};
THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.clone=function(){var a=new THREE.LineDashedMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.scale=this.scale;a.dashSize=this.dashSize;a.gapSize=this.gapSize;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};
THREE.MeshBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(a)};
THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshBasicMaterial.prototype.clone=function(){var a=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=
this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;return a};
THREE.MeshLambertMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
"round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshLambertMaterial.prototype.clone=function(){var a=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;
a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshPhongMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.wrapAround=this.metal=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.bumpMap=this.lightMap=this.map=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.envMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=
1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshPhongMaterial.prototype.clone=function(){var a=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.specular.copy(this.specular);a.shininess=this.shininess;a.metal=this.metal;a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.bumpMap=this.bumpMap;a.bumpScale=this.bumpScale;a.normalMap=this.normalMap;a.normalScale.copy(this.normalScale);
a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.MeshDepthMaterial=function(a){THREE.Material.call(this);this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(a)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.clone=function(){var a=new THREE.MeshDepthMaterial;THREE.Material.prototype.clone.call(this,a);a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};
THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a);this.shading=THREE.FlatShading;this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(a)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.clone=function(){var a=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,a);a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};
THREE.MeshFaceMaterial=function(a){this.materials=a instanceof Array?a:[]};THREE.MeshFaceMaterial.prototype.clone=function(){for(var a=new THREE.MeshFaceMaterial,b=0;b<this.materials.length;b++)a.materials.push(this.materials[b].clone());return a};
THREE.ShaderMaterial=function(a){THREE.Material.call(this);this.vertexShader=this.fragmentShader="void main() {}";this.uniforms={};this.defines={};this.attributes=null;this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName="position";this.setValues(a)};
THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ShaderMaterial.prototype.clone=function(){var a=new THREE.ShaderMaterial;THREE.Material.prototype.clone.call(this,a);a.fragmentShader=this.fragmentShader;a.vertexShader=this.vertexShader;a.uniforms=THREE.UniformsUtils.clone(this.uniforms);a.attributes=this.attributes;a.defines=this.defines;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.fog=this.fog;a.lights=this.lights;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=
this.morphTargets;a.morphNormals=this.morphNormals;return a};
THREE.Texture=function(a,b,c,e,d,g,f,h,k){this.id=THREE.TextureIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.image=a;this.mipmaps=[];this.mapping=void 0!==b?b:new THREE.UVMapping;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==e?e:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==d?d:THREE.LinearFilter;this.minFilter=void 0!==g?g:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==k?k:1;this.format=void 0!==f?f:THREE.RGBAFormat;this.type=void 0!==h?h:THREE.UnsignedByteType;
this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this._needsUpdate=!1;this.onUpdate=null};
THREE.Texture.prototype={constructor:THREE.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(a){!0===a&&this.update();this._needsUpdate=a},clone:function(a){void 0===a&&(a=new THREE.Texture);a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.format=this.format;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.generateMipmaps=
this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=this.unpackAlignment;return a},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount=0;THREE.CompressedTexture=function(a,b,c,e,d,g,f,h,k,l,m){THREE.Texture.call(this,null,g,f,h,k,l,e,d,m);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=!1};
THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.clone=function(){var a=new THREE.CompressedTexture;THREE.Texture.prototype.clone.call(this,a);return a};THREE.DataTexture=function(a,b,c,e,d,g,f,h,k,l,m){THREE.Texture.call(this,null,g,f,h,k,l,e,d,m);this.image={data:a,width:b,height:c}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);
THREE.DataTexture.prototype.clone=function(){var a=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,a);return a};THREE.Line=function(a,b,c){THREE.Object3D.call(this);this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==c?c:THREE.LineStrip};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);
THREE.Line.prototype.clone=function(a){void 0===a&&(a=new THREE.Line(this.geometry,this.material,this.type));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Mesh=function(a,b,c){THREE.Object3D.call(this,c);this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random()});this.updateMorphTargets()};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);
THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};
THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(a){void 0===a&&(a=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Bone=function(a){THREE.Object3D.call(this);this.skin=a;this.skinMatrix=new THREE.Matrix4};
THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.update=function(a,b){this.matrixAutoUpdate&&(b|=this.updateMatrix());if(b||this.matrixWorldNeedsUpdate)a?this.skinMatrix.multiplyMatrices(a,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,b=!0;var c,e=this.children.length;for(c=0;c<e;c++)this.children[c].update(this.skinMatrix,b)};THREE.LOD=function(){THREE.Object3D.call(this);this.objects=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);
THREE.LOD.prototype.addLevel=function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=0;c<this.objects.length&&!(b<this.objects[c].distance);c++);this.objects.splice(c,0,{distance:b,object:a});this.add(a)};THREE.LOD.prototype.getObjectForDistance=function(a){for(var b=1,c=this.objects.length;b<c&&!(a<this.objects[b].distance);b++);return this.objects[b-1].object};
THREE.LOD.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){if(1<this.objects.length){a.setFromMatrixPosition(c.matrixWorld);b.setFromMatrixPosition(this.matrixWorld);c=a.distanceTo(b);this.objects[0].object.visible=!0;for(var e=1,d=this.objects.length;e<d;e++)if(c>=this.objects[e].distance)this.objects[e-1].object.visible=!1,this.objects[e].object.visible=!0;else break;for(;e<d;e++)this.objects[e].object.visible=!1}}}();
THREE.LOD.prototype.clone=function(a){void 0===a&&(a=new THREE.LOD);THREE.Object3D.prototype.clone.call(this,a);for(var b=0,c=this.objects.length;b<c;b++){var e=this.objects[b].object.clone();e.visible=0===b;a.addLevel(e,this.objects[b].distance)}return a};THREE.Sprite=function(){var a=new THREE.Geometry2(3);a.vertices.set([-0.5,-0.5,0,0.5,-0.5,0,0.5,0.5,0]);return function(b){THREE.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new THREE.SpriteMaterial}}();
THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.updateMatrix=function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0};THREE.Sprite.prototype.clone=function(a){void 0===a&&(a=new THREE.Sprite(this.material));THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Particle=THREE.Sprite;
THREE.Scene=function(a){THREE.Object3D.call(this,a);this.children=[];this.overrideMaterial=this.fog=null;this.autoUpdate=!0;this.matrixAutoUpdate=!1;this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);
THREE.Scene.prototype.__addObject=function(a){if(a instanceof THREE.Light)-1===this.__lights.indexOf(a)&&this.__lights.push(a),a.target&&void 0===a.target.parent&&this.add(a.target);else if(!(a instanceof THREE.Camera||a instanceof THREE.Bone)){this.__objectsAdded.push(a);var b=this.__objectsRemoved.indexOf(a);-1!==b&&this.__objectsRemoved.splice(b,1)}this.dispatchEvent({type:"objectAdded",object:a});a.dispatchEvent({type:"addedToScene",scene:this});if(a.children)for(b=0;b<a.children.length;b++)this.__addObject(a.children[b])};
THREE.Scene.prototype.__removeObject=function(a){if(a instanceof THREE.Light){var b=this.__lights.indexOf(a);-1!==b&&this.__lights.splice(b,1);if(a.shadowCascadeArray)for(b=0;b<a.shadowCascadeArray.length;b++)this.__removeObject(a.shadowCascadeArray[b])}else a instanceof THREE.Camera||(this.__objectsRemoved.push(a),b=this.__objectsAdded.indexOf(a),-1!==b&&this.__objectsAdded.splice(b,1));this.dispatchEvent({type:"objectRemoved",object:a});a.dispatchEvent({type:"removedFromScene",scene:this});if(a.children)for(b=
0;b<a.children.length;b++)this.__removeObject(a.children[b])};THREE.Scene.prototype.clone=function(a){void 0===a&&(a=new THREE.Scene);THREE.Object3D.prototype.clone.call(this,a);null!==this.fog&&(a.fog=this.fog.clone());null!==this.overrideMaterial&&(a.overrideMaterial=this.overrideMaterial.clone());a.autoUpdate=this.autoUpdate;a.matrixAutoUpdate=this.matrixAutoUpdate;return a};THREE.Fog=function(a,b,c){this.name="";this.color=new THREE.Color(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3};
THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(a,b){this.name="";this.color=new THREE.Color(a);this.density=void 0!==b?b:2.5E-4};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};
THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#endif\n#endif",
normal_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",envmap_fragment:"#if defined(USE_ENVMAP)\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( -vViewPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nvec3 cameraToVertex = normalize( -vViewPosition );\nreflectVec = reflect( cameraToVertex, vNormal );\n#endif\nreflectVec = mat3( viewMatrixInverse[ 0 ].xyz, viewMatrixInverse[ 1 ].xyz, viewMatrixInverse[ 2 ].xyz ) * reflectVec;\n#ifdef ENV_LOGLUV\nfloat MipmapIndex = max(0.0, -1.66096404744368 * log(shininess) + 5.5);\nvec4 envTexColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ), MipmapIndex );\nvec3 cubeColor = LogLuvDecode(envTexColor);\n#else\nvec4 envTexColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\nvec3 cubeColor = envTexColor.xyz;\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\n#endif\nfloat facing = max(0.0, dot( viewPosition, normal ));\nvec4 speca = vec4(specular, gl_FragColor.a);\n#ifdef METAL\nvec4 schlickRefl = speca; /* + ( 1.0 - speca ) * pow( max(1.0 - facing, 0.0), 5.0 );*/\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * schlickRefl.xyz;\ngl_FragColor.a = speca.a;\n#else\n#ifdef CLEARCOAT\nvec3 cubeColorClearcoat;\nvec3 reflectVecClearcoat = reflect( -vViewPosition, vNormal );\nreflectVecClearcoat = mat3( viewMatrixInverse[ 0 ].xyz, viewMatrixInverse[ 1 ].xyz, viewMatrixInverse[ 2 ].xyz ) * reflectVecClearcoat;\n#ifdef ENV_LOGLUV\nvec4 envTexColorClearcoat = textureCube( envMap, vec3( flipEnvMap * reflectVecClearcoat.x, reflectVecClearcoat.yz ));\ncubeColorClearcoat = LogLuvDecode(envTexColorClearcoat);\n#else\nvec4 envTexColorClearcoat = textureCube( envMap, vec3( flipEnvMap * reflectVecClearcoat.x, reflectVecClearcoat.yz ) );\ncubeColorClearcoat = envTexColorClearcoat.xyz;\n#ifdef GAMMA_INPUT\ncubeColorClearcoat.xyz *= cubeColorClearcoat.xyz;\n#endif\n#endif\ncubeColor = mix(cubeColor, cubeColorClearcoat, reflectivity);\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * speca.xyz;\nfloat schlickRefl = reflectivity + ( 1.0 - reflectivity ) * pow( max(1.0 - facing, 0.0), 5.0 );\ngl_FragColor.xyz = mix(gl_FragColor.xyz, cubeColorClearcoat * schlickRefl, 0.5);\n#else\nvec4 schlickRefl = speca + ( 1.0 - speca ) * pow( max(1.0 - facing, 0.0), 5.0 );\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * schlickRefl.xyz );\ngl_FragColor.a = schlickRefl.a;\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * schlickRefl.xyz;\ngl_FragColor.a = schlickRefl.a;\n} else {\ngl_FragColor = mix( gl_FragColor, vec4(gl_FragColor.xyz * cubeColor.xyz, gl_FragColor.a), specularStrength * schlickRefl );\n}\n#endif\n#endif\n#endif",
envmap_pars_vertex:"#if defined( USE_ENVMAP )\n#if ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif",envmap_vertex:"#if defined( USE_ENVMAP ) \nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n#endif",
map_pars_vertex:"#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec2 vUvBump;\nuniform vec4 offsetRepeatBump;\n#endif",map_pars_fragment:"#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec2 vUvBump;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_vertex:"#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvUvBump = uv * offsetRepeatBump.zw + offsetRepeatBump.xy;\n#endif",
map_fragment:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",
logluv_pars_fragment:"const mat3 InverseM = mat3(\n6.0014, -2.7008, -1.7996,\n-1.3320,  3.1029, -5.7721,\n0.3008, -1.0882,  5.6268);\nvec3 LogLuvDecode(in vec4 vLogLuv) {\nfloat Le = vLogLuv.b * 255.0 + vLogLuv.a;\nvec3 Xp_Y_XYZp;\nXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\nXp_Y_XYZp.z = Xp_Y_XYZp.y / vLogLuv.g;\nXp_Y_XYZp.x = vLogLuv.r * Xp_Y_XYZp.z;\nvec3 vRGB = InverseM * Xp_Y_XYZp;\nreturn max(vRGB, vec3(0.0));\n}",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUvBump );\nvec2 dSTdy = dFdy( vUvBump );\nfloat Hll = bumpScale * texture2D( bumpMap, vUvBump ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUvBump + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUvBump + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUvBump.st );\nvec2 st1 = dFdy( vUvBump.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUvBump ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",
specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",lights_phong_pars_vertex:"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec3 vWorldPosition;\n#endif",lights_phong_vertex:"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",
lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef USE_IRRADIANCEMAP\nuniform samplerCube irradianceMap;\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",
lights_phong_fragment:"#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = shininess * 0.125 + 0.25;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max(1.0 - dot( lVector, pointHalfVector ), 0.0), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization ;\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = shininess * 0.125 + 0.25;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max(1.0 - dot( lVector, spotHalfVector ), 0.0), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = shininess * 0.125 + 0.25;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max(1.0 - dot( dirVector, dirHalfVector ), 0.0), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef USE_IRRADIANCEMAP\nvec3 worldNormal = mat3( viewMatrixInverse[ 0 ].xyz, viewMatrixInverse[ 1 ].xyz, viewMatrixInverse[ 2 ].xyz ) * normal;\nvec4 cubeColor4 = textureCube(irradianceMap, worldNormal);\n#ifdef IRR_LOGLUV\nvec3 indirectDiffuse = LogLuvDecode(cubeColor4);\n#else\nvec3 indirectDiffuse = cubeColor.xyz;\n#ifdef GAMMA_INPUT\nindirectDiffuse.xyz *= indirectDiffuse.xyz;\n#endif\n#endif\ntotalDiffuse += diffuse * indirectDiffuse;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",
color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",default_vertex:"vec4 mvPosition;\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",defaultnormal_vertex:"vec3 objectNormal;\nobjectNormal = normal;\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",
shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nvec3 shadowZ = vec3( shadowCoord.z );\nshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\nshadowKernel[0] *= vec3(0.25);\nshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\nshadowKernel[1] *= vec3(0.25);\nshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\nshadowKernel[2] *= vec3(0.25);\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif",mrt_normals_pars_vertex:"#ifdef MRT_NORMALS\nvarying float depth;\n#endif",
mrt_normals_vertex:"#ifdef MRT_NORMALS\ndepth = mvPosition.z;\n#endif",mrt_normals_pars_fragment:["#ifdef MRT_NORMALS","undefined"!==typeof _isIE11&&_isIE11?"":"#extension GL_EXT_draw_buffers : require","varying float depth;\n#define gl_FragColor gl_FragData[0]\n#endif"].join("\n"),mrt_normals_fragment:"#ifdef MRT_NORMALS\ngl_FragData[1] = vec4(normal.x, normal.y, depth, gl_FragColor.a < 1.0 ? 0.0 : 1.0);\n#endif"};
THREE.UniformsUtils={merge:function(a){var b,c,e,d={};for(b=0;b<a.length;b++)for(c in e=this.clone(a[b]),e)d[c]=e[c];return d},clone:function(a){var b,c,e,d={};for(b in a)for(c in d[b]={},a[b])e=a[b][c],d[b][c]=e instanceof THREE.Color||e instanceof THREE.Vector2||e instanceof THREE.Vector3||e instanceof THREE.Vector4||e instanceof THREE.Matrix4||e instanceof THREE.Texture?e.clone():e instanceof Array?e.slice():e;return d}};
THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},offsetRepeatBump:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0}},
bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",
value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},irradianceMap:{type:"t",value:null}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",
value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};
THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.defaultnormal_vertex,
"#endif",THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",
THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,
THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,
THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.mrt_normals_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,THREE.ShaderChunk.mrt_normals_vertex,
"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.logluv_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,
THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.mrt_normals_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.normal_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,
THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,THREE.ShaderChunk.mrt_normals_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),
fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2E3},opacity:{type:"f",
value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvNormal = normalize( normalMatrix * normal );",
THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};
THREE.WebGLRenderTarget=function(a,b,c){this.width=a;this.height=b;c=c||{};this.wrapS=void 0!==c.wrapS?c.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==c.wrapT?c.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==c.magFilter?c.magFilter:THREE.LinearFilter;this.minFilter=void 0!==c.minFilter?c.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==c.anisotropy?c.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==c.format?c.format:
THREE.RGBAFormat;this.type=void 0!==c.type?c.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.generateMipmaps=!0;this.shareDepthFrom=null};
THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,clone:function(){var a=new THREE.WebGLRenderTarget(this.width,this.height);a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.format=this.format;a.type=this.type;a.depthBuffer=this.depthBuffer;a.stencilBuffer=this.stencilBuffer;a.generateMipmaps=this.generateMipmaps;a.shareDepthFrom=this.shareDepthFrom;
return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);
THREE.GeometryUtils={merge:function(a,b,c){var e,d,g=a.vertices.length,f=b instanceof THREE.Mesh?b.geometry:b,h=a.vertices,k=f.vertices,l=a.faces,m=f.faces;a=a.faceVertexUvs[0];f=f.faceVertexUvs[0];void 0===c&&(c=0);b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),e=b.matrix,d=(new THREE.Matrix3).getNormalMatrix(e));b=0;for(var n=k.length;b<n;b++){var r=k[b].clone();e&&r.applyMatrix4(e);h.push(r)}b=0;for(n=m.length;b<n;b++){var r=m[b],p,t,s=r.vertexNormals,u=r.vertexColors;p=new THREE.Face3(r.a+
g,r.b+g,r.c+g);p.normal.copy(r.normal);d&&p.normal.applyMatrix3(d).normalize();h=0;for(k=s.length;h<k;h++)t=s[h].clone(),d&&t.applyMatrix3(d).normalize(),p.vertexNormals.push(t);p.color.copy(r.color);h=0;for(k=u.length;h<k;h++)t=u[h],p.vertexColors.push(t.clone());p.materialIndex=r.materialIndex+c;p.centroid.copy(r.centroid);e&&p.centroid.applyMatrix4(e);l.push(p)}b=0;for(n=f.length;b<n;b++){c=f[b];e=[];h=0;for(k=c.length;h<k;h++)e.push(new THREE.Vector2(c[h].x,c[h].y));a.push(e)}},randomPointInTriangle:function(){var a=
new THREE.Vector3;return function(b,c,e){var d=new THREE.Vector3,g=THREE.Math.random16(),f=THREE.Math.random16();1<g+f&&(g=1-g,f=1-f);var h=1-g-f;d.copy(b);d.multiplyScalar(g);a.copy(c);a.multiplyScalar(f);d.add(a);a.copy(e);a.multiplyScalar(h);d.add(a);return d}}(),randomPointInFace:function(a,b,c){return THREE.GeometryUtils.randomPointInTriangle(b.vertices[a.a],b.vertices[a.b],b.vertices[a.c])},randomPointsInGeometry:function(a,b){function c(a){function b(f,d){if(d<f)return f;var c=f+Math.floor((d-
f)/2);return l[c]>a?b(f,c-1):l[c]<a?b(c+1,d):c}return b(0,l.length-1)}var e,d,g=a.faces,f=a.vertices,h=g.length,k=0,l=[],m,n,r;for(d=0;d<h;d++)e=g[d],m=f[e.a],n=f[e.b],r=f[e.c],e._area=THREE.GeometryUtils.triangleArea(m,n,r),k+=e._area,l[d]=k;e=[];for(d=0;d<b;d++)f=THREE.Math.random16()*k,f=c(f),e[d]=THREE.GeometryUtils.randomPointInFace(g[f],a,!0);return e},triangleArea:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,e,d){a.subVectors(e,c);b.subVectors(d,c);a.cross(b);return 0.5*
a.length()}}(),center:function(a){a.computeBoundingBox();var b=a.boundingBox,c=new THREE.Vector3;c.addVectors(b.min,b.max);c.multiplyScalar(-0.5);a.applyMatrix((new THREE.Matrix4).makeTranslation(c.x,c.y,c.z));a.computeBoundingBox();return c},triangulateQuads:function(a){var b,c,e,d,g=[],f=[];b=0;for(c=a.faceVertexUvs.length;b<c;b++)f[b]=[];b=0;for(c=a.faces.length;b<c;b++)for(g.push(a.faces[b]),e=0,d=a.faceVertexUvs.length;e<d;e++)f[e].push(a.faceVertexUvs[e][b]);a.faces=g;a.faceVertexUvs=f;a.computeCentroids();
a.computeFaceNormals();a.computeVertexNormals();a.hasTangents&&a.computeTangents()}};
THREE.ImageUtils={crossOrigin:"",loadTexture:function(a,b,c,e){e=new THREE.ImageLoader;e.crossOrigin=this.crossOrigin;var d=new THREE.Texture(void 0,b);b=e.load(a,function(){d.needsUpdate=!0;c&&c(d)});d.image=b;d.sourceFile=a;return d},loadCompressedTexture:function(a,b,c,e){var d=new THREE.CompressedTexture;d.mapping=b;var g=new XMLHttpRequest;g.onload=function(){var a=THREE.ImageUtils.parseDDS(g.response,!0);d.format=a.format;d.type=a.type;d.mipmaps=a.mipmaps;d.image.width=a.width;d.image.height=
a.height;d.generateMipmaps=!1;d.needsUpdate=!0;c&&c(d)};g.onerror=e;g.open("GET",a,!0);g.responseType="arraybuffer";g.send(null);return d},loadTextureCube:function(a,b,c,e){var d=[];d.loadCount=0;var g=new THREE.Texture;g.image=d;void 0!==b&&(g.mapping=b);g.flipY=!1;b=0;for(var f=a.length;b<f;++b){var h=new Image;d[b]=h;h.onload=function(){d.loadCount+=1;6===d.loadCount&&(g.needsUpdate=!0,c&&c(g))};h.onerror=e;h.crossOrigin=this.crossOrigin;h.src=a[b]}return g},loadCompressedTextureCube:function(a,
b,c,e){var d=[];d.loadCount=0;var g=new THREE.CompressedTexture;g.image=d;void 0!==b&&(g.mapping=b);g.flipY=!1;g.generateMipmaps=!1;b=function(a,b){return function(){var f=THREE.ImageUtils.parseDDS(a.response,!0);b.format=f.format;b.type=f.type;b.mipmaps=f.mipmaps;b.width=f.width;b.height=f.height;d.loadCount+=1;6===d.loadCount&&(g.format=f.format,g.type=f.type,1==f.mipmapCount&&(g.minFilter=THREE.LinearFilter),g.needsUpdate=!0,c&&c(g))}};if(a instanceof Array)for(var f=0,h=a.length;f<h;++f){var k=
{};d[f]=k;var l=new XMLHttpRequest;l.onload=b(l,k);l.onerror=e;k=a[f];l.open("GET",k,!0);l.responseType="arraybuffer";l.send(null)}else l=new XMLHttpRequest,l.onload=function(){var a=THREE.ImageUtils.parseDDS(l.response,!0);if(a.isCubemap){for(var b=a.mipmaps.length/a.mipmapCount,f=0;f<b;f++){d[f]={mipmaps:[]};for(var h=0;h<a.mipmapCount;h++)d[f].mipmaps.push(a.mipmaps[f*a.mipmapCount+h]),d[f].format=a.format,d[f].type=a.type,d[f].width=a.width,d[f].height=a.height}g.format=a.format;g.type=a.type;
1==a.mipmapCount&&(g.minFilter=THREE.LinearFilter);g.needsUpdate=!0;c&&c(g)}},l.onerror=e,l.open("GET",a,!0),l.responseType="arraybuffer",l.send(null);return g},loadDDSTexture:function(a,b,c,e){var d=[];d.loadCount=0;var g=new THREE.CompressedTexture;g.image=d;void 0!==b&&(g.mapping=b);g.flipY=!1;g.generateMipmaps=!1;var f=new XMLHttpRequest;f.onload=function(){var a=THREE.ImageUtils.parseDDS(f.response,!0);if(a.isCubemap)for(var b=a.mipmaps.length/a.mipmapCount,e=0;e<b;e++){d[e]={mipmaps:[]};for(var m=
0;m<a.mipmapCount;m++)d[e].mipmaps.push(a.mipmaps[e*a.mipmapCount+m]),d[e].format=a.format,d[e].type=a.type,d[e].width=a.width,d[e].height=a.height}else g.image.width=a.width,g.image.height=a.height,g.mipmaps=a.mipmaps;g.format=a.format;g.type=a.type;1==a.mipmapCount&&(g.minFilter=THREE.LinearFilter);g.needsUpdate=!0;c&&c(g)};f.onerror=e;f.open("GET",a,!0);f.responseType="arraybuffer";f.send(null);return g},parseDDS:function(a,b){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<
16)+(a.charCodeAt(3)<<24)}function e(a,b,f,d){var c=f*d*4;a=new Uint8Array(a,b,c);for(var c=new Uint8Array(c),h=b=0,e=0;e<d;e++)for(var k=0;k<f;k++){var g=a[h];h++;var l=a[h];h++;var m=a[h];h++;var n=a[h];h++;c[b]=m;b++;c[b]=l;b++;c[b]=g;b++;c[b]=n;b++}return c}var d={mipmaps:[],width:0,height:0,format:null,type:THREE.UnsignedByteType,mipmapCount:1},g=c("DXT1"),f=c("DXT3"),h=c("DXT5"),k=new Int32Array(a,0,31);if(542327876!==k[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),
d;if(!k[20]&4)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),d;var l=k[21],m=!1;switch(l){case g:g=8;d.format=THREE.RGB_S3TC_DXT1_Format;break;case f:g=16;d.format=THREE.RGBA_S3TC_DXT3_Format;break;case h:g=16;d.format=THREE.RGBA_S3TC_DXT5_Format;break;case 116:g=16;d.format=THREE.RGBAFormat;d.type=THREE.FloatType;m=!0;break;default:if(32==k[22]&&k[23]&16711680&&k[24]&65280&&k[25]&255&&k[26]&4278190080)m=!0,g=64,d.format=THREE.RGBAFormat,d.type=THREE.UnsignedByteType;
else return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(l&255,l>>8&255,l>>16&255,l>>24&255)),d}d.mipmapCount=1;k[2]&131072&&!1!==b&&(d.mipmapCount=Math.max(1,k[7]));d.isCubemap=k[28]&512?!0:!1;d.width=k[4];d.height=k[3];for(var k=k[1]+4,f=d.width,h=d.height,l=d.isCubemap?6:1,n=0;n<l;n++){for(var r=0;r<d.mipmapCount;r++){if(m)if(d.type==THREE.FloatType)var p=f*h*16,t=new Float32Array(a.slice(k,k+p));else t=e(a,k,f,h),p=t.length;else p=Math.max(4,f)/4*Math.max(4,
h)/4*g,t=new Uint8Array(a,k,p);d.mipmaps.push({data:t,width:f,height:h});k+=p;f=Math.max(0.5*f,1);h=Math.max(0.5*h,1)}f=d.width;h=d.height}return d},getNormalMap:function(a,b){var c=function(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/b,a[1]/b,a[2]/b]};b|=1;var e=a.width,d=a.height,g=document.createElement("canvas");g.width=e;g.height=d;var f=g.getContext("2d");f.drawImage(a,0,0);for(var h=f.getImageData(0,0,e,d).data,k=f.createImageData(e,d),l=k.data,m=0;m<e;m++)for(var n=0;n<d;n++){var r=
0>n-1?0:n-1,p=n+1>d-1?d-1:n+1,t=0>m-1?0:m-1,s=m+1>e-1?e-1:m+1,u=[],v=[0,0,h[4*(n*e+m)]/255*b];u.push([-1,0,h[4*(n*e+t)]/255*b]);u.push([-1,-1,h[4*(r*e+t)]/255*b]);u.push([0,-1,h[4*(r*e+m)]/255*b]);u.push([1,-1,h[4*(r*e+s)]/255*b]);u.push([1,0,h[4*(n*e+s)]/255*b]);u.push([1,1,h[4*(p*e+s)]/255*b]);u.push([0,1,h[4*(p*e+m)]/255*b]);u.push([-1,1,h[4*(p*e+t)]/255*b]);r=[];t=u.length;for(p=0;p<t;p++){var s=u[p],w=u[(p+1)%t],s=[s[0]-v[0],s[1]-v[1],s[2]-v[2]],w=[w[0]-v[0],w[1]-v[1],w[2]-v[2]];r.push(c([s[1]*
w[2]-s[2]*w[1],s[2]*w[0]-s[0]*w[2],s[0]*w[1]-s[1]*w[0]]))}u=[0,0,0];for(p=0;p<r.length;p++)u[0]+=r[p][0],u[1]+=r[p][1],u[2]+=r[p][2];u[0]/=r.length;u[1]/=r.length;u[2]/=r.length;v=4*(n*e+m);l[v]=(u[0]+1)/2*255|0;l[v+1]=(u[1]+1)/2*255|0;l[v+2]=255*u[2]|0;l[v+3]=255}f.putImageData(k,0,0);return g},generateDataTexture:function(a,b,c){var e=a*b,d=new Uint8Array(3*e),g=Math.floor(255*c.r),f=Math.floor(255*c.g);c=Math.floor(255*c.b);for(var h=0;h<e;h++)d[3*h]=g,d[3*h+1]=f,d[3*h+2]=c;a=new THREE.DataTexture(d,
a,b,THREE.RGBFormat);a.needsUpdate=!0;return a}};THREE.SceneUtils={createMultiMaterialObject:function(a,b){for(var c=new THREE.Object3D,e=0,d=b.length;e<d;e++)c.add(new THREE.Mesh(a,b[e]));return c},detach:function(a,b,c){a.applyMatrix(b.matrixWorld);b.remove(a);c.add(a)},attach:function(a,b,c){var e=new THREE.Matrix4;e.getInverse(c.matrixWorld);a.applyMatrix(e);b.remove(a);c.add(a)}};
THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(a){var b=a.familyName.toLowerCase();this.faces[b]=this.faces[b]||{};this.faces[b][a.cssFontWeight]=this.faces[b][a.cssFontWeight]||{};this.faces[b][a.cssFontWeight][a.cssFontStyle]=a;return this.faces[b][a.cssFontWeight][a.cssFontStyle]=a},drawText:function(a){var b=this.getFace(),c=this.size/b.resolution,e=0,d=
String(a).split(""),g=d.length,f=[];for(a=0;a<g;a++){var h=new THREE.Path,h=this.extractGlyphPoints(d[a],b,c,e,h),e=e+h.offset;f.push(h.path)}return{paths:f,offset:e/2}},extractGlyphPoints:function(a,b,c,e,d){var g=[],f,h,k,l,m,n,r,p,t,s,u,v=b.glyphs[a]||b.glyphs["?"];if(v){if(v.o)for(b=v._cachedOutline||(v._cachedOutline=v.o.split(" ")),l=b.length,a=0;a<l;)switch(k=b[a++],k){case "m":k=b[a++]*c+e;m=b[a++]*c;d.moveTo(k,m);break;case "l":k=b[a++]*c+e;m=b[a++]*c;d.lineTo(k,m);break;case "q":k=b[a++]*
c+e;m=b[a++]*c;p=b[a++]*c+e;t=b[a++]*c;d.quadraticCurveTo(p,t,k,m);if(f=g[g.length-1])for(n=f.x,r=f.y,f=1,h=this.divisions;f<=h;f++){var w=f/h;THREE.Shape.Utils.b2(w,n,p,k);THREE.Shape.Utils.b2(w,r,t,m)}break;case "b":if(k=b[a++]*c+e,m=b[a++]*c,p=b[a++]*c+e,t=b[a++]*-c,s=b[a++]*c+e,u=b[a++]*-c,d.bezierCurveTo(k,m,p,t,s,u),f=g[g.length-1])for(n=f.x,r=f.y,f=1,h=this.divisions;f<=h;f++)w=f/h,THREE.Shape.Utils.b3(w,n,p,s,k),THREE.Shape.Utils.b3(w,r,t,u,m)}return{offset:v.ha*c,path:d}}}};
THREE.FontUtils.generateShapes=function(a,b){b=b||{};var c=void 0!==b.curveSegments?b.curveSegments:4,e=void 0!==b.font?b.font:"helvetiker",d=void 0!==b.weight?b.weight:"normal",g=void 0!==b.style?b.style:"normal";THREE.FontUtils.size=void 0!==b.size?b.size:100;THREE.FontUtils.divisions=c;THREE.FontUtils.face=e;THREE.FontUtils.weight=d;THREE.FontUtils.style=g;c=THREE.FontUtils.drawText(a).paths;e=[];d=0;for(g=c.length;d<g;d++)Array.prototype.push.apply(e,c[d].toShapes());return e};
(function(a){var b=function(a){for(var b=a.length,d=0,g=b-1,f=0;f<b;g=f++)d+=a[g].x*a[f].y-a[f].x*a[g].y;return 0.5*d};a.Triangulate=function(a,e){var d=a.length;if(3>d)return null;var g=[],f=[],h=[],k,l,m;if(0<b(a))for(l=0;l<d;l++)f[l]=l;else for(l=0;l<d;l++)f[l]=d-1-l;var n=2*d;for(l=d-1;2<d;){if(0>=n--){console.log("Warning, unable to triangulate polygon!");break}k=l;d<=k&&(k=0);l=k+1;d<=l&&(l=0);m=l+1;d<=m&&(m=0);var r;a:{var p=void 0,t=void 0,s=void 0,u=void 0,v=void 0,w=void 0,z=void 0,x=void 0,
p=a[f[k]].x,t=a[f[k]].y,s=a[f[l]].x,u=a[f[l]].y,v=a[f[m]].x,w=a[f[m]].y;if(1E-10>(s-p)*(w-t)-(u-t)*(v-p))r=!1;else{var y=void 0,C=void 0,B=void 0,D=void 0,F=void 0,O=void 0,H=void 0,I=void 0,E=void 0,P=void 0,E=I=H=x=z=void 0,y=v-s,C=w-u,B=p-v,D=t-w,F=s-p,O=u-t;for(r=0;r<d;r++)if(z=a[f[r]].x,x=a[f[r]].y,!(z===p&&x===t||z===s&&x===u||z===v&&x===w)&&(H=z-p,I=x-t,E=z-s,P=x-u,z-=v,x-=w,E=y*P-C*E,H=F*I-O*H,I=B*x-D*z,-1E-10<=E&&-1E-10<=I&&-1E-10<=H)){r=!1;break a}r=!0}}if(r){g.push([a[f[k]],a[f[l]],a[f[m]]]);
h.push([f[k],f[l],f[m]]);k=l;for(m=l+1;m<d;k++,m++)f[k]=f[m];d--;n=2*d}}return e?h:g};a.Triangulate.area=b;return a})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);
THREE.Gyroscope.prototype.updateMatrixWorld=function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),
this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3;THREE.Gyroscope.prototype.translationObject=new THREE.Vector3;THREE.Gyroscope.prototype.quaternionWorld=new THREE.Quaternion;THREE.Gyroscope.prototype.quaternionObject=new THREE.Quaternion;THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3;THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3;
THREE.AnimationHandler=function(){var a=[],b={},c={update:function(b){for(var c=0;c<a.length;c++)a[c].update(b)},addToUpdate:function(b){-1===a.indexOf(b)&&a.push(b)},removeFromUpdate:function(b){b=a.indexOf(b);-1!==b&&a.splice(b,1)},add:function(a){void 0!==b[a.name]&&console.log("THREE.AnimationHandler.add: Warning! "+a.name+" already exists in library. Overwriting.");b[a.name]=a;if(!0!==a.initialized){for(var c=0;c<a.hierarchy.length;c++){for(var f=0;f<a.hierarchy[c].keys.length;f++)if(0>a.hierarchy[c].keys[f].time&&
(a.hierarchy[c].keys[f].time=0),void 0!==a.hierarchy[c].keys[f].rot&&!(a.hierarchy[c].keys[f].rot instanceof THREE.Quaternion)){var h=a.hierarchy[c].keys[f].rot;a.hierarchy[c].keys[f].rot=new THREE.Quaternion(h[0],h[1],h[2],h[3])}if(a.hierarchy[c].keys.length&&void 0!==a.hierarchy[c].keys[0].morphTargets){h={};for(f=0;f<a.hierarchy[c].keys.length;f++)for(var e=0;e<a.hierarchy[c].keys[f].morphTargets.length;e++){var l=a.hierarchy[c].keys[f].morphTargets[e];h[l]=-1}a.hierarchy[c].usedMorphTargets=h;
for(f=0;f<a.hierarchy[c].keys.length;f++){var m={};for(l in h){for(e=0;e<a.hierarchy[c].keys[f].morphTargets.length;e++)if(a.hierarchy[c].keys[f].morphTargets[e]===l){m[l]=a.hierarchy[c].keys[f].morphTargetsInfluences[e];break}e===a.hierarchy[c].keys[f].morphTargets.length&&(m[l]=0)}a.hierarchy[c].keys[f].morphTargetsInfluences=m}}for(f=1;f<a.hierarchy[c].keys.length;f++)a.hierarchy[c].keys[f].time===a.hierarchy[c].keys[f-1].time&&(a.hierarchy[c].keys.splice(f,1),f--);for(f=0;f<a.hierarchy[c].keys.length;f++)a.hierarchy[c].keys[f].index=
f}a.initialized=!0}},get:function(a){if("string"===typeof a){if(b[a])return b[a];console.log("THREE.AnimationHandler.get: Couldn't find animation "+a);return null}},parse:function(a){var b=[];if(a instanceof THREE.SkinnedMesh)for(var f=0;f<a.bones.length;f++)b.push(a.bones[f]);else e(a,b);return b}},e=function(a,b){b.push(a);for(var f=0;f<a.children.length;f++)e(a.children[f],b)};c.LINEAR=0;c.CATMULLROM=1;c.CATMULLROM_FORWARD=2;return c}();
THREE.Animation=function(a,b){this.root=a;this.data=THREE.AnimationHandler.get(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=this.isPaused=!0;this.interpolationType=THREE.AnimationHandler.LINEAR};THREE.Animation.prototype.play=function(a){this.currentTime=void 0!==a?a:0;!1===this.isPlaying&&(this.isPlaying=!0,this.reset(),this.update(0));this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};
THREE.Animation.prototype.pause=function(){!0===this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this)};
THREE.Animation.prototype.reset=function(){for(var a=0,b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a];c.matrixAutoUpdate=!0;void 0===c.animationCache&&(c.animationCache={},c.animationCache.prevKey={pos:0,rot:0,scl:0},c.animationCache.nextKey={pos:0,rot:0,scl:0},c.animationCache.originalMatrix=c instanceof THREE.Bone?c.skinMatrix:c.matrix);var e=c.animationCache.prevKey,c=c.animationCache.nextKey;e.pos=this.data.hierarchy[a].keys[0];e.rot=this.data.hierarchy[a].keys[0];e.scl=this.data.hierarchy[a].keys[0];
c.pos=this.getNextKeyWith("pos",a,1);c.rot=this.getNextKeyWith("rot",a,1);c.scl=this.getNextKeyWith("scl",a,1)}};
THREE.Animation.prototype.update=function(){var a=[],b=new THREE.Vector3,c=function(a,b){var f=[],c=[],k,l,m,n,r,p;k=(a.length-1)*b;l=Math.floor(k);k-=l;f[0]=0===l?l:l-1;f[1]=l;f[2]=l>a.length-2?l:l+1;f[3]=l>a.length-3?l:l+2;l=a[f[0]];n=a[f[1]];r=a[f[2]];p=a[f[3]];f=k*k;m=k*f;c[0]=e(l[0],n[0],r[0],p[0],k,f,m);c[1]=e(l[1],n[1],r[1],p[1],k,f,m);c[2]=e(l[2],n[2],r[2],p[2],k,f,m);return c},e=function(a,b,f,c,e,l,m){a=0.5*(f-a);c=0.5*(c-b);return(2*(b-f)+a+c)*m+(-3*(b-f)-2*a-c)*l+a*e+b};return function(d){if(!1!==
this.isPlaying){this.currentTime+=d*this.timeScale;var e;d=["pos","rot","scl"];var f=this.data.length;if(!0===this.loop&&this.currentTime>f)this.currentTime%=f,this.reset();else if(!1===this.loop&&this.currentTime>f){this.stop();return}this.currentTime=Math.min(this.currentTime,f);for(var f=0,h=this.hierarchy.length;f<h;f++)for(var k=this.hierarchy[f],l=k.animationCache,m=0;3>m;m++){e=d[m];var n=l.prevKey[e],r=l.nextKey[e];if(r.time<=this.currentTime){n=this.data.hierarchy[f].keys[0];for(r=this.getNextKeyWith(e,
f,1);r.time<this.currentTime&&r.index>n.index;)n=r,r=this.getNextKeyWith(e,f,r.index+1);l.prevKey[e]=n;l.nextKey[e]=r}k.matrixAutoUpdate=!0;k.matrixWorldNeedsUpdate=!0;var p=(this.currentTime-n.time)/(r.time-n.time),t=n[e],s=r[e];0>p&&(p=0);1<p&&(p=1);if("pos"===e)if(e=k.position,this.interpolationType===THREE.AnimationHandler.LINEAR)e.x=t[0]+(s[0]-t[0])*p,e.y=t[1]+(s[1]-t[1])*p,e.z=t[2]+(s[2]-t[2])*p;else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)a[0]=
this.getPrevKeyWith("pos",f,n.index-1).pos,a[1]=t,a[2]=s,a[3]=this.getNextKeyWith("pos",f,r.index+1).pos,p=0.33*p+0.33,n=c(a,p),e.x=n[0],e.y=n[1],e.z=n[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(p=c(a,1.01*p),b.set(p[0],p[1],p[2]),b.sub(e),b.y=0,b.normalize(),e=Math.atan2(b.x,b.z),k.rotation.set(0,e,0))}else"rot"===e?THREE.Quaternion.slerp(t,s,k.quaternion,p):"scl"===e&&(e=k.scale,e.x=t[0]+(s[0]-t[0])*p,e.y=t[1]+(s[1]-t[1])*p,e.z=t[2]+(s[2]-t[2])*p)}}}}();
THREE.Animation.prototype.getNextKeyWith=function(a,b,c){var e=this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?c<e.length-1?c:e.length-1:c%e.length;c<e.length;c++)if(void 0!==e[c][a])return e[c];return this.data.hierarchy[b].keys[0]};
THREE.Animation.prototype.getPrevKeyWith=function(a,b,c){var e=this.data.hierarchy[b].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<c?c:0:0<=c?c:c+e.length;0<=c;c--)if(void 0!==e[c][a])return e[c];return this.data.hierarchy[b].keys[e.length-1]};
THREE.KeyFrameAnimation=function(a,b){this.root=a;this.data=THREE.AnimationHandler.get(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=0.001;this.isPlaying=!1;this.loop=this.isPaused=!0;for(var c=0,e=this.hierarchy.length;c<e;c++){var d=this.data.hierarchy[c].sids,g=this.hierarchy[c];if(this.data.hierarchy[c].keys.length&&d){for(var f=0;f<d.length;f++){var h=d[f],k=this.getNextKeyWith(h,c,0);k&&k.apply(h)}g.matrixAutoUpdate=!1;this.data.hierarchy[c].node.updateMatrix();
g.matrixWorldNeedsUpdate=!0}}};
THREE.KeyFrameAnimation.prototype.play=function(a){this.currentTime=void 0!==a?a:0;if(!1===this.isPlaying){this.isPlaying=!0;var b=this.hierarchy.length,c,e;for(a=0;a<b;a++)c=this.hierarchy[a],e=this.data.hierarchy[a],void 0===e.animationCache&&(e.animationCache={},e.animationCache.prevKey=null,e.animationCache.nextKey=null,e.animationCache.originalMatrix=c instanceof THREE.Bone?c.skinMatrix:c.matrix),c=this.data.hierarchy[a].keys,c.length&&(e.animationCache.prevKey=c[0],e.animationCache.nextKey=
c[1],this.startTime=Math.min(c[0].time,this.startTime),this.endTime=Math.max(c[c.length-1].time,this.endTime));this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};
THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var a=0;a<this.data.hierarchy.length;a++){var b=this.hierarchy[a],c=this.data.hierarchy[a];if(void 0!==c.animationCache){var e=c.animationCache.originalMatrix;b instanceof THREE.Bone?(e.copy(b.skinMatrix),b.skinMatrix=e):(e.copy(b.matrix),b.matrix=e);delete c.animationCache}}};
THREE.KeyFrameAnimation.prototype.update=function(a){if(!1!==this.isPlaying){this.currentTime+=a*this.timeScale;a=this.data.length;!0===this.loop&&this.currentTime>a&&(this.currentTime%=a);this.currentTime=Math.min(this.currentTime,a);a=0;for(var b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a],e=this.data.hierarchy[a],d=e.keys,e=e.animationCache;if(d.length){var g=e.prevKey,f=e.nextKey;if(f.time<=this.currentTime){for(;f.time<this.currentTime&&f.index>g.index;)g=f,f=d[g.index+1];e.prevKey=
g;e.nextKey=f}f.time>=this.currentTime?g.interpolate(f,this.currentTime):g.interpolate(f,f.time);this.data.hierarchy[a].node.updateMatrix();c.matrixWorldNeedsUpdate=!0}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c%=b.length;c<b.length;c++)if(b[c].hasTarget(a))return b[c];return b[0]};
THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(a,b,c){b=this.data.hierarchy[b].keys;for(c=0<=c?c:c+b.length;0<=c;c--)if(b[c].hasTarget(a))return b[c];return b[b.length-1]};
THREE.CubeCamera=function(a,b,c){THREE.Object3D.call(this);var e=new THREE.PerspectiveCamera(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new THREE.Vector3(1,0,0));this.add(e);var d=new THREE.PerspectiveCamera(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new THREE.Vector3(-1,0,0));this.add(d);var g=new THREE.PerspectiveCamera(90,1,a,b);g.up.set(0,0,1);g.lookAt(new THREE.Vector3(0,1,0));this.add(g);var f=new THREE.PerspectiveCamera(90,1,a,b);f.up.set(0,0,-1);f.lookAt(new THREE.Vector3(0,-1,0));this.add(f);var h=new THREE.PerspectiveCamera(90,
1,a,b);h.up.set(0,-1,0);h.lookAt(new THREE.Vector3(0,0,1));this.add(h);var k=new THREE.PerspectiveCamera(90,1,a,b);k.up.set(0,-1,0);k.lookAt(new THREE.Vector3(0,0,-1));this.add(k);this.renderTarget=new THREE.WebGLRenderTargetCube(c,c,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(a,b){var c=this.renderTarget,r=c.generateMipmaps;c.generateMipmaps=!1;c.activeCubeFace=0;a.render(b,e,c);c.activeCubeFace=1;a.render(b,d,c);c.activeCubeFace=
2;a.render(b,g,c);c.activeCubeFace=3;a.render(b,f,c);c.activeCubeFace=4;a.render(b,h,c);c.generateMipmaps=r;c.activeCubeFace=5;a.render(b,k,c)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CombinedCamera=function(a,b,c,e,d,g,f){THREE.Camera.call(this);this.fov=c;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2;this.cameraO=new THREE.OrthographicCamera(a/-2,a/2,b/2,b/-2,g,f);this.cameraP=new THREE.PerspectiveCamera(c,a/b,e,d);this.zoom=1;this.toPerspective()};
THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype);THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near;this.far=this.cameraP.far;this.cameraP.fov=this.fov/this.zoom;this.cameraP.updateProjectionMatrix();this.projectionMatrix=this.cameraP.projectionMatrix;this.inPerspectiveMode=!0;this.inOrthographicMode=!1};
THREE.CombinedCamera.prototype.toOrthographic=function(){var a=this.cameraP.aspect,b=(this.cameraP.near+this.cameraP.far)/2,b=Math.tan(this.fov/2)*b,a=2*b*a/2,b=b/this.zoom,a=a/this.zoom;this.cameraO.left=-a;this.cameraO.right=a;this.cameraO.top=b;this.cameraO.bottom=-b;this.cameraO.updateProjectionMatrix();this.near=this.cameraO.near;this.far=this.cameraO.far;this.projectionMatrix=this.cameraO.projectionMatrix;this.inPerspectiveMode=!1;this.inOrthographicMode=!0};
THREE.CombinedCamera.prototype.setSize=function(a,b){this.cameraP.aspect=a/b;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2};THREE.CombinedCamera.prototype.setFov=function(a){this.fov=a;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())};
THREE.CombinedCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);var c=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.setFov(c);return c};THREE.CombinedCamera.prototype.setZoom=function(a){this.zoom=a;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0;this.rotation.y=Math.PI;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0;this.rotation.y=-Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0;this.rotation.y=Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.BoxGeometry=function(a,b,c,e,d,g){function f(a,b,f,c,d,e,g,s){var u,v=h.widthSegments,w=h.heightSegments,z=d/2,x=e/2,y=h.vertices.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)u="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)u="y",w=h.depthSegments;else if("z"===a&&"y"===b||"y"===a&&"z"===b)u="x",v=h.depthSegments;var C=v+1,B=w+1,D=d/v,F=e/w,O=new THREE.Vector3;O[u]=0<g?1:-1;for(d=0;d<B;d++)for(e=0;e<C;e++){var H=new THREE.Vector3;H[a]=(e*D-z)*f;H[b]=(d*F-x)*c;H[u]=g;h.vertices.push(H)}for(d=
0;d<w;d++)for(e=0;e<v;e++)x=e+C*d,a=e+C*(d+1),b=e+1+C*(d+1),f=e+1+C*d,c=new THREE.Vector2(e/v,1-d/w),g=new THREE.Vector2(e/v,1-(d+1)/w),u=new THREE.Vector2((e+1)/v,1-(d+1)/w),z=new THREE.Vector2((e+1)/v,1-d/w),x=new THREE.Face3(x+y,a+y,f+y),x.normal.copy(O),x.vertexNormals.push(O.clone(),O.clone(),O.clone()),x.materialIndex=s,h.faces.push(x),h.faceVertexUvs[0].push([c,g,z]),x=new THREE.Face3(a+y,b+y,f+y),x.normal.copy(O),x.vertexNormals.push(O.clone(),O.clone(),O.clone()),x.materialIndex=s,h.faces.push(x),
h.faceVertexUvs[0].push([g.clone(),u,z.clone()])}THREE.Geometry.call(this);var h=this;this.width=a;this.height=b;this.depth=c;this.widthSegments=e||1;this.heightSegments=d||1;this.depthSegments=g||1;a=this.width/2;b=this.height/2;c=this.depth/2;f("z","y",-1,-1,this.depth,this.height,a,0);f("z","y",1,-1,this.depth,this.height,-a,1);f("x","z",1,1,this.width,this.depth,b,2);f("x","z",1,-1,this.width,this.depth,-b,3);f("x","y",1,-1,this.width,this.height,c,4);f("x","y",-1,-1,this.width,this.height,-c,
5);this.computeCentroids();this.mergeVertices()};THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CircleGeometry=function(a,b,c,e){THREE.Geometry.call(this);this.radius=a=a||50;this.segments=b=void 0!==b?Math.max(3,b):8;this.thetaStart=c=void 0!==c?c:0;this.thetaLength=e=void 0!==e?e:2*Math.PI;var d,g=[];d=new THREE.Vector3;var f=new THREE.Vector2(0.5,0.5);this.vertices.push(d);g.push(f);for(d=0;d<=b;d++){var h=new THREE.Vector3,k=c+d/b*e;h.x=a*Math.cos(k);h.y=a*Math.sin(k);this.vertices.push(h);g.push(new THREE.Vector2((h.x/a+1)/2,(h.y/a+1)/2))}c=new THREE.Vector3(0,0,1);for(d=1;d<=b;d++)this.faces.push(new THREE.Face3(d,
d+1,0,[c.clone(),c.clone(),c.clone()])),this.faceVertexUvs[0].push([g[d].clone(),g[d+1].clone(),f.clone()]);this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CylinderGeometry=function(a,b,c,e,d,g){THREE.Geometry.call(this);this.radiusTop=a=void 0!==a?a:20;this.radiusBottom=b=void 0!==b?b:20;this.height=c=void 0!==c?c:100;this.radialSegments=e=e||8;this.heightSegments=d=d||1;this.openEnded=g=void 0!==g?g:!1;var f=c/2,h,k,l=[],m=[];for(k=0;k<=d;k++){var n=[],r=[],p=k/d,t=p*(b-a)+a;for(h=0;h<=e;h++){var s=h/e,u=new THREE.Vector3;u.x=t*Math.sin(s*Math.PI*2);u.y=-p*c+f;u.z=t*Math.cos(s*Math.PI*2);this.vertices.push(u);n.push(this.vertices.length-1);r.push(new THREE.Vector2(s,
1-p))}l.push(n);m.push(r)}c=(b-a)/c;for(h=0;h<e;h++)for(0!==a?(n=this.vertices[l[0][h]].clone(),r=this.vertices[l[0][h+1]].clone()):(n=this.vertices[l[1][h]].clone(),r=this.vertices[l[1][h+1]].clone()),n.setY(Math.sqrt(n.x*n.x+n.z*n.z)*c).normalize(),r.setY(Math.sqrt(r.x*r.x+r.z*r.z)*c).normalize(),k=0;k<d;k++){var p=l[k][h],t=l[k+1][h],s=l[k+1][h+1],u=l[k][h+1],v=n.clone(),w=n.clone(),z=r.clone(),x=r.clone(),y=m[k][h].clone(),C=m[k+1][h].clone(),B=m[k+1][h+1].clone(),D=m[k][h+1].clone();this.faces.push(new THREE.Face3(p,
t,u,[v,w,x]));this.faceVertexUvs[0].push([y,C,D]);this.faces.push(new THREE.Face3(t,s,u,[w.clone(),z,x.clone()]));this.faceVertexUvs[0].push([C.clone(),B,D.clone()])}if(!1===g&&0<a)for(this.vertices.push(new THREE.Vector3(0,f,0)),h=0;h<e;h++)p=l[0][h],t=l[0][h+1],s=this.vertices.length-1,v=new THREE.Vector3(0,1,0),w=new THREE.Vector3(0,1,0),z=new THREE.Vector3(0,1,0),y=m[0][h].clone(),C=m[0][h+1].clone(),B=new THREE.Vector2(C.x,0),this.faces.push(new THREE.Face3(p,t,s,[v,w,z])),this.faceVertexUvs[0].push([y,
C,B]);if(!1===g&&0<b)for(this.vertices.push(new THREE.Vector3(0,-f,0)),h=0;h<e;h++)p=l[k][h+1],t=l[k][h],s=this.vertices.length-1,v=new THREE.Vector3(0,-1,0),w=new THREE.Vector3(0,-1,0),z=new THREE.Vector3(0,-1,0),y=m[k][h+1].clone(),C=m[k][h].clone(),B=new THREE.Vector2(C.x,1),this.faces.push(new THREE.Face3(p,t,s,[v,w,z])),this.faceVertexUvs[0].push([y,C,B]);this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ExtrudeGeometry=function(a,b){"undefined"!==typeof a&&(THREE.Geometry.call(this),a=a instanceof Array?a:[a],this.shapebb=a[a.length-1].getBoundingBox(),this.addShapeList(a,b),this.computeCentroids(),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(a,b){for(var c=a.length,e=0;e<c;e++)this.addShape(a[e],b)};
THREE.ExtrudeGeometry.prototype.addShape=function(a,b){function c(a,b,f){b||console.log("die");return b.clone().multiplyScalar(f).add(a)}function e(a,b,f){var c=THREE.Math.sign,d=1,d=a.x-b.x,h=a.y-b.y,e=f.x-a.x,k=f.y-a.y,g=d*d+h*h;if(1E-10<Math.abs(d*k-h*e)){var l=Math.sqrt(g),c=Math.sqrt(e*e+k*k),g=b.x-h/l;b=b.y+d/l;e=((f.x-k/c-g)*k-(f.y+e/c-b)*e)/(d*k-h*e);f=g+d*e-a.x;a=b+h*e-a.y;d=f*f+a*a;if(2>=d)return new THREE.Vector2(f,a);d=Math.sqrt(d/2)}else a=!1,1E-10<d?1E-10<e&&(a=!0):-1E-10>d?-1E-10>e&&
(a=!0):c(h)==c(k)&&(a=!0),a?(f=-h,a=d,d=Math.sqrt(g)):(f=d,a=h,d=Math.sqrt(g/2));return new THREE.Vector2(f/d,a/d)}function d(f,c){var d,h;for(K=f.length;0<=--K;){d=K;h=K-1;0>h&&(h=f.length-1);for(var e=0,k=p+2*m,e=0;e<k;e++){var g=R*e,l=R*(e+1),n=c+d+g,g=c+h+g,r=c+h+l,l=c+d+l,s=f,t=e,u=k,v=d,S=h,n=n+I,g=g+I,r=r+I,l=l+I;H.faces.push(new THREE.Face3(n,g,l,null,null,w));H.faces.push(new THREE.Face3(g,r,l,null,null,w));n=z.generateSideWallUV(H,a,s,b,n,g,r,l,t,u,v,S);H.faceVertexUvs[0].push([n[0],n[1],
n[3]]);H.faceVertexUvs[0].push([n[1],n[2],n[3]])}}}function g(a,b,f){H.vertices.push(new THREE.Vector3(a,b,f))}function f(f,c,d,h){f+=I;c+=I;d+=I;H.faces.push(new THREE.Face3(f,c,d,null,null,v));f=h?z.generateBottomUV(H,a,b,f,c,d):z.generateTopUV(H,a,b,f,c,d);H.faceVertexUvs[0].push(f)}var h=void 0!==b.amount?b.amount:100,k=void 0!==b.bevelThickness?b.bevelThickness:6,l=void 0!==b.bevelSize?b.bevelSize:k-2,m=void 0!==b.bevelSegments?b.bevelSegments:3,n=void 0!==b.bevelEnabled?b.bevelEnabled:!0,r=
void 0!==b.curveSegments?b.curveSegments:12,p=void 0!==b.steps?b.steps:1,t=b.extrudePath,s,u=!1,v=b.material,w=b.extrudeMaterial,z=void 0!==b.UVGenerator?b.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,x,y,C,B;t&&(s=t.getSpacedPoints(p),u=!0,n=!1,x=void 0!==b.frames?b.frames:new THREE.TubeGeometry.FrenetFrames(t,p,!1),y=new THREE.Vector3,C=new THREE.Vector3,B=new THREE.Vector3);n||(l=k=m=0);var D,F,O,H=this,I=this.vertices.length,t=a.extractPoints(r),r=t.shape,E=t.holes;if(t=!THREE.Shape.Utils.isClockWise(r)){r=
r.reverse();F=0;for(O=E.length;F<O;F++)D=E[F],THREE.Shape.Utils.isClockWise(D)&&(E[F]=D.reverse());t=!1}var P=THREE.Shape.Utils.triangulateShape(r,E),T=r;F=0;for(O=E.length;F<O;F++)D=E[F],r=r.concat(D);var S,U,N,aa,Q,R=r.length,X,ga=P.length,t=[],K=0;N=T.length;S=N-1;for(U=K+1;K<N;K++,S++,U++)S===N&&(S=0),U===N&&(U=0),t[K]=e(T[K],T[S],T[U]);var ia=[],ha,ea=t.concat();F=0;for(O=E.length;F<O;F++){D=E[F];ha=[];K=0;N=D.length;S=N-1;for(U=K+1;K<N;K++,S++,U++)S===N&&(S=0),U===N&&(U=0),ha[K]=e(D[K],D[S],
D[U]);ia.push(ha);ea=ea.concat(ha)}for(S=0;S<m;S++){N=S/m;aa=k*(1-N);U=l*Math.sin(N*Math.PI/2);K=0;for(N=T.length;K<N;K++)Q=c(T[K],t[K],U),g(Q.x,Q.y,-aa);F=0;for(O=E.length;F<O;F++)for(D=E[F],ha=ia[F],K=0,N=D.length;K<N;K++)Q=c(D[K],ha[K],U),g(Q.x,Q.y,-aa)}U=l;for(K=0;K<R;K++)Q=n?c(r[K],ea[K],U):r[K],u?(C.copy(x.normals[0]).multiplyScalar(Q.x),y.copy(x.binormals[0]).multiplyScalar(Q.y),B.copy(s[0]).add(C).add(y),g(B.x,B.y,B.z)):g(Q.x,Q.y,0);for(N=1;N<=p;N++)for(K=0;K<R;K++)Q=n?c(r[K],ea[K],U):r[K],
u?(C.copy(x.normals[N]).multiplyScalar(Q.x),y.copy(x.binormals[N]).multiplyScalar(Q.y),B.copy(s[N]).add(C).add(y),g(B.x,B.y,B.z)):g(Q.x,Q.y,h/p*N);for(S=m-1;0<=S;S--){N=S/m;aa=k*(1-N);U=l*Math.sin(N*Math.PI/2);K=0;for(N=T.length;K<N;K++)Q=c(T[K],t[K],U),g(Q.x,Q.y,h+aa);F=0;for(O=E.length;F<O;F++)for(D=E[F],ha=ia[F],K=0,N=D.length;K<N;K++)Q=c(D[K],ha[K],U),u?g(Q.x,Q.y+s[p-1].y,s[p-1].x+aa):g(Q.x,Q.y,h+aa)}(function(){if(n){var a;a=0*R;for(K=0;K<ga;K++)X=P[K],f(X[2]+a,X[1]+a,X[0]+a,!0);a=p+2*m;a*=R;
for(K=0;K<ga;K++)X=P[K],f(X[0]+a,X[1]+a,X[2]+a,!1)}else{for(K=0;K<ga;K++)X=P[K],f(X[2],X[1],X[0],!0);for(K=0;K<ga;K++)X=P[K],f(X[0]+R*p,X[1]+R*p,X[2]+R*p,!1)}})();(function(){var a=0;d(T,a);a+=T.length;F=0;for(O=E.length;F<O;F++)D=E[F],d(D,a),a+=D.length})()};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(a,b,c,e,d,g){b=a.vertices[d].x;d=a.vertices[d].y;c=a.vertices[g].x;g=a.vertices[g].y;return[new THREE.Vector2(a.vertices[e].x,a.vertices[e].y),new THREE.Vector2(b,d),new THREE.Vector2(c,g)]},generateBottomUV:function(a,b,c,e,d,g){return this.generateTopUV(a,b,c,e,d,g)},generateSideWallUV:function(a,b,c,e,d,g,f,h,k,l,m,n){b=a.vertices[d].x;c=a.vertices[d].y;d=a.vertices[d].z;e=a.vertices[g].x;k=a.vertices[g].y;g=a.vertices[g].z;l=a.vertices[f].x;
m=a.vertices[f].y;f=a.vertices[f].z;n=a.vertices[h].x;var r=a.vertices[h].y;a=a.vertices[h].z;return 0.01>Math.abs(c-k)?[new THREE.Vector2(b,1-d),new THREE.Vector2(e,1-g),new THREE.Vector2(l,1-f),new THREE.Vector2(n,1-a)]:[new THREE.Vector2(c,1-d),new THREE.Vector2(k,1-g),new THREE.Vector2(m,1-f),new THREE.Vector2(r,1-a)]}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;
THREE.ExtrudeGeometry.__v5=new THREE.Vector2;THREE.ExtrudeGeometry.__v6=new THREE.Vector2;THREE.ShapeGeometry=function(a,b){THREE.Geometry.call(this);!1===a instanceof Array&&(a=[a]);this.shapebb=a[a.length-1].getBoundingBox();this.addShapeList(a,b);this.computeCentroids();this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.addShapeList=function(a,b){for(var c=0,e=a.length;c<e;c++)this.addShape(a[c],b);return this};
THREE.ShapeGeometry.prototype.addShape=function(a,b){void 0===b&&(b={});var c=b.material,e=void 0===b.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:b.UVGenerator,d,g,f,h=this.vertices.length;d=a.extractPoints(void 0!==b.curveSegments?b.curveSegments:12);var k=d.shape,l=d.holes;if(!THREE.Shape.Utils.isClockWise(k))for(k=k.reverse(),d=0,g=l.length;d<g;d++)f=l[d],THREE.Shape.Utils.isClockWise(f)&&(l[d]=f.reverse());var m=THREE.Shape.Utils.triangulateShape(k,l);d=0;for(g=l.length;d<g;d++)f=l[d],
k=k.concat(f);l=k.length;g=m.length;for(d=0;d<l;d++)f=k[d],this.vertices.push(new THREE.Vector3(f.x,f.y,0));for(d=0;d<g;d++)l=m[d],k=l[0]+h,f=l[1]+h,l=l[2]+h,this.faces.push(new THREE.Face3(k,f,l,null,null,c)),this.faceVertexUvs[0].push(e.generateBottomUV(this,a,b,k,f,l))};
THREE.LatheGeometry=function(a,b,c,e){THREE.Geometry.call(this);b=b||12;c=c||0;e=e||2*Math.PI;for(var d=1/(a.length-1),g=1/b,f=0,h=b;f<=h;f++)for(var k=c+f*g*e,l=Math.cos(k),m=Math.sin(k),k=0,n=a.length;k<n;k++){var r=a[k],p=new THREE.Vector3;p.x=l*r.x-m*r.y;p.y=m*r.x+l*r.y;p.z=r.z;this.vertices.push(p)}c=a.length;f=0;for(h=b;f<h;f++)for(k=0,n=a.length-1;k<n;k++){b=m=k+c*f;e=m+c;var l=m+1+c,m=m+1,r=f*g,p=k*d,t=r+g,s=p+d;this.faces.push(new THREE.Face3(b,e,m));this.faceVertexUvs[0].push([new THREE.Vector2(r,
p),new THREE.Vector2(t,p),new THREE.Vector2(r,s)]);this.faces.push(new THREE.Face3(e,l,m));this.faceVertexUvs[0].push([new THREE.Vector2(t,p),new THREE.Vector2(t,s),new THREE.Vector2(r,s)])}this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.PlaneGeometry=function(a,b,c,e){THREE.Geometry.call(this);this.width=a;this.height=b;this.widthSegments=c||1;this.heightSegments=e||1;var d=a/2,g=b/2;c=this.widthSegments;e=this.heightSegments;var f=c+1,h=e+1,k=this.width/c,l=this.height/e,m=new THREE.Vector3(0,0,1);for(a=0;a<h;a++)for(b=0;b<f;b++)this.vertices.push(new THREE.Vector3(b*k-d,-(a*l-g),0));for(a=0;a<e;a++)for(b=0;b<c;b++){var n=b+f*a,d=b+f*(a+1),g=b+1+f*(a+1),h=b+1+f*a,k=new THREE.Vector2(b/c,1-a/e),l=new THREE.Vector2(b/c,1-(a+
1)/e),r=new THREE.Vector2((b+1)/c,1-(a+1)/e),p=new THREE.Vector2((b+1)/c,1-a/e),n=new THREE.Face3(n,d,h);n.normal.copy(m);n.vertexNormals.push(m.clone(),m.clone(),m.clone());this.faces.push(n);this.faceVertexUvs[0].push([k,l,p]);n=new THREE.Face3(d,g,h);n.normal.copy(m);n.vertexNormals.push(m.clone(),m.clone(),m.clone());this.faces.push(n);this.faceVertexUvs[0].push([l.clone(),r,p.clone()])}this.computeCentroids()};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.RingGeometry=function(a,b,c,e,d,g){THREE.Geometry.call(this);a=a||0;b=b||50;d=void 0!==d?d:0;g=void 0!==g?g:2*Math.PI;c=void 0!==c?Math.max(3,c):8;e=void 0!==e?Math.max(3,e):8;var f,h=[],k=a,l=(b-a)/e;for(a=0;a<=e;a++){for(f=0;f<=c;f++){var m=new THREE.Vector3,n=d+f/c*g;m.x=k*Math.cos(n);m.y=k*Math.sin(n);this.vertices.push(m);h.push(new THREE.Vector2((m.x/b+1)/2,(m.y/b+1)/2))}k+=l}b=new THREE.Vector3(0,0,1);for(a=0;a<e;a++)for(d=a*c,f=0;f<=c;f++)n=f+d,g=n+a,l=n+c+a,m=n+c+1+a,this.faces.push(new THREE.Face3(g,
l,m,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([h[g].clone(),h[l].clone(),h[m].clone()]),g=n+a,l=n+c+1+a,m=n+1+a,this.faces.push(new THREE.Face3(g,l,m,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([h[g].clone(),h[l].clone(),h[m].clone()]);this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,k)};THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.SphereGeometry=function(a,b,c,e,d,g,f){THREE.Geometry.call(this);this.radius=a=a||50;this.widthSegments=b=Math.max(3,Math.floor(b)||8);this.heightSegments=c=Math.max(2,Math.floor(c)||6);this.phiStart=e=void 0!==e?e:0;this.phiLength=d=void 0!==d?d:2*Math.PI;this.thetaStart=g=void 0!==g?g:0;this.thetaLength=f=void 0!==f?f:Math.PI;var h,k,l=[],m=[];for(k=0;k<=c;k++){var n=[],r=[];for(h=0;h<=b;h++){var p=h/b,t=k/c,s=new THREE.Vector3;s.x=-a*Math.cos(e+p*d)*Math.sin(g+t*f);s.y=a*Math.cos(g+t*f);
s.z=a*Math.sin(e+p*d)*Math.sin(g+t*f);this.vertices.push(s);n.push(this.vertices.length-1);r.push(new THREE.Vector2(p,1-t))}l.push(n);m.push(r)}for(k=0;k<this.heightSegments;k++)for(h=0;h<this.widthSegments;h++){b=l[k][h+1];c=l[k][h];e=l[k+1][h];d=l[k+1][h+1];g=this.vertices[b].clone().normalize();f=this.vertices[c].clone().normalize();var n=this.vertices[e].clone().normalize(),r=this.vertices[d].clone().normalize(),p=m[k][h+1].clone(),t=m[k][h].clone(),s=m[k+1][h].clone(),u=m[k+1][h+1].clone();Math.abs(this.vertices[b].y)===
this.radius?(p.x=(p.x+t.x)/2,this.faces.push(new THREE.Face3(b,e,d,[g,n,r])),this.faceVertexUvs[0].push([p,s,u])):Math.abs(this.vertices[e].y)===this.radius?(s.x=(s.x+u.x)/2,this.faces.push(new THREE.Face3(b,c,e,[g,f,n])),this.faceVertexUvs[0].push([p,t,s])):(this.faces.push(new THREE.Face3(b,c,d,[g,f,r])),this.faceVertexUvs[0].push([p,t,u]),this.faces.push(new THREE.Face3(c,e,d,[f.clone(),n,r.clone()])),this.faceVertexUvs[0].push([t.clone(),s,u.clone()]))}this.computeCentroids();this.computeFaceNormals();
this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TextGeometry=function(a,b){b=b||{};var c=THREE.FontUtils.generateShapes(a,b);b.amount=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,c,b)};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);
THREE.TorusGeometry=function(a,b,c,e,d){THREE.Geometry.call(this);this.radius=a||100;this.tube=b||40;this.radialSegments=c||8;this.tubularSegments=e||6;this.arc=d||2*Math.PI;d=new THREE.Vector3;a=[];b=[];for(c=0;c<=this.radialSegments;c++)for(e=0;e<=this.tubularSegments;e++){var g=e/this.tubularSegments*this.arc,f=c/this.radialSegments*Math.PI*2;d.x=this.radius*Math.cos(g);d.y=this.radius*Math.sin(g);var h=new THREE.Vector3;h.x=(this.radius+this.tube*Math.cos(f))*Math.cos(g);h.y=(this.radius+this.tube*
Math.cos(f))*Math.sin(g);h.z=this.tube*Math.sin(f);this.vertices.push(h);a.push(new THREE.Vector2(e/this.tubularSegments,c/this.radialSegments));b.push(h.clone().sub(d).normalize())}for(c=1;c<=this.radialSegments;c++)for(e=1;e<=this.tubularSegments;e++){d=(this.tubularSegments+1)*c+e-1;var g=(this.tubularSegments+1)*(c-1)+e-1,f=(this.tubularSegments+1)*(c-1)+e,h=(this.tubularSegments+1)*c+e,k=new THREE.Face3(d,g,h,[b[d].clone(),b[g].clone(),b[h].clone()]);this.faces.push(k);this.faceVertexUvs[0].push([a[d].clone(),
a[g].clone(),a[h].clone()]);k=new THREE.Face3(g,f,h,[b[g].clone(),b[f].clone(),b[h].clone()]);this.faces.push(k);this.faceVertexUvs[0].push([a[g].clone(),a[f].clone(),a[h].clone()])}this.computeCentroids();this.computeFaceNormals()};THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry=function(a,b,c,e,d){THREE.Geometry.call(this);this.path=a;this.segments=b||64;this.radius=c||1;this.radialSegments=e||8;this.closed=d||!1;this.grid=[];var g,f;e=this.segments+1;var h,k,l;d=new THREE.Vector3;var m,n;b=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed);m=b.normals;n=b.binormals;this.tangents=b.tangents;this.normals=m;this.binormals=n;for(b=0;b<e;b++)for(this.grid[b]=[],c=b/(e-1),l=a.getPointAt(c),g=m[b],f=n[b],c=0;c<this.radialSegments;c++)h=
c/this.radialSegments*2*Math.PI,k=-this.radius*Math.cos(h),h=this.radius*Math.sin(h),d.copy(l),d.x+=k*g.x+h*f.x,d.y+=k*g.y+h*f.y,d.z+=k*g.z+h*f.z,this.grid[b][c]=this.vertices.push(new THREE.Vector3(d.x,d.y,d.z))-1;for(b=0;b<this.segments;b++)for(c=0;c<this.radialSegments;c++)d=this.closed?(b+1)%this.segments:b+1,m=(c+1)%this.radialSegments,a=this.grid[b][c],e=this.grid[d][c],d=this.grid[d][m],m=this.grid[b][m],n=new THREE.Vector2(b/this.segments,c/this.radialSegments),g=new THREE.Vector2((b+1)/this.segments,
c/this.radialSegments),f=new THREE.Vector2((b+1)/this.segments,(c+1)/this.radialSegments),k=new THREE.Vector2(b/this.segments,(c+1)/this.radialSegments),this.faces.push(new THREE.Face3(a,e,m)),this.faceVertexUvs[0].push([n,g,k]),this.faces.push(new THREE.Face3(e,d,m)),this.faceVertexUvs[0].push([g.clone(),f,k.clone()]);this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry.FrenetFrames=function(a,b,c){new THREE.Vector3;var e=new THREE.Vector3;new THREE.Vector3;var d=[],g=[],f=[],h=new THREE.Vector3,k=new THREE.Matrix4;b+=1;var l,m,n;this.tangents=d;this.normals=g;this.binormals=f;for(l=0;l<b;l++)m=l/(b-1),d[l]=a.getTangentAt(m),d[l].normalize();g[0]=new THREE.Vector3;f[0]=new THREE.Vector3;a=Number.MAX_VALUE;l=Math.abs(d[0].x);m=Math.abs(d[0].y);n=Math.abs(d[0].z);l<=a&&(a=l,e.set(1,0,0));m<=a&&(a=m,e.set(0,1,0));n<=a&&e.set(0,0,1);h.crossVectors(d[0],
e).normalize();g[0].crossVectors(d[0],h);f[0].crossVectors(d[0],g[0]);for(l=1;l<b;l++)g[l]=g[l-1].clone(),f[l]=f[l-1].clone(),h.crossVectors(d[l-1],d[l]),1E-4<h.length()&&(h.normalize(),e=Math.acos(THREE.Math.clamp(d[l-1].dot(d[l]),-1,1)),g[l].applyMatrix4(k.makeRotationAxis(h,e))),f[l].crossVectors(d[l],g[l]);if(c)for(e=Math.acos(THREE.Math.clamp(g[0].dot(g[b-1]),-1,1)),e/=b-1,0<d[0].dot(h.crossVectors(g[0],g[b-1]))&&(e=-e),l=1;l<b;l++)g[l].applyMatrix4(k.makeRotationAxis(d[l],e*l)),f[l].crossVectors(d[l],
g[l])};
THREE.ParametricGeometry=function(a,b,c){THREE.Geometry.call(this);var e=this.vertices,d=this.faces,g=this.faceVertexUvs[0],f,h,k,l,m=b+1;for(f=0;f<=c;f++)for(l=f/c,h=0;h<=b;h++)k=h/b,k=a(k,l),e.push(k);var n,r,p,t;for(f=0;f<c;f++)for(h=0;h<b;h++)a=f*m+h,e=f*m+h+1,l=(f+1)*m+h+1,k=(f+1)*m+h,n=new THREE.Vector2(h/b,f/c),r=new THREE.Vector2((h+1)/b,f/c),p=new THREE.Vector2((h+1)/b,(f+1)/c),t=new THREE.Vector2(h/b,(f+1)/c),d.push(new THREE.Face3(a,e,k)),g.push([n,r,t]),d.push(new THREE.Face3(e,l,k)),
g.push([r.clone(),p,t.clone()]);this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.AxisHelper=function(a){a=a||1;var b=new THREE.Geometry;b.vertices.push(new THREE.Vector3,new THREE.Vector3(a,0,0),new THREE.Vector3,new THREE.Vector3(0,a,0),new THREE.Vector3,new THREE.Vector3(0,0,a));b.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));a=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,b,a,THREE.LinePieces)};
THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);
THREE.ArrowHelper=function(a,b,c,e,d,g){THREE.Object3D.call(this);void 0===e&&(e=16776960);void 0===c&&(c=1);void 0===d&&(d=0.2*c);void 0===g&&(g=0.2*d);this.position=b;b=new THREE.Geometry;b.vertices.push(new THREE.Vector3(0,0,0));b.vertices.push(new THREE.Vector3(0,1,0));this.line=new THREE.Line(b,new THREE.LineBasicMaterial({color:e}));this.line.matrixAutoUpdate=!1;this.add(this.line);b=new THREE.CylinderGeometry(0,0.5,1,5,1);b.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0));this.cone=
new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:e}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(c,d,g)};THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(){var a=new THREE.Vector3,b;return function(c){0.99999<c.y?this.quaternion.set(0,0,0,1):-0.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();
THREE.ArrowHelper.prototype.setLength=function(a,b,c){void 0===b&&(b=0.2*a);void 0===c&&(c=0.2*b);this.line.scale.set(1,a,1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};THREE.ArrowHelper.prototype.setColor=function(a){this.line.material.color.setHex(a);this.cone.material.color.setHex(a)};
THREE.BoxHelper=function(a){var b=[new THREE.Vector3(1,1,1),new THREE.Vector3(-1,1,1),new THREE.Vector3(-1,-1,1),new THREE.Vector3(1,-1,1),new THREE.Vector3(1,1,-1),new THREE.Vector3(-1,1,-1),new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,-1,-1)];this.vertices=b;var c=new THREE.Geometry;c.vertices.push(b[0],b[1],b[1],b[2],b[2],b[3],b[3],b[0],b[4],b[5],b[5],b[6],b[6],b[7],b[7],b[4],b[0],b[4],b[1],b[5],b[2],b[6],b[3],b[7]);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces);
void 0!==a&&this.update(a)};THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);
THREE.BoxHelper.prototype.update=function(a){var b=a.geometry;null===b.boundingBox&&b.computeBoundingBox();var c=b.boundingBox.min,b=b.boundingBox.max,e=this.vertices;e[0].set(b.x,b.y,b.z);e[1].set(c.x,b.y,b.z);e[2].set(c.x,c.y,b.z);e[3].set(b.x,c.y,b.z);e[4].set(b.x,b.y,c.z);e[5].set(c.x,b.y,c.z);e[6].set(c.x,c.y,c.z);e[7].set(b.x,c.y,c.z);this.geometry.computeBoundingSphere();this.geometry.verticesNeedUpdate=!0;this.matrixAutoUpdate=!1;this.matrixWorld=a.matrixWorld};
THREE.BoundingBoxHelper=function(a,b){var c=void 0!==b?b:8947848;this.object=a;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:c,wireframe:!0}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};
THREE.CameraHelper=function(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){e.vertices.push(new THREE.Vector3);e.colors.push(new THREE.Color(b));void 0===g[a]&&(g[a]=[]);g[a].push(e.vertices.length-1)}var e=new THREE.Geometry,d=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),g={};b("n1","n2",16755200);b("n2","n4",16755200);b("n4","n3",16755200);b("n3","n1",16755200);b("f1","f2",16755200);b("f2","f4",16755200);b("f4","f3",16755200);b("f3","f1",16755200);b("n1","f1",16755200);
b("n2","f2",16755200);b("n3","f3",16755200);b("n4","f4",16755200);b("p","n1",16711680);b("p","n2",16711680);b("p","n3",16711680);b("p","n4",16711680);b("u1","u2",43775);b("u2","u3",43775);b("u3","u1",43775);b("c","t",16777215);b("p","c",3355443);b("cn1","cn2",3355443);b("cn3","cn4",3355443);b("cf1","cf2",3355443);b("cf3","cf4",3355443);THREE.Line.call(this,e,d,THREE.LinePieces);this.camera=a;this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=g;this.update()};
THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);
THREE.CameraHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Camera,c=new THREE.Projector;return function(){function e(e,f,h,k){a.set(f,h,k);c.unprojectVector(a,b);e=d.pointMap[e];if(void 0!==e)for(f=0,h=e.length;f<h;f++)d.geometry.vertices[e[f]].copy(a)}var d=this;b.projectionMatrix.copy(this.camera.projectionMatrix);e("c",0,0,-1);e("t",0,0,1);e("n1",-1,-1,-1);e("n2",1,-1,-1);e("n3",-1,1,-1);e("n4",1,1,-1);e("f1",-1,-1,1);e("f2",1,-1,1);e("f3",-1,1,1);e("f4",1,1,1);e("u1",0.7,
1.1,-1);e("u2",-0.7,1.1,-1);e("u3",0,2,-1);e("cf1",-1,0,1);e("cf2",1,0,1);e("cf3",0,-1,1);e("cf4",0,1,1);e("cn1",-1,0,-1);e("cn2",1,0,-1);e("cn3",0,-1,-1);e("cn4",0,1,-1);this.geometry.verticesNeedUpdate=!0}}();
THREE.DirectionalLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;b=b||1;var c=new THREE.PlaneGeometry(b,b),e=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});e.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Mesh(c,e);this.add(this.lightPlane);c=new THREE.Geometry;c.vertices.push(new THREE.Vector3);c.vertices.push(new THREE.Vector3);e=new THREE.LineBasicMaterial({fog:!1});
e.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(c,e);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};
THREE.DirectionalLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(){a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);c.subVectors(b,a);this.lightPlane.lookAt(c);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(c);this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();
THREE.EdgesHelper=function(a,b){var c=void 0!==b?b:16777215,e=[0,0],d={},g=function(a,b){return a-b},f=["a","b","c"],h=new THREE.BufferGeometry,k=a.geometry.clone();k.mergeVertices();k.computeFaceNormals();for(var l=k.vertices,k=k.faces,m=0,n=0,r=k.length;n<r;n++)for(var p=k[n],t=0;3>t;t++){e[0]=p[f[t]];e[1]=p[f[(t+1)%3]];e.sort(g);var s=e.toString();void 0===d[s]?(d[s]={vert1:e[0],vert2:e[1],face1:n,face2:void 0},m++):d[s].face2=n}h.addAttribute("position",Float32Array,2*m,3);e=h.attributes.position.array;
g=0;for(s in d)if(f=d[s],void 0===f.face2||0.9999>k[f.face1].normal.dot(k[f.face2].normal))m=l[f.vert1],e[g++]=m.x,e[g++]=m.y,e[g++]=m.z,m=l[f.vert2],e[g++]=m.x,e[g++]=m.y,e[g++]=m.z;THREE.Line.call(this,h,new THREE.LineBasicMaterial({color:c}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.matrixWorld=a.matrixWorld};THREE.EdgesHelper.prototype=Object.create(THREE.Line.prototype);
THREE.FaceNormalsHelper=function(a,b,c,e){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;e=void 0!==e?e:1;b=new THREE.Geometry;c=0;for(var d=this.object.geometry.faces.length;c<d;c++)b.vertices.push(new THREE.Vector3),b.vertices.push(new THREE.Vector3);THREE.Line.call(this,b,new THREE.LineBasicMaterial({color:a,linewidth:e}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.FaceNormalsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);a=this.geometry.vertices;for(var e=this.object.geometry.faces,d=this.object.matrixWorld,g=0,f=e.length;g<f;g++){var h=e[g];b.copy(h.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);var k=2*g;a[k].copy(h.centroid).applyMatrix4(d);a[k+1].addVectors(a[k],b)}this.geometry.verticesNeedUpdate=
!0;return this}}();THREE.GridHelper=function(a,b){var c=new THREE.Geometry,e=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var d=-a;d<=a;d+=b){c.vertices.push(new THREE.Vector3(-a,0,d),new THREE.Vector3(a,0,d),new THREE.Vector3(d,0,-a),new THREE.Vector3(d,0,a));var g=0===d?this.color1:this.color2;c.colors.push(g,g,g,g)}THREE.Line.call(this,c,e,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);
THREE.GridHelper.prototype.setColors=function(a,b){this.color1.set(a);this.color2.set(b);this.geometry.colorsNeedUpdate=!0};
THREE.HemisphereLightHelper=function(a,b,c,e){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;this.colors=[new THREE.Color,new THREE.Color];a=new THREE.SphereGeometry(b,4,2);a.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(b=0;8>b;b++)a.faces[b].color=this.colors[4>b?0:1];b=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(a,b);this.add(this.lightSphere);
this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};
THREE.HemisphereLightHelper.prototype.update=function(){var a=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=!0}}();
THREE.PointLightHelper=function(a,b){this.light=a;this.light.updateMatrixWorld();var c=new THREE.SphereGeometry(b,4,2),e=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});e.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,c,e);this.matrixWorld=this.light.matrixWorld;this.matrixAutoUpdate=!1};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};
THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.SpotLightHelper=function(a){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=!1;a=new THREE.CylinderGeometry(0,1,1,8,1,!0);a.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0));a.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var b=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(a,b);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};THREE.SpotLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){var c=this.light.distance?this.light.distance:1E4,e=c*Math.tan(this.light.angle);this.cone.scale.set(e,e,c);a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(b.sub(a));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();
THREE.VertexNormalsHelper=function(a,b,c,e){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:16711680;e=void 0!==e?e:1;c=new THREE.Geometry;a=a.geometry.faces;for(var d=0,g=a.length;d<g;d++)for(var f=0,h=a[d].vertexNormals.length;f<h;f++)c.vertices.push(new THREE.Vector3),c.vertices.push(new THREE.Vector3);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:b,linewidth:e}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.normalMatrix=new THREE.Matrix3;this.update()};
THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexNormalsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var e=this.geometry.vertices,d=this.object.geometry.vertices,g=this.object.geometry.faces,f=this.object.matrixWorld,h=0,k=0,l=g.length;k<l;k++)for(var m=g[k],n=0,r=m.vertexNormals.length;n<r;n++){var p=m.vertexNormals[n];e[h].copy(d[m[a[n]]]).applyMatrix4(f);b.copy(p).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);
b.add(e[h]);h+=1;e[h].copy(b);h+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.VertexTangentsHelper=function(a,b,c,e){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:255;e=void 0!==e?e:1;c=new THREE.Geometry;a=a.geometry.faces;for(var d=0,g=a.length;d<g;d++)for(var f=0,h=a[d].vertexTangents.length;f<h;f++)c.vertices.push(new THREE.Vector3),c.vertices.push(new THREE.Vector3);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:b,linewidth:e}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.update()};THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype);
THREE.VertexTangentsHelper.prototype.update=function(a){var b=new THREE.Vector3;return function(a){a=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var e=this.geometry.vertices,d=this.object.geometry.vertices,g=this.object.geometry.faces,f=this.object.matrixWorld,h=0,k=0,l=g.length;k<l;k++)for(var m=g[k],n=0,r=m.vertexTangents.length;n<r;n++){var p=m.vertexTangents[n];e[h].copy(d[m[a[n]]]).applyMatrix4(f);b.copy(p).transformDirection(f).multiplyScalar(this.size);b.add(e[h]);h+=1;e[h].copy(b);
h+=1}this.geometry.verticesNeedUpdate=!0;return this}}();
THREE.WireframeHelper=function(a,b){var c=void 0!==b?b:16777215,e=[0,0],d={},g=function(a,b){return a-b},f=["a","b","c"],h=new THREE.BufferGeometry;if(a.geometry instanceof THREE.Geometry){for(var k=a.geometry.vertices,l=a.geometry.faces,m=0,n=new Uint32Array(6*l.length),r=0,p=l.length;r<p;r++)for(var t=l[r],s=0;3>s;s++){e[0]=t[f[s]];e[1]=t[f[(s+1)%3]];e.sort(g);var u=e.toString();void 0===d[u]&&(n[2*m]=e[0],n[2*m+1]=e[1],d[u]=!0,m++)}h.addAttribute("position",Float32Array,2*m,3);e=h.attributes.position.array;
r=0;for(p=m;r<p;r++)for(s=0;2>s;s++)m=k[n[2*r+s]],f=6*r+3*s,e[f+0]=m.x,e[f+1]=m.y,e[f+2]=m.z}else if(a.geometry instanceof THREE.BufferGeometry&&void 0!==a.geometry.attributes.index){for(var k=a.geometry.attributes.position.array,p=a.geometry.attributes.index.array,l=a.geometry.offsets,m=0,n=new Uint32Array(2*p.length),t=0,v=l.length;t<v;++t)for(var s=l[t].start,u=l[t].count,f=l[t].index,r=s,w=s+u;r<w;r+=3)for(s=0;3>s;s++)e[0]=f+p[r+s],e[1]=f+p[r+(s+1)%3],e.sort(g),u=e.toString(),void 0===d[u]&&(n[2*
m]=e[0],n[2*m+1]=e[1],d[u]=!0,m++);h.addAttribute("position",Float32Array,2*m,3);e=h.attributes.position.array;r=0;for(p=m;r<p;r++)for(s=0;2>s;s++)f=6*r+3*s,m=3*n[2*r+s],e[f+0]=k[m],e[f+1]=k[m+1],e[f+2]=k[m+2]}else if(a.geometry instanceof THREE.BufferGeometry)for(k=a.geometry.attributes.position.array,m=k.length/3,n=m/3,h.addAttribute("position",Float32Array,2*m,3),e=h.attributes.position.array,r=0,p=n;r<p;r++)for(s=0;3>s;s++)f=18*r+6*s,n=9*r+3*s,e[f+0]=k[n],e[f+1]=k[n+1],e[f+2]=k[n+2],m=9*r+(s+
1)%3*3,e[f+3]=k[m],e[f+4]=k[m+1],e[f+5]=k[m+2];THREE.Line.call(this,h,new THREE.LineBasicMaterial({color:c}),THREE.LinePieces);this.matrixAutoUpdate=!1;this.matrixWorld=a.matrixWorld};THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype);
THREE.ShadowMapPlugin=function(){var a,b,c,e,d,g,f=new THREE.Frustum,h=new THREE.Matrix4,k=new THREE.Vector3,l=new THREE.Vector3,m=new THREE.Vector3;this.init=function(f){a=f.context;b=f;f=THREE.ShaderLib.depthRGBA;var h=THREE.UniformsUtils.clone(f.uniforms);c=new THREE.ShaderMaterial({fragmentShader:f.fragmentShader,vertexShader:f.vertexShader,uniforms:h});e=new THREE.ShaderMaterial({fragmentShader:f.fragmentShader,vertexShader:f.vertexShader,uniforms:h,morphTargets:!0});d=new THREE.ShaderMaterial({fragmentShader:f.fragmentShader,
vertexShader:f.vertexShader,uniforms:h,skinning:!0});g=new THREE.ShaderMaterial({fragmentShader:f.fragmentShader,vertexShader:f.vertexShader,uniforms:h,morphTargets:!0,skinning:!0});c._shadowPass=!0;e._shadowPass=!0;d._shadowPass=!0;g._shadowPass=!0};this.render=function(a,f){b.shadowMapEnabled&&b.shadowMapAutoUpdate&&this.update(a,f)};this.update=function(n,r){var p,t,s,u,v,w,z,x,y,C=[];u=0;a.clearColor(1,1,1,1);a.disable(a.BLEND);a.enable(a.CULL_FACE);a.frontFace(a.CCW);b.shadowMapCullFace===THREE.CullFaceFront?
a.cullFace(a.FRONT):a.cullFace(a.BACK);b.setDepthTest(!0);p=0;for(t=n.__lights.length;p<t;p++)if(s=n.__lights[p],s.castShadow)if(s instanceof THREE.DirectionalLight&&s.shadowCascade)for(v=0;v<s.shadowCascadeCount;v++){var B;if(s.shadowCascadeArray[v])B=s.shadowCascadeArray[v];else{y=s;z=v;B=new THREE.DirectionalLight;B.isVirtual=!0;B.onlyShadow=!0;B.castShadow=!0;B.shadowCameraNear=y.shadowCameraNear;B.shadowCameraFar=y.shadowCameraFar;B.shadowCameraLeft=y.shadowCameraLeft;B.shadowCameraRight=y.shadowCameraRight;
B.shadowCameraBottom=y.shadowCameraBottom;B.shadowCameraTop=y.shadowCameraTop;B.shadowCameraVisible=y.shadowCameraVisible;B.shadowDarkness=y.shadowDarkness;B.shadowBias=y.shadowCascadeBias[z];B.shadowMapWidth=y.shadowCascadeWidth[z];B.shadowMapHeight=y.shadowCascadeHeight[z];B.pointsWorld=[];B.pointsFrustum=[];x=B.pointsWorld;w=B.pointsFrustum;for(var D=0;8>D;D++)x[D]=new THREE.Vector3,w[D]=new THREE.Vector3;x=y.shadowCascadeNearZ[z];y=y.shadowCascadeFarZ[z];w[0].set(-1,-1,x);w[1].set(1,-1,x);w[2].set(-1,
1,x);w[3].set(1,1,x);w[4].set(-1,-1,y);w[5].set(1,-1,y);w[6].set(-1,1,y);w[7].set(1,1,y);B.originalCamera=r;w=new THREE.Gyroscope;w.position=s.shadowCascadeOffset;w.add(B);w.add(B.target);r.add(w);s.shadowCascadeArray[v]=B;console.log("Created virtualLight",B)}z=s;x=v;y=z.shadowCascadeArray[x];y.position.copy(z.position);y.target.position.copy(z.target.position);y.lookAt(y.target);y.shadowCameraVisible=z.shadowCameraVisible;y.shadowDarkness=z.shadowDarkness;y.shadowBias=z.shadowCascadeBias[x];w=z.shadowCascadeNearZ[x];
z=z.shadowCascadeFarZ[x];y=y.pointsFrustum;y[0].z=w;y[1].z=w;y[2].z=w;y[3].z=w;y[4].z=z;y[5].z=z;y[6].z=z;y[7].z=z;C[u]=B;u++}else C[u]=s,u++;p=0;for(t=C.length;p<t;p++){s=C[p];s.shadowMap||(v=THREE.LinearFilter,b.shadowMapType===THREE.PCFSoftShadowMap&&(v=THREE.NearestFilter),s.shadowMap=new THREE.WebGLRenderTarget(s.shadowMapWidth,s.shadowMapHeight,{minFilter:v,magFilter:v,format:THREE.RGBAFormat}),s.shadowMapSize=new THREE.Vector2(s.shadowMapWidth,s.shadowMapHeight),s.shadowMatrix=new THREE.Matrix4);
if(!s.shadowCamera){if(s instanceof THREE.SpotLight)s.shadowCamera=new THREE.PerspectiveCamera(s.shadowCameraFov,s.shadowMapWidth/s.shadowMapHeight,s.shadowCameraNear,s.shadowCameraFar);else if(s instanceof THREE.DirectionalLight)s.shadowCamera=new THREE.OrthographicCamera(s.shadowCameraLeft,s.shadowCameraRight,s.shadowCameraTop,s.shadowCameraBottom,s.shadowCameraNear,s.shadowCameraFar);else{console.error("Unsupported light type for shadow");continue}n.add(s.shadowCamera);!0===n.autoUpdate&&n.updateMatrixWorld()}s.shadowCameraVisible&&
!s.cameraHelper&&(s.cameraHelper=new THREE.CameraHelper(s.shadowCamera),s.shadowCamera.add(s.cameraHelper));if(s.isVirtual&&B.originalCamera==r){v=r;u=s.shadowCamera;w=s.pointsFrustum;y=s.pointsWorld;k.set(Infinity,Infinity,Infinity);l.set(-Infinity,-Infinity,-Infinity);for(z=0;8>z;z++)x=y[z],x.copy(w[z]),THREE.ShadowMapPlugin.__projector.unprojectVector(x,v),x.applyMatrix4(u.matrixWorldInverse),x.x<k.x&&(k.x=x.x),x.x>l.x&&(l.x=x.x),x.y<k.y&&(k.y=x.y),x.y>l.y&&(l.y=x.y),x.z<k.z&&(k.z=x.z),x.z>l.z&&
(l.z=x.z);u.left=k.x;u.right=l.x;u.top=l.y;u.bottom=k.y;u.updateProjectionMatrix()}u=s.shadowMap;w=s.shadowMatrix;v=s.shadowCamera;v.position.setFromMatrixPosition(s.matrixWorld);m.setFromMatrixPosition(s.target.matrixWorld);v.lookAt(m);v.updateMatrixWorld();v.matrixWorldInverse.getInverse(v.matrixWorld);s.cameraHelper&&(s.cameraHelper.visible=s.shadowCameraVisible);s.shadowCameraVisible&&s.cameraHelper.update();w.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);w.multiply(v.projectionMatrix);w.multiply(v.matrixWorldInverse);
h.multiplyMatrices(v.projectionMatrix,v.matrixWorldInverse);f.setFromMatrix(h);b.setRenderTarget(u);b.clear();y=n.__webglObjects;s=0;for(u=y.length;s<u;s++)z=y[s],w=z.object,z.render=!1,!w.visible||!w.castShadow||(w instanceof THREE.Mesh||w instanceof THREE.ParticleSystem)&&w.frustumCulled&&!f.intersectsObject(w)||(w._modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,w.matrixWorld),z.render=!0);s=0;for(u=y.length;s<u;s++)z=y[s],z.render&&(w=z.object,z=z.buffer,D=w.material instanceof THREE.MeshFaceMaterial?
w.material.materials[0]:w.material,x=void 0!==w.geometry.morphTargets&&0<w.geometry.morphTargets.length&&D.morphTargets,D=w instanceof THREE.SkinnedMesh&&D.skinning,x=w.customDepthMaterial?w.customDepthMaterial:D?x?g:d:x?e:c,z instanceof THREE.BufferGeometry?b.renderBufferDirect(v,n.__lights,null,x,z,w):b.renderBuffer(v,n.__lights,null,x,z,w));y=n.__webglObjectsImmediate;s=0;for(u=y.length;s<u;s++)z=y[s],w=z.object,w.visible&&w.castShadow&&(w._modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,
w.matrixWorld),b.renderImmediateObject(v,n.__lights,null,c,w))}p=b.getClearColor();t=b.getClearAlpha();a.clearColor(p.r,p.g,p.b,t);a.enable(a.BLEND);b.shadowMapCullFace===THREE.CullFaceFront&&a.cullFace(a.BACK)}};THREE.ShadowMapPlugin.__projector=new THREE.Projector;
THREE.DepthPassPlugin=function(){this.enabled=!1;this.renderTarget=null;var a,b,c,e,d,g,f=new THREE.Frustum,h=new THREE.Matrix4;this.init=function(f){a=f.context;b=f;f=THREE.ShaderLib.depthRGBA;var h=THREE.UniformsUtils.clone(f.uniforms);c=new THREE.ShaderMaterial({fragmentShader:f.fragmentShader,vertexShader:f.vertexShader,uniforms:h});e=new THREE.ShaderMaterial({fragmentShader:f.fragmentShader,vertexShader:f.vertexShader,uniforms:h,morphTargets:!0});d=new THREE.ShaderMaterial({fragmentShader:f.fragmentShader,
vertexShader:f.vertexShader,uniforms:h,skinning:!0});g=new THREE.ShaderMaterial({fragmentShader:f.fragmentShader,vertexShader:f.vertexShader,uniforms:h,morphTargets:!0,skinning:!0});c._shadowPass=!0;e._shadowPass=!0;d._shadowPass=!0;g._shadowPass=!0};this.render=function(a,b){this.enabled&&this.update(a,b)};this.update=function(k,l){var m,n,r,p,t,s;a.clearColor(1,1,1,1);a.disable(a.BLEND);b.setDepthTest(!0);!0===k.autoUpdate&&k.updateMatrixWorld();l.matrixWorldInverse.getInverse(l.matrixWorld);h.multiplyMatrices(l.projectionMatrix,
l.matrixWorldInverse);f.setFromMatrix(h);b.setRenderTarget(this.renderTarget);b.clear();s=k.__webglObjects;m=0;for(n=s.length;m<n;m++)r=s[m],t=r.object,r.render=!1,!t.visible||(t instanceof THREE.Mesh||t instanceof THREE.ParticleSystem)&&t.frustumCulled&&!f.intersectsObject(t)||(t._modelViewMatrix.multiplyMatrices(l.matrixWorldInverse,t.matrixWorld),r.render=!0);var u;m=0;for(n=s.length;m<n;m++)r=s[m],r.render&&(t=r.object,r=r.buffer,t instanceof THREE.ParticleSystem&&!t.customDepthMaterial||((u=
t.material instanceof THREE.MeshFaceMaterial?t.material.materials[0]:t.material)&&b.setMaterialFaces(t.material),p=0<t.geometry.morphTargets.length&&u.morphTargets,u=t instanceof THREE.SkinnedMesh&&u.skinning,p=t.customDepthMaterial?t.customDepthMaterial:u?p?g:d:p?e:c,r instanceof THREE.BufferGeometry?b.renderBufferDirect(l,k.__lights,null,p,r,t):b.renderBuffer(l,k.__lights,null,p,r,t)));s=k.__webglObjectsImmediate;m=0;for(n=s.length;m<n;m++)r=s[m],t=r.object,t.visible&&(t._modelViewMatrix.multiplyMatrices(l.matrixWorldInverse,
t.matrixWorld),b.renderImmediateObject(l,k.__lights,null,c,t));m=b.getClearColor();n=b.getClearAlpha();a.clearColor(m.r,m.g,m.b,n);a.enable(a.BLEND)}};/*
 zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */
(function(){function a(a){throw a;}function b(a,b){var f=a.split("."),c=s;f[0]in c||!c.execScript||c.execScript("var "+f[0]);for(var d;f.length&&(d=f.shift());)f.length||b===p?c=c[d]?c[d]:c[d]={}:c[d]=b}function c(a){var b=a.length,f=0,c=Number.POSITIVE_INFINITY,d,h,e,k,g,l,m,n,r;for(n=0;n<b;++n)a[n]>f&&(f=a[n]),a[n]<c&&(c=a[n]);d=1<<f;h=new (u?Uint32Array:Array)(d);e=1;k=0;for(g=2;e<=f;){for(n=0;n<b;++n)if(a[n]===e){l=0;m=k;for(r=0;r<e;++r)l=l<<1|m&1,m>>=1;for(r=l;r<d;r+=g)h[r]=e<<16|n;++k}++e;k<<=
1;g<<=1}return[h,f,c]}function e(b,f){this.l=[];this.m=32768;this.d=this.f=this.c=this.t=0;this.input=u?new Uint8Array(b):b;this.u=!1;this.n=y;this.K=!1;if(f||!(f={}))f.index&&(this.c=f.index),f.bufferSize&&(this.m=f.bufferSize),f.bufferType&&(this.n=f.bufferType),f.resize&&(this.K=f.resize);switch(this.n){case x:this.a=32768;this.b=new (u?Uint8Array:Array)(32768+this.m+258);break;case y:this.a=0;this.b=new (u?Uint8Array:Array)(this.m);this.e=this.W;this.B=this.R;this.q=this.V;break;default:a(Error("invalid inflate mode"))}}
function d(b,f){for(var c=b.f,d=b.d,h=b.input,e=b.c,k;d<f;)k=h[e++],k===p&&a(Error("input buffer is broken")),c|=k<<d,d+=8;b.f=c>>>f;b.d=d-f;b.c=e;return c&(1<<f)-1}function g(a,b){for(var f=a.f,c=a.d,d=a.input,h=a.c,e=b[0],k=b[1],g;c<k;){g=d[h++];if(g===p)break;f|=g<<c;c+=8}d=e[f&(1<<k)-1];e=d>>>16;a.f=f>>e;a.d=c-e;a.c=h;return d&65535}function f(a){function b(a,f,c){var h,e,k,l;for(l=0;l<a;)switch(h=g(this,f),h){case 16:for(k=3+d(this,2);k--;)c[l++]=e;break;case 17:for(k=3+d(this,3);k--;)c[l++]=
0;e=0;break;case 18:for(k=11+d(this,7);k--;)c[l++]=0;e=0;break;default:e=c[l++]=h}return c}var f=d(a,5)+257,h=d(a,5)+1,e=d(a,4)+4,k=new (u?Uint8Array:Array)(C.length),l;for(l=0;l<e;++l)k[C[l]]=d(a,3);e=c(k);k=new (u?Uint8Array:Array)(f);l=new (u?Uint8Array:Array)(h);a.q(c(b.call(a,f,e,k)),c(b.call(a,h,e,l)))}function h(a){a=a||{};this.files=[];this.v=a.comment}function k(a,b){b=b||{};this.input=u&&a instanceof Array?new Uint8Array(a):a;this.c=0;this.ba=b.verify||!1;this.j=b.password}function l(a,
b){this.input=a;this.offset=b}function m(a,b){this.input=a;this.offset=b}function n(b){var f=[],c={},d,h,e,k;if(!b.i){if(b.o===p){d=b.input;if(!b.D)a:{h=b.input;for(e=h.length-12;0<e;--e)if(h[e]===T[0]&&h[e+1]===T[1]&&h[e+2]===T[2]&&h[e+3]===T[3]){b.D=e;break a}a(Error("End of Central Directory Record not found"))}h=b.D;d[h++]===T[0]&&d[h++]===T[1]&&d[h++]===T[2]&&d[h++]===T[3]||a(Error("invalid signature"));b.ha=d[h++]|d[h++]<<8;b.ja=d[h++]|d[h++]<<8;b.ka=d[h++]|d[h++]<<8;b.aa=d[h++]|d[h++]<<8;b.Q=
(d[h++]|d[h++]<<8|d[h++]<<16|d[h++]<<24)>>>0;b.o=(d[h++]|d[h++]<<8|d[h++]<<16|d[h++]<<24)>>>0;b.w=d[h++]|d[h++]<<8;b.v=u?d.subarray(h,h+b.w):d.slice(h,h+b.w)}d=b.o;e=0;for(k=b.aa;e<k;++e)h=new l(b.input,d),h.parse(),d+=h.length,f[e]=h,c[h.filename]=e;b.Q<d-b.o&&a(Error("invalid file header size"));b.i=f;b.G=c}}function r(a,b,f){f^=a.s(b);a.k(b,f);return f}var p=void 0,t,s=this,u="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;new (u?Uint8Array:Array)(256);
for(t=0;256>t;++t)for(var v=t,w=7,v=v>>>1;v;v>>>=1)--w;t=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,
3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,
314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,
3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,
1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,
1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];var z=u?new Uint32Array(t):t;t=[];for(v=0;288>v;v++)switch(!0){case 143>=v:t.push([v+48,8]);break;case 255>=v:t.push([v-144+400,9]);break;case 279>=v:t.push([v-256+0,7]);break;case 287>=v:t.push([v-280+192,8]);break;default:a("invalid literal: "+
v)}t=function(){function b(f){switch(!0){case 3===f:return[257,f-3,0];case 4===f:return[258,f-4,0];case 5===f:return[259,f-5,0];case 6===f:return[260,f-6,0];case 7===f:return[261,f-7,0];case 8===f:return[262,f-8,0];case 9===f:return[263,f-9,0];case 10===f:return[264,f-10,0];case 12>=f:return[265,f-11,1];case 14>=f:return[266,f-13,1];case 16>=f:return[267,f-15,1];case 18>=f:return[268,f-17,1];case 22>=f:return[269,f-19,2];case 26>=f:return[270,f-23,2];case 30>=f:return[271,f-27,2];case 34>=f:return[272,
f-31,2];case 42>=f:return[273,f-35,3];case 50>=f:return[274,f-43,3];case 58>=f:return[275,f-51,3];case 66>=f:return[276,f-59,3];case 82>=f:return[277,f-67,4];case 98>=f:return[278,f-83,4];case 114>=f:return[279,f-99,4];case 130>=f:return[280,f-115,4];case 162>=f:return[281,f-131,5];case 194>=f:return[282,f-163,5];case 226>=f:return[283,f-195,5];case 257>=f:return[284,f-227,5];case 258===f:return[285,f-258,0];default:a("invalid length: "+f)}}var f=[],d,c;for(d=3;258>=d;d++)c=b(d),f[d]=c[2]<<24|c[1]<<
16|c[0];return f}();u&&new Uint32Array(t);var x=0,y=1;e.prototype.r=function(){for(;!this.u;){var b=d(this,3);b&1&&(this.u=!0);b>>>=1;switch(b){case 0:var b=this.input,c=this.c,h=this.b,e=this.a,k=p,g=p,l=p,m=h.length,k=p;this.d=this.f=0;k=b[c++];k===p&&a(Error("invalid uncompressed block header: LEN (first byte)"));g=k;k=b[c++];k===p&&a(Error("invalid uncompressed block header: LEN (second byte)"));g|=k<<8;k=b[c++];k===p&&a(Error("invalid uncompressed block header: NLEN (first byte)"));l=k;k=b[c++];
k===p&&a(Error("invalid uncompressed block header: NLEN (second byte)"));l|=k<<8;g===~l&&a(Error("invalid uncompressed block header: length verify"));c+g>b.length&&a(Error("input buffer is broken"));switch(this.n){case x:for(;e+g>h.length;){k=m-e;g-=k;if(u)h.set(b.subarray(c,c+k),e),e+=k,c+=k;else for(;k--;)h[e++]=b[c++];this.a=e;h=this.e();e=this.a}break;case y:for(;e+g>h.length;)h=this.e({H:2});break;default:a(Error("invalid inflate mode"))}if(u)h.set(b.subarray(c,c+g),e),e+=g,c+=g;else for(;g--;)h[e++]=
b[c++];this.c=c;this.a=e;this.b=h;break;case 1:this.q(H,I);break;case 2:f(this);break;default:a(Error("unknown BTYPE: "+b))}}return this.B()};t=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var C=u?new Uint16Array(t):t;t=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];var B=u?new Uint16Array(t):t;t=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];var D=u?new Uint8Array(t):t;t=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,
769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var F=u?new Uint16Array(t):t;t=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var O=u?new Uint8Array(t):t;t=new (u?Uint8Array:Array)(288);v=0;for(w=t.length;v<w;++v)t[v]=143>=v?8:255>=v?9:279>=v?7:8;var H=c(t);t=new (u?Uint8Array:Array)(30);v=0;for(w=t.length;v<w;++v)t[v]=5;var I=c(t);t=e.prototype;t.q=function(a,b){var f=this.b,c=this.a;this.C=a;for(var h=f.length-258,e,k,l;256!==(e=g(this,a));)if(256>e)c>=h&&(this.a=
c,f=this.e(),c=this.a),f[c++]=e;else for(e-=257,l=B[e],0<D[e]&&(l+=d(this,D[e])),e=g(this,b),k=F[e],0<O[e]&&(k+=d(this,O[e])),c>=h&&(this.a=c,f=this.e(),c=this.a);l--;)f[c]=f[c++-k];for(;8<=this.d;)this.d-=8,this.c--;this.a=c};t.V=function(a,b){var f=this.b,c=this.a;this.C=a;for(var h=f.length,e,k,l;256!==(e=g(this,a));)if(256>e)c>=h&&(f=this.e(),h=f.length),f[c++]=e;else for(e-=257,l=B[e],0<D[e]&&(l+=d(this,D[e])),e=g(this,b),k=F[e],0<O[e]&&(k+=d(this,O[e])),c+l>h&&(f=this.e(),h=f.length);l--;)f[c]=
f[c++-k];for(;8<=this.d;)this.d-=8,this.c--;this.a=c};t.e=function(){var a=new (u?Uint8Array:Array)(this.a-32768),b=this.a-32768,f,c,d=this.b;if(u)a.set(d.subarray(32768,a.length));else for(f=0,c=a.length;f<c;++f)a[f]=d[f+32768];this.l.push(a);this.t+=a.length;if(u)d.set(d.subarray(b,b+32768));else for(f=0;32768>f;++f)d[f]=d[b+f];this.a=32768;return d};t.W=function(a){var b,f=this.input.length/this.c+1|0,c,d,h,e=this.input,k=this.b;a&&("number"===typeof a.H&&(f=a.H),"number"===typeof a.P&&(f+=a.P));
2>f?(c=(e.length-this.c)/this.C[2],h=c/2*258|0,d=h<k.length?k.length+h:k.length<<1):d=k.length*f;u?(b=new Uint8Array(d),b.set(k)):b=k;return this.b=b};t.B=function(){var a=0,b=this.b,f=this.l,c,d=new (u?Uint8Array:Array)(this.t+(this.a-32768)),h,e,k,g;if(0===f.length)return u?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);h=0;for(e=f.length;h<e;++h)for(c=f[h],k=0,g=c.length;k<g;++k)d[a++]=c[k];h=32768;for(e=this.a;h<e;++h)d[a++]=b[h];this.l=[];return this.buffer=d};t.R=function(){var a,
b=this.a;u?this.K?(a=new Uint8Array(b),a.set(this.b.subarray(0,b))):a=this.b.subarray(0,b):(this.b.length>b&&(this.b.length=b),a=this.b);return this.buffer=a};h.prototype.L=function(a){this.j=a};h.prototype.s=function(a){a=a[2]&65535|2;return a*(a^1)>>8&255};h.prototype.k=function(a,b){a[0]=(z[(a[0]^b)&255]^a[0]>>>8)>>>0;a[1]=(6681*(20173*(a[1]+(a[0]&255))>>>0)>>>0)+1>>>0;a[2]=(z[(a[2]^a[1]>>>24)&255]^a[2]>>>8)>>>0};h.prototype.T=function(a){var b=[305419896,591751049,878082192],f,c;u&&(b=new Uint32Array(b));
f=0;for(c=a.length;f<c;++f)this.k(b,a[f]&255);return b};var E=[80,75,1,2],P=[80,75,3,4],T=[80,75,5,6];l.prototype.parse=function(){var b=this.input,f=this.offset;b[f++]===E[0]&&b[f++]===E[1]&&b[f++]===E[2]&&b[f++]===E[3]||a(Error("invalid file header signature"));this.version=b[f++];this.ia=b[f++];this.Z=b[f++]|b[f++]<<8;this.I=b[f++]|b[f++]<<8;this.A=b[f++]|b[f++]<<8;this.time=b[f++]|b[f++]<<8;this.U=b[f++]|b[f++]<<8;this.p=(b[f++]|b[f++]<<8|b[f++]<<16|b[f++]<<24)>>>0;this.z=(b[f++]|b[f++]<<8|b[f++]<<
16|b[f++]<<24)>>>0;this.J=(b[f++]|b[f++]<<8|b[f++]<<16|b[f++]<<24)>>>0;this.h=b[f++]|b[f++]<<8;this.g=b[f++]|b[f++]<<8;this.F=b[f++]|b[f++]<<8;this.ea=b[f++]|b[f++]<<8;this.ga=b[f++]|b[f++]<<8;this.fa=b[f++]|b[f++]<<8|b[f++]<<16|b[f++]<<24;this.$=(b[f++]|b[f++]<<8|b[f++]<<16|b[f++]<<24)>>>0;this.filename=String.fromCharCode.apply(null,u?b.subarray(f,f+=this.h):b.slice(f,f+=this.h));this.X=u?b.subarray(f,f+=this.g):b.slice(f,f+=this.g);this.v=u?b.subarray(f,f+this.F):b.slice(f,f+this.F);this.length=
f-this.offset};m.prototype.parse=function(){var b=this.input,f=this.offset;b[f++]===P[0]&&b[f++]===P[1]&&b[f++]===P[2]&&b[f++]===P[3]||a(Error("invalid local file header signature"));this.Z=b[f++]|b[f++]<<8;this.I=b[f++]|b[f++]<<8;this.A=b[f++]|b[f++]<<8;this.time=b[f++]|b[f++]<<8;this.U=b[f++]|b[f++]<<8;this.p=(b[f++]|b[f++]<<8|b[f++]<<16|b[f++]<<24)>>>0;this.z=(b[f++]|b[f++]<<8|b[f++]<<16|b[f++]<<24)>>>0;this.J=(b[f++]|b[f++]<<8|b[f++]<<16|b[f++]<<24)>>>0;this.h=b[f++]|b[f++]<<8;this.g=b[f++]|b[f++]<<
8;this.filename=String.fromCharCode.apply(null,u?b.subarray(f,f+=this.h):b.slice(f,f+=this.h));this.X=u?b.subarray(f,f+=this.g):b.slice(f,f+=this.g);this.length=f-this.offset};t=k.prototype;t.Y=function(){var a=[],b,f,c;this.i||n(this);c=this.i;b=0;for(f=c.length;b<f;++b)a[b]=c[b].filename;return a};t.r=function(b,f){var c;this.G||n(this);c=this.G[b];c===p&&a(Error(b+" not found"));var d;d=f||{};var h=this.input,k=this.i,g,l,s,t;k||n(this);k[c]===p&&a(Error("wrong index"));k=k[c].$;c=new m(this.input,
k);c.parse();k+=c.length;g=c.z;if(0!==(c.I&1)){d.password||this.j||a(Error("please set password"));d=this.S(d.password||this.j);s=k;for(t=k+12;s<t;++s)r(this,d,h[s]);k+=12;g-=12;s=k;for(t=k+g;s<t;++s)h[s]=r(this,d,h[s])}switch(c.A){case 0:l=u?this.input.subarray(k,k+g):this.input.slice(k,k+g);break;case 8:l=(new e(this.input,{index:k,bufferSize:c.J})).r();break;default:a(Error("unknown compression type"))}if(this.ba){h=p;g="number"===typeof h?h:h=0;d=l.length;k=-1;for(g=d&7;g--;++h)k=k>>>8^z[(k^l[h])&
255];for(g=d>>3;g--;h+=8)k=k>>>8^z[(k^l[h])&255],k=k>>>8^z[(k^l[h+1])&255],k=k>>>8^z[(k^l[h+2])&255],k=k>>>8^z[(k^l[h+3])&255],k=k>>>8^z[(k^l[h+4])&255],k=k>>>8^z[(k^l[h+5])&255],k=k>>>8^z[(k^l[h+6])&255],k=k>>>8^z[(k^l[h+7])&255];h=(k^4294967295)>>>0;c.p!==h&&a(Error("wrong crc: file=0x"+c.p.toString(16)+", data=0x"+h.toString(16)))}return l};t.L=function(a){this.j=a};t.k=h.prototype.k;t.S=h.prototype.T;t.s=h.prototype.s;b("Zlib.Unzip",k);b("Zlib.Unzip.prototype.decompress",k.prototype.r);b("Zlib.Unzip.prototype.getFilenames",
k.prototype.Y);b("Zlib.Unzip.prototype.setPassword",k.prototype.L)}).call(this);/*
 zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */
(function(){function a(a){throw a;}function b(a,b){var f=a.split("."),c=n;f[0]in c||!c.execScript||c.execScript("var "+f[0]);for(var d;f.length&&(d=f.shift());)f.length||b===m?c=c[d]?c[d]:c[d]={}:c[d]=b}function c(a,b,f){var c="number"===typeof b?b:b=0,d="number"===typeof f?f:a.length;f=-1;for(c=d&7;c--;++b)f=f>>>8^u[(f^a[b])&255];for(c=d>>3;c--;b+=8)f=f>>>8^u[(f^a[b])&255],f=f>>>8^u[(f^a[b+1])&255],f=f>>>8^u[(f^a[b+2])&255],f=f>>>8^u[(f^a[b+3])&255],f=f>>>8^u[(f^a[b+4])&255],f=f>>>8^u[(f^a[b+5])&
255],f=f>>>8^u[(f^a[b+6])&255],f=f>>>8^u[(f^a[b+7])&255];return(f^4294967295)>>>0}function e(){}function d(a){var b=a.length,f=0,c=Number.POSITIVE_INFINITY,d,h,e,k,g,l,m,n,p;for(n=0;n<b;++n)a[n]>f&&(f=a[n]),a[n]<c&&(c=a[n]);d=1<<f;h=new (r?Uint32Array:Array)(d);e=1;k=0;for(g=2;e<=f;){for(n=0;n<b;++n)if(a[n]===e){l=0;m=k;for(p=0;p<e;++p)l=l<<1|m&1,m>>=1;for(p=l;p<d;p+=g)h[p]=e<<16|n;++k}++e;k<<=1;g<<=1}return[h,f,c]}function g(b,f){this.i=[];this.j=32768;this.d=this.f=this.c=this.n=0;this.input=r?
new Uint8Array(b):b;this.o=!1;this.k=w;this.w=!1;if(f||!(f={}))f.index&&(this.c=f.index),f.bufferSize&&(this.j=f.bufferSize),f.bufferType&&(this.k=f.bufferType),f.resize&&(this.w=f.resize);switch(this.k){case v:this.a=32768;this.b=new (r?Uint8Array:Array)(32768+this.j+258);break;case w:this.a=0;this.b=new (r?Uint8Array:Array)(this.j);this.e=this.D;this.q=this.A;this.l=this.C;break;default:a(Error("invalid inflate mode"))}}function f(b,f){for(var c=b.f,d=b.d,h=b.input,e=b.c,k;d<f;)k=h[e++],k===m&&
a(Error("input buffer is broken")),c|=k<<d,d+=8;b.f=c>>>f;b.d=d-f;b.c=e;return c&(1<<f)-1}function h(a,b){for(var f=a.f,c=a.d,d=a.input,h=a.c,e=b[0],k=b[1],g;c<k;){g=d[h++];if(g===m)break;f|=g<<c;c+=8}d=e[f&(1<<k)-1];e=d>>>16;a.f=f>>e;a.d=c-e;a.c=h;return d&65535}function k(a){function b(a,c,d){var e,k,g,l;for(l=0;l<a;)switch(e=h(this,c),e){case 16:for(g=3+f(this,2);g--;)d[l++]=k;break;case 17:for(g=3+f(this,3);g--;)d[l++]=0;k=0;break;case 18:for(g=11+f(this,7);g--;)d[l++]=0;k=0;break;default:k=d[l++]=
e}return d}var c=f(a,5)+257,e=f(a,5)+1,k=f(a,4)+4,g=new (r?Uint8Array:Array)(z.length),l;for(l=0;l<k;++l)g[z[l]]=f(a,3);k=d(g);g=new (r?Uint8Array:Array)(c);l=new (r?Uint8Array:Array)(e);a.l(d(b.call(a,c,k,g)),d(b.call(a,e,k,l)))}function l(a){this.input=a;this.c=0;this.m=[];this.s=!1}var m=void 0,n=this,r="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;new (r?Uint8Array:Array)(256);var p;for(p=0;256>p;++p)for(var t=p,s=7,t=t>>>1;t;t>>>=1)--s;p=
[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,
651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,
4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,
167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,
3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,
2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];var u=r?new Uint32Array(p):p;e.prototype.getName=function(){return this.name};e.prototype.getData=function(){return this.data};e.prototype.G=function(){return this.H};b("Zlib.GunzipMember",e);b("Zlib.GunzipMember.prototype.getName",e.prototype.getName);b("Zlib.GunzipMember.prototype.getData",
e.prototype.getData);b("Zlib.GunzipMember.prototype.getMtime",e.prototype.G);p=[];for(t=0;288>t;t++)switch(!0){case 143>=t:p.push([t+48,8]);break;case 255>=t:p.push([t-144+400,9]);break;case 279>=t:p.push([t-256+0,7]);break;case 287>=t:p.push([t-280+192,8]);break;default:a("invalid literal: "+t)}p=function(){function b(f){switch(!0){case 3===f:return[257,f-3,0];case 4===f:return[258,f-4,0];case 5===f:return[259,f-5,0];case 6===f:return[260,f-6,0];case 7===f:return[261,f-7,0];case 8===f:return[262,
f-8,0];case 9===f:return[263,f-9,0];case 10===f:return[264,f-10,0];case 12>=f:return[265,f-11,1];case 14>=f:return[266,f-13,1];case 16>=f:return[267,f-15,1];case 18>=f:return[268,f-17,1];case 22>=f:return[269,f-19,2];case 26>=f:return[270,f-23,2];case 30>=f:return[271,f-27,2];case 34>=f:return[272,f-31,2];case 42>=f:return[273,f-35,3];case 50>=f:return[274,f-43,3];case 58>=f:return[275,f-51,3];case 66>=f:return[276,f-59,3];case 82>=f:return[277,f-67,4];case 98>=f:return[278,f-83,4];case 114>=f:return[279,
f-99,4];case 130>=f:return[280,f-115,4];case 162>=f:return[281,f-131,5];case 194>=f:return[282,f-163,5];case 226>=f:return[283,f-195,5];case 257>=f:return[284,f-227,5];case 258===f:return[285,f-258,0];default:a("invalid length: "+f)}}var f=[],c,d;for(c=3;258>=c;c++)d=b(c),f[c]=d[2]<<24|d[1]<<16|d[0];return f}();r&&new Uint32Array(p);var v=0,w=1;g.prototype.g=function(){for(;!this.o;){var b=f(this,3);b&1&&(this.o=!0);b>>>=1;switch(b){case 0:var b=this.input,c=this.c,d=this.b,h=this.a,e=m,g=m,l=m,n=
d.length,e=m;this.d=this.f=0;e=b[c++];e===m&&a(Error("invalid uncompressed block header: LEN (first byte)"));g=e;e=b[c++];e===m&&a(Error("invalid uncompressed block header: LEN (second byte)"));g|=e<<8;e=b[c++];e===m&&a(Error("invalid uncompressed block header: NLEN (first byte)"));l=e;e=b[c++];e===m&&a(Error("invalid uncompressed block header: NLEN (second byte)"));l|=e<<8;g===~l&&a(Error("invalid uncompressed block header: length verify"));c+g>b.length&&a(Error("input buffer is broken"));switch(this.k){case v:for(;h+
g>d.length;){e=n-h;g-=e;if(r)d.set(b.subarray(c,c+e),h),h+=e,c+=e;else for(;e--;)d[h++]=b[c++];this.a=h;d=this.e();h=this.a}break;case w:for(;h+g>d.length;)d=this.e({t:2});break;default:a(Error("invalid inflate mode"))}if(r)d.set(b.subarray(c,c+g),h),h+=g,c+=g;else for(;g--;)d[h++]=b[c++];this.c=c;this.a=h;this.b=d;break;case 1:this.l(D,F);break;case 2:k(this);break;default:a(Error("unknown BTYPE: "+b))}}return this.q()};p=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var z=r?new Uint16Array(p):
p;p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];var x=r?new Uint16Array(p):p;p=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];var y=r?new Uint8Array(p):p;p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var C=r?new Uint16Array(p):p;p=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var B=r?new Uint8Array(p):p;p=new (r?Uint8Array:Array)(288);t=
0;for(s=p.length;t<s;++t)p[t]=143>=t?8:255>=t?9:279>=t?7:8;var D=d(p);p=new (r?Uint8Array:Array)(30);t=0;for(s=p.length;t<s;++t)p[t]=5;var F=d(p);g.prototype.l=function(a,b){var c=this.b,d=this.a;this.r=a;for(var e=c.length-258,k,g,l;256!==(k=h(this,a));)if(256>k)d>=e&&(this.a=d,c=this.e(),d=this.a),c[d++]=k;else for(k-=257,l=x[k],0<y[k]&&(l+=f(this,y[k])),k=h(this,b),g=C[k],0<B[k]&&(g+=f(this,B[k])),d>=e&&(this.a=d,c=this.e(),d=this.a);l--;)c[d]=c[d++-g];for(;8<=this.d;)this.d-=8,this.c--;this.a=
d};g.prototype.C=function(a,b){var c=this.b,d=this.a;this.r=a;for(var e=c.length,k,g,l;256!==(k=h(this,a));)if(256>k)d>=e&&(c=this.e(),e=c.length),c[d++]=k;else for(k-=257,l=x[k],0<y[k]&&(l+=f(this,y[k])),k=h(this,b),g=C[k],0<B[k]&&(g+=f(this,B[k])),d+l>e&&(c=this.e(),e=c.length);l--;)c[d]=c[d++-g];for(;8<=this.d;)this.d-=8,this.c--;this.a=d};g.prototype.e=function(){var a=new (r?Uint8Array:Array)(this.a-32768),f=this.a-32768,b,c,d=this.b;if(r)a.set(d.subarray(32768,a.length));else for(b=0,c=a.length;b<
c;++b)a[b]=d[b+32768];this.i.push(a);this.n+=a.length;if(r)d.set(d.subarray(f,f+32768));else for(b=0;32768>b;++b)d[b]=d[f+b];this.a=32768;return d};g.prototype.D=function(a){var b,f=this.input.length/this.c+1|0,c,d,h,e=this.input,k=this.b;a&&("number"===typeof a.t&&(f=a.t),"number"===typeof a.z&&(f+=a.z));2>f?(c=(e.length-this.c)/this.r[2],h=c/2*258|0,d=h<k.length?k.length+h:k.length<<1):d=k.length*f;r?(b=new Uint8Array(d),b.set(k)):b=k;return this.b=b};g.prototype.q=function(){var a=0,f=this.b,b=
this.i,c,d=new (r?Uint8Array:Array)(this.n+(this.a-32768)),h,e,k,g;if(0===b.length)return r?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);h=0;for(e=b.length;h<e;++h)for(c=b[h],k=0,g=c.length;k<g;++k)d[a++]=c[k];h=32768;for(e=this.a;h<e;++h)d[a++]=f[h];this.i=[];return this.buffer=d};g.prototype.A=function(){var a,b=this.a;r?this.w?(a=new Uint8Array(b),a.set(this.b.subarray(0,b))):a=this.b.subarray(0,b):(this.b.length>b&&(this.b.length=b),a=this.b);return this.buffer=a};l.prototype.F=function(){this.s||
this.g();return this.m.slice()};l.prototype.g=function(){for(var b=this.input.length;this.c<b;){var f=new e,d=m,h=m,k=m,l=d=k=m,n=m,d=d=m,p=this.input,h=this.c;f.u=p[h++];f.v=p[h++];31===f.u&&139===f.v||a(Error("invalid file signature:"+f.u+","+f.v));f.p=p[h++];switch(f.p){case 8:break;default:a(Error("unknown compression method: "+f.p))}f.h=p[h++];d=p[h++]|p[h++]<<8|p[h++]<<16|p[h++]<<24;f.H=new Date(1E3*d);f.N=p[h++];f.M=p[h++];0<(f.h&4)&&(f.I=p[h++]|p[h++]<<8,h+=f.I);if(0<(f.h&8)){n=[];for(l=0;0<
(d=p[h++]);)n[l++]=String.fromCharCode(d);f.name=n.join("")}if(0<(f.h&16)){n=[];for(l=0;0<(d=p[h++]);)n[l++]=String.fromCharCode(d);f.J=n.join("")}0<(f.h&2)&&(f.B=c(p,0,h)&65535,f.B!==(p[h++]|p[h++]<<8)&&a(Error("invalid header crc16")));d=p[p.length-4]|p[p.length-3]<<8|p[p.length-2]<<16|p[p.length-1]<<24;p.length-h-4-4<512*d&&(k=d);h=new g(p,{index:h,bufferSize:k});f.data=k=h.g();h=h.c;f.K=d=(p[h++]|p[h++]<<8|p[h++]<<16|p[h++]<<24)>>>0;c(k,m,m)!==d&&a(Error("invalid CRC-32 checksum: 0x"+c(k,m,m).toString(16)+
" / 0x"+d.toString(16)));f.L=d=(p[h++]|p[h++]<<8|p[h++]<<16|p[h++]<<24)>>>0;(k.length&4294967295)!==d&&a(Error("invalid input size: "+(k.length&4294967295)+" / "+d));this.m.push(f);this.c=h}this.s=!0;b=this.m;f=k=h=0;for(p=b.length;f<p;++f)k+=b[f].data.length;if(r)for(k=new Uint8Array(k),f=0;f<p;++f)k.set(b[f].data,h),h+=b[f].data.length;else{k=[];for(f=0;f<p;++f)k[f]=b[f].data;k=Array.prototype.concat.apply([],k)}return k};b("Zlib.Gunzip",l);b("Zlib.Gunzip.prototype.decompress",l.prototype.g);b("Zlib.Gunzip.prototype.getMembers",
l.prototype.F)}).call(this);"undefined"!==typeof window&&!function(a,b,c){var e=a.L,d={version:"0.7.2",noConflict:function(){return a.L=e,this}};a.L=d;d.Util={extend:function(a){var b,c,d,e,g=Array.prototype.slice.call(arguments,1);c=0;for(d=g.length;d>c;c++)for(b in e=g[c]||{},e)e.hasOwnProperty(b)&&(a[b]=e[b]);return a},bind:function(a,b){var c=2<arguments.length?Array.prototype.slice.call(arguments,2):null;return function(){return a.apply(b,c||arguments)}},stamp:function(){var a=0;return function(b){return b._leaflet_id=
b._leaflet_id||++a,b._leaflet_id}}(),invokeEach:function(a,b,c){var d,e;if("object"==typeof a){e=Array.prototype.slice.call(arguments,3);for(d in a)b.apply(c,[d,a[d]].concat(e));return!0}return!1},limitExecByInterval:function(a,b,c){var d,e;return function r(){var g=arguments;return d?void(e=!0):(d=!0,setTimeout(function(){d=!1;e&&(r.apply(c,g),e=!1)},b),void a.apply(c,g))}},falseFn:function(){return!1},formatNum:function(a,b){var c=Math.pow(10,b||5);return Math.round(a*c)/c},trim:function(a){return a.trim?
a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return d.Util.trim(a).split(/\s+/)},setOptions:function(a,b){return a.options=d.extend({},a.options,b),a.options},getParamString:function(a,b,c){var d=[],e;for(e in a)d.push(encodeURIComponent(c?e.toUpperCase():e)+"="+encodeURIComponent(a[e]));return(b&&-1!==b.indexOf("?")?"&":"?")+d.join("&")},template:function(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,f){var d=b[f];if(d===c)throw Error("No value provided for variable "+a);return"function"==
typeof d&&(d=d(b)),d})},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="};(function(){function b(f){var c,d,h=["webkit","moz","o","ms"];for(c=0;c<h.length&&!d;c++)d=a[h[c]+f];return d}function c(b){var f=+new Date,d=Math.max(0,16-(f-e));return e=f+d,a.setTimeout(b,d)}var e=0,g=a.requestAnimationFrame||b("RequestAnimationFrame")||c,m=a.cancelAnimationFrame||b("CancelAnimationFrame")||
b("CancelRequestAnimationFrame")||function(b){a.clearTimeout(b)};d.Util.requestAnimFrame=function(b,f,e,k){return b=d.bind(b,f),e&&g===c?void b():g.call(a,b,k)};d.Util.cancelAnimFrame=function(b){b&&m.call(a,b)}})();d.extend=d.Util.extend;d.bind=d.Util.bind;d.stamp=d.Util.stamp;d.setOptions=d.Util.setOptions;d.Class=function(){};d.Class.extend=function(a){var b=function(){this.initialize&&this.initialize.apply(this,arguments);this._initHooks&&this.callInitHooks()},c=function(){};c.prototype=this.prototype;
var e=new c;e.constructor=b;b.prototype=e;for(var g in this)this.hasOwnProperty(g)&&"prototype"!==g&&(b[g]=this[g]);a.statics&&(d.extend(b,a.statics),delete a.statics);a.includes&&(d.Util.extend.apply(null,[e].concat(a.includes)),delete a.includes);a.options&&e.options&&(a.options=d.extend({},e.options,a.options));d.extend(e,a);e._initHooks=[];var n=this;return b.__super__=n.prototype,e.callInitHooks=function(){if(!this._initHooksCalled){n.prototype.callInitHooks&&n.prototype.callInitHooks.call(this);
this._initHooksCalled=!0;for(var a=0,b=e._initHooks.length;b>a;a++)e._initHooks[a].call(this)}},b};d.Class.include=function(a){d.extend(this.prototype,a)};d.Class.mergeOptions=function(a){d.extend(this.prototype.options,a)};d.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1);this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push("function"==typeof a?a:function(){this[a].apply(this,b)})};d.Mixin={};d.Mixin.Events={addEventListener:function(a,
b,c){if(d.Util.invokeEach(a,this.addEventListener,this,b,c))return this;var e,g,n,r,p,t,s,u=this._leaflet_events=this._leaflet_events||{},v=c&&c!==this&&d.stamp(c);a=d.Util.splitWords(a);e=0;for(g=a.length;g>e;e++)n={action:b,context:c||this},r=a[e],v?(p=r+"_idx",t=p+"_len",s=u[p]=u[p]||{},s[v]||(s[v]=[],u[t]=(u[t]||0)+1),s[v].push(n)):(u[r]=u[r]||[],u[r].push(n));return this},hasEventListeners:function(a){var b=this._leaflet_events;return!!b&&(a in b&&0<b[a].length||a+"_idx"in b&&0<b[a+"_idx_len"])},
removeEventListener:function(a,b,c){if(!this._leaflet_events)return this;if(!a)return this.clearAllEventListeners();if(d.Util.invokeEach(a,this.removeEventListener,this,b,c))return this;var e,g,n,r,p,t,s,u,v,w=this._leaflet_events,z=c&&c!==this&&d.stamp(c);a=d.Util.splitWords(a);e=0;for(g=a.length;g>e;e++)if(n=a[e],t=n+"_idx",s=t+"_len",u=w[t],b){if(r=z&&u?u[z]:w[n]){for(p=r.length-1;0<=p;p--)r[p].action!==b||c&&r[p].context!==c||(v=r.splice(p,1),v[0].action=d.Util.falseFn);c&&u&&0===r.length&&(delete u[z],
w[s]--)}}else delete w[n],delete w[t],delete w[s];return this},clearAllEventListeners:function(){return delete this._leaflet_events,this},fireEvent:function(a,b){if(!this.hasEventListeners(a))return this;var c,e,g,n,r,p=d.Util.extend({},b,{type:a,target:this});n=this._leaflet_events;if(n[a])for(c=n[a].slice(),e=0,g=c.length;g>e;e++)c[e].action.call(c[e].context,p);n=n[a+"_idx"];for(r in n)if(c=n[r].slice())for(e=0,g=c.length;g>e;e++)c[e].action.call(c[e].context,p);return this},addOneTimeEventListener:function(a,
b,c){if(d.Util.invokeEach(a,this.addOneTimeEventListener,this,b,c))return this;var e=d.bind(function(){this.removeEventListener(a,b,c).removeEventListener(a,e,c)},this);return this.addEventListener(a,b,c).addEventListener(a,e,c)}};d.Mixin.Events.on=d.Mixin.Events.addEventListener;d.Mixin.Events.off=d.Mixin.Events.removeEventListener;d.Mixin.Events.once=d.Mixin.Events.addOneTimeEventListener;d.Mixin.Events.fire=d.Mixin.Events.fireEvent;(function(){var f="ActiveXObject"in a,h=f&&!b.addEventListener,
e=navigator.userAgent.toLowerCase(),g=-1!==e.indexOf("webkit"),m=-1!==e.indexOf("chrome"),n=-1!==e.indexOf("phantom"),r=-1!==e.indexOf("android"),p=-1!==e.search("android [23]"),e=-1!==e.indexOf("gecko"),t=typeof orientation!=c+"",s=a.navigator&&a.navigator.msPointerEnabled&&a.navigator.msMaxTouchPoints&&!a.PointerEvent,u=a.PointerEvent&&a.navigator.pointerEnabled&&a.navigator.maxTouchPoints||s,v="devicePixelRatio"in a&&1<a.devicePixelRatio||"matchMedia"in a&&a.matchMedia("(min-resolution:144dpi)")&&
a.matchMedia("(min-resolution:144dpi)").matches,w=b.documentElement,z=f&&"transition"in w.style,x="WebKitCSSMatrix"in a&&"m11"in new a.WebKitCSSMatrix&&!p,y="MozPerspective"in w.style,C="OTransition"in w.style,B=!a.L_DISABLE_3D&&(z||x||y||C)&&!n,D;if(D=!a.L_NO_TOUCH){if(n=!n)u||"ontouchstart"in w?n=!0:(n=b.createElement("div"),w=!1,n=n.setAttribute?(n.setAttribute("ontouchstart","return;"),"function"==typeof n.ontouchstart&&(w=!0),n.removeAttribute("ontouchstart"),w):!1);D=n}d.Browser={ie:f,ielt9:h,
webkit:g,gecko:e&&!g&&!a.opera&&!f,android:r,android23:p,chrome:m,ie3d:z,webkit3d:x,gecko3d:y,opera3d:C,any3d:B,mobile:t,mobileWebkit:t&&g,mobileWebkit3d:t&&x,mobileOpera:t&&a.opera,touch:D,msPointer:s,pointer:u,retina:v}})();d.Point=function(a,b,c){this.x=c?Math.round(a):a;this.y=c?Math.round(b):b};d.Point.prototype={clone:function(){return new d.Point(this.x,this.y)},add:function(a){return this.clone()._add(d.point(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(d.point(a))},
_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),
this.y=Math.floor(this.y),this},distanceTo:function(a){a=d.point(a);var b=a.x-this.x;a=a.y-this.y;return Math.sqrt(b*b+a*a)},equals:function(a){return a=d.point(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=d.point(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+d.Util.formatNum(this.x)+", "+d.Util.formatNum(this.y)+")"}};d.point=function(a,b,e){return a instanceof d.Point?a:d.Util.isArray(a)?new d.Point(a[0],a[1]):a===c||null===
a?a:new d.Point(a,b,e)};d.Bounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;e>d;d++)this.extend(c[d])};d.Bounds.prototype={extend:function(a){return a=d.point(a),this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone()),this},getCenter:function(a){return new d.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new d.Point(this.min.x,
this.max.y)},getTopRight:function(){return new d.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var b,c;return a="number"==typeof a[0]||a instanceof d.Point?d.point(a):d.bounds(a),a instanceof d.Bounds?(b=a.min,c=a.max):b=c=a,b.x>=this.min.x&&c.x<=this.max.x&&b.y>=this.min.y&&c.y<=this.max.y},intersects:function(a){a=d.bounds(a);var b=this.min,c=this.max,e=a.min;a=a.max;var g=a.y>=b.y&&e.y<=c.y;return a.x>=b.x&&e.x<=c.x&&g},isValid:function(){return!(!this.min||
!this.max)}};d.bounds=function(a,b){return!a||a instanceof d.Bounds?a:new d.Bounds(a,b)};d.Transformation=function(a,b,c,d){this._a=a;this._b=b;this._c=c;this._d=d};d.Transformation.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){return b=b||1,a.x=b*(this._a*a.x+this._b),a.y=b*(this._c*a.y+this._d),a},untransform:function(a,b){return b=b||1,new d.Point((a.x/b-this._b)/this._a,(a.y/b-this._d)/this._c)}};d.DomUtil={get:function(a){return"string"==typeof a?
b.getElementById(a):a},getStyle:function(a,c){var d=a.style[c];(!d&&a.currentStyle&&(d=a.currentStyle[c]),d&&"auto"!==d||!b.defaultView)||(d=(d=b.defaultView.getComputedStyle(a,null))?d[c]:null);return"auto"===d?null:d},getViewportOffset:function(a){var c,e=0,g=0,m=a,n=b.body,r=b.documentElement;do{if(e+=m.offsetTop||0,g+=m.offsetLeft||0,e+=parseInt(d.DomUtil.getStyle(m,"borderTopWidth"),10)||0,g+=parseInt(d.DomUtil.getStyle(m,"borderLeftWidth"),10)||0,c=d.DomUtil.getStyle(m,"position"),m.offsetParent===
n&&"absolute"===c)break;if("fixed"===c){e+=n.scrollTop||r.scrollTop||0;g+=n.scrollLeft||r.scrollLeft||0;break}if("relative"===c&&!m.offsetLeft){c=d.DomUtil.getStyle(m,"width");var p=d.DomUtil.getStyle(m,"max-width"),t=m.getBoundingClientRect();"none"===c&&"none"===p||(g+=t.left+m.clientLeft);e+=t.top+(n.scrollTop||r.scrollTop||0);break}m=m.offsetParent}while(m);m=a;do{if(m===n)break;e-=m.scrollTop||0;g-=m.scrollLeft||0;m=m.parentNode}while(m);return new d.Point(g,e)},documentIsLtr:function(){return d.DomUtil._docIsLtrCached||
(d.DomUtil._docIsLtrCached=!0,d.DomUtil._docIsLtr="ltr"===d.DomUtil.getStyle(b.body,"direction")),d.DomUtil._docIsLtr},create:function(a,c,d){a=b.createElement(a);return a.className=c,d&&d.appendChild(a),a},hasClass:function(a,b){if(a.classList!==c)return a.classList.contains(b);var e=d.DomUtil._getClass(a);return 0<e.length&&RegExp("(^|\\s)"+b+"(\\s|$)").test(e)},addClass:function(a,b){if(a.classList!==c)for(var e=d.Util.splitWords(b),g=0,m=e.length;m>g;g++)a.classList.add(e[g]);else d.DomUtil.hasClass(a,
b)||(e=d.DomUtil._getClass(a),d.DomUtil._setClass(a,(e?e+" ":"")+b))},removeClass:function(a,b){a.classList!==c?a.classList.remove(b):d.DomUtil._setClass(a,d.Util.trim((" "+d.DomUtil._getClass(a)+" ").replace(" "+b+" "," ")))},_setClass:function(a,b){a.className.baseVal===c?a.className=b:a.className.baseVal=b},_getClass:function(a){return a.className.baseVal===c?a.className:a.className.baseVal},setOpacity:function(a,b){if("opacity"in a.style)a.style.opacity=b;else if("filter"in a.style){var c=!1;
try{c=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(d){if(1===b)return}b=Math.round(100*b);c?(c.Enabled=100!==b,c.Opacity=b):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+b+")"}},testProp:function(a){for(var c=b.documentElement.style,d=0;d<a.length;d++)if(a[d]in c)return a[d];return!1},getTranslateString:function(a){var b=d.Browser.webkit3d;return"translate"+(b?"3d":"")+"("+a.x+"px,"+a.y+"px"+((b?",0":"")+")")},getScaleString:function(a,b){return d.DomUtil.getTranslateString(b.add(b.multiplyBy(-1*
a)))+(" scale("+a+") ")},setPosition:function(a,b,c){a._leaflet_pos=b;!c&&d.Browser.any3d?a.style[d.DomUtil.TRANSFORM]=d.DomUtil.getTranslateString(b):(a.style.left=b.x+"px",a.style.top=b.y+"px")},getPosition:function(a){return a._leaflet_pos}};d.DomUtil.TRANSFORM=d.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);d.DomUtil.TRANSITION=d.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);d.DomUtil.TRANSITION_END=
"webkitTransition"===d.DomUtil.TRANSITION||"OTransition"===d.DomUtil.TRANSITION?d.DomUtil.TRANSITION+"End":"transitionend";(function(){if("onselectstart"in b)d.extend(d.DomUtil,{disableTextSelection:function(){d.DomEvent.on(a,"selectstart",d.DomEvent.preventDefault)},enableTextSelection:function(){d.DomEvent.off(a,"selectstart",d.DomEvent.preventDefault)}});else{var f=d.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);d.extend(d.DomUtil,{disableTextSelection:function(){if(f){var a=
b.documentElement.style;this._userSelect=a[f];a[f]="none"}},enableTextSelection:function(){f&&(b.documentElement.style[f]=this._userSelect,delete this._userSelect)}})}d.extend(d.DomUtil,{disableImageDrag:function(){d.DomEvent.on(a,"dragstart",d.DomEvent.preventDefault)},enableImageDrag:function(){d.DomEvent.off(a,"dragstart",d.DomEvent.preventDefault)}})})();d.LatLng=function(a,b,d){if(a=parseFloat(a),b=parseFloat(b),isNaN(a)||isNaN(b))throw Error("Invalid LatLng object: ("+a+", "+b+")");this.lat=
a;this.lng=b;d!==c&&(this.alt=parseFloat(d))};d.extend(d.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1E-9});d.LatLng.prototype={equals:function(a){if(!a)return!1;a=d.latLng(a);return Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=d.LatLng.MAX_MARGIN},toString:function(a){return"LatLng("+d.Util.formatNum(this.lat,a)+", "+d.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){a=d.latLng(a);var b=d.LatLng.DEG_TO_RAD,c=(a.lng-this.lng)*b,e=this.lat*b,g=a.lat*b;a=Math.sin((a.lat-
this.lat)*b/2);c=Math.sin(c/2);e=a*a+c*c*Math.cos(e)*Math.cos(g);return 12756274*Math.atan2(Math.sqrt(e),Math.sqrt(1-e))},wrap:function(a,b){var c=this.lng;return a=a||-180,b=b||180,c=(c+b)%(b-a)+(a>c||c===b?b:a),new d.LatLng(this.lat,c)}};d.latLng=function(a,b){return a instanceof d.LatLng?a:d.Util.isArray(a)?"number"==typeof a[0]||"string"==typeof a[0]?new d.LatLng(a[0],a[1],a[2]):null:a===c||null===a?a:"object"==typeof a&&"lat"in a?new d.LatLng(a.lat,"lng"in a?a.lng:a.lon):b===c?null:new d.LatLng(a,
b)};d.LatLngBounds=function(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;e>d;d++)this.extend(c[d])};d.LatLngBounds.prototype={extend:function(a){if(!a)return this;var b=d.latLng(a);return a=null!==b?b:d.latLngBounds(a),a instanceof d.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(a.lat,this._southWest.lat),this._southWest.lng=Math.min(a.lng,this._southWest.lng),this._northEast.lat=Math.max(a.lat,this._northEast.lat),this._northEast.lng=Math.max(a.lng,this._northEast.lng)):(this._southWest=
new d.LatLng(a.lat,a.lng),this._northEast=new d.LatLng(a.lat,a.lng)):a instanceof d.LatLngBounds&&(this.extend(a._southWest),this.extend(a._northEast)),this},pad:function(a){var b=this._southWest,c=this._northEast,e=Math.abs(b.lat-c.lat)*a;a*=Math.abs(b.lng-c.lng);return new d.LatLngBounds(new d.LatLng(b.lat-e,b.lng-a),new d.LatLng(c.lat+e,c.lng+a))},getCenter:function(){return new d.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},
getNorthEast:function(){return this._northEast},getNorthWest:function(){return new d.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new d.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"==typeof a[0]||a instanceof d.LatLng?d.latLng(a):d.latLngBounds(a);var b,c,e=this._southWest,
g=this._northEast;return a instanceof d.LatLngBounds?(b=a.getSouthWest(),c=a.getNorthEast()):b=c=a,b.lat>=e.lat&&c.lat<=g.lat&&b.lng>=e.lng&&c.lng<=g.lng},intersects:function(a){a=d.latLngBounds(a);var b=this._southWest,c=this._northEast,e=a.getSouthWest();a=a.getNorthEast();var g=a.lng>=b.lng&&e.lng<=c.lng;return a.lat>=b.lat&&e.lat<=c.lat&&g},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(a){return a?(a=d.latLngBounds(a),this._southWest.equals(a.getSouthWest())&&
this._northEast.equals(a.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}};d.latLngBounds=function(a,b){return!a||a instanceof d.LatLngBounds?a:new d.LatLngBounds(a,b)};d.Projection={};d.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(a){var b=d.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,c=Math.max(Math.min(c,a.lat),-c);a=a.lng*b;b*=c;return b=Math.log(Math.tan(Math.PI/4+b/2)),new d.Point(a,b)},unproject:function(a){var b=d.LatLng.RAD_TO_DEG,
c=a.x*b;a=(2*Math.atan(Math.exp(a.y))-Math.PI/2)*b;return new d.LatLng(a,c)}};d.Projection.LonLat={project:function(a){return new d.Point(a.lng,a.lat)},unproject:function(a){return new d.LatLng(a.y,a.x)}};d.CRS={latLngToPoint:function(a,b){var c=this.projection.project(a),d=this.scale(b);return this.transformation._transform(c,d)},pointToLatLng:function(a,b){var c=this.scale(b),c=this.transformation.untransform(a,c);return this.projection.unproject(c)},project:function(a){return this.projection.project(a)},
scale:function(a){return 256*Math.pow(2,a)},getSize:function(a){a=this.scale(a);return d.point(a,a)}};d.CRS.Simple=d.extend({},d.CRS,{projection:d.Projection.LonLat,transformation:new d.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)}});d.CRS.EPSG3857=d.extend({},d.CRS,{code:"EPSG:3857",projection:d.Projection.SphericalMercator,transformation:new d.Transformation(0.5/Math.PI,0.5,-0.5/Math.PI,0.5),project:function(a){return this.projection.project(a).multiplyBy(6378137)}});d.CRS.EPSG900913=
d.extend({},d.CRS.EPSG3857,{code:"EPSG:900913"});d.CRS.EPSG4326=d.extend({},d.CRS,{code:"EPSG:4326",projection:d.Projection.LonLat,transformation:new d.Transformation(1/360,0.5,-1/360,0.5)});d.Map=d.Class.extend({includes:d.Mixin.Events,options:{crs:d.CRS.EPSG3857,fadeAnimation:d.DomUtil.TRANSITION&&!d.Browser.android23,trackResize:!0,markerZoomAnimation:d.DomUtil.TRANSITION&&d.Browser.any3d},initialize:function(a,b){b=d.setOptions(this,b);this._initContainer(a);this._initLayout();this._onResize=
d.bind(this._onResize,this);this._initEvents();b.maxBounds&&this.setMaxBounds(b.maxBounds);b.center&&b.zoom!==c&&this.setView(d.latLng(b.center),b.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._tileLayersNum=0;this.callInitHooks();this._addLayers(b.layers)},setView:function(a,b){return b=b===c?this.getZoom():b,this._resetView(d.latLng(a),this._limitZoom(b)),this},setZoom:function(a,b){return this._loaded?this.setView(this.getCenter(),a,{zoom:b}):(this._zoom=this._limitZoom(a),
this)},zoomIn:function(a,b){return this.setZoom(this._zoom+(a||1),b)},zoomOut:function(a,b){return this.setZoom(this._zoom-(a||1),b)},setZoomAround:function(a,b,c){var e=this.getZoomScale(b),g=this.getSize().divideBy(2);a=(a instanceof d.Point?a:this.latLngToContainerPoint(a)).subtract(g).multiplyBy(1-1/e);g=this.containerPointToLatLng(g.add(a));return this.setView(g,b,{zoom:c})},fitBounds:function(a,b){b=b||{};a=a.getBounds?a.getBounds():d.latLngBounds(a);var c=d.point(b.paddingTopLeft||b.padding||
[0,0]),e=d.point(b.paddingBottomRight||b.padding||[0,0]),g=this.getBoundsZoom(a,!1,c.add(e)),c=e.subtract(c).divideBy(2),e=this.project(a.getSouthWest(),g),n=this.project(a.getNorthEast(),g),c=this.unproject(e.add(n).divideBy(2).add(c),g);return g=b&&b.maxZoom?Math.min(b.maxZoom,g):g,this.setView(c,g,b)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,{pan:b})},panBy:function(a){return this.fire("movestart"),this._rawPanBy(d.point(a)),
this.fire("move"),this.fire("moveend")},setMaxBounds:function(a){return a=d.latLngBounds(a),this.options.maxBounds=a,a?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(a,b){var c=this.getCenter(),d=this._limitCenter(c,this._zoom,a);return c.equals(d)?this:this.panTo(d,b)},addLayer:function(a){var b=d.stamp(a);return this._layers[b]?this:(this._layers[b]=a,!a.options||isNaN(a.options.maxZoom)&&
isNaN(a.options.minZoom)||(this._zoomBoundLayers[b]=a,this._updateZoomLevels()),this.options.zoomAnimation&&d.TileLayer&&a instanceof d.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,a.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(a),this)},removeLayer:function(a){var b=d.stamp(a);return this._layers[b]?(this._loaded&&a.onRemove(this),delete this._layers[b],this._loaded&&this.fire("layerremove",{layer:a}),this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],
this._updateZoomLevels()),this.options.zoomAnimation&&d.TileLayer&&a instanceof d.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,a.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(a){return a?d.stamp(a)in this._layers:!1},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},invalidateSize:function(a){if(!this._loaded)return this;a=d.extend({animate:!1,pan:!0},!0===a?{animate:!0}:a);var b=this.getSize();this._sizeChanged=!0;this._initialCenter=
null;var c=this.getSize(),e=b.divideBy(2).round(),g=c.divideBy(2).round(),e=e.subtract(g);return e.x||e.y?(a.animate&&a.pan?this.panBy(e):(a.pan&&this._rawPanBy(e),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(d.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:b,newSize:c})):this},addHandler:function(a,b){if(!b)return this;var c=this[a]=new b(this);return this._handlers.push(c),this.options[a]&&c.enable(),this},
remove:function(){this._loaded&&this.fire("unload");this._initEvents("off");try{delete this._container._leaflet}catch(a){this._container._leaflet=c}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),b=this.unproject(a.getBottomLeft()),
a=this.unproject(a.getTopRight());return new d.LatLngBounds(b,a)},getMinZoom:function(){return this.options.minZoom===c?this._layersMinZoom===c?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===c?this._layersMaxZoom===c?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,b,c){a=d.latLngBounds(a);var e,g=this.getMinZoom()-(b?1:0),n=this.getMaxZoom(),r=this.getSize(),p=a.getNorthWest();a=a.getSouthEast();e=!0;c=d.point(c||[0,0]);do g++,
e=this.project(a,g).subtract(this.project(p,g)).add(c),e=b?e.x<r.x||e.y<r.y:r.contains(e);while(e&&n>=g);return e&&b?null:b?g:g-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new d.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var a=this._getTopLeftPoint();return new d.Bounds(a,a.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},
getContainer:function(){return this._container},getZoomScale:function(a){var b=this.options.crs;return b.scale(a)/b.scale(this._zoom)},getScaleZoom:function(a){return this._zoom+Math.log(a)/Math.LN2},project:function(a,b){return b=b===c?this._zoom:b,this.options.crs.latLngToPoint(d.latLng(a),b)},unproject:function(a,b){return b=b===c?this._zoom:b,this.options.crs.pointToLatLng(d.point(a),b)},layerPointToLatLng:function(a){a=d.point(a).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(a){return this.project(d.latLng(a))._round()._subtract(this.getPixelOrigin())},
containerPointToLayerPoint:function(a){return d.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return d.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){a=this.containerPointToLayerPoint(d.point(a));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(d.latLng(a)))},mouseEventToContainerPoint:function(a){return d.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},
mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){a=this._container=d.DomUtil.get(a);if(!a)throw Error("Map container not found.");if(a._leaflet)throw Error("Map container is already initialized.");a._leaflet=!0},_initLayout:function(){var a=this._container;d.DomUtil.addClass(a,"leaflet-container"+(d.Browser.touch?" leaflet-touch":"")+(d.Browser.retina?" leaflet-retina":"")+(d.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?
" leaflet-fade-anim":""));var b=d.DomUtil.getStyle(a,"position");"absolute"!==b&&"relative"!==b&&"fixed"!==b&&(a.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._mapPane=a.mapPane=this._createPane("leaflet-map-pane",this._container);this._tilePane=a.tilePane=this._createPane("leaflet-tile-pane",this._mapPane);a.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane);a.shadowPane=this._createPane("leaflet-shadow-pane");
a.overlayPane=this._createPane("leaflet-overlay-pane");a.markerPane=this._createPane("leaflet-marker-pane");a.popupPane=this._createPane("leaflet-popup-pane");this.options.markerZoomAnimation||(d.DomUtil.addClass(a.markerPane," leaflet-zoom-hide"),d.DomUtil.addClass(a.shadowPane," leaflet-zoom-hide"),d.DomUtil.addClass(a.popupPane," leaflet-zoom-hide"))},_createPane:function(a,b){return d.DomUtil.create("div",a,b||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},
_addLayers:function(a){a=a?d.Util.isArray(a)?a:[a]:[];for(var b=0,c=a.length;c>b;b++)this.addLayer(a[b])},_resetView:function(a,b,c,e){var g=this._zoom!==b;e||(this.fire("movestart"),g&&this.fire("zoomstart"));this._zoom=b;this._initialCenter=a;this._initialTopLeftPoint=this._getNewTopLeftPoint(a);c?this._initialTopLeftPoint._add(this._getMapPanePos()):d.DomUtil.setPosition(this._mapPane,new d.Point(0,0));this._tileLayersToLoad=this._tileLayersNum;a=!this._loaded;this._loaded=!0;a&&(this.fire("load"),
this.eachLayer(this._layerAdd,this));this.fire("viewreset",{hard:!c});this.fire("move");(g||e)&&this.fire("zoomend");this.fire("moveend",{hard:!c})},_rawPanBy:function(a){d.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var a,b=1/0,d=-1/0,e=this._getZoomSpan();for(a in this._zoomBoundLayers){var g=this._zoomBoundLayers[a];isNaN(g.options.minZoom)||(b=Math.min(b,g.options.minZoom));
isNaN(g.options.maxZoom)||(d=Math.max(d,g.options.maxZoom))}a===c?this._layersMaxZoom=this._layersMinZoom=c:(this._layersMaxZoom=d,this._layersMinZoom=b);e!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");},_initEvents:function(b){if(d.DomEvent){b=b||"on";d.DomEvent[b](this._container,"click",this._onMouseClick,this);var c,e,g="dblclick mousedown mouseup mouseenter mouseleave mousemove contextmenu".split(" ");
c=0;for(e=g.length;e>c;c++)d.DomEvent[b](this._container,g[c],this._fireMouseEvent,this);this.options.trackResize&&d.DomEvent[b](a,"resize",this._onResize,this)}},_onResize:function(){d.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=d.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(a){!this._loaded||!a._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||d.DomEvent._skipped(a)||
(this.fire("preclick"),this._fireMouseEvent(a))},_fireMouseEvent:function(a){if(this._loaded&&!d.DomEvent._skipped(a)){var b=a.type;if(b="mouseenter"===b?"mouseover":"mouseleave"===b?"mouseout":b,this.hasEventListeners(b)){"contextmenu"===b&&d.DomEvent.preventDefault(a);var c=this.mouseEventToContainerPoint(a),e=this.containerPointToLayerPoint(c),g=this.layerPointToLatLng(e);this.fire(b,{latlng:g,layerPoint:e,containerPoint:c,originalEvent:a})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--;
this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var a=0,b=this._handlers.length;b>a;a++)this._handlers[a].disable()},whenReady:function(a,b){return this._loaded?a.call(b||this,this):this.on("load",a,b),this},_layerAdd:function(a){a.onAdd(this);this.fire("layeradd",{layer:a})},_getMapPanePos:function(){return d.DomUtil.getPosition(this._mapPane)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},
_getNewTopLeftPoint:function(a,b){var c=this.getSize()._divideBy(2);return this.project(a,b)._subtract(c)._round()},_latLngToNewLayerPoint:function(a,b,c){c=this._getNewTopLeftPoint(c,b).add(this._getMapPanePos());return this.project(a,b)._subtract(c)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,b,c){if(!c)return a;a=
this.project(a,b);var e=this.getSize().divideBy(2),e=new d.Bounds(a.subtract(e),a.add(e));c=this._getBoundsOffset(e,c,b);return this.unproject(a.add(c),b)},_limitOffset:function(a,b){if(!b)return a;var c=this.getPixelBounds(),c=new d.Bounds(c.min.add(a),c.max.add(a));return a.add(this._getBoundsOffset(c,b))},_getBoundsOffset:function(a,b,c){var e=this.project(b.getNorthWest(),c).subtract(a.min);b=this.project(b.getSouthEast(),c).subtract(a.max);a=this._rebound(e.x,-b.x);e=this._rebound(e.y,-b.y);
return new d.Point(a,e)},_rebound:function(a,b){return 0<a+b?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},_limitZoom:function(a){var b=this.getMinZoom(),c=this.getMaxZoom();return Math.max(b,Math.min(c,a))}});d.map=function(a,b){return new d.Map(a,b)};d.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(a){var b=d.LatLng.DEG_TO_RAD,c=this.MAX_LATITUDE,e=Math.max(Math.min(c,a.lat),-c),c=this.R_MAJOR;a=a.lng*b*c;var b=
e*b,e=this.R_MINOR/c,e=Math.sqrt(1-e*e),g=e*Math.sin(b),g=Math.pow((1-g)/(1+g),0.5*e),e=Math.tan(0.5*(0.5*Math.PI-b))/g;return b=-c*Math.log(e),new d.Point(a,b)},unproject:function(a){var b,c=d.LatLng.RAD_TO_DEG,e=this.R_MAJOR,g=a.x*c/e,n=this.R_MINOR/e,n=Math.sqrt(1-n*n);a=Math.exp(-a.y/e);var e=Math.PI/2-2*Math.atan(a),r=15;for(b=0.1;1E-7<Math.abs(b)&&0<--r;)b=n*Math.sin(e),b=Math.PI/2-2*Math.atan(a*Math.pow((1-b)/(1+b),0.5*n))-e,e+=b;return new d.LatLng(e*c,g)}};d.CRS.EPSG3395=d.extend({},d.CRS,
{code:"EPSG:3395",projection:d.Projection.Mercator,transformation:function(){var a=0.5/(Math.PI*d.Projection.Mercator.R_MAJOR);return new d.Transformation(a,0.5,-a,0.5)}()});d.TileLayer=d.Class.extend({includes:d.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:d.Browser.mobile,updateWhenIdle:d.Browser.mobile},initialize:function(a,b){b=d.setOptions(this,b);b.detectRetina&&d.Browser.retina&&0<b.maxZoom&&
(b.tileSize=Math.floor(b.tileSize/2),b.zoomOffset++,0<b.minZoom&&b.minZoom--,this.options.maxZoom--);b.bounds&&(b.bounds=d.latLngBounds(b.bounds));this._url=a;var c=this.options.subdomains;"string"==typeof c&&(this.options.subdomains=c.split(""))},onAdd:function(a){this._map=a;this._animated=a._zoomAnimated;this._initContainer();a.on({viewreset:this._reset,moveend:this._update},this);this._animated&&a.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);this.options.updateWhenIdle||(this._limitedUpdate=
d.Util.limitExecByInterval(this._update,150,this),a.on("move",this._limitedUpdate,this));this._reset();this._update()},addTo:function(a){return a.addLayer(this),this},onRemove:function(a){this._container.parentNode.removeChild(this._container);a.off({viewreset:this._reset,moveend:this._update},this);this._animated&&a.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);this.options.updateWhenIdle||a.off("move",this._limitedUpdate,this);this._map=this._container=null},bringToFront:function(){var a=
this._map._panes.tilePane;return this._container&&(a.appendChild(this._container),this._setAutoZIndex(a,Math.max)),this},bringToBack:function(){var a=this._map._panes.tilePane;return this._container&&(a.insertBefore(this._container,a.firstChild),this._setAutoZIndex(a,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=
a,this._updateZIndex(),this},setUrl:function(a,b){return this._url=a,b||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==c&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a,b){var c,d,e,g=a.children,r=-b(1/0,-1/0);d=0;for(e=g.length;e>d;d++)g[d]!==this._container&&(c=parseInt(g[d].style.zIndex,10),isNaN(c)||(r=b(r,c)));this.options.zIndex=this._container.style.zIndex=
(isFinite(r)?r:0)+b(1,-1)},_updateOpacity:function(){var a,b=this._tiles;if(d.Browser.ielt9)for(a in b)d.DomUtil.setOpacity(b[a],this.options.opacity);else d.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var a=this._map._panes.tilePane;this._container||((this._container=d.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated)?(this._bgBuffer=d.DomUtil.create("div","leaflet-tile-container",this._container),this._tileContainer=d.DomUtil.create("div",
"leaflet-tile-container",this._container)):this._tileContainer=this._container,a.appendChild(this._container),1>this.options.opacity&&this._updateOpacity())},_reset:function(a){for(var b in this._tiles)this.fire("tileunload",{tile:this._tiles[b]});this._tiles={};this._tilesToLoad=0;this.options.reuseTiles&&(this._unusedTiles=[]);this._tileContainer.innerHTML="";this._animated&&a&&a.hard&&this._clearBgBuffer();this._initContainer()},_getTileSize:function(){var a=this._map,b=a.getZoom()+this.options.zoomOffset,
c=this.options.maxNativeZoom,d=this.options.tileSize;return c&&b>c&&(d=Math.round(a.getZoomScale(b)/a.getZoomScale(c)*d)),d},_update:function(){if(this._map){var a=this._map,b=a.getPixelBounds(),a=a.getZoom(),c=this._getTileSize();a>this.options.maxZoom||a<this.options.minZoom||(b=d.bounds(b.min.divideBy(c)._floor(),b.max.divideBy(c)._floor()),this._addTilesFromCenterOut(b),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(b))}},_addTilesFromCenterOut:function(a){var c,
e,g,m=[],n=a.getCenter();for(c=a.min.y;c<=a.max.y;c++)for(e=a.min.x;e<=a.max.x;e++)g=new d.Point(e,c),this._tileShouldBeLoaded(g)&&m.push(g);a=m.length;if(0!==a){m.sort(function(a,b){return a.distanceTo(n)-b.distanceTo(n)});c=b.createDocumentFragment();this._tilesToLoad||this.fire("loading");this._tilesToLoad+=a;for(e=0;a>e;e++)this._addTile(m[e],c);this._tileContainer.appendChild(c)}},_tileShouldBeLoaded:function(a){if(a.x+":"+a.y in this._tiles)return!1;var b=this.options;if(!b.continuousWorld){var c=
this._getWrapTileNum();if(b.noWrap&&(0>a.x||a.x>=c.x)||0>a.y||a.y>=c.y)return!1}return b.bounds&&(c=b.tileSize,a=a.multiplyBy(c),c=a.add([c,c]),a=this._map.unproject(a),c=this._map.unproject(c),b.continuousWorld||b.noWrap||(a=a.wrap(),c=c.wrap()),!b.bounds.intersects([a,c]))?!1:!0},_removeOtherTiles:function(a){var b,c,d;for(d in this._tiles)b=d.split(":"),c=parseInt(b[0],10),b=parseInt(b[1],10),(c<a.min.x||c>a.max.x||b<a.min.y||b>a.max.y)&&this._removeTile(d)},_removeTile:function(a){var b=this._tiles[a];
this.fire("tileunload",{tile:b,url:b.src});this.options.reuseTiles?(d.DomUtil.removeClass(b,"leaflet-tile-loaded"),this._unusedTiles.push(b)):b.parentNode===this._tileContainer&&this._tileContainer.removeChild(b);d.Browser.android||(b.onload=null,b.src=d.Util.emptyImageUrl);delete this._tiles[a]},_addTile:function(a,b){var c=this._getTilePos(a),e=this._getTile();d.DomUtil.setPosition(e,c,d.Browser.chrome);this._tiles[a.x+":"+a.y]=e;this._loadTile(e,a);e.parentNode!==this._tileContainer&&b.appendChild(e)},
_getZoomForUrl:function(){var a=this.options,b=this._map.getZoom();return a.zoomReverse&&(b=a.maxZoom-b),b+=a.zoomOffset,a.maxNativeZoom?Math.min(b,a.maxNativeZoom):b},_getTilePos:function(a){var b=this._map.getPixelOrigin(),c=this._getTileSize();return a.multiplyBy(c).subtract(b)},getTileUrl:function(a){return d.Util.template(this._url,d.extend({s:this._getSubdomain(a),z:a.z,x:a.x,y:a.y},this.options))},_getWrapTileNum:function(){return this._map.options.crs.getSize(this._map.getZoom()).divideBy(this._getTileSize())._floor()},
_adjustTilePoint:function(a){var b=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(a.x=(a.x%b.x+b.x)%b.x);this.options.tms&&(a.y=b.y-a.y-1);a.z=this._getZoomForUrl()},_getSubdomain:function(a){a=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[a]},_getTile:function(){if(this.options.reuseTiles&&0<this._unusedTiles.length){var a=this._unusedTiles.pop();return this._resetTile(a),a}return this._createTile()},_resetTile:function(){},_createTile:function(){var a=
d.DomUtil.create("img","leaflet-tile");return a.style.width=a.style.height=this._getTileSize()+"px",a.galleryimg="no",a.onselectstart=a.onmousemove=d.Util.falseFn,d.Browser.ielt9&&this.options.opacity!==c&&d.DomUtil.setOpacity(a,this.options.opacity),d.Browser.mobileWebkit3d&&(a.style.WebkitBackfaceVisibility="hidden"),a},_loadTile:function(a,b){a._layer=this;a.onload=this._tileOnLoad;a.onerror=this._tileOnError;this._adjustTilePoint(b);a.src=this.getTileUrl(b);this.fire("tileloadstart",{tile:a,url:a.src})},
_tileLoaded:function(){this._tilesToLoad--;this._animated&&d.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated");this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(d.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var a=this._layer;this.src!==d.Util.emptyImageUrl&&(d.DomUtil.addClass(this,"leaflet-tile-loaded"),a.fire("tileload",{tile:this,url:this.src}));a._tileLoaded()},_tileOnError:function(){var a=
this._layer;a.fire("tileerror",{tile:this,url:this.src});var b=a.options.errorTileUrl;b&&(this.src=b);a._tileLoaded()}});d.tileLayer=function(a,b){return new d.TileLayer(a,b)};d.TileLayer.WMS=d.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(a,b){this._url=a;var c=d.extend({},this.defaultWmsParams),e=b.tileSize||this.options.tileSize;c.width=c.height=b.detectRetina&&d.Browser.retina?2*e:
e;for(var g in b)this.options.hasOwnProperty(g)||"crs"===g||(c[g]=b[g]);this.wmsParams=c;d.setOptions(this,b)},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;d.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var b=this._map,c=this.options.tileSize,e=a.multiplyBy(c),c=e.add([c,c]),e=this._crs.project(b.unproject(e,a.z)),b=this._crs.project(b.unproject(c,a.z)),
b=1.3<=this._wmsVersion&&this._crs===d.CRS.EPSG4326?[b.y,e.x,e.y,b.x].join():[e.x,b.y,b.x,e.y].join();a=d.Util.template(this._url,{s:this._getSubdomain(a)});return a+d.Util.getParamString(this.wmsParams,a,!0)+"&BBOX="+b},setParams:function(a,b){return d.extend(this.wmsParams,a),b||this.redraw(),this}});d.tileLayer.wms=function(a,b){return new d.TileLayer.WMS(a,b)};d.TileLayer.Canvas=d.TileLayer.extend({options:{async:!1},initialize:function(a){d.setOptions(this,a)},redraw:function(){this._map&&(this._reset({hard:!0}),
this._update());for(var a in this._tiles)this._redrawTile(this._tiles[a]);return this},_redrawTile:function(a){this.drawTile(a,a._tilePoint,this._map._zoom)},_createTile:function(){var a=d.DomUtil.create("canvas","leaflet-tile");return a.width=a.height=this.options.tileSize,a.onselectstart=a.onmousemove=d.Util.falseFn,a},_loadTile:function(a,b){a._layer=this;a._tilePoint=b;this._redrawTile(a);this.options.async||this.tileDrawn(a)},drawTile:function(){},tileDrawn:function(a){this._tileOnLoad.call(a)}});
d.tileLayer.canvas=function(a){return new d.TileLayer.Canvas(a)};d.ImageOverlay=d.Class.extend({includes:d.Mixin.Events,options:{opacity:1},initialize:function(a,b,c){this._url=a;this._bounds=d.latLngBounds(b);d.setOptions(this,c)},onAdd:function(a){this._map=a;this._image||this._initImage();a._panes.overlayPane.appendChild(this._image);a.on("viewreset",this._reset,this);a.options.zoomAnimation&&d.Browser.any3d&&a.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(a){a.getPanes().overlayPane.removeChild(this._image);
a.off("viewreset",this._reset,this);a.options.zoomAnimation&&a.off("zoomanim",this._animateZoom,this)},addTo:function(a){return a.addLayer(this),this},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var a=this._map._panes.overlayPane;return this._image&&a.insertBefore(this._image,a.firstChild),this},setUrl:function(a){this._url=a;this._image.src=
this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=d.DomUtil.create("img","leaflet-image-layer");this._map.options.zoomAnimation&&d.Browser.any3d?d.DomUtil.addClass(this._image,"leaflet-zoom-animated"):d.DomUtil.addClass(this._image,"leaflet-zoom-hide");this._updateOpacity();d.extend(this._image,{galleryimg:"no",onselectstart:d.Util.falseFn,onmousemove:d.Util.falseFn,onload:d.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(a){var b=
this._map,c=this._image,e=b.getZoomScale(a.zoom),g=this._bounds.getNorthWest(),n=this._bounds.getSouthEast(),g=b._latLngToNewLayerPoint(g,a.zoom,a.center);a=b._latLngToNewLayerPoint(n,a.zoom,a.center)._subtract(g);a=g._add(a._multiplyBy(0.5*(1-1/e)));c.style[d.DomUtil.TRANSFORM]=d.DomUtil.getTranslateString(a)+" scale("+e+") "},_reset:function(){var a=this._image,b=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),c=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(b);d.DomUtil.setPosition(a,
b);a.style.width=c.x+"px";a.style.height=c.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){d.DomUtil.setOpacity(this._image,this.options.opacity)}});d.imageOverlay=function(a,b,c){return new d.ImageOverlay(a,b,c)};d.Icon=d.Class.extend({options:{className:""},initialize:function(a){d.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);
if(!c){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}var d;return d=b&&"IMG"===b.tagName?this._createImg(c,b):this._createImg(c),this._setIconStyles(d,a),d},_setIconStyles:function(a,b){var c,e=this.options,g=d.point(e[b+"Size"]);c=d.point("shadow"===b?e.shadowAnchor||e.iconAnchor:e.iconAnchor);!c&&g&&(c=g.divideBy(2,!0));a.className="leaflet-marker-"+b+" "+e.className;c&&(a.style.marginLeft=-c.x+"px",a.style.marginTop=-c.y+"px");g&&(a.style.width=g.x+"px",
a.style.height=g.y+"px")},_createImg:function(a,c){return c=c||b.createElement("img"),c.src=a,c},_getIconUrl:function(a){return d.Browser.retina&&this.options[a+"RetinaUrl"]?this.options[a+"RetinaUrl"]:this.options[a+"Url"]}});d.icon=function(a){return new d.Icon(a)};d.Icon.Default=d.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(a){var b=a+"Url";if(this.options[b])return this.options[b];d.Browser.retina&&"icon"===a&&(a+="-2x");
b=d.Icon.Default.imagePath;if(!b)throw Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return b+"/marker-"+a+".png"}});d.Icon.Default.imagePath=function(){var a,c,d,e,g=b.getElementsByTagName("script"),n=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;a=0;for(c=g.length;c>a;a++)if(d=g[a].src,d.match(n))return e=d.split(n)[0],(e?e+"/":"")+"images"}();d.Marker=d.Class.extend({includes:d.Mixin.Events,options:{icon:new d.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,
zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(a,b){d.setOptions(this,b);this._latlng=d.latLng(a)},onAdd:function(a){this._map=a;a.on("viewreset",this.update,this);this._initIcon();this.update();this.fire("add");a.options.zoomAnimation&&a.options.markerZoomAnimation&&a.on("zoomanim",this._animateZoom,this)},addTo:function(a){return a.addLayer(this),this},onRemove:function(a){this.dragging&&this.dragging.disable();this._removeIcon();this._removeShadow();this.fire("remove");
a.off({viewreset:this.update,zoomanim:this._animateZoom},this);this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=d.latLng(a),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update(),this},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var a=this._map.latLngToLayerPoint(this._latlng).round();
this._setPos(a)}return this},_initIcon:function(){var a=this.options,b=this._map,c=b.options.zoomAnimation&&b.options.markerZoomAnimation?"leaflet-zoom-animated":"leaflet-zoom-hide",e=a.icon.createIcon(this._icon),b=!1;e!==this._icon&&(this._icon&&this._removeIcon(),b=!0,a.title&&(e.title=a.title),a.alt&&(e.alt=a.alt));d.DomUtil.addClass(e,c);a.keyboard&&(e.tabIndex="0");this._icon=e;this._initInteraction();a.riseOnHover&&d.DomEvent.on(e,"mouseover",this._bringToFront,this).on(e,"mouseout",this._resetZIndex,
this);var e=a.icon.createShadow(this._shadow),g=!1;e!==this._shadow&&(this._removeShadow(),g=!0);e&&d.DomUtil.addClass(e,c);this._shadow=e;1>a.opacity&&this._updateOpacity();a=this._map._panes;b&&a.markerPane.appendChild(this._icon);e&&g&&a.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&d.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex);this._map._panes.markerPane.removeChild(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&
this._map._panes.shadowPane.removeChild(this._shadow);this._shadow=null},_setPos:function(a){d.DomUtil.setPosition(this._icon,a);this._shadow&&d.DomUtil.setPosition(this._shadow,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.clickable){var a=this._icon,b=["dblclick",
"mousedown","mouseover","mouseout","contextmenu"];d.DomUtil.addClass(a,"leaflet-clickable");d.DomEvent.on(a,"click",this._onMouseClick,this);d.DomEvent.on(a,"keypress",this._onKeyPress,this);for(var c=0;c<b.length;c++)d.DomEvent.on(a,b[c],this._fireMouseEvent,this);d.Handler.MarkerDrag&&(this.dragging=new d.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(a){var b=this.dragging&&this.dragging.moved();(this.hasEventListeners(a.type)||b)&&d.DomEvent.stopPropagation(a);
b||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(a.type,{originalEvent:a,latlng:this._latlng})},_onKeyPress:function(a){13===a.keyCode&&this.fire("click",{originalEvent:a,latlng:this._latlng})},_fireMouseEvent:function(a){this.fire(a.type,{originalEvent:a,latlng:this._latlng});"contextmenu"===a.type&&this.hasEventListeners(a.type)&&d.DomEvent.preventDefault(a);"mousedown"!==a.type?d.DomEvent.stopPropagation(a):d.DomEvent.preventDefault(a)},setOpacity:function(a){return this.options.opacity=
a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){d.DomUtil.setOpacity(this._icon,this.options.opacity);this._shadow&&d.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}});d.marker=function(a,b){return new d.Marker(a,b)};d.DivIcon=d.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(a){a=a&&"DIV"===a.tagName?a:b.createElement("div");
var c=this.options;return a.innerHTML=!1!==c.html?c.html:"",c.bgPos&&(a.style.backgroundPosition=-c.bgPos.x+"px "+-c.bgPos.y+"px"),this._setIconStyles(a,"icon"),a},createShadow:function(){return null}});d.divIcon=function(a){return new d.DivIcon(a)};d.Map.mergeOptions({closePopupOnClick:!0});d.Popup=d.Class.extend({includes:d.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(a,
b){d.setOptions(this,a);this._source=b;this._animated=d.Browser.any3d&&this.options.zoomAnimation;this._isOpen=!1},onAdd:function(a){this._map=a;this._container||this._initLayout();var b=a.options.fadeAnimation;b&&d.DomUtil.setOpacity(this._container,0);a._panes.popupPane.appendChild(this._container);a.on(this._getEvents(),this);this.update();b&&d.DomUtil.setOpacity(this._container,1);this.fire("open");a.fire("popupopen",{popup:this});this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(a){return a.addLayer(this),
this},openOn:function(a){return a.openPopup(this),this},onRemove:function(a){a._panes.popupPane.removeChild(this._container);d.Util.falseFn(this._container.offsetWidth);a.off(this._getEvents(),this);a.options.fadeAnimation&&d.DomUtil.setOpacity(this._container,0);this._map=null;this.fire("close");a.fire("popupclose",{popup:this});this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=d.latLng(a),this._map&&(this._updatePosition(),
this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var a={viewreset:this._updatePosition};return this._animated&&(a.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:
this._map.options.closePopupOnClick)&&(a.preclick=this._close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a,b=this._container=d.DomUtil.create("div","leaflet-popup "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"));this.options.closeButton&&(a=this._closeButton=d.DomUtil.create("a","leaflet-popup-close-button",b),a.href="#close",a.innerHTML="&#215;",d.DomEvent.disableClickPropagation(a),
d.DomEvent.on(a,"click",this._onCloseButtonClick,this));a=this._wrapper=d.DomUtil.create("div","leaflet-popup-content-wrapper",b);d.DomEvent.disableClickPropagation(a);this._contentNode=d.DomUtil.create("div","leaflet-popup-content",a);d.DomEvent.disableScrollPropagation(this._contentNode);d.DomEvent.on(a,"contextmenu",d.DomEvent.stopPropagation);this._tipContainer=d.DomUtil.create("div","leaflet-popup-tip-container",b);this._tip=d.DomUtil.create("div","leaflet-popup-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==
typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var a=this._contentNode,b=a.style;b.width="";b.whiteSpace="nowrap";var c=a.offsetWidth,c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth);b.width=c+1+"px";b.whiteSpace="";b.height="";var c=a.offsetHeight,e=this.options.maxHeight;
e&&c>e?(b.height=e+"px",d.DomUtil.addClass(a,"leaflet-popup-scrolled")):d.DomUtil.removeClass(a,"leaflet-popup-scrolled");this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),b=this._animated,c=d.point(this.options.offset);b&&d.DomUtil.setPosition(this._container,a);this._containerBottom=-c.y-(b?0:a.y);this._containerLeft=-Math.round(this._containerWidth/2)+c.x+(b?0:a.x);this._container.style.bottom=this._containerBottom+
"px";this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);d.DomUtil.setPosition(this._container,a)},_adjustPan:function(){if(this.options.autoPan){var a=this._map,b=this._container.offsetHeight,c=this._containerWidth,e=new d.Point(this._containerLeft,-b-this._containerBottom);this._animated&&e._add(d.DomUtil.getPosition(this._container));var e=a.layerPointToContainerPoint(e),g=d.point(this.options.autoPanPadding),
n=d.point(this.options.autoPanPaddingTopLeft||g),g=d.point(this.options.autoPanPaddingBottomRight||g),r=a.getSize(),p=0,t=0;e.x+c+g.x>r.x&&(p=e.x+c-r.x+g.x);0>e.x-p-n.x&&(p=e.x-n.x);e.y+b+g.y>r.y&&(t=e.y+b-r.y+g.y);0>e.y-t-n.y&&(t=e.y-n.y);(p||t)&&a.fire("autopanstart").panBy([p,t])}},_onCloseButtonClick:function(a){this._close();d.DomEvent.stop(a)}});d.popup=function(a,b){return new d.Popup(a,b)};d.Map.include({openPopup:function(a,b,c){(this.closePopup(),a instanceof d.Popup)||(a=(new d.Popup(c)).setLatLng(b).setContent(a));
return a._isOpen=!0,this._popup=a,this.addLayer(a)},closePopup:function(a){return a&&a!==this._popup||(a=this._popup,this._popup=null),a&&(this.removeLayer(a),a._isOpen=!1),this}});d.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():
this.openPopup()),this},bindPopup:function(a,b){var c=d.point(this.options.icon.options.popupAnchor||[0,0]);return c=c.add(d.Popup.prototype.options.offset),b&&b.offset&&(c=c.add(b.offset)),b=d.extend({offset:c},b),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),a instanceof d.Popup?(d.setOptions(a,b),this._popup=a):this._popup=(new d.Popup(b,this)).setContent(a),this},setPopupContent:function(a){return this._popup&&
this._popup.setContent(a),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(a){this._popup.setLatLng(a.latlng)}});d.LayerGroup=d.Class.extend({initialize:function(a){this._layers={};var b,c;if(a)for(b=0,c=a.length;c>b;b++)this.addLayer(a[b])},addLayer:function(a){var b=this.getLayerId(a);
return this._layers[b]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){a=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]),delete this._layers[a],this},hasLayer:function(a){return a?a in this._layers||this.getLayerId(a)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(a){var b,c,d=Array.prototype.slice.call(arguments,1);for(b in this._layers)c=this._layers[b],
c[a]&&c[a].apply(c,d);return this},onAdd:function(a){this._map=a;this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a);this._map=null},addTo:function(a){return a.addLayer(this),this},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[],b;for(b in this._layers)a.push(this._layers[b]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return d.stamp(a)}});
d.layerGroup=function(a){return new d.LayerGroup(a)};d.FeatureGroup=d.LayerGroup.extend({includes:d.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(a){return this.hasLayer(a)?this:("on"in a&&a.on(d.FeatureGroup.EVENTS,this._propagateEvent,this),d.LayerGroup.prototype.addLayer.call(this,a),this._popupContent&&a.bindPopup&&a.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?
(a in this._layers&&(a=this._layers[a]),a.off(d.FeatureGroup.EVENTS,this._propagateEvent,this),d.LayerGroup.prototype.removeLayer.call(this,a),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:a})):this},bindPopup:function(a,b){return this._popupContent=a,this._popupOptions=b,this.invoke("bindPopup",a,b)},openPopup:function(a){for(var b in this._layers){this._layers[b].openPopup(a);break}return this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},
bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new d.LatLngBounds;return this.eachLayer(function(b){a.extend(b instanceof d.Marker?b.getLatLng():b.getBounds())}),a},_propagateEvent:function(a){a=d.extend({layer:a.target,target:this},a);this.fire(a.type,a)}});d.featureGroup=function(a){return new d.FeatureGroup(a)};d.Path=d.Class.extend({includes:[d.Mixin.Events],statics:{CLIP_PADDING:function(){var b=((d.Browser.mobile?1280:2E3)/Math.max(a.outerWidth,a.outerHeight)-
1)/2;return Math.max(0,Math.min(0.5,b))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:0.5,fill:!1,fillColor:null,fillOpacity:0.2,clickable:!0},initialize:function(a){d.setOptions(this,a)},onAdd:function(a){this._map=a;this._container||(this._initElements(),this._initEvents());this.projectLatlngs();this._updatePath();this._container&&this._map._pathRoot.appendChild(this._container);this.fire("add");a.on({viewreset:this.projectLatlngs,moveend:this._updatePath},
this)},addTo:function(a){return a.addLayer(this),this},onRemove:function(a){a._pathRoot.removeChild(this._container);this.fire("remove");this._map=null;d.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null);a.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(a){return d.setOptions(this,a),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}});
d.Map.include({_updatePathViewport:function(){var a=d.Path.CLIP_PADDING,b=this.getSize(),c=d.DomUtil.getPosition(this._mapPane).multiplyBy(-1)._subtract(b.multiplyBy(a)._round()),a=c.add(b.multiplyBy(1+2*a)._round());this._pathViewport=new d.Bounds(c,a)}});d.Path.SVG_NS="http://www.w3.org/2000/svg";d.Browser.svg=!(!b.createElementNS||!b.createElementNS(d.Path.SVG_NS,"svg").createSVGRect);d.Path=d.Path.extend({statics:{SVG:d.Browser.svg},bringToFront:function(){var a=this._map._pathRoot,b=this._container;
return b&&a.lastChild!==b&&a.appendChild(b),this},bringToBack:function(){var a=this._map._pathRoot,b=this._container,c=a.firstChild;return b&&c!==b&&a.insertBefore(b,c),this},getPathString:function(){},_createElement:function(a){return b.createElementNS(d.Path.SVG_NS,a)},_initElements:function(){this._map._initPathRoot();this._initPath();this._initStyle()},_initPath:function(){this._container=this._createElement("g");this._path=this._createElement("path");this.options.className&&d.DomUtil.addClass(this._path,
this.options.className);this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round"));this.options.fill&&this._path.setAttribute("fill-rule","evenodd");this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents);this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none");this._updateStyle()},_updateStyle:function(){this.options.stroke?
(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke",
"none");this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var a=this.getPathString();a||(a="M0 0");this._path.setAttribute("d",a)},_initEvents:function(){if(this.options.clickable){!d.Browser.svg&&d.Browser.vml||d.DomUtil.addClass(this._path,"leaflet-clickable");d.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var a=
"dblclick mousedown mouseover mouseout mousemove contextmenu".split(" "),b=0;b<a.length;b++)d.DomEvent.on(this._container,a[b],this._fireMouseEvent,this)}},_onMouseClick:function(a){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(a)},_fireMouseEvent:function(a){if(this.hasEventListeners(a.type)){var b=this._map,c=b.mouseEventToContainerPoint(a),e=b.containerPointToLayerPoint(c),b=b.layerPointToLatLng(e);this.fire(a.type,{latlng:b,layerPoint:e,containerPoint:c,originalEvent:a});
"contextmenu"===a.type&&d.DomEvent.preventDefault(a);"mousemove"!==a.type&&d.DomEvent.stopPropagation(a)}}});d.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=d.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&d.Browser.any3d?(d.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):d.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",
this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(a){var b=this.getZoomScale(a.zoom);a=this._getCenterOffset(a.center)._multiplyBy(-b)._add(this._pathViewport.min);this._pathRoot.style[d.DomUtil.TRANSFORM]=d.DomUtil.getTranslateString(a)+" scale("+b+") ";this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var a=this._pathViewport,b=a.min,c=a.max,a=c.x-b.x,c=c.y-b.y,e=this._pathRoot,
g=this._panes.overlayPane;d.Browser.mobileWebkit&&g.removeChild(e);d.DomUtil.setPosition(e,b);e.setAttribute("width",a);e.setAttribute("height",c);e.setAttribute("viewBox",[b.x,b.y,a,c].join(" "));d.Browser.mobileWebkit&&g.appendChild(e)}}});d.Path.include({bindPopup:function(a,b){return a instanceof d.Popup?this._popup=a:((!this._popup||b)&&(this._popup=new d.Popup(b,this)),this._popup.setContent(a)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),
this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(a){return this._popup&&(a=a||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:a})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(a){this._popup.setLatLng(a.latlng);this._map.openPopup(this._popup)}});
d.Browser.vml=!d.Browser.svg&&function(){try{var a=b.createElement("div");a.innerHTML='<v:shape adj="1"/>';var c=a.firstChild;return c.style.behavior="url(#default#VML)",c&&"object"==typeof c.adj}catch(d){return!1}}();d.Path=d.Browser.svg||!d.Browser.vml?d.Path:d.Path.extend({statics:{VML:!0,CLIP_PADDING:0.02},_createElement:function(){try{return b.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return b.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return b.createElement("<"+
a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var a=this._container=this._createElement("shape");d.DomUtil.addClass(a,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:""));this.options.clickable&&d.DomUtil.addClass(a,"leaflet-clickable");a.coordsize="1 1";this._path=this._createElement("path");a.appendChild(this._path);this._map._pathRoot.appendChild(a)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var a=this._stroke,
b=this._fill,c=this.options,e=this._container;e.stroked=c.stroke;e.filled=c.fill;c.stroke?(a||(a=this._stroke=this._createElement("stroke"),a.endcap="round",e.appendChild(a)),a.weight=c.weight+"px",a.color=c.color,a.opacity=c.opacity,a.dashStyle=c.dashArray?d.Util.isArray(c.dashArray)?c.dashArray.join(" "):c.dashArray.replace(/( *, *)/g," "):"",c.lineCap&&(a.endcap=c.lineCap.replace("butt","flat")),c.lineJoin&&(a.joinstyle=c.lineJoin)):a&&(e.removeChild(a),this._stroke=null);c.fill?(b||(b=this._fill=
this._createElement("fill"),e.appendChild(b)),b.color=c.fillColor||c.color,b.opacity=c.fillOpacity):b&&(e.removeChild(b),this._fill=null)},_updatePath:function(){var a=this._container.style;a.display="none";this._path.v=this.getPathString()+" ";a.display=""}});d.Map.include(d.Browser.svg||!d.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var a=this._pathRoot=b.createElement("div");a.className="leaflet-vml-container";this._panes.overlayPane.appendChild(a);this.on("moveend",this._updatePathViewport);
this._updatePathViewport()}}});d.Browser.canvas=!!b.createElement("canvas").getContext;d.Path=d.Path.SVG&&!a.L_PREFER_CANVAS||!d.Browser.canvas?d.Path:d.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(a){return d.setOptions(this,a),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(a){a.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this);this.options.clickable&&
(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this));this._requestUpdate();this._map=null},_requestUpdate:function(){this._map&&!d.Path._updateRequest&&(d.Path._updateRequest=d.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){d.Path._updateRequest=null;this.fire("moveend")},_initElements:function(){this._map._initPathRoot();this._ctx=this._map._canvasCtx},_updateStyle:function(){var a=this.options;a.stroke&&(this._ctx.lineWidth=
a.weight,this._ctx.strokeStyle=a.color);a.fill&&(this._ctx.fillStyle=a.fillColor||a.color)},_drawPath:function(){var a,b,c,e,g,n;this._ctx.beginPath();a=0;for(c=this._parts.length;c>a;a++){b=0;for(e=this._parts[a].length;e>b;b++)g=this._parts[a][b],n=(0===b?"move":"line")+"To",this._ctx[n](g.x,g.y);this instanceof d.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var a=this._ctx,b=this.options;this._drawPath();a.save();
this._updateStyle();b.fill&&(a.globalAlpha=b.fillOpacity,a.fill());b.stroke&&(a.globalAlpha=b.opacity,a.stroke());a.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this))},_onClick:function(a){this._containsPoint(a.layerPoint)&&this.fire("click",a)},_onMouseMove:function(a){this._map&&!this._map._animatingZoom&&(this._containsPoint(a.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=
!0,this.fire("mouseover",a)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",a)))}});d.Map.include(d.Path.SVG&&!a.L_PREFER_CANVAS||!d.Browser.canvas?{}:{_initPathRoot:function(){var a,c=this._pathRoot;c||(c=this._pathRoot=b.createElement("canvas"),c.style.position="absolute",a=this._canvasCtx=c.getContext("2d"),a.lineCap="round",a.lineJoin="round",this._panes.overlayPane.appendChild(c),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",
this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var a=this._pathViewport,b=a.min,a=a.max.subtract(b),c=this._pathRoot;d.DomUtil.setPosition(c,b);c.width=a.x;c.height=a.y;c.getContext("2d").translate(-b.x,-b.y)}}});d.LineUtil={simplify:function(a,b){if(!b||!a.length)return a.slice();var c=b*b;return a=this._reducePoints(a,
c),this._simplifyDP(a,c)},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqClosestPointOnSegment(a,b,c,!0))},closestPointOnSegment:function(a,b,c){return this._sqClosestPointOnSegment(a,b,c)},_simplifyDP:function(a,b){var d=a.length,e=new (typeof Uint8Array!=c+""?Uint8Array:Array)(d);e[0]=e[d-1]=1;this._simplifyDPStep(a,e,b,0,d-1);var g,n=[];for(g=0;d>g;g++)e[g]&&n.push(a[g]);return n},_simplifyDPStep:function(a,b,c,d,e){var g,r,p,t=0;for(r=d+1;e-1>=r;r++)p=this._sqClosestPointOnSegment(a[r],
a[d],a[e],!0),p>t&&(g=r,t=p);t>c&&(b[g]=1,this._simplifyDPStep(a,b,c,d,g),this._simplifyDPStep(a,b,c,g,e))},_reducePoints:function(a,b){for(var c=[a[0]],d=1,e=0,g=a.length;g>d;d++)this._sqDist(a[d],a[e])>b&&(c.push(a[d]),e=d);return g-1>e&&c.push(a[g-1]),c},clipSegment:function(a,b,c,d){var e,g,r=d?this._lastCode:this._getBitCode(a,c),p=this._getBitCode(b,c);for(this._lastCode=p;;){if(!(r|p))return[a,b];if(r&p)return!1;d=r||p;e=this._getEdgeIntersection(a,b,d,c);g=this._getBitCode(e,c);d===r?(a=e,
r=g):(b=e,p=g)}},_getEdgeIntersection:function(a,b,c,e){var g=b.x-a.x;b=b.y-a.y;var n=e.min;e=e.max;return 8&c?new d.Point(a.x+g*(e.y-a.y)/b,e.y):4&c?new d.Point(a.x+g*(n.y-a.y)/b,n.y):2&c?new d.Point(e.x,a.y+b*(e.x-a.x)/g):1&c?new d.Point(n.x,a.y+b*(n.x-a.x)/g):void 0},_getBitCode:function(a,b){var c=0;return a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2),a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8),c},_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d},_sqClosestPointOnSegment:function(a,b,c,e){var g,n=
b.x;b=b.y;var r=c.x-n,p=c.y-b,t=r*r+p*p;return 0<t&&(g=((a.x-n)*r+(a.y-b)*p)/t,1<g?(n=c.x,b=c.y):0<g&&(n+=r*g,b+=p*g)),r=a.x-n,p=a.y-b,e?r*r+p*p:new d.Point(n,b)}};d.Polyline=d.Path.extend({initialize:function(a,b){d.Path.prototype.initialize.call(this,b);this._latlngs=this._convertLatLngs(a)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var a=0,b=this._latlngs.length;b>a;a++)this._originalPoints[a]=this._map.latLngToLayerPoint(this._latlngs[a])},getPathString:function(){for(var a=
0,b=this._parts.length,c="";b>a;a++)c+=this._getPathPartStr(this._parts[a]);return c},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._latlngs=this._convertLatLngs(a),this.redraw()},addLatLng:function(a){return this._latlngs.push(d.latLng(a)),this.redraw()},spliceLatLngs:function(){var a=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),a},closestLayerPoint:function(a){for(var b,c,e=1/0,g=this._parts,n=null,r=0,p=g.length;p>
r;r++)for(var t=g[r],s=1,u=t.length;u>s;s++){b=t[s-1];c=t[s];var v=d.LineUtil._sqClosestPointOnSegment(a,b,c,!0);e>v&&(e=v,n=d.LineUtil._sqClosestPointOnSegment(a,b,c))}return n&&(n.distance=Math.sqrt(e)),n},getBounds:function(){return new d.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(a,b){var c,e,g=b?a:[];c=0;for(e=a.length;e>c;c++){if(d.Util.isArray(a[c])&&"number"!=typeof a[c][0])return;g[c]=d.latLng(a[c])}return g},_initEvents:function(){d.Path.prototype._initEvents.call(this)},
_getPathPartStr:function(a){for(var b,c=d.Path.VML,e=0,g=a.length,n="";g>e;e++)b=a[e],c&&b._round(),n+=(e?"L":"M")+b.x+" "+b.y;return n},_clipPoints:function(){var a,b,c,e=this._originalPoints,g=e.length;if(this.options.noClip)return void(this._parts=[e]);var n=this._parts=[],r=this._map._pathViewport,p=d.LineUtil;for(b=a=0;g-1>a;a++)(c=p.clipSegment(e[a],e[a+1],r,a))&&(n[b]=n[b]||[],n[b].push(c[0]),(c[1]!==e[a+1]||a===g-2)&&(n[b].push(c[1]),b++))},_simplifyPoints:function(){for(var a=this._parts,
b=d.LineUtil,c=0,e=a.length;e>c;c++)a[c]=b.simplify(a[c],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),d.Path.prototype._updatePath.call(this))}});d.polyline=function(a,b){return new d.Polyline(a,b)};d.PolyUtil={};d.PolyUtil.clipPolygon=function(a,b){var c,e,g,n,r,p,t,s,u=[1,4,2,8],v=d.LineUtil;e=0;for(p=a.length;p>e;e++)a[e]._code=v._getBitCode(a[e],b);for(n=0;4>n;n++){t=u[n];c=[];e=0;p=a.length;for(g=p-1;p>e;g=e++)r=a[e],g=a[g],r._code&
t?g._code&t||(s=v._getEdgeIntersection(g,r,t,b),s._code=v._getBitCode(s,b),c.push(s)):(g._code&t&&(s=v._getEdgeIntersection(g,r,t,b),s._code=v._getBitCode(s,b),c.push(s)),c.push(r));a=c}return a};d.Polygon=d.Polyline.extend({options:{fill:!0},initialize:function(a,b){d.Polyline.prototype.initialize.call(this,a,b);this._initWithHoles(a)},_initWithHoles:function(a){var b,c;if(a&&d.Util.isArray(a[0])&&"number"!=typeof a[0][0])for(this._latlngs=this._convertLatLngs(a[0]),this._holes=a.slice(1),a=0,b=
this._holes.length;b>a;a++)c=this._holes[a]=this._convertLatLngs(this._holes[a]),c[0].equals(c[c.length-1])&&c.pop();a=this._latlngs;2<=a.length&&a[0].equals(a[a.length-1])&&a.pop()},projectLatlngs:function(){if(d.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var a,b,c,e;a=0;for(c=this._holes.length;c>a;a++)for(this._holePoints[a]=[],b=0,e=this._holes[a].length;e>b;b++)this._holePoints[a][b]=this._map.latLngToLayerPoint(this._holes[a][b])}},setLatLngs:function(a){return a&&
d.Util.isArray(a[0])&&"number"!=typeof a[0][0]?(this._initWithHoles(a),this.redraw()):d.Polyline.prototype.setLatLngs.call(this,a)},_clipPoints:function(){var a=[];if(this._parts=[this._originalPoints].concat(this._holePoints),!this.options.noClip){for(var b=0,c=this._parts.length;c>b;b++){var e=d.PolyUtil.clipPolygon(this._parts[b],this._map._pathViewport);e.length&&a.push(e)}this._parts=a}},_getPathPartStr:function(a){return d.Polyline.prototype._getPathPartStr.call(this,a)+(d.Browser.svg?"z":"x")}});
d.polygon=function(a,b){return new d.Polygon(a,b)};(function(){function a(b){return d.FeatureGroup.extend({initialize:function(a,b){this._layers={};this._options=b;this.setLatLngs(a)},setLatLngs:function(a){var c=0,d=a.length;for(this.eachLayer(function(b){d>c?b.setLatLngs(a[c++]):this.removeLayer(b)},this);d>c;)this.addLayer(new b(a[c++],this._options));return this},getLatLngs:function(){var a=[];return this.eachLayer(function(b){a.push(b.getLatLngs())}),a}})}d.MultiPolyline=a(d.Polyline);d.MultiPolygon=
a(d.Polygon);d.multiPolyline=function(a,b){return new d.MultiPolyline(a,b)};d.multiPolygon=function(a,b){return new d.MultiPolygon(a,b)}})();d.Rectangle=d.Polygon.extend({initialize:function(a,b){d.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),b)},setBounds:function(a){this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=d.latLngBounds(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});d.rectangle=function(a,b){return new d.Rectangle(a,
b)};d.Circle=d.Path.extend({initialize:function(a,b,c){d.Path.prototype.initialize.call(this,c);this._latlng=d.latLng(a);this._mRadius=b},options:{fill:!0},setLatLng:function(a){return this._latlng=d.latLng(a),this.redraw()},setRadius:function(a){return this._mRadius=a,this.redraw()},projectLatlngs:function(){var a=this._getLngRadius(),b=this._latlng,a=this._map.latLngToLayerPoint([b.lat,b.lng-a]);this._point=this._map.latLngToLayerPoint(b);this._radius=Math.max(this._point.x-a.x,1)},getBounds:function(){var a=
this._getLngRadius(),b=this._mRadius/40075017*360,c=this._latlng;return new d.LatLngBounds([c.lat-b,c.lng-a],[c.lat+b,c.lng+a])},getLatLng:function(){return this._latlng},getPathString:function(){var a=this._point,b=this._radius;return this._checkIfEmpty()?"":d.Browser.svg?"M"+a.x+","+(a.y-b)+"A"+b+","+b+",0,1,1,"+(a.x-0.1)+","+(a.y-b)+" z":(a._round(),b=Math.round(b),"AL "+a.x+","+a.y+" "+b+","+b+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/
40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(d.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var a=this._map._pathViewport,b=this._radius,c=this._point;return c.x-b>a.max.x||c.y-b>a.max.y||c.x+b<a.min.x||c.y+b<a.min.y}});d.circle=function(a,b,c){return new d.Circle(a,b,c)};d.CircleMarker=d.Circle.extend({options:{radius:10,weight:2},initialize:function(a,b){d.Circle.prototype.initialize.call(this,a,null,b);this._radius=this.options.radius},
projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){d.Circle.prototype._updateStyle.call(this);this.setRadius(this.options.radius)},setLatLng:function(a){return d.Circle.prototype.setLatLng.call(this,a),this._popup&&this._popup._isOpen&&this._popup.setLatLng(a),this},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius}});d.circleMarker=function(a,b){return new d.CircleMarker(a,
b)};d.Polyline.include(d.Path.CANVAS?{_containsPoint:function(a,b){var c,e,g,n,r,p,t,s=this.options.weight/2;d.Browser.touch&&(s+=10);c=0;for(n=this._parts.length;n>c;c++)for(t=this._parts[c],e=0,r=t.length,g=r-1;r>e;g=e++)if((b||0!==e)&&(p=d.LineUtil.pointToSegmentDistance(a,t[g],t[e]),s>=p))return!0;return!1}}:{});d.Polygon.include(d.Path.CANVAS?{_containsPoint:function(a){var b,c,e,g,n,r,p,t=!1;if(d.Polyline.prototype._containsPoint.call(this,a,!0))return!0;g=0;for(r=this._parts.length;r>g;g++)for(b=
this._parts[g],n=0,p=b.length,e=p-1;p>n;e=n++)c=b[n],e=b[e],c.y>a.y!=e.y>a.y&&a.x<(e.x-c.x)*(a.y-c.y)/(e.y-c.y)+c.x&&(t=!t);return t}}:{});d.Circle.include(d.Path.CANVAS?{_drawPath:function(){var a=this._point;this._ctx.beginPath();this._ctx.arc(a.x,a.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(a){var b=this.options.stroke?this.options.weight/2:0;return a.distanceTo(this._point)<=this._radius+b}}:{});d.CircleMarker.include(d.Path.CANVAS?{_updateStyle:function(){d.Path.prototype._updateStyle.call(this)}}:
{});d.GeoJSON=d.FeatureGroup.extend({initialize:function(a,b){d.setOptions(this,b);this._layers={};a&&this.addData(a)},addData:function(a){var b,c,e=d.Util.isArray(a)?a:a.features;if(e){a=0;for(b=e.length;b>a;a++)c=e[a],(c.geometries||c.geometry||c.features||c.coordinates)&&this.addData(e[a]);return this}e=this.options;if(!e.filter||e.filter(a))return b=d.GeoJSON.geometryToLayer(a,e.pointToLayer,e.coordsToLatLng,e),b.feature=d.GeoJSON.asFeature(a),b.defaultOptions=b.options,this.resetStyle(b),e.onEachFeature&&
e.onEachFeature(a,b),this.addLayer(b)},resetStyle:function(a){var b=this.options.style;b&&(d.Util.extend(a.options,a.defaultOptions),this._setLayerStyle(a,b))},setStyle:function(a){this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){"function"==typeof b&&(b=b(a.feature));a.setStyle&&a.setStyle(b)}});d.extend(d.GeoJSON,{geometryToLayer:function(a,b,c,e){var g,n,r,p="Feature"===a.type?a.geometry:a,t=p.coordinates,s=[];switch(c=c||this.coordsToLatLng,p.type){case "Point":return g=
c(t),b?b(a,g):new d.Marker(g);case "MultiPoint":n=0;for(r=t.length;r>n;n++)g=c(t[n]),s.push(b?b(a,g):new d.Marker(g));return new d.FeatureGroup(s);case "LineString":return n=this.coordsToLatLngs(t,0,c),new d.Polyline(n,e);case "Polygon":if(2===t.length&&!t[1].length)throw Error("Invalid GeoJSON object.");return n=this.coordsToLatLngs(t,1,c),new d.Polygon(n,e);case "MultiLineString":return n=this.coordsToLatLngs(t,1,c),new d.MultiPolyline(n,e);case "MultiPolygon":return n=this.coordsToLatLngs(t,2,
c),new d.MultiPolygon(n,e);case "GeometryCollection":n=0;for(r=p.geometries.length;r>n;n++)s.push(this.geometryToLayer({geometry:p.geometries[n],type:"Feature",properties:a.properties},b,c,e));return new d.FeatureGroup(s);default:throw Error("Invalid GeoJSON object.");}},coordsToLatLng:function(a){return new d.LatLng(a[1],a[0],a[2])},coordsToLatLngs:function(a,b,c){var d,e,g,r=[];e=0;for(g=a.length;g>e;e++)d=b?this.coordsToLatLngs(a[e],b-1,c):(c||this.coordsToLatLng)(a[e]),r.push(d);return r},latLngToCoords:function(a){var b=
[a.lng,a.lat];return a.alt!==c&&b.push(a.alt),b},latLngsToCoords:function(a){for(var b=[],c=0,e=a.length;e>c;c++)b.push(d.GeoJSON.latLngToCoords(a[c]));return b},getFeature:function(a,b){return a.feature?d.extend({},a.feature,{geometry:b}):d.GeoJSON.asFeature(b)},asFeature:function(a){return"Feature"===a.type?a:{type:"Feature",properties:{},geometry:a}}});var g={toGeoJSON:function(){return d.GeoJSON.getFeature(this,{type:"Point",coordinates:d.GeoJSON.latLngToCoords(this.getLatLng())})}};d.Marker.include(g);
d.Circle.include(g);d.CircleMarker.include(g);d.Polyline.include({toGeoJSON:function(){return d.GeoJSON.getFeature(this,{type:"LineString",coordinates:d.GeoJSON.latLngsToCoords(this.getLatLngs())})}});d.Polygon.include({toGeoJSON:function(){var a,b,c,e=[d.GeoJSON.latLngsToCoords(this.getLatLngs())];if(e[0].push(e[0][0]),this._holes)for(a=0,b=this._holes.length;b>a;a++)c=d.GeoJSON.latLngsToCoords(this._holes[a]),c.push(c[0]),e.push(c);return d.GeoJSON.getFeature(this,{type:"Polygon",coordinates:e})}});
(function(){function a(b){return function(){var a=[];return this.eachLayer(function(b){a.push(b.toGeoJSON().geometry.coordinates)}),d.GeoJSON.getFeature(this,{type:b,coordinates:a})}}d.MultiPolyline.include({toGeoJSON:a("MultiLineString")});d.MultiPolygon.include({toGeoJSON:a("MultiPolygon")});d.LayerGroup.include({toGeoJSON:function(){var b,c=this.feature&&this.feature.geometry,e=[];if(c&&"MultiPoint"===c.type)return a("MultiPoint").call(this);var g=c&&"GeometryCollection"===c.type;return this.eachLayer(function(a){a.toGeoJSON&&
(b=a.toGeoJSON(),e.push(g?b.geometry:d.GeoJSON.asFeature(b)))}),g?d.GeoJSON.getFeature(this,{geometries:e,type:"GeometryCollection"}):{type:"FeatureCollection",features:e}}})})();d.geoJson=function(a,b){return new d.GeoJSON(a,b)};d.DomEvent={addListener:function(a,b,c,e){var g,n,r,p=d.stamp(c),t="_leaflet_"+b+p;return a[t]?this:(g=function(b){return c.call(e||a,b||d.DomEvent._getEvent())},d.Browser.pointer&&0===b.indexOf("touch")?this.addPointerListener(a,b,g,p):(d.Browser.touch&&"dblclick"===b&&
this.addDoubleTapListener&&this.addDoubleTapListener(a,g,p),"addEventListener"in a?"mousewheel"===b?(a.addEventListener("DOMMouseScroll",g,!1),a.addEventListener(b,g,!1)):"mouseenter"===b||"mouseleave"===b?(n=g,r="mouseenter"===b?"mouseover":"mouseout",g=function(b){return d.DomEvent._checkMouse(a,b)?n(b):void 0},a.addEventListener(r,g,!1)):"click"===b&&d.Browser.android?(n=g,g=function(a){return d.DomEvent._filterClick(a,n)},a.addEventListener(b,g,!1)):a.addEventListener(b,g,!1):"attachEvent"in a&&
a.attachEvent("on"+b,g),a[t]=g,this))},removeListener:function(a,b,c){c=d.stamp(c);var e="_leaflet_"+b+c,g=a[e];return g?(d.Browser.pointer&&0===b.indexOf("touch")?this.removePointerListener(a,b,c):d.Browser.touch&&"dblclick"===b&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,c):"removeEventListener"in a?"mousewheel"===b?(a.removeEventListener("DOMMouseScroll",g,!1),a.removeEventListener(b,g,!1)):"mouseenter"===b||"mouseleave"===b?a.removeEventListener("mouseenter"===b?"mouseover":"mouseout",
g,!1):a.removeEventListener(b,g,!1):"detachEvent"in a&&a.detachEvent("on"+b,g),a[e]=null,this):this},stopPropagation:function(a){return a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,d.DomEvent._skipped(a),this},disableScrollPropagation:function(a){var b=d.DomEvent.stopPropagation;return d.DomEvent.on(a,"mousewheel",b).on(a,"MozMousePixelScroll",b)},disableClickPropagation:function(a){for(var b=d.DomEvent.stopPropagation,c=d.Draggable.START.length-1;0<=c;c--)d.DomEvent.on(a,d.Draggable.START[c],
b);return d.DomEvent.on(a,"click",d.DomEvent._fakeStop).on(a,"dblclick",b)},preventDefault:function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this},stop:function(a){return d.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,b){if(!b)return new d.Point(a.clientX,a.clientY);var c=b.getBoundingClientRect();return new d.Point(a.clientX-c.left-b.clientLeft,a.clientY-c.top-b.clientTop)},getWheelDelta:function(a){var b=0;return a.wheelDelta&&(b=a.wheelDelta/
120),a.detail&&(b=-a.detail/3),b},_skipEvents:{},_fakeStop:function(a){d.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var b=this._skipEvents[a.type];return this._skipEvents[a.type]=!1,b},_checkMouse:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!==a;)c=c.parentNode}catch(d){return!1}return c!==a},_getEvent:function(){var b=a.event;if(!b)for(var c=arguments.callee.caller;c&&(b=c.arguments[0],!b||a.Event!==b.constructor);)c=c.caller;return b},_filterClick:function(a,b){var c=
a.timeStamp||a.originalEvent.timeStamp,e=d.DomEvent._lastClick&&c-d.DomEvent._lastClick;return e&&100<e&&1E3>e||a.target._simulatedClick&&!a._simulated?void d.DomEvent.stop(a):(d.DomEvent._lastClick=c,b(a))}};d.DomEvent.on=d.DomEvent.addListener;d.DomEvent.off=d.DomEvent.removeListener;d.Draggable=d.Class.extend({includes:d.Mixin.Events,statics:{START:d.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},
MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,b){this._element=a;this._dragStartTarget=b||a},enable:function(){if(!this._enabled){for(var a=d.Draggable.START.length-1;0<=a;a--)d.DomEvent.on(this._dragStartTarget,d.Draggable.START[a],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var a=d.Draggable.START.length-1;0<=a;a--)d.DomEvent.off(this._dragStartTarget,d.Draggable.START[a],this._onDown,
this);this._moved=this._enabled=!1}},_onDown:function(a){if(this._moved=!1,!(a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(d.DomEvent.stopPropagation(a),d.Draggable._disabled||(d.DomUtil.disableImageDrag(),d.DomUtil.disableTextSelection(),this._moving)))){var c=a.touches?a.touches[0]:a;this._startPoint=new d.Point(c.clientX,c.clientY);this._startPos=this._newPos=d.DomUtil.getPosition(this._element);d.DomEvent.on(b,d.Draggable.MOVE[a.type],this._onMove,this).on(b,d.Draggable.END[a.type],this._onUp,
this)}},_onMove:function(a){if(a.touches&&1<a.touches.length)return void(this._moved=!0);var c=a.touches&&1===a.touches.length?a.touches[0]:a,c=(new d.Point(c.clientX,c.clientY)).subtract(this._startPoint);(c.x||c.y)&&(d.DomEvent.preventDefault(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=d.DomUtil.getPosition(this._element).subtract(c),d.DomUtil.addClass(b.body,"leaflet-dragging"),d.DomUtil.addClass(a.target||a.srcElement,"leaflet-drag-target")),this._newPos=this._startPos.add(c),
this._moving=!0,d.Util.cancelAnimFrame(this._animRequest),this._animRequest=d.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget))},_updatePosition:function(){this.fire("predrag");d.DomUtil.setPosition(this._element,this._newPos);this.fire("drag")},_onUp:function(a){d.DomUtil.removeClass(b.body,"leaflet-dragging");d.DomUtil.removeClass(a.target||a.srcElement,"leaflet-drag-target");for(var c in d.Draggable.MOVE)d.DomEvent.off(b,d.Draggable.MOVE[c],this._onMove).off(b,d.Draggable.END[c],
this._onUp);d.DomUtil.enableImageDrag();d.DomUtil.enableTextSelection();this._moved&&this._moving&&(d.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1}});d.Handler=d.Class.extend({initialize:function(a){this._map=a},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}});d.Map.mergeOptions({dragging:!0,
inertia:!d.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:d.Browser.touch?32:18,easeLinearity:0.25,worldCopyJump:!1});d.Map.Drag=d.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new d.Draggable(a._mapPane,a._container);this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),a.on("viewreset",this._onViewReset,
this),a.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var a=this._map;a._panAnim&&a._panAnim.stop();a.fire("movestart").fire("dragstart");a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var a=this._lastTime=+new Date,b=this._lastPos=this._draggable._newPos;this._positions.push(b);this._times.push(a);
200<a-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var a=this._map.getSize()._divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(a).x;this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,e=(d-b+c)%a+b-c,a=(d+b+c)%a-b-c,c=Math.abs(e+c)<Math.abs(a+c)?e:a;this._draggable._newPos.x=c},
_onDragEnd:function(a){var b=this._map,c=b.options,e=+new Date-this._lastTime,g=!c.inertia||e>c.inertiaThreshold||!this._positions[0];if(b.fire("dragend",a),g)b.fire("moveend");else{a=this._lastPos.subtract(this._positions[0]);var n=c.easeLinearity;a=a.multiplyBy(n/((this._lastTime+e-this._times[0])/1E3));g=a.distanceTo([0,0]);e=Math.min(c.inertiaMaxSpeed,g);a=a.multiplyBy(e/g);var r=e/(c.inertiaDeceleration*n),p=a.multiplyBy(-r/2).round();p.x&&p.y?(p=b._limitOffset(p,b.options.maxBounds),d.Util.requestAnimFrame(function(){b.panBy(p,
{duration:r,easeLinearity:n,noMoveStart:!0})})):b.fire("moveend")}}});d.Map.addInitHook("addHandler","dragging",d.Map.Drag);d.Map.mergeOptions({doubleClickZoom:!0});d.Map.DoubleClickZoom=d.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom()+(a.originalEvent.shiftKey?-1:1);"center"===b.options.doubleClickZoom?b.setZoom(c):b.setZoomAround(a.containerPoint,
c)}});d.Map.addInitHook("addHandler","doubleClickZoom",d.Map.DoubleClickZoom);d.Map.mergeOptions({scrollWheelZoom:!0});d.Map.ScrollWheelZoom=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this);d.DomEvent.on(this._map._container,"MozMousePixelScroll",d.DomEvent.preventDefault);this._delta=0},removeHooks:function(){d.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll);d.DomEvent.off(this._map._container,"MozMousePixelScroll",
d.DomEvent.preventDefault)},_onWheelScroll:function(a){var b=d.DomEvent.getWheelDelta(a);this._delta+=b;this._lastMousePos=this._map.mouseEventToContainerPoint(a);this._startTime||(this._startTime=+new Date);b=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(d.bind(this._performZoom,this),b);d.DomEvent.preventDefault(a);d.DomEvent.stopPropagation(a)},_performZoom:function(){var a=this._map,b=this._delta,c=a.getZoom(),b=0<b?Math.ceil(b):Math.floor(b),b=Math.max(Math.min(b,
4),-4),b=a._limitZoom(c+b)-c;this._delta=0;this._startTime=null;b&&("center"===a.options.scrollWheelZoom?a.setZoom(c+b):a.setZoomAround(this._lastMousePos,c+b))}});d.Map.addInitHook("addHandler","scrollWheelZoom",d.Map.ScrollWheelZoom);d.extend(d.DomEvent,{_touchstart:d.Browser.msPointer?"MSPointerDown":d.Browser.pointer?"pointerdown":"touchstart",_touchend:d.Browser.msPointer?"MSPointerUp":d.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(a,c,e){function g(a){var b;if(d.Browser.pointer?
(v.push(a.pointerId),b=v.length):b=a.touches.length,!(1<b)){b=Date.now();var c=b-(n||b);r=a.touches?a.touches[0]:a;p=0<c&&t>=c;n=b}}function m(a){if(d.Browser.pointer){a=v.indexOf(a.pointerId);if(-1===a)return;v.splice(a,1)}if(p){if(d.Browser.pointer){var b={},e;for(e in r)a=r[e],b[e]="function"==typeof a?a.bind(r):a;r=b}r.type="dblclick";c(r);n=null}}var n,r,p=!1,t=250,s=this._touchstart,u=this._touchend,v=[];a["_leaflet_"+s+e]=g;a["_leaflet_"+u+e]=m;e=d.Browser.pointer?b.documentElement:a;return a.addEventListener(s,
g,!1),e.addEventListener(u,m,!1),d.Browser.pointer&&e.addEventListener(d.DomEvent.POINTER_CANCEL,m,!1),this},removeDoubleTapListener:function(a,c){return a.removeEventListener(this._touchstart,a["_leaflet_"+this._touchstart+c],!1),(d.Browser.pointer?b.documentElement:a).removeEventListener(this._touchend,a["_leaflet_"+this._touchend+c],!1),d.Browser.pointer&&b.documentElement.removeEventListener(d.DomEvent.POINTER_CANCEL,a["_leaflet_"+this._touchend+c],!1),this}});d.extend(d.DomEvent,{POINTER_DOWN:d.Browser.msPointer?
"MSPointerDown":"pointerdown",POINTER_MOVE:d.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:d.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:d.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(a,b,c,d){switch(b){case "touchstart":return this.addPointerListenerStart(a,b,c,d);case "touchend":return this.addPointerListenerEnd(a,b,c,d);case "touchmove":return this.addPointerListenerMove(a,b,c,d);default:throw"Unknown touch event type";
}},addPointerListenerStart:function(a,c,e,g){var m=this._pointers;c=function(a){d.DomEvent.preventDefault(a);for(var b=!1,c=0;c<m.length;c++)if(m[c].pointerId===a.pointerId){b=!0;break}b||m.push(a);a.touches=m.slice();a.changedTouches=[a];e(a)};(a["_leaflet_touchstart"+g]=c,a.addEventListener(this.POINTER_DOWN,c,!1),this._pointerDocumentListener)||(a=function(a){for(var b=0;b<m.length;b++)if(m[b].pointerId===a.pointerId){m.splice(b,1);break}},b.documentElement.addEventListener(this.POINTER_UP,a,!1),
b.documentElement.addEventListener(this.POINTER_CANCEL,a,!1),this._pointerDocumentListener=!0);return this},addPointerListenerMove:function(a,b,c,d){function e(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons){for(var b=0;b<g.length;b++)if(g[b].pointerId===a.pointerId){g[b]=a;break}a.touches=g.slice();a.changedTouches=[a];c(a)}}var g=this._pointers;return a["_leaflet_touchmove"+d]=e,a.addEventListener(this.POINTER_MOVE,e,!1),this},addPointerListenerEnd:function(a,
b,c,d){var e=this._pointers;b=function(a){for(var b=0;b<e.length;b++)if(e[b].pointerId===a.pointerId){e.splice(b,1);break}a.touches=e.slice();a.changedTouches=[a];c(a)};return a["_leaflet_touchend"+d]=b,a.addEventListener(this.POINTER_UP,b,!1),a.addEventListener(this.POINTER_CANCEL,b,!1),this},removePointerListener:function(a,b,c){c=a["_leaflet_"+b+c];switch(b){case "touchstart":a.removeEventListener(this.POINTER_DOWN,c,!1);break;case "touchmove":a.removeEventListener(this.POINTER_MOVE,c,!1);break;
case "touchend":a.removeEventListener(this.POINTER_UP,c,!1),a.removeEventListener(this.POINTER_CANCEL,c,!1)}return this}});d.Map.mergeOptions({touchZoom:d.Browser.touch&&!d.Browser.android23,bounceAtZoomLimits:!0});d.Map.TouchZoom=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){d.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map;if(a.touches&&2===
a.touches.length&&!c._animatingZoom&&!this._zooming){var e=c.mouseEventToLayerPoint(a.touches[0]),g=c.mouseEventToLayerPoint(a.touches[1]),m=c._getCenterLayerPoint();this._startCenter=e.add(g)._divideBy(2);this._startDist=e.distanceTo(g);this._moved=!1;this._zooming=!0;this._centerOffset=m.subtract(this._startCenter);c._panAnim&&c._panAnim.stop();d.DomEvent.on(b,"touchmove",this._onTouchMove,this).on(b,"touchend",this._onTouchEnd,this);d.DomEvent.preventDefault(a)}},_onTouchMove:function(a){var b=
this._map;if(a.touches&&2===a.touches.length&&this._zooming){var c=b.mouseEventToLayerPoint(a.touches[0]),e=b.mouseEventToLayerPoint(a.touches[1]);this._scale=c.distanceTo(e)/this._startDist;this._delta=c._add(e)._divideBy(2)._subtract(this._startCenter);1===this._scale||!b.options.bounceAtZoomLimits&&(b.getZoom()===b.getMinZoom()&&1>this._scale||b.getZoom()===b.getMaxZoom()&&1<this._scale)||(this._moved||(d.DomUtil.addClass(b._mapPane,"leaflet-touching"),b.fire("movestart").fire("zoomstart"),this._moved=
!0),d.Util.cancelAnimFrame(this._animRequest),this._animRequest=d.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),d.DomEvent.preventDefault(a))}},_updateOnMove:function(){var a=this._map,b=this._getScaleOrigin(),b=a.layerPointToLatLng(b),c=a.getScaleZoom(this._scale);a._animateZoom(b,c,this._startCenter,this._scale,this._delta)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var a=this._map;this._zooming=!1;d.DomUtil.removeClass(a._mapPane,
"leaflet-touching");d.Util.cancelAnimFrame(this._animRequest);d.DomEvent.off(b,"touchmove",this._onTouchMove).off(b,"touchend",this._onTouchEnd);var c=this._getScaleOrigin(),e=a.layerPointToLatLng(c),g=a.getZoom(),m=a.getScaleZoom(this._scale)-g,m=0<m?Math.ceil(m):Math.floor(m),g=a._limitZoom(g+m),m=a.getZoomScale(g)/this._scale;a._animateZoom(e,g,c,m)},_getScaleOrigin:function(){var a=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(a)}});d.Map.addInitHook("addHandler",
"touchZoom",d.Map.TouchZoom);d.Map.mergeOptions({tap:!0,tapTolerance:15});d.Map.Tap=d.Handler.extend({addHooks:function(){d.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){d.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches){if(d.DomEvent.preventDefault(a),this._fireClick=!0,1<a.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var c=a.touches[0];a=c.target;this._startPos=this._newPos=
new d.Point(c.clientX,c.clientY);a.tagName&&"a"===a.tagName.toLowerCase()&&d.DomUtil.addClass(a,"leaflet-active");this._holdTimeout=setTimeout(d.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",c))},this),1E3);d.DomEvent.on(b,"touchmove",this._onMove,this).on(b,"touchend",this._onUp,this)}},_onUp:function(a){if(clearTimeout(this._holdTimeout),d.DomEvent.off(b,"touchmove",this._onMove,this).off(b,"touchend",this._onUp,this),this._fireClick&&a&&
a.changedTouches){a=a.changedTouches[0];var c=a.target;c&&c.tagName&&"a"===c.tagName.toLowerCase()&&d.DomUtil.removeClass(c,"leaflet-active");this._isTapValid()&&this._simulateEvent("click",a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){a=a.touches[0];this._newPos=new d.Point(a.clientX,a.clientY)},_simulateEvent:function(c,d){var e=b.createEvent("MouseEvents");e._simulated=!0;d.target._simulatedClick=!0;e.initMouseEvent(c,
!0,!0,a,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null);d.target.dispatchEvent(e)}});d.Browser.touch&&!d.Browser.pointer&&d.Map.addInitHook("addHandler","tap",d.Map.Tap);d.Map.mergeOptions({boxZoom:!0});d.Map.BoxZoom=d.Handler.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane;this._moved=!1},addHooks:function(){d.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){d.DomEvent.off(this._container,
"mousedown",this._onMouseDown);this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(a){return this._moved=!1,!a.shiftKey||1!==a.which&&1!==a.button?!1:(d.DomUtil.disableTextSelection(),d.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(a),void d.DomEvent.on(b,"mousemove",this._onMouseMove,this).on(b,"mouseup",this._onMouseUp,this).on(b,"keydown",this._onKeyDown,this))},_onMouseMove:function(a){this._moved||(this._box=d.DomUtil.create("div","leaflet-zoom-box",
this._pane),d.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var b=this._startLayerPoint,c=this._box,e=this._map.mouseEventToLayerPoint(a);a=e.subtract(b);b=new d.Point(Math.min(e.x,b.x),Math.min(e.y,b.y));d.DomUtil.setPosition(c,b);this._moved=!0;c.style.width=Math.max(0,Math.abs(a.x)-4)+"px";c.style.height=Math.max(0,Math.abs(a.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=
"");d.DomUtil.enableTextSelection();d.DomUtil.enableImageDrag();d.DomEvent.off(b,"mousemove",this._onMouseMove).off(b,"mouseup",this._onMouseUp).off(b,"keydown",this._onKeyDown)},_onMouseUp:function(a){this._finish();var b=this._map;a=b.mouseEventToLayerPoint(a);this._startLayerPoint.equals(a)||(a=new d.LatLngBounds(b.layerPointToLatLng(this._startLayerPoint),b.layerPointToLatLng(a)),b.fitBounds(a),b.fire("boxzoomend",{boxZoomBounds:a}))},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});d.Map.addInitHook("addHandler",
"boxZoom",d.Map.BoxZoom);d.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1});d.Map.Keyboard=d.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(a){this._map=a;this._setPanOffset(a.options.keyboardPanOffset);this._setZoomOffset(a.options.keyboardZoomOffset)},addHooks:function(){var a=this._map._container;-1===a.tabIndex&&(a.tabIndex="0");d.DomEvent.on(a,"focus",this._onFocus,this).on(a,"blur",
this._onBlur,this).on(a,"mousedown",this._onMouseDown,this);this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var a=this._map._container;d.DomEvent.off(a,"focus",this._onFocus,this).off(a,"blur",this._onBlur,this).off(a,"mousedown",this._onMouseDown,this);this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var c=b.body,d=b.documentElement,e=c.scrollTop||d.scrollTop,
c=c.scrollLeft||d.scrollLeft;this._map._container.focus();a.scrollTo(c,e)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanOffset:function(a){var b,c,d=this._panKeys={},e=this.keyCodes;b=0;for(c=e.left.length;c>b;b++)d[e.left[b]]=[-1*a,0];b=0;for(c=e.right.length;c>b;b++)d[e.right[b]]=[a,0];b=0;for(c=e.down.length;c>b;b++)d[e.down[b]]=[0,a];b=0;for(c=e.up.length;c>b;b++)d[e.up[b]]=[0,-1*a]},_setZoomOffset:function(a){var b,
c,d=this._zoomKeys={},e=this.keyCodes;b=0;for(c=e.zoomIn.length;c>b;b++)d[e.zoomIn[b]]=a;b=0;for(c=e.zoomOut.length;c>b;b++)d[e.zoomOut[b]]=-a},_addHooks:function(){d.DomEvent.on(b,"keydown",this._onKeyDown,this)},_removeHooks:function(){d.DomEvent.off(b,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){var b=a.keyCode,c=this._map;if(b in this._panKeys){if(c._panAnim&&c._panAnim._inProgress)return;c.panBy(this._panKeys[b]);c.options.maxBounds&&c.panInsideBounds(c.options.maxBounds)}else{if(!(b in
this._zoomKeys))return;c.setZoom(c.getZoom()+this._zoomKeys[b])}d.DomEvent.stop(a)}});d.Map.addInitHook("addHandler","keyboard",d.Map.Keyboard);d.Handler.MarkerDrag=d.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new d.Draggable(a,a));this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this);this._draggable.enable();d.DomUtil.addClass(this._marker._icon,
"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this);this._draggable.disable();d.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var a=this._marker,b=a._shadow,c=d.DomUtil.getPosition(a._icon),
e=a._map.layerPointToLatLng(c);b&&d.DomUtil.setPosition(b,c);a._latlng=e;a.fire("move",{latlng:e}).fire("drag")},_onDragEnd:function(a){this._marker.fire("moveend").fire("dragend",a)}});d.Control=d.Class.extend({options:{position:"topright"},initialize:function(a){d.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;return b&&b.removeControl(this),this.options.position=a,b&&b.addControl(this),this},getContainer:function(){return this._container},
addTo:function(a){this._map=a;var b=this._container=this.onAdd(a),c=this.getPosition();a=a._controlCorners[c];return d.DomUtil.addClass(b,"leaflet-control"),-1!==c.indexOf("bottom")?a.insertBefore(b,a.firstChild):a.appendChild(b),this},removeFrom:function(a){var b=this.getPosition();return a._controlCorners[b].removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(a),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}});d.control=function(a){return new d.Control(a)};
d.Map.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.removeFrom(this),this},_initControlPos:function(){function a(f,g){b[f+g]=d.DomUtil.create("div",c+f+" "+c+g,e)}var b=this._controlCorners={},c="leaflet-",e=this._controlContainer=d.DomUtil.create("div",c+"control-container",this._container);a("top","left");a("top","right");a("bottom","left");a("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}});d.Control.Zoom=
d.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(a){var b=d.DomUtil.create("div","leaflet-control-zoom leaflet-bar");return this._map=a,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,"leaflet-control-zoom-in",b,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,"leaflet-control-zoom-out",b,this._zoomOut,this),this._updateDisabled(),
a.on("zoomend zoomlevelschange",this._updateDisabled,this),b},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(a){this._map.zoomIn(a.shiftKey?3:1)},_zoomOut:function(a){this._map.zoomOut(a.shiftKey?3:1)},_createButton:function(a,b,c,e,g,n){c=d.DomUtil.create("a",c,e);c.innerHTML=a;c.href="#";c.title=b;a=d.DomEvent.stopPropagation;return d.DomEvent.on(c,"click",a).on(c,"mousedown",a).on(c,"dblclick",a).on(c,"click",d.DomEvent.preventDefault).on(c,"click",
g,n).on(c,"click",this._refocusOnMap,n),c},_updateDisabled:function(){var a=this._map;d.DomUtil.removeClass(this._zoomInButton,"leaflet-disabled");d.DomUtil.removeClass(this._zoomOutButton,"leaflet-disabled");a._zoom===a.getMinZoom()&&d.DomUtil.addClass(this._zoomOutButton,"leaflet-disabled");a._zoom===a.getMaxZoom()&&d.DomUtil.addClass(this._zoomInButton,"leaflet-disabled")}});d.Map.mergeOptions({zoomControl:!0});d.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new d.Control.Zoom,
this.addControl(this.zoomControl))});d.control.zoom=function(a){return new d.Control.Zoom(a)};d.Control.Attribution=d.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(a){d.setOptions(this,a);this._attributions={}},onAdd:function(a){this._container=d.DomUtil.create("div","leaflet-control-attribution");d.DomEvent.disableClickPropagation(this._container);for(var b in a._layers)a._layers[b].getAttribution&&
this.addAttribution(a._layers[b].getAttribution());return a.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(a){a.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):void 0},removeAttribution:function(a){return a?
(this._attributions[a]&&(this._attributions[a]--,this._update()),this):void 0},_update:function(){if(this._map){var a=[],b;for(b in this._attributions)this._attributions[b]&&a.push(b);b=[];this.options.prefix&&b.push(this.options.prefix);a.length&&b.push(a.join(", "));this._container.innerHTML=b.join(" | ")}},_onLayerAdd:function(a){a.layer.getAttribution&&this.addAttribution(a.layer.getAttribution())},_onLayerRemove:function(a){a.layer.getAttribution&&this.removeAttribution(a.layer.getAttribution())}});
d.Map.mergeOptions({attributionControl:!0});d.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new d.Control.Attribution).addTo(this))});d.control.attribution=function(a){return new d.Control.Attribution(a)};d.Control.Scale=d.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(a){this._map=a;var b=d.DomUtil.create("div","leaflet-control-scale"),c=this.options;return this._addScales(c,"leaflet-control-scale",
b),a.on(c.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),b},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,b,c){a.metric&&(this._mScale=d.DomUtil.create("div",b+"-line",c));a.imperial&&(this._iScale=d.DomUtil.create("div",b+"-line",c))},_update:function(){var a=this._map.getBounds(),b=a.getCenter().lat,a=6378137*Math.PI*Math.cos(b*Math.PI/180)*(a.getNorthEast().lng-a.getSouthWest().lng)/180,b=this._map.getSize(),
c=this.options,d=0;0<b.x&&(d=c.maxWidth/b.x*a);this._updateScales(c,d)},_updateScales:function(a,b){a.metric&&b&&this._updateMetric(b);a.imperial&&b&&this._updateImperial(b)},_updateMetric:function(a){var b=this._getRoundNum(a);this._mScale.style.width=this._getScaleWidth(b/a)+"px";this._mScale.innerHTML=1E3>b?b+" m":b/1E3+" km"},_updateImperial:function(a){var b,c,d;a*=3.2808399;var e=this._iScale;5280<a?(b=a/5280,c=this._getRoundNum(b),e.style.width=this._getScaleWidth(c/b)+"px",e.innerHTML=c+" mi"):
(d=this._getRoundNum(a),e.style.width=this._getScaleWidth(d/a)+"px",e.innerHTML=d+" ft")},_getScaleWidth:function(a){return Math.round(this.options.maxWidth*a)-10},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1);a/=b;return a=10<=a?10:5<=a?5:3<=a?3:2<=a?2:1,b*a}});d.control.scale=function(a){return new d.Control.Scale(a)};d.Control.Layers=d.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(a,b,c){d.setOptions(this,c);this._layers=
{};this._lastZIndex=0;this._handlingClick=!1;for(var e in a)this._addLayer(a[e],e);for(e in b)this._addLayer(b[e],e,!0)},onAdd:function(a){return this._initLayout(),this._update(),a.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(a){a.off("layeradd",this._onLayerChange).off("layerremove",this._onLayerChange)},addBaseLayer:function(a,b){return this._addLayer(a,b),this._update(),this},addOverlay:function(a,b){return this._addLayer(a,
b,!0),this._update(),this},removeLayer:function(a){a=d.stamp(a);return delete this._layers[a],this._update(),this},_initLayout:function(){var a=this._container=d.DomUtil.create("div","leaflet-control-layers");a.setAttribute("aria-haspopup",!0);d.Browser.touch?d.DomEvent.on(a,"click",d.DomEvent.stopPropagation):d.DomEvent.disableClickPropagation(a).disableScrollPropagation(a);var b=this._form=d.DomUtil.create("form","leaflet-control-layers-list");if(this.options.collapsed){d.Browser.android||d.DomEvent.on(a,
"mouseover",this._expand,this).on(a,"mouseout",this._collapse,this);var c=this._layersLink=d.DomUtil.create("a","leaflet-control-layers-toggle",a);c.href="#";c.title="Layers";d.Browser.touch?d.DomEvent.on(c,"click",d.DomEvent.stop).on(c,"click",this._expand,this):d.DomEvent.on(c,"focus",this._expand,this);d.DomEvent.on(b,"click",function(){setTimeout(d.bind(this._onInputClick,this),0)},this);this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=d.DomUtil.create("div",
"leaflet-control-layers-base",b);this._separator=d.DomUtil.create("div","leaflet-control-layers-separator",b);this._overlaysList=d.DomUtil.create("div","leaflet-control-layers-overlays",b);a.appendChild(b)},_addLayer:function(a,b,c){var e=d.stamp(a);this._layers[e]={layer:a,name:b,overlay:c};this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="";this._overlaysList.innerHTML="";var a,b,c=!1,
d=!1;for(a in this._layers)b=this._layers[a],this._addItem(b),d=d||b.overlay,c=c||!b.overlay;this._separator.style.display=d&&c?"":"none"}},_onLayerChange:function(a){var b=this._layers[d.stamp(a.layer)];b&&(this._handlingClick||this._update(),(a=b.overlay?"layeradd"===a.type?"overlayadd":"overlayremove":"layeradd"===a.type?"baselayerchange":null)&&this._map.fire(a,b))},_createRadioElement:function(a,c){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"';c&&(d+=' checked="checked"');
var d=d+"/>",e=b.createElement("div");return e.innerHTML=d,e.firstChild},_addItem:function(a){var c,e=b.createElement("label"),g=this._map.hasLayer(a.layer);a.overlay?(c=b.createElement("input"),c.type="checkbox",c.className="leaflet-control-layers-selector",c.defaultChecked=g):c=this._createRadioElement("leaflet-base-layers",g);c.layerId=d.stamp(a.layer);d.DomEvent.on(c,"click",this._onInputClick,this);g=b.createElement("span");g.innerHTML=" "+a.name;e.appendChild(c);e.appendChild(g);return(a.overlay?
this._overlaysList:this._baseLayersList).appendChild(e),e},_onInputClick:function(){var a,b,c,d=this._form.getElementsByTagName("input"),e=d.length;this._handlingClick=!0;for(a=0;e>a;a++)b=d[a],c=this._layers[b.layerId],b.checked&&!this._map.hasLayer(c.layer)?this._map.addLayer(c.layer):!b.checked&&this._map.hasLayer(c.layer)&&this._map.removeLayer(c.layer);this._handlingClick=!1;this._refocusOnMap()},_expand:function(){d.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=
this._container.className.replace(" leaflet-control-layers-expanded","")}});d.control.layers=function(a,b,c){return new d.Control.Layers(a,b,c)};d.PosAnimation=d.Class.extend({includes:d.Mixin.Events,run:function(a,b,c,e){this.stop();this._el=a;this._inProgress=!0;this._newPos=b;this.fire("start");a.style[d.DomUtil.TRANSITION]="all "+(c||0.25)+"s cubic-bezier(0,0,"+(e||0.5)+",1)";d.DomEvent.on(a,d.DomUtil.TRANSITION_END,this._onTransitionEnd,this);d.DomUtil.setPosition(a,b);d.Util.falseFn(a.offsetWidth);
this._stepTimer=setInterval(d.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(d.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),d.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var a=this._getPos();return a?(this._el._leaflet_pos=a,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var b,c,e=a.getComputedStyle(this._el);if(d.Browser.any3d){if(c=e[d.DomUtil.TRANSFORM].match(this._transformRe),
!c)return;b=parseFloat(c[1]);c=parseFloat(c[2])}else b=parseFloat(e.left),c=parseFloat(e.top);return new d.Point(b,c,!0)},_onTransitionEnd:function(){d.DomEvent.off(this._el,d.DomUtil.TRANSITION_END,this._onTransitionEnd,this);this._inProgress&&(this._inProgress=!1,this._el.style[d.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}});d.Map.include({setView:function(a,b,e){if(b=b===c?this._zoom:this._limitZoom(b),a=this._limitCenter(d.latLng(a),
b,this.options.maxBounds),e=e||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!e.reset&&!0!==e)if(e.animate!==c&&(e.zoom=d.extend({animate:e.animate},e.zoom),e.pan=d.extend({animate:e.animate},e.pan)),this._zoom!==b?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,b,e.zoom):this._tryAnimatedPan(a,e.pan))return clearTimeout(this._sizeTimer),this;return this._resetView(a,b),this},panBy:function(a,b){if(a=d.point(a).round(),b=b||{},!a.x&&!a.y)return this;if(this._panAnim||(this._panAnim=new d.PosAnimation,
this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),!1!==b.animate){d.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(a);this._panAnim.run(this._mapPane,c,b.duration||0.25,b.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){d.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");
this.fire("moveend")},_tryAnimatedPan:function(a,b){var c=this._getCenterOffset(a)._floor();return!0===(b&&b.animate)||this.getSize().contains(c)?(this.panBy(c,b),!0):!1}});d.PosAnimation=d.DomUtil.TRANSITION?d.PosAnimation:d.PosAnimation.extend({run:function(a,b,c,e){this.stop();this._el=a;this._inProgress=!0;this._duration=c||0.25;this._easeOutPower=1/Math.max(e||0.5,0.2);this._startPos=d.DomUtil.getPosition(a);this._offset=b.subtract(this._startPos);this._startTime=+new Date;this.fire("start");
this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=d.Util.requestAnimFrame(this._animate,this);this._step()},_step:function(){var a=+new Date-this._startTime,b=1E3*this._duration;b>a?this._runFrame(this._easeOut(a/b)):(this._runFrame(1),this._complete())},_runFrame:function(a){a=this._startPos.add(this._offset.multiplyBy(a));d.DomUtil.setPosition(this._el,a);this.fire("step")},_complete:function(){d.Util.cancelAnimFrame(this._animId);
this._inProgress=!1;this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}});d.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});d.DomUtil.TRANSITION&&d.Map.addInitHook(function(){(this._zoomAnimated=this.options.zoomAnimation&&d.DomUtil.TRANSITION&&d.Browser.any3d&&!d.Browser.android23&&!d.Browser.mobileOpera)&&d.DomEvent.on(this._mapPane,d.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)});d.Map.include(d.DomUtil.TRANSITION?{_catchTransitionEnd:function(a){this._animatingZoom&&
0<=a.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,b,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||!1===c.animate||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var d=this.getZoomScale(b),e=this._getCenterOffset(a)._divideBy(1-1/d),g=this._getCenterLayerPoint()._add(e);return!0===
c.animate||this.getSize().contains(e)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(a,b,g,d,null,!0),!0):!1},_animateZoom:function(a,b,c,e,g,n){this._animatingZoom=!0;d.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim");this._animateToCenter=a;this._animateToZoom=b;d.Draggable&&(d.Draggable._disabled=!0);this.fire("zoomanim",{center:a,zoom:b,origin:c,scale:e,delta:g,backwards:n})},_onZoomTransitionEnd:function(){this._animatingZoom=!1;d.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim");
this._resetView(this._animateToCenter,this._animateToZoom,!0,!0);d.Draggable&&(d.Draggable._disabled=!1)}}:{});d.TileLayer.include({_animateZoom:function(a){this._animating||(this._animating=!0,this._prepareBgBuffer());var b=this._bgBuffer,c=d.DomUtil.TRANSFORM,e=a.delta?d.DomUtil.getTranslateString(a.delta):b.style[c],g=d.DomUtil.getScaleString(a.scale,a.origin);b.style[c]=a.backwards?g+" "+e:e+" "+g},_endZoomAnim:function(){var a=this._tileContainer,b=this._bgBuffer;a.style.visibility="";a.parentNode.appendChild(a);
d.Util.falseFn(b.offsetWidth);this._animating=!1},_clearBgBuffer:function(){var a=this._map;!a||a._animatingZoom||a.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[d.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var a=this._tileContainer,b=this._bgBuffer,c=this._getLoadedTilesPercentage(b),e=this._getLoadedTilesPercentage(a);return b&&0.5<c&&0.5>e?(a.style.visibility="hidden",void this._stopLoadingImages(a)):(b.style.visibility="hidden",b.style[d.DomUtil.TRANSFORM]="",
this._tileContainer=b,b=this._bgBuffer=a,this._stopLoadingImages(b),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(a){var b,c=a.getElementsByTagName("img"),d=0;a=0;for(b=c.length;b>a;a++)c[a].complete&&d++;return d/b},_stopLoadingImages:function(a){var b,c,e=Array.prototype.slice.call(a.getElementsByTagName("img"));a=0;for(b=e.length;b>a;a++)c=e[a],c.complete||(c.onload=d.Util.falseFn,c.onerror=d.Util.falseFn,c.src=d.Util.emptyImageUrl,c.parentNode.removeChild(c))}});
d.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1E4,maximumAge:0,enableHighAccuracy:!1},locate:function(a){if(a=this._locateOptions=d.extend(this._defaultLocateOptions,a),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var b=d.bind(this._handleGeolocationResponse,this),c=d.bind(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(b,c,a):navigator.geolocation.getCurrentPosition(b,
c,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){var b=a.code;a=a.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:b,message:"Geolocation error: "+a+"."})},_handleGeolocationResponse:function(a){var b=a.coords.latitude,
c=a.coords.longitude,e=new d.LatLng(b,c),g=180*a.coords.accuracy/40075017,n=g/Math.cos(d.LatLng.DEG_TO_RAD*b),b=d.latLngBounds([b-g,c-n],[b+g,c+n]),c=this._locateOptions;c.setView&&(c=Math.min(this.getBoundsZoom(b),c.maxZoom),this.setView(e,c));var e={latlng:e,bounds:b,timestamp:a.timestamp},r;for(r in a.coords)"number"==typeof a.coords[r]&&(e[r]=a.coords[r]);this.fire("locationfound",e)}})}(window,document);AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.InputStream=function(a){this.buffer=a;this.offset=0;this.byteLength=a.length;this.convBuf=new ArrayBuffer(8);this.convUint8=new Uint8Array(this.convBuf);this.convUint16=new Uint16Array(this.convBuf);this.convInt32=new Int32Array(this.convBuf);this.convUint32=new Uint32Array(this.convBuf);this.convFloat32=new Float32Array(this.convBuf);this.convFloat64=new Float64Array(this.convBuf)};
Autodesk.Viewing.Private.InputStream.prototype.seek=function(a){this.offset=a};Autodesk.Viewing.Private.InputStream.prototype.getBytes=function(a){var b=new Uint8Array(this.buffer.buffer,this.offset,a);this.offset+=a;return b};Autodesk.Viewing.Private.InputStream.prototype.getUint8=function(){return this.buffer[this.offset++]};Autodesk.Viewing.Private.InputStream.prototype.getUint16=function(){this.convUint8[0]=this.buffer[this.offset++];this.convUint8[1]=this.buffer[this.offset++];return this.convUint16[0]};
Autodesk.Viewing.Private.InputStream.prototype.getInt16=function(){var a=this.getUint16();32767<a&&(a|=4294901760);return a};Autodesk.Viewing.Private.InputStream.prototype.getInt32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convInt32[0]};
Autodesk.Viewing.Private.InputStream.prototype.getUint32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convUint32[0]};Autodesk.Viewing.Private.InputStream.prototype.getFloat32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convFloat32[0]};
Autodesk.Viewing.Private.InputStream.prototype.getFloat64=function(){for(var a=this.buffer,b=this.convUint8,c=this.offset,e=0;8>e;e++)b[e]=a[c+e];this.offset+=8;return this.convFloat64[0]};Autodesk.Viewing.Private.InputStream.prototype.getString=function(a){for(var b=this.buffer,c="",e=this.offset,d=this.offset+a;e<d;e++)c+=String.fromCharCode(b[e]);this.offset+=a;return decodeURIComponent(escape(c))};
Autodesk.Viewing.Private.InputStream.prototype.reset=function(a){this.buffer=a;this.offset=0;this.byteLength=a.length};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.VBUtils={deduceUVRepetition:function(a){for(var b in a.vblayout)if(0==b.indexOf("uv"))for(var c=a.vbstride,e=a.vb,d=a.vb.length/c,g=0,f=a.vblayout[b].offset;g<d;g++,f+=c){var h=e[f],k=e[f+1];if(2<h||0>h||2<k||0>k){a.vblayout[b].isPattern=!0;break}}},computeBounds3D:function(a){var b=Infinity,c=Infinity,e=Infinity,d=-Infinity,g=-Infinity,f=-Infinity,h,k,l,m,n,r=a.vbstride,p=a.vblayout.position.offset,t=a.vb,s=a.vb.length/r;h=0;for(k=p;h<s;h++,k+=r)l=t[k],m=t[k+1],n=t[k+2],
b>l&&(b=l),c>m&&(c=m),e>n&&(e=n),d<l&&(d=l),g<m&&(g=m),f<n&&(f=n);h=a.boundingBox=new THREE.Box3;h.min.set(b,c,e);h.max.set(d,g,f);b=0.5*(b+d);c=0.5*(c+g);e=0.5*(e+f);a=a.boundingSphere=new THREE.Sphere;a.center.set(b,c,e);h=f=0;for(k=p;h<s;h++,k+=r)l=t[k],m=t[k+1],n=t[k+2],p=l-b,m-=c,n-=e,n=p*p+m*m+n*n,n>f&&(f=n);a.radius=Math.sqrt(f)},computeBounds2D:function(a){if(!a.boundingBox){var b=Infinity,c=Infinity,e=-Infinity,d=-Infinity,g,f,h,k,l=a.vbstride;f=a.vblayout.position.offset;var m=a.vb,n=a.vb.length/
l;g=0;for(k=f;g<n;g++,k+=l)f=m[k],h=m[k+1],b>f&&(b=f),c>h&&(c=h),e<f&&(e=f),d<h&&(d=h);g=a.boundingBox=new THREE.Box3;l=Math.max(e-b,d-c);g.min.set(b,c,0.001*-l);g.max.set(e,d,0.001*l)}b=a.boundingSphere=new THREE.Sphere;b.center.copy(a.boundingBox.center());b.radius=0.5*a.boundingBox.size().length()}};var VBB_LINE_SEGMENT=16,VBB_ARC_CIRCULAR=32,VBB_ARC_ELLIPTICAL=48,VBB_TEX_QUAD=64,VBB_SEG_START_RIGHT=1,VBB_SEG_START_LEFT=2,VBB_SEG_END_RIGHT=3,VBB_SEG_END_LEFT=4,TAU=2*Math.PI;function VertexBufferBuilder(){this.stride=8;this.vb=new ArrayBuffer(262144*this.stride);this.vbf=new Float32Array(this.vb);this.vbi=new Int32Array(this.vb);this.vcount=0;this.ib=new Uint16Array(65536);this.icount=0;this.minx=this.miny=Infinity;this.maxx=this.maxy=-Infinity}
VertexBufferBuilder.prototype.expandStride=function(){var a=this.stride;if(!(8<a)){for(var b=this.stride+4,c=new ArrayBuffer(this.vb.byteLength/a*b),e=new Uint8Array(this.vb),d=new Uint8Array(c),g=0,f=this.vcount;g<f;g++)for(var h=g*a*4,k=g*b*4,l=0;l<4*a;l++)d[k+l]=e[h+l];this.vb=c;this.vbf=new Float32Array(c);this.vbi=new Int32Array(c);this.stride=b}};
VertexBufferBuilder.prototype.addVertex=function(a,b,c,e,d,g,f,h){var k=this.vcount,l=k*this.stride,m=this.vbf;m[l]=a;m[l+1]=b;m[l+2]=c;m[l+3]=e;m[l+4]=d;this.vbi[l+5]=g;this.vbi[l+6]=f;this.vbi[l+7]=0|h<<16;this.vcount++;return k};VertexBufferBuilder.prototype.addToBounds=function(a,b){a<this.minx&&(this.minx=a);a>this.maxx&&(this.maxx=a);b<this.miny&&(this.miny=b);b>this.maxy&&(this.maxy=b)};
VertexBufferBuilder.prototype.addVertexLine=function(a,b,c,e,d,g,f,h,k,l){var m=this.vcount,n=m*this.stride,r=this.vbf;void 0===l&&(l=VBB_LINE_SEGMENT);r[n]=a;r[n+1]=b;r[n+2]=c;r[n+3]=e;r[n+4]=d;this.vbi[n+5]=g;this.vbi[n+6]=f;this.vbi[n+7]=l|k|h<<16;this.vcount++;return m};
VertexBufferBuilder.prototype.addVertexArc=function(a,b,c,e,d,g,f,h,k,l,m,n){var r=this.vcount,p=r*this.stride,t=this.vbf,s=d==g?VBB_ARC_CIRCULAR:VBB_ARC_ELLIPTICAL;t[p]=a;t[p+1]=b;t[p+2]=c;t[p+3]=e;t[p+4]=h;this.vbi[p+5]=k;this.vbi[p+6]=l;this.vbi[p+7]=s|n|m<<16;t[p+8]=d;t[p+9]=g;t[p+10]=f;t[p+11]=0;this.vcount++;return r};VertexBufferBuilder.prototype.addVertexPolytriangle=function(a,b,c,e,d,g,f,h){this.addVertex(a,b,c,e,d,g,f,h);this.addToBounds(a,b)};
VertexBufferBuilder.prototype.setVertexColor=function(a,b){this.vbi[a*this.stride+5]=b};VertexBufferBuilder.prototype.addTriangle=function(a,b,c){var e=this.ib,d=this.icount;if(d+3>=e.length){for(var g=new Uint16Array(2*e.length),f=0;f<d;f++)g[f]=e[f];this.ib=e=g}e[d]=a;e[d+1]=b;e[d+2]=c;this.icount+=3};
VertexBufferBuilder.prototype.addSegment=function(a,b,c,e,d,g,f,h){var k=c-a,l=e-b,m=0;if(k||l)m=Math.atan2(l,k);var n=Math.sqrt(k*k+l*l);d*=0.5;var k=this.addVertexLine(a,b,m,n,d,g,f,h,VBB_SEG_START_RIGHT),l=this.addVertexLine(a,b,m,n,d,g,f,h,VBB_SEG_END_RIGHT),r=this.addVertexLine(a,b,m,n,d,g,f,h,VBB_SEG_END_LEFT);d=this.addVertexLine(a,b,m,n,d,g,f,h,VBB_SEG_START_LEFT);this.addTriangle(k,l,r);this.addTriangle(k,r,d);this.addToBounds(a,b);this.addToBounds(c,e)};
VertexBufferBuilder.prototype.addCircularArc=function(a,b,c,e,d,g,f,h,k){this.expandStride();var l=Math.abs(c-e);if(1E-4<l&&1E-4<Math.abs(l-TAU)){var l=a+d*Math.cos(c),m=b+d*Math.sin(c);this.addSegment(l,m,l,m,g,f,h,k);l=a+d*Math.cos(e);m=b+d*Math.sin(e);this.addSegment(l,m,l,m,g,f,h,k)}else this.addToBounds(a-d,b-d),this.addToBounds(a+d,b+d);g*=0.5;var l=this.addVertexArc(a,b,c,e,d,d,0,g,f,h,k,VBB_SEG_START_RIGHT),m=this.addVertexArc(a,b,c,e,d,d,0,g,f,h,k,VBB_SEG_END_RIGHT),n=this.addVertexArc(a,
b,c,e,d,d,0,g,f,h,k,VBB_SEG_END_LEFT);a=this.addVertexArc(a,b,c,e,d,d,0,g,f,h,k,VBB_SEG_START_LEFT);this.addTriangle(l,m,n);this.addTriangle(l,n,a)};
VertexBufferBuilder.prototype.addEllipticalArc=function(a,b,c,e,d,g,f,h,k,l,m){this.expandStride();var n=Math.abs(c-e);if(1E-4<Math.abs(n-TAU)){var n=a+d*Math.cos(c),r=b+g*Math.sin(c);this.addSegment(n,r,n,r,h,k,l,m);n=a+d*Math.cos(e);r=b+g*Math.sin(e);this.addSegment(n,r,n,r,h,k,l,m)}else this.addToBounds(a-d,b-g),this.addToBounds(a+d,b+g);h*=0.5;var n=this.addVertexArc(a,b,c,e,d,g,f,h,k,l,m,VBB_SEG_START_RIGHT),r=this.addVertexArc(a,b,c,e,d,g,f,h,k,l,m,VBB_SEG_END_RIGHT),p=this.addVertexArc(a,b,
c,e,d,g,f,h,k,l,m,VBB_SEG_END_LEFT);a=this.addVertexArc(a,b,c,e,d,g,f,h,k,l,m,VBB_SEG_START_LEFT);this.addTriangle(n,r,p);this.addTriangle(n,p,a)};
VertexBufferBuilder.prototype.addTexturedQuad=function(a,b,c,e,d,g){var f=0.5*e,h=this.addVertexLine(a,b+f,0,c,-f,4278255615,d,g,VBB_SEG_START_RIGHT,VBB_TEX_QUAD),k=this.addVertexLine(a,b+f,0,c,-f,4278255615,d,g,VBB_SEG_END_RIGHT,VBB_TEX_QUAD),l=this.addVertexLine(a,b+f,0,c,-f,4278255615,d,g,VBB_SEG_END_LEFT,VBB_TEX_QUAD);d=this.addVertexLine(a,b+f,0,c,-f,4278255615,d,g,VBB_SEG_START_LEFT,VBB_TEX_QUAD);this.addTriangle(h,k,l);this.addTriangle(h,l,d);this.addToBounds(a,b);this.addToBounds(a+c,b+e)};
VertexBufferBuilder.prototype.isFull=function(a){a||(a=3);return 32767<=this.vcount+a};
VertexBufferBuilder.prototype.toMesh=function(){var a={};a.vb=new Float32Array(this.vb.slice(0,this.vcount*this.stride*4));a.vbstride=this.stride;a.indices=new Uint16Array(this.ib.buffer.slice(0,2*this.icount));a.vblayout={position:{offset:0,itemSize:3,bytesPerItem:4},uv:{offset:3,itemSize:2,bytesPerItem:4},color4b:{offset:5,itemSize:4,bytesPerItem:1,normalize:!0},dbId4b:{offset:6,itemSize:4,bytesPerItem:1,normalize:!0},flags4b:{offset:7,itemSize:4,bytesPerItem:1,normalize:!1}};8<this.stride&&(a.vblayout.extraParams=
{offset:8,itemSize:4,bytesPerItem:4,normalize:!1});var b=a.boundingBox=new THREE.Box3,c=Math.max(this.maxx-this.minx,this.maxy-this.miny);b.min.set(this.minx,this.miny,0.001*-c);b.max.set(this.maxx,this.maxy,0.001*c);Autodesk.Viewing.Private.VBUtils.computeBounds2D(a);return a};function readOpenCTM_RAW(a,b){var c=a.getString(4);if("INDX"!=c)return null;for(var e=b.vertexCount,d=b.triangleCount,g=b.indices=new Uint16Array(3*d),c=0,d=3*d;c<d;c++)g[c]=a.getInt32();c=a.getString(4);if("VERT"!=c)return null;for(var g=b.vbstride,d=b.vb,c=0,f=b.vblayout.position.offset;c<e;c++,f+=g)d[f]=a.getFloat32(),d[f+1]=a.getFloat32(),d[f+2]=a.getFloat32();if(b.flags&1){c=a.getString(4);if("NORM"!=c)return null;c=0;for(f=b.vblayout.normal.offset;c<e;c++,f+=g)d[f]=a.getFloat32(),d[f+1]=a.getFloat32(),
d[f+2]=a.getFloat32()}for(var h=0;h<b.texMapCount;h++){c=a.getString(4);if("TEXC"!=c)return null;c={name:a.getString(a.getInt32()),file:a.getString(a.getInt32())};b.uvs.push(c);f="uv";h&&(f+=(h+1).toString());c=0;for(f=b.vblayout[f].offset;c<e;c++,f+=g)d[f]=a.getFloat32(),d[f+1]=a.getFloat32()}for(h=0;h<b.attribMapCount;h++){c=a.getString(4);if("ATTR"!=c)return null;c={name:a.getString(a.getInt32())};if(-1!=c.name.indexOf("Color"))for(c=0,f=b.vblayout.color.offset;c<e;c++,f+=g)d[f]=a.getFloat32(),
d[f+1]=a.getFloat32(),d[f+2]=a.getFloat32(),a.getFloat32();else b.attrs.push(c),a.getBytes(16*e)}}
var readOpenCTM=function(a){if("OCTM"!=a.getString(4)||5!=a.getInt32())return null;var b=a.getString(3);a.getUint8();var c={stream:null,vertices:null,indices:null,normals:null,colors:null,uvs:[],attrs:[]};c.vertexCount=a.getInt32();c.triangleCount=a.getInt32();c.texMapCount=a.getInt32();c.attribMapCount=a.getInt32();c.flags=a.getInt32();c.comment=a.getString(a.getInt32());c.vbstride=3;c.flags&1&&(c.vbstride+=3);c.vbstride+=2*(c.texMapCount||0);0<c.attribMapCount&&(c.vbstride+=3);c.vblayout={};var e=
0;c.vblayout.position={offset:e,itemSize:3};e+=3;c.flags&1&&(c.vblayout.normal={offset:e,itemSize:3},e+=3);if(c.texMapCount)for(var d=0;d<c.texMapCount;d++){var g="uv";d&&(g+=(d+1).toString());c.vblayout[g]={offset:e,itemSize:2};e+=2}c.attribMapCount&&(c.vblayout.color={offset:e,itemSize:3});c.vb=new Float32Array(c.vertexCount*c.vbstride);return"RAW"==b?(readOpenCTM_RAW(a,c),Autodesk.Viewing.Private.VBUtils.deduceUVRepetition(c),Autodesk.Viewing.Private.VBUtils.computeBounds3D(c),c):"MG2"==b?(readOpenCTM_MG2(a,
c),Autodesk.Viewing.Private.VBUtils.deduceUVRepetition(c),Autodesk.Viewing.Private.VBUtils.computeBounds3D(c),c):null},readLines=function(a,b){var c={isLines:!0,vertices:null,indices:null,colors:null,normals:null,uvs:[],attrs:[]},e,d;1<b.version?(c.vertexCount=a.readU16(),e=a.readU16(),d=a.readU16()):(c.vertexCount=a.readU32V(),e=a.readU32V(),d=a.readU32V());var g=0!=a.stream.getUint8();c.vbstride=3;g&&(c.vbstride+=3);c.vblayout={};var f=0;c.vblayout.position={offset:f,itemSize:3};g&&(c.vblayout.color=
{offset:f+3,itemSize:3});c.vb=new Float32Array(c.vertexCount*c.vbstride);for(var h=c.vb,k=c.vbstride,l=a.stream,m=0,f=c.vblayout.position.offset,n=c.vertexCount;m<n;m++,f+=k)h[f]=l.getFloat32(),h[f+1]=l.getFloat32(),h[f+2]=l.getFloat32();if(g)for(m=0,f=c.vblayout.color.offset,g=c.vertexCount;m<g;m++,f+=k)h[f]=l.getFloat32(),h[f+1]=l.getFloat32(),h[f+2]=l.getFloat32(),l.getFloat32();m=function(a){return a.buffer.slice(a.byteOffset,a.byteOffset+a.length)};1<b.version?(e=new Uint16Array(m(l.getBytes(2*
e))),l=new Uint16Array(m(l.getBytes(2*d)))):(e=new Int32Array(m(l.getBytes(4*e))),l=new Int32Array(m(l.getBytes(4*d))));m=l[d-1]-d+1;debug(m);c.indices=new Uint16Array(2*m);for(m=f=0;m+1<d;m++)for(h=l[m];h+1<l[m+1];h++)c.indices[f++]=e[h],c.indices[f++]=e[h+1];Autodesk.Viewing.Private.VBUtils.computeBounds3D(c);return c};
function readGeometry(a,b,c){return(b=a.seekToEntry(b))?"Autodesk.CloudPlatform.OpenCTM"==b.entryType?readOpenCTM(a.stream):"Autodesk.CloudPlatform.Lines"==b.entryType?readLines(a,b):null:null};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.convertMaterials=function(a){var b=function(a,b){var c=new THREE.Color;if(!a||!a.colors)return c.setRGB(1,0,0);var d=a.colors[b];if(!d)return c.setRGB(0,0,0);d=d.values;if(!d||!d.length)return c.setRGB(1,0,0);d=d[0];return c.setRGB(d.r,d.g,d.b)},c=function(a,b){if(!a||!a.scalars)return 0;var c=a.scalars[b];return c?c.values[0]:void 0},e=function(a,b){if(!a||!a.booleans)return 0;var c=a.booleans;return c?c[b]:void 0},d=a.materials.materials;a.simplemats={};for(var g in d){var f=
d[g],h=f.materials,k=h[f.userassets[0]];if(k&&"SimplePhong"==k.definition){var f=k.properties,l={};l.ambient=b(f,"generic_ambient");l.color=b(f,"generic_diffuse");l.specular=b(f,"generic_specular");l.emissive=b(f,"generic_emissive");var m=c(f,"generic_glossiness");m||(m=30);l.shininess=m;(m=c(f,"generic_transparency"))||(m=0);l.opacity=1-m;(m=c(f,"generic_reflectivity_at_0deg"))||(m=0);l.reflectivity=m;m=e(f,"generic_is_metal");void 0!==m&&(l.metal=m);m=e(f,"generic_backface_cull");void 0!==m&&(l.doubleSided=
!m);l.transparent=k.transparent;var k=k.textures,n;for(n in k){var m=h[k[n].connections[0]].properties,r=m.uris.unifiedbitmap_Bitmap.values[0],p=null;if(r)if("generic_diffuse"==n){if(p="map",!l.color||0==l.color.r&&0==l.color.g&&0==l.color.b)l.color=new THREE.Color(1,1,1)}else"generic_bump"==n?(p=e(f,"generic_bump_is_normal")?"normalMap":"bumpMap",l.bumpScale=c(f,"generic_bump_amount")):"generic_specular"==n?p="specularMap":"generic_reflection"!=n&&"generic_alpha"==n&&(p="opacityMap");p&&(l["uri_"+
p]=r,(r=c(m,"texture_UScale"))&&(l["uscale_"+p]=r),(r=c(m,"texture_VScale"))&&(l["vscale_"+p]=r))}a.simplemats[g]=l}}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.readLightDefinition=function(a,b){var c=a.seekToEntry(b);if(!c||1<c.version)return null;c=a.stream;return{position:a.readVector3f(),dir:a.readVector3f(),r:c.getFloat32(),g:c.getFloat32(),b:c.getFloat32(),intensity:c.getFloat32(),spotAngle:c.getFloat32(),size:c.getFloat32(),type:c.getUint8()}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.readCameraDefinition=function(a,b){var c=a.seekToEntry(b.definition);if(!c||2<c.version)return null;var e=a.stream,d={isPerspective:!e.getUint8(),position:a.readVector3f(),target:a.readVector3f(),up:a.readVector3f(),aspect:e.getFloat32(),fov:THREE.Math.radToDeg(e.getFloat32())};2>c.version&&(e.getFloat32(),e.getFloat32());d.orthoScale=e.getFloat32();d.inst=b;return d};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.FragList=function(){this.numLoaded=this.length=0;this.mesh2frag=this.fragId2dbId=this.entityIndexes=this.packIds=this.materials=this.transforms=this.boxes=null};
Autodesk.Viewing.Private.readGeometryMetadata=function(a,b){var c=a.getEntryCounts(),e=a.stream;b.length=c;for(var d=b.fragTypes=new Uint8Array(c),g=b.primCounts=new Uint16Array(c),f=b.packIds=new Int32Array(c),h=b.entityIndexes=new Int32Array(c),k=0;k<c&&a.seekToEntry(k);k++)d[k]=e.getUint8(),e.seek(e.offset+24),g[k]=e.getUint16(),f[k]=parseInt(a.readString()),h[k]=a.readU32V()};
Autodesk.Viewing.Private.readFragments=function(a,b){function c(a){a*=6;for(var b=0;6>b;b++)f[a++]=g.getFloat32()}function e(a,b,c){a*=6;for(var d=0;6>d;d++)f[a++]=g.getFloat32()+b[c+d%3]}var d=a.getEntryCounts(),g=a.stream;b.length=d;b.numLoaded=0;for(var f=b.boxes=new Float32Array(6*d),h=b.transforms=new Float32Array(16*d),k=b.materials=new Int32Array(d),l=b.packIds=new Int32Array(d),m=b.entityIndexes=new Int32Array(d),n=b.geomDataIndexes=new Int32Array(d),d=b.fragId2dbId=new Int32Array(d),r=0,
p=b.length;r<p;r++){var t=a.seekToEntry(r);if(!t)break;if(5<t.version)break;4<t.version&&a.readU8();k[r]=a.readU32V();2<t.version?n[r]=a.readU32V():(l[r]=parseInt(a.readString()),m[r]=a.readU32V());a.readTransform(r,h,16*r);3<t.version?e(r,h,16*r+12):c(r);1<t.version&&(d[r]=a.readU32V())}};
Autodesk.Viewing.Private.filterFragments=function(a,b){a.length=b.length;a.numLoaded=0;for(var c=a.length,e=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],d=new Float32Array(6*c),g=new Float32Array(16*c),f=new Int32Array(c),h=new Int32Array(c),c=new Int32Array(c),k={},l=0;l<b.length;++l){for(var m=b[l],n=6*m,r=6*l,p=0;6>p;++p)d[r++]=a.boxes[n++];n=16*m;r=16*l;for(p=0;16>p;++p)g[r++]=a.transforms[n++];f[l]=a.materials[m];h[l]=a.packIds[m];c[l]=a.entityIndexes[m];p=a.packIds[m]+":"+a.entityIndexes[m];
m=k[p];void 0==m?k[p]=l:Array.isArray(m)?m.push(l):k[p]=[m,l];m=6*l;for(p=0;3>p;++p)d[m+p]<e[p]&&(e[p]=d[m+p]);for(p=3;6>p;++p)d[m+p]>e[p]&&(e[p]=d[m+p])}a.boxes=d;a.transforms=g;a.materials=f;a.packIds=h;a.entityIndexes=c;a.mesh2frag=k;return e};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.readInstance=function(a,b){var c=a.seekToEntry(b);if(!c||2<c.version)return null;1<c.version&&a.readU8();return{definition:a.stream.getUint32(),transform:a.readTransform(),instanceNodePath:a.readPathID()}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.Package=function(){this.fragments=this.metadata=this.simplemats=this.materials=this.manifest=null;this.geompacks=[];this.instances=[];this.cameras=[];this.lights=[];this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[]};this.bbox=null;this.pendingRequests=0};
Autodesk.Viewing.Private.Package.prototype.loadAsyncResource=function(a,b,c,e){function d(b){g.pendingRequests--;this.response&&(b=new Uint8Array(this.response),31==b[0]&&139==b[1]&&(b=(new Zlib.Gunzip(b)).decompress()),e(b));0==g.pendingRequests&&g.postLoad(a)}if(c)e(c);else{var g=this;this.pendingRequests++;(new Xhr(a.errorHandler,a.auth,a.viewing_url)).get(a.basePath+b,a.headers,"arraybuffer",d)}};
Autodesk.Viewing.Private.Package.prototype.load=function(a,b){var c=this,e=new Zlib.Unzip(b),d=e.decompress("manifest.json");if(!d)return!1;var g=new Autodesk.Viewing.Private.InputStream(d),f=JSON.parse(g.getString(d.byteLength)),d=e.decompress("metadata.json"),g=new Autodesk.Viewing.Private.InputStream(d);3<d.byteLength&&0!==d[3]&&(this.metadata=JSON.parse(g.getString(d.byteLength)).metadata)&&(g=this.metadata["world bounding box"],this.bbox=new THREE.Box3({x:g.minXYZ[0],y:g.minXYZ[1],z:g.minXYZ[2]},
{x:g.maxXYZ[0],y:g.maxXYZ[1],z:g.maxXYZ[2]}));this.manifest=f;for(var h=f.typesets,g={},d=0;d<h.length;d++){var k=h[d];g[k.id]=k.types}f=f.assets;for(d=0;d<f.length;d++){k=f[d];h=k.type;0==h.indexOf("Autodesk.CloudPlatform.")&&(h=h.substr(23));var l=k.URI,m=k.typeset?g[k.typeset]:null;0!=l.indexOf("embed:/")&&("PackFile"==h?"Autodesk.CloudPlatform.Geometry"==(m?m[0]["class"]:null)&&this.geompacks.push({id:k.id,uri:l}):"PropertyAttributes"==h?this.propertydb.attrs.push(l):"PropertyAVs"==h?this.propertydb.avs.push(l):
"PropertyIDs"==h?this.propertydb.ids.push(l):"PropertyOffsets"==h?this.propertydb.offsets.push(l):"PropertyValues"==h&&this.propertydb.values.push(l));var k=k.URI,n;0==k.indexOf("embed:/")&&(k=k.substr(7),n=e.decompress(k));"ProteinMaterials"==h?-1==k.indexOf("Protein")?this.loadAsyncResource(a,k,n,function(a){var b=new Autodesk.Viewing.Private.InputStream(a);a=a.byteLength;0<a?(c.materials=JSON.parse(b.getString(a)),Autodesk.Viewing.Private.convertMaterials(c)):c.materials=null}):this.loadAsyncResource(a,
k,n,function(a){var b=new Autodesk.Viewing.Private.InputStream(a);a=a.byteLength;c.proteinMaterials=0<a?JSON.parse(b.getString(a)):null}):"FragmentList"==h?this.loadAsyncResource(a,k,n,function(a){a=new Autodesk.Viewing.Private.PackFileReader(a);var b=c.fragments=new Autodesk.Viewing.Private.FragList;Autodesk.Viewing.Private.readFragments(a,b)}):"GeometryMetadataList"==h?this.loadAsyncResource(a,k,n,function(a){a=new Autodesk.Viewing.Private.PackFileReader(a);c.geomMetadata={};Autodesk.Viewing.Private.readGeometryMetadata(a,
c.geomMetadata)}):"PackFile"==h&&(-1!=k.indexOf("CameraDefinitions.bin")?this.loadAsyncResource(a,k,n,function(a){c.camDefPack=new Autodesk.Viewing.Private.PackFileReader(a)}):-1!=k.indexOf("CameraList.bin")?this.loadAsyncResource(a,k,n,function(a){c.camInstPack=new Autodesk.Viewing.Private.PackFileReader(a)}):-1!=k.indexOf("LightDefinitions.bin")?this.loadAsyncResource(a,k,n,function(a){c.lightDefPack=new Autodesk.Viewing.Private.PackFileReader(a)}):-1!=k.indexOf("LightList.bin")&&this.loadAsyncResource(a,
k,n,function(a){c.lightInstPack=new Autodesk.Viewing.Private.PackFileReader(a)}))}0==this.pendingRequests&&this.postLoad(a)};
Autodesk.Viewing.Private.Package.prototype.postLoad=function(a){if(this.camDefPack&&this.camInstPack){for(var b=0,c=this.camInstPack.getEntryCounts();b<c;b++){var e=Autodesk.Viewing.Private.readInstance(this.camInstPack,b);this.cameras.push(Autodesk.Viewing.Private.readCameraDefinition(this.camDefPack,e))}delete this.camDefPack;delete this.camInstPack}if(this.lightDefPack&&this.lightInstPack){b=0;for(c=this.lightInstPack.getEntryCounts();b<c;b++)e=Autodesk.Viewing.Private.readInstance(this.lightInstPack,
b),this.lights.push(Autodesk.Viewing.Private.readLightDefinition(this.lightDefPack,e.definition));delete this.lightInstPack;delete this.lightDefPack}e=this.fragments;if(this.geomMetadata){for(var c=this.geomMetadata,b=0,d=e.length;b<d;b++){var g=e.geomDataIndexes[b];e.entityIndexes[b]=c.entityIndexes[g];e.packIds[b]=c.packIds[g]}delete this.geomMetadata}for(var g=e.mesh2frag={},c=e.packIds,f=e.entityIndexes,b=0,d=e.length;b<d;b++){var h=c[b]+":"+f[b],k=g[h];void 0===k?g[h]=b:Array.isArray(k)?k.push(b):
g[h]=[k,b]}if(!this.bbox){c=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];d=e.boxes;g=0;for(e=e.length;g<e;g++){f=6*g;for(b=0;3>b;b++)d[f+b]<c[b]&&(c[b]=d[f+b]);for(b=3;6>b;b++)d[f+b]>c[b]&&(c[b]=d[f+b])}this.bbox=new THREE.Box3(new THREE.Vector3(c[0],c[1],c[2]),new THREE.Vector3(c[3],c[4],c[5]))}g=a.objectIds;if(null!=g){c=[];e=[];for(b=0;b<g.length;++b)for(d=0;d<this.fragments.length;++d)this.fragments.fragId2dbId[d]==g[b]&&(c.push(this.fragments.packIds[d]),e.push(d));d=1;g=c.length;
for(b=1;b<g;){for(;b<g&&c[b]==c[b-1];)++b;if(g==b)break;c[d++]=c[b++]}c.splice(d-1,g-d);g=[];for(b=0;b<this.geompacks.length;++b)for(d=0;d<c.length;++d)parseInt(this.geompacks[b].id)==c[d]&&g.push(this.geompacks[b]);this.geompacks=g;b=Autodesk.Viewing.Private.filterFragments(this.fragments,e);this.bbox=new THREE.Box3(new THREE.Vector3(b[0],b[1],b[2]),new THREE.Vector3(b[3],b[4],b[5]))}a.loadDoneCB(!0)};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.PackFileReader=function(a){31==a[0]&&139==a[1]&&(a=(new Zlib.Gunzip(a)).decompress());this.tempQuat=new THREE.Quaternion;this.tempTrans=new THREE.Vector3;this.tempScale=new THREE.Vector3;this.tempMat=new THREE.Matrix4;a=this.stream=new Autodesk.Viewing.Private.InputStream(a);var b=a.getInt32();this.type=a.getString(b);this.version=a.getInt32();this.types=null;this.entryOffsets=[];a.seek(a.byteLength-8);var c=a.getUint32();this.typesOffset=a.getUint32();a.seek(this.typesOffset);
var e=this.readU32V();this.types=[];for(b=0;b<e;++b)this.types.push({entryClass:this.readString(),entryType:this.readString(),version:this.readU32V()});a.seek(c);c=this.readU32V();e=this.entryOffsets;for(b=0;b<c;++b)e.push(a.getUint32());a.seek(0)};Autodesk.Viewing.Private.PackFileReader.prototype.readVarint=function(){var a,b=0,c=0;do a=this.stream.getUint8(),b|=(a&127)<<c,c+=7;while(a&128);return b};Autodesk.Viewing.Private.PackFileReader.prototype.readU32V=Autodesk.Viewing.Private.PackFileReader.prototype.readVarint;
Autodesk.Viewing.Private.PackFileReader.prototype.readU16=function(){return this.stream.getUint16()};Autodesk.Viewing.Private.PackFileReader.prototype.readU8=function(){return this.stream.getUint8()};Autodesk.Viewing.Private.PackFileReader.prototype.readString=function(){return this.stream.getString(this.readU32V())};Autodesk.Viewing.Private.PackFileReader.prototype.readVector3f=function(){var a=this.stream;return new THREE.Vector3(a.getFloat32(),a.getFloat32(),a.getFloat32())};
Autodesk.Viewing.Private.PackFileReader.prototype.readTransform=function(a,b,c){function e(a){a.set(f.getFloat32(),f.getFloat32(),f.getFloat32(),f.getFloat32())}function d(a){a.set(f.getFloat64(),f.getFloat64(),f.getFloat64())}function g(){m.identity();for(var a=0;3>a;++a)for(var b=0;3>b;++b)m.elements[4*a+b]=f.getFloat32()}var f=this.stream,h=this.tempTrans,k=this.tempQuat,l=this.tempScale,m=this.tempMat;switch(f.getUint8()){case 4:m.identity();break;case 0:d(h);m.makeTranslation(h.x,h.y,h.z);break;
case 1:e(k);d(h);m.compose(h,k,l.set(1,1,1));break;case 2:var n=f.getFloat32();e(k);d(h);m.compose(h,k,l.set(n,n,n));break;case 3:g(),d(h),m.setPosition(h)}if(void 0!==a)for(a=m.elements,h=0;16>h;h++)b[c++]=a[h];else return(new THREE.Matrix4).copy(m)};Autodesk.Viewing.Private.PackFileReader.prototype.getEntryCounts=function(){return this.entryOffsets.length};
Autodesk.Viewing.Private.PackFileReader.prototype.seekToEntry=function(a){var b=this.getEntryCounts();if(a>=b)return null;this.stream.seek(this.entryOffsets[a]);a=this.stream.getUint32();return a>=this.types.length?null:this.types[a]};
Autodesk.Viewing.Private.PackFileReader.prototype.readPathID=function(){var a=this.stream;if(2>this.version){var b=a.getUint16();if(!b)return null;a.getUint16();if(1==b)return"";for(var c=a.getUint16(),e=2;e<b;++e)c+="/"+a.getUint16()}else{b=this.readU32V();if(!b)return null;this.readU32V();if(1==b)return"";c=this.readU32V();for(e=2;e<b;++e)c+="/"+this.readU32V()}return c};function PropertyDatabase(a){function b(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);a=decodeURIComponent(escape(b));return JSON.parse(a)}function c(a,b){for(var c=b,d="";c<a.length-1;){var e=a[c];if(44==e&&(10==a[c+1]||13==a[c+1]))break;if(10==e||13==e)break;d+=String.fromCharCode(e);c++}c=decodeURIComponent(escape(d));return JSON.parse(c)}function e(a,b){for(var c=0,d=0,e=a.length;d<e;d++)44==a[d]&&c++;c++;for(var e=new Uint32Array(c+(b?1:0)),d=0,f=a.length;91!=a[d]&&d<f;)d++;
if(d==a.length)return null;d++;for(var g=!1,h=c=0;d<f;){var k=a[d];48<=k&&57>=k?(h=10*h+(k-48),g=!0):44==k||93==k?g&&(e[c++]=h,g=!1,h=0):(g=!1,h=0);d++}return e}function d(a){for(var b=0,c=a.length-1,d=0;d<c;d++)44!=a[d]||10!=a[d+1]&&13!=a[d+1]||b++;if(!b)return null;b++;for(var e=new Uint32Array(b),b=d=0;91!=a[d]&&d<c;)d++;d++;e[b++]=d;for(var f=!1;d<c;)10==a[d]||13==a[d]?f=!0:f&&(f=!1,e[b++]=d),d++;return e}function g(a){var b=0<=a?Math.floor(a):Math.ceil(a);return{intPart:b,fracPart:a-b}}function f(a,
b,c){var d="";0===a&&(a=0);c&&0===a&&(d+="-");0===g(a).fracPart?d+=a:0<b?(a=a.toFixed(b),b=/^\-?([0-9]+)\.0+$/.exec(a),d=null!==b?d+b[1]:d+a):d+=a.toFixed(0);return d}var h,k,l,m,n,r,p,t,s,u,v,w,z;for(z in a.attrs){h=b(a.attrs[z]);for(var x=0;x<h.length;x++){var y=h[x][1];"__parent__"==y?s=x:"__child__"==y?t=x:"__name__"==y?u=x:"__instanceof__"==y?v=x:"__viewable_in__"==y&&(w=x)}break}for(z in a.avs){l=e(a.avs[z],0);delete a.avs;break}for(z in a.offsets){k=e(a.offsets[z],1);k[k.length-1]=l.length/
2;delete a.offsets;break}for(z in a.values){m=a.values[z];n=d(m);break}for(z in a.ids){r=a.ids[z];p=d(r);break}this.getObjectCount=function(){return k.length-1};this.getValueAt=function(a){return c(m,n[a])};this.getIntValueAt=function(a){var b=0;a=n[a];for(34==m[a]&&a++;a<m.length-1;){var c=m[a];if(44==c&&(10==m[a+1]||13==m[a+1]))break;if(10==c||13==c||34==c)break;48<=c&&57>=c&&(b+=10*b+(c-48));a++}return b};this.getIdAt=function(a){return c(r,p[a])};this.getObjectProperties=function(a){var b={dbId:a,
name:"",properties:[]},c=null,d=2*k[a+1];for(a=2*k[a];a<d;a+=2){var e=l[a];if(e==u)e=this.getValueAt(l[a+1]),b.name=e;else if(e==v)(e=this.getObjectProperties(this.getValueAt(l[a+1])))&&e.properties&&(c=e);else if(e!=s&&e!=t&&e!=w){var f=h[e],g=f[5]?f[5]:f[0],e=this.getValueAt(l[a+1]);b.properties.push({displayName:g,displayValue:this.formatValueWithUnits(e,f[3],f[2])})}}if(c){d={};e=b.properties;for(a=0;a<e.length;a++)d[e[a].displayName]=1;b.name||(b.name=c.name);c=c.properties;for(a=0;a<c.length;a++)d.hasOwnProperty(c[a].displayName)||
e.push(c[a])}return b};this.findRootNodes=function(){for(var a=[],b=1,c=k.length;b<c;b++){for(var d=!1,e=!1,f=!1,g=2*k[b+1],h=2*k[b];h<g;h+=2){var m=l[h];m==s?this.getIntValueAt(l[h+1])&&(e=!0):m==t?d=!0:m==u&&(f=!0)}d&&f&&!e&&a.push(b)}return a};this.getNodeNameAndChildren=function(a,b){for(var c=a.dbId,d=2*k[c+1],e,c=2*k[c];c<d;c+=2){var f=l[c];f!=s&&(f!=t||b?f==u?(f=this.getValueAt(l[c+1]),a.name=f):f==v&&(f={dbId:this.getValueAt(l[c+1]),name:null},this.getNodeNameAndChildren(f,!0),f&&f.name&&
!a.name&&(a.name=f.name)):(f=this.getValueAt(l[c+1]),f={dbId:f,parent:a},e?e.push(f):e=[f]))}return e};this.buildObjectTree=function(a,b,c,d){c>d[0]&&(d[0]=c);var e=this.getNodeNameAndChildren(a);if(e){for(var f=0;f<e.length;f++)this.buildObjectTree(e[f],b,c+1,d);for(f=0;f<e.length;f++)if(e[f].children||void 0!==e[f].fragIds)a.children?a.children.push(e[f]):a.children=[e[f]]}else b=b[a.dbId],void 0!==b&&(a.fragIds=b)};this.bruteForceSearch=function(a){a=a.toLowerCase();for(var b=[],c=[],d=0,e=n.length;d<
e;d++){var f=this.getValueAt(d);"string"==typeof f?-1!=f.toLowerCase().indexOf(a)&&c.push(d):-1!=f.toString().toLowerCase().indexOf(a)&&c.push(d)}a=1;for(e=k.length;a<e;a++)for(f=2*k[a+1],d=2*k[a];d<f;d+=2)if(-1!=c.indexOf(l[d+1])){b.push(a);break}return b};this.formatValueWithUnits=function(a,b,c){1==c?a=a?"Yes":"No":"ft"===b||"feet"===b||"foot"===b?a=this.formatFeet(12*a):"in"===b||"inch"===b?a=this.formatFeet(a):3===c&&b?(b=b.replace("^2",String.fromCharCode(178)),b=b.replace("^3",String.fromCharCode(179)),
a=f(a,2)+" "+b):a=b?a+" "+b:3==c?f(a,3):a;return a};this.formatFeet=function(a){if(isNaN(a))return"NaN";var b="",c=16,d=0>a;a=0<a?a+0.5/c:a-0.5/c;var e=g(a/12).intPart,b=b+(f(e,0,d)+"' "),d=a-12*e;0>d&&(d=-d);a=g(d).intPart;d=g((d-a)*c).intPart;if(0===d||0!==a)b+=f(a,0);if(0!==d){for(0>a&&0>d&&(d=-d);0===d%2;)d/=2,c/=2;0!==a&&(b+="-");b+=f(d,0)+"/"+f(c,0)}return b+'"'}};function Fydo(a){this.metadata=a;this.scaleY=this.scaleX=1;this.bbox=new THREE.Box3;this.is2d=!0;this.layersList=[];if(a){this.paperWidth=parseFloat(a.paperWidth);this.paperHeight=parseFloat(a.paperHeight);this.scaleX=this.paperWidth/parseFloat(a[".destWidth"]);this.scaleY=this.paperHeight/parseFloat(a[".destHeight"]);this.bbox.min.set(0,0,0);this.bbox.max.set(this.paperWidth,this.paperHeight,0);for(var b in a.layers){var c=parseInt(b),e=null,e=(e=a.layers[c])?e.title:"Default Layer";this.layersList.push({name:e,
index:c})}this.layersList.length&&this.layersList.sort(function(a,b){return a.index-b.index})}this.layersList.length||this.layersList.push({name:"0",index:0});this.opCount=0;this.fontFaces=[];this.fontFamilies=[];this.clip=null;this.layer=this.imageNumber=this.objectNumber=0;this.bgColor=4294967295;this.contrastColor=this.color=this.fillColor=4278190080;this.currentVbb=new VertexBufferBuilder(!1);this.meshes=[];this.numCircles=this.numEllipses=this.numPolylines=this.numLineSegs=0;this.metadata&&(a=
this.paperWidth,b=this.paperHeight,this.currentVbb.addVertexPolytriangle(0,0,0,0,0,4294967295,0,0),this.currentVbb.addVertexPolytriangle(a,0,0,0,0,4294967295,0,0),this.currentVbb.addVertexPolytriangle(a,b,0,0,0,4294967295,0,0),this.currentVbb.addVertexPolytriangle(0,b,0,0,0,4294967295,0,0),this.currentVbb.addTriangle(0,1,2),this.currentVbb.addTriangle(0,2,3),c=0.0075*a,this.currentVbb.addVertexPolytriangle(c,-c,0,0,0,4283782485,0,0),this.currentVbb.addVertexPolytriangle(a+c,-c,0,0,0,4283782485,0,
0),this.currentVbb.addVertexPolytriangle(a+c,0,0,0,0,4283782485,0,0),this.currentVbb.addVertexPolytriangle(c,0,0,0,0,4283782485,0,0),this.currentVbb.addTriangle(4,5,6),this.currentVbb.addTriangle(4,6,7),this.currentVbb.addVertexPolytriangle(a,0,0,0,0,4283782485,0,0),this.currentVbb.addVertexPolytriangle(a+c,0,0,0,0,4283782485,0,0),this.currentVbb.addVertexPolytriangle(a+c,b-c,0,0,0,4283782485,0,0),this.currentVbb.addVertexPolytriangle(a,b-c,0,0,0,4283782485,0,0),this.currentVbb.addTriangle(8,9,10),
this.currentVbb.addTriangle(8,10,11),this.currentVbb.addSegment(0,0,a,0,1E-6,4278190080,0,0),this.currentVbb.addSegment(a,0,a,b,1E-6,4278190080,0,0),this.currentVbb.addSegment(a,b,0,b,1E-6,4278190080,0,0),this.currentVbb.addSegment(0,b,0,0,1E-6,4278190080,0,0));this.fragments={};this.fragments.mesh2frag={};this.fragments.materials=[];this.fragments.length=0}Fydo.prototype.load=function(a,b){31==b[0]&&139==b[1]&&(b=(new Zlib.Gunzip(b)).decompress());this.data=b;this.parse();a.loadDoneCB(!0)};
Fydo.prototype.loadFrames=function(a,b){this.data=b;this.parseFrames();a.loadDoneCB(!0)};var FydoOpcode={kClip:75,kBackColor:66,kColor:67,kFill:70,kLayer:76,kLink:72,kLineCaps:69,kLineJoin:74,kLinePatternDef:68,kLineWeight:87,kMiterLimit:109,kMarkup:77,kObject:79,kResource:82,kFontFace:78,kFontFamily:110,kClipOff:107,kFillOff:102,kLinePatternRef:100,kArc:65,kPolyline:80,kRaster:73,kText:84,kExtended:88,kPolytriangle:83,kUndefined:89};Fydo.prototype.readColor=function(){return this.stream.getInt32()};
Fydo.prototype.readFontFace=function(){for(var a=this.stream,b=a.getUint16(),c={name:a.getString(b),resources:[]},e=a.getUint16(),d=0;d<e;d++)b=a.getUint16(),c.resources.push(a.getString(b));c.flags=a.getUint8();c.panose=a.getBytes(10);this.fontFaces.push(c)};Fydo.prototype.readFontFamily=function(){for(var a=this.stream,b={id:a.getUint16(),names:[]},c=a.getUint16(),e=0;e<c;e++)b.names.push(a.getString(a.getUint16()));this.fontFamilies.push(b)};
Fydo.prototype.readClip=function(){var a=this.stream,b=a.getUint16();this.clip=[];for(var c=0;c<b;c++){for(var e=a.getUint16(),d=new Float32Array(2*e),g=0;g<e;g++)d[2*g]=this.tx(a.getInt32()),d[2*g+1]=this.ty(a.getInt32());this.clip.push(d)}};
Fydo.prototype.readPolyline=function(){var a=this.stream,b=this.objectNumber,c=this.color,e=this.lineWeight,d=this.layer,g=a.getUint32();if(g){this.flushBuffer();var f=this.currentVbb;this.numPolylines++;this.numLineSegs+=g-1;if(this.fill)for(var e=f.vcount,h,k,l,m,n=0;n<g;n++){var r=this.tx(a.getInt32()),p=this.ty(a.getInt32());f.addVertexPolytriangle(r,p,0,0,0,c,b,d);2<=n&&(0<(l-h)*(p-k)-(r-h)*(m-k)?f.addTriangle(e,e+n-1,e+n):f.addTriangle(e,e+n,e+n-1));h=l;k=m;l=r;m=p}else for(h=this.tx(a.getInt32()),
k=this.ty(a.getInt32()),n=1;n<g;n++)l=this.tx(a.getInt32()),m=this.ty(a.getInt32()),this.currentVbb.addSegment(h,k,l,m,e,c,b,d,1==n,n==g-1,!0),h=l,k=m}};
Fydo.prototype.readArc=function(){var a=this.stream,b=this.tx(a.getInt32()),c=this.ty(a.getInt32()),e=this.sx(a.getInt32()),d=this.sy(a.getInt32()),g=a.getFloat32(),f=a.getFloat32()%(2*Math.PI),h=a.getFloat32()%(2*Math.PI);a.getUint8();a.getUint8();a=0.001>Math.abs(h-f);0.01>Math.abs(1-e/d)?(a&&this.fill?(this.flushBuffer(),this.currentVbb.addSegment(b,c,b,c,2*e,this.color,this.objectNumber,this.layer,!0,!1,!0)):(this.flushBuffer(),this.currentVbb.addCircularArc(b,c,a?0:f+g,a?2*Math.PI:h+g,e,this.lineWeight,
this.color,this.objectNumber,this.layer)),this.numCircles++):(this.currentVbb.addEllipticalArc(b,c,f,h,e,d,g,this.lineWeight,this.color,this.objectNumber,this.layer),this.numEllipses++)};
Fydo.prototype.readPolytriangle=function(){var a=this.stream,b,c=a.getUint32();this.flushBuffer(c);var e=this.currentVbb,d=this.currentVbb.vcount;for(b=0;b<c;b++){var g=this.tx(a.getInt32()),f=this.ty(a.getInt32());e.addVertexPolytriangle(g,f,0,0,0,this.color,this.objectNumber,this.layer)}c=a.getUint32();for(b=0;b<c;b+=3){var g=a.getUint16(),f=a.getUint16(),h=a.getUint16();e.addTriangle(d+g,d+f,d+h)}c=a.getUint32();for(b=0;b<c;b++)g=a.getInt32(),e.setVertexColor(d+b,g)};
Fydo.prototype.readRaster=function(){function a(a){for(var b="",c=0,d=a.length,e,f,g;c<d;){e=a[c++]&255;if(c==d){b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>2);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((e&3)<<4);b+="==";break}f=a[c++];if(c==d){b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>2);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((e&3)<<4|(f&240)>>4);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((f&
15)<<2);b+="=";break}g=a[c++];b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>2);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((e&3)<<4|(f&240)>>4);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((f&15)<<2|(g&192)>>6);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g&63)}return b}var b=this.stream;this.flushBuffer(4,!0);var c=this.tx(b.getInt32()),e=this.ty(b.getInt32()),d=b.getUint32(),
g=b.getUint32(),f=this.tx(b.getFloat32()),h=this.ty(b.getFloat32()),b={isPng:b.getUint8(),bits:b.getBytes(b.getUint32()),width:d,height:g};b.dataURI=b.isPng?"data:image/png;base64,"+a(b.bits):"data:image/jpg;base64,"+a(b.bits);b.bits=null;this.currentVbb.addTexturedQuad(c,e-g*h,d*f,g*h,this.objectNumber,this.layer);this.currentImage=b;this.flushBuffer(0,!0)};
Fydo.prototype.readLinePatternDef=function(){var a=this.stream,b={};b.id=a.getUint16();for(var c=a.getUint16(),e=b.def=[],d=0;d<c;d++)e.push(a.getFloat32()),e.push(a.getFloat32());this.linePatterns[b.id]=b};
Fydo.prototype.flushBuffer=function(a,b){if(this.currentVbb.vcount){var c;if(c=b||this.currentVbb.isFull(a))c=this.currentVbb.toMesh(),this.bbox.union(c.boundingBox),this.meshes.push(c),c.material={},this.currentImage&&(c.material.image=this.currentImage,c.material.image.name=this.imageNumber++,this.currentImage=null),this.currentVbb=new VertexBufferBuilder}};Fydo.prototype.tx=function(a){return this.sx(a)};Fydo.prototype.ty=function(a){return this.sy(a)};Fydo.prototype.sx=function(a){return a*this.scaleX};
Fydo.prototype.sy=function(a){return a*this.scaleY};Fydo.prototype.invertColor=function(a){var b,c,e;b=255-(a>>16&255);c=255-(a>>8&255);e=255-(a&255);return(a>>24&255)<<24|b<<16|c<<8|e};Fydo.prototype.mapColor=function(a){return a};
Fydo.prototype.parse=function(){var a;a=this.stream=new Autodesk.Viewing.Private.InputStream(this.data);a.getString(14);for(var b=!1;a.offset<a.byteLength-7;){var c=a.getUint8();switch(c){case FydoOpcode.kBackColor:this.bgColor=this.readColor();this.contrastColor=this.invertColor(this.bgColor);break;case FydoOpcode.kFontFace:this.readFontFace();break;case FydoOpcode.kFontFamily:this.readFontFamily();break;case FydoOpcode.kClip:this.readClip();break;case FydoOpcode.kClipOff:this.clip=null;break;case FydoOpcode.kResource:this.resourceId=
a.getUint16();break;case FydoOpcode.kObject:this.objectNumber=a.getUint32();break;case FydoOpcode.kLineCaps:this.lineCaps=a.getUint8();break;case FydoOpcode.kLineWeight:this.lineWeight=this.sx(a.getInt16());break;case FydoOpcode.kLineJoin:this.lineJoin=a.getUint8();break;case FydoOpcode.kMiterLimit:this.miterAngle=a.getFloat32();this.miterLength=this.sx(a.getFloat32());break;case FydoOpcode.kLinePatternDef:this.readLinePatternDef();break;case FydoOpcode.kLinePatternRef:this.linePatternRef=a.getUint16();
break;case FydoOpcode.kColor:this.color=this.mapColor(this.readColor());break;case FydoOpcode.kFillOff:this.fill=!1;break;case FydoOpcode.kFill:this.fill=!0;this.fillColor=this.readColor();break;case FydoOpcode.kLayer:this.layer=a.getUint16();break;case FydoOpcode.kMarkup:this.markup=a.getUint32();break;case FydoOpcode.kLink:this.linkNum=a.getUint16();break;case FydoOpcode.kPolyline:this.readPolyline();break;case FydoOpcode.kArc:this.readArc();break;case FydoOpcode.kRaster:this.readRaster();break;
case FydoOpcode.kPolytriangle:this.readPolytriangle();break;default:debug("Unexpected opcode "+c),b=!0}if(b)break;this.opCount++}this.flushBuffer(0,!0);this.currentVbb=null;this.fragments.length=this.meshes.length;for(a=0;a<this.meshes.length;a++)this.fragments.mesh2frag["0:"+a]=a;this.data=this.stream=null};
Fydo.prototype.parseFrames=function(){var a;a=this.stream=new Autodesk.Viewing.Private.InputStream(this.data);for(var b=!1;a.offset<a.byteLength;){var c=a.getUint8();switch(c){case FydoOpcode.kBackColor:this.bgColor=this.readColor();this.contrastColor=this.invertColor(this.bgColor);break;case FydoOpcode.kFontFace:this.readFontFace();break;case FydoOpcode.kFontFamily:this.readFontFamily();break;case FydoOpcode.kClip:this.readClip();break;case FydoOpcode.kClipOff:this.clip=null;break;case FydoOpcode.kResource:this.resourceId=
a.getUint16();break;case FydoOpcode.kObject:this.objectNumber=a.getUint32();break;case FydoOpcode.kLineCaps:this.lineCaps=a.getUint8();break;case FydoOpcode.kLineWeight:this.lineWeight=this.sx(a.getInt16());break;case FydoOpcode.kLineJoin:this.lineJoin=a.getUint8();break;case FydoOpcode.kMiterLimit:this.miterAngle=a.getFloat32();this.miterLength=this.sx(a.getFloat32());break;case FydoOpcode.kColor:this.color=this.mapColor(this.readColor());break;case FydoOpcode.kFillOff:this.fill=!1;break;case FydoOpcode.kFill:this.fill=
!0;this.fillColor=this.readColor();break;case FydoOpcode.kLayer:this.layer=a.getUint16();break;case FydoOpcode.kMarkup:this.markup=a.getUint32();break;case FydoOpcode.kLink:this.linkNum=a.getUint16();break;case FydoOpcode.kPolyline:this.readPolyline();break;case FydoOpcode.kArc:this.readArc();break;case FydoOpcode.kRaster:this.readRaster();break;case FydoOpcode.kPolytriangle:this.readPolytriangle();break;default:debug("Unexpected opcode "+c),b=!0}if(b)break;this.opCount++}this.flushBuffer(0,!0);this.currentVbb=
null;this.fragments.length+=this.meshes.length;for(a=0;a<this.meshes.length;a++)this.fragments.mesh2frag["0:"+a]=a;this.data=this.stream=null};function FydoProbe(){this.data=null;this.frameEnd=this.frameStart=0;this.stream=null;this.opCount=0}FydoProbe.prototype.load=function(a,b){this.data=a;this.frameStart=b;this.stream?(this.stream.reset(this.data),this.stream.seek(b)):(this.stream=new Autodesk.Viewing.Private.CheckedInputStream(this.data),this.stream.seek(14));this.probe();return{frameStart:this.frameStart,frameEnd:this.frameEnd}};
var FydoProbeOpcode={kClip:75,kBackColor:66,kColor:67,kFill:70,kLayer:76,kLink:72,kLineCaps:69,kLineJoin:74,kLinePatternDef:68,kLineWeight:87,kMiterLimit:109,kMarkup:77,kObject:79,kResource:82,kFontFace:78,kFontFamily:110,kClipOff:107,kFillOff:102,kLinePatternRef:100,kArc:65,kPolyline:80,kRaster:73,kText:84,kExtended:88,kPolytriangle:83,kUndefined:89};FydoProbe.prototype.readColor=function(){this.stream.getInt32();this.frameEnd=this.stream.offset};
FydoProbe.prototype.readFontFace=function(){var a=this.stream;a.getString(a.getUint16());for(var b=a.getUint16(),c=0;c<b;c++)a.getString(a.getUint16());a.getUint8();a.getBytes(10);this.frameEnd=this.stream.offset};FydoProbe.prototype.readFontFamily=function(){var a=this.stream;a.getUint16();for(var b=a.getUint16(),c=0;c<b;c++)a.getString(a.getUint16());this.frameEnd=this.stream.offset};
FydoProbe.prototype.readClip=function(){for(var a=this.stream,b=a.getUint16(),c=0;c<b;c++)for(var e=a.getUint16(),d=0;d<e;d++)a.getInt32(),a.getInt32();this.frameEnd=this.stream.offset};FydoProbe.prototype.readPolyline=function(){var a=this.stream,b=a.getUint32();if(b){if(this.fill)var c=0;else a.getInt32(),a.getInt32(),c=1;for(;c<b;c++)a.getInt32(),a.getInt32();this.frameEnd=this.stream.offset}};
FydoProbe.prototype.readArc=function(){var a=this.stream;a.getInt32();a.getInt32();a.getInt32();a.getInt32();a.getFloat32();a.getFloat32();a.getFloat32();a.getUint8();a.getUint8();this.frameEnd=this.stream.offset};FydoProbe.prototype.readPolytriangle=function(){var a=this.stream,b,c=a.getUint32();for(b=0;b<c;b++)a.getInt32(),a.getInt32();c=a.getUint32();for(b=0;b<c;b+=3)a.getUint16(),a.getUint16(),a.getUint16();c=a.getUint32();for(b=0;b<c;b++)a.getInt32();this.frameEnd=this.stream.offset};
FydoProbe.prototype.readRaster=function(){var a=this.stream;a.getInt32();a.getInt32();a.getUint32();a.getUint32();a.getFloat32();a.getFloat32();a.getUint8();a.getBytes(a.getUint32());this.frameEnd=this.stream.offset};FydoProbe.prototype.readLinePatternDef=function(){var a=this.stream;a.getUint16();for(var b=a.getUint16(),c=0;c<b;c++)a.getFloat32(),a.getFloat32();this.frameEnd=this.stream.offset};
FydoProbe.prototype.probe=function(){var a=this.stream,b=!1;try{for(;;){var c=a.getUint8();switch(c){case FydoProbeOpcode.kBackColor:this.bgColor=this.readColor();break;case FydoProbeOpcode.kFontFace:this.readFontFace();break;case FydoProbeOpcode.kFontFamily:this.readFontFamily();break;case FydoProbeOpcode.kClip:this.readClip();break;case FydoProbeOpcode.kClipOff:this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kResource:a.getUint16();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kObject:a.getUint32();
this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kLineCaps:a.getUint8();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kLineWeight:a.getInt16();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kLineJoin:a.getUint8();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kMiterLimit:a.getFloat32();a.getFloat32();this.frameEnd=this.stream.offset;break;case FydoOpcode.kLinePatternDef:this.readLinePatternDef();break;case FydoOpcode.kLinePatternRef:a.getUint16();
this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kColor:this.readColor();break;case FydoProbeOpcode.kFillOff:this.fill=!1;this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kFill:this.fill=!0;this.readColor();break;case FydoProbeOpcode.kLayer:a.getUint16();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kMarkup:a.getUint32();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kLink:a.getUint16();this.frameEnd=this.stream.offset;break;case FydoProbeOpcode.kPolyline:this.readPolyline();
break;case FydoProbeOpcode.kArc:this.readArc();break;case FydoProbeOpcode.kRaster:this.readRaster();break;case FydoProbeOpcode.kPolytriangle:this.readPolytriangle();break;default:debug("error probing fydo with op code: "+c),b=!0}if(b){debug("bad op code : "+c);break}this.opCount++}}catch(e){}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.CheckedInputStream=function(a){this.buffer=a;this.offset=0;this.byteLength=a.length;this.convBuf=new ArrayBuffer(8);this.convUint8=new Uint8Array(this.convBuf);this.convUint16=new Uint16Array(this.convBuf);this.convInt32=new Int32Array(this.convBuf);this.convUint32=new Uint32Array(this.convBuf);this.convFloat32=new Float32Array(this.convBuf);this.convFloat64=new Float64Array(this.convBuf)};
Autodesk.Viewing.Private.OutOfBoundsBufferAccessException=function(a){this.offset=a;this.message="try to access an offset that is out of bounds: "+this.offset;this.toString=function(){return this.message}};Autodesk.Viewing.Private.CheckedInputStream.prototype.boundsCheck=function(a){if(a>=this.byteLength)throw new Autodesk.Viewing.Private.OutOfBoundsBufferAccessException(a);};Autodesk.Viewing.Private.CheckedInputStream.prototype.seek=function(a){this.boundsCheck(a);this.offset=a};
Autodesk.Viewing.Private.CheckedInputStream.prototype.getBytes=function(a){this.boundsCheck(this.offset+a);var b=new Uint8Array(this.buffer.buffer,this.offset,a);this.offset+=a;return b};Autodesk.Viewing.Private.CheckedInputStream.prototype.getUint8=function(){this.boundsCheck(this.offset+1);return this.buffer[this.offset++]};
Autodesk.Viewing.Private.CheckedInputStream.prototype.getUint16=function(){this.boundsCheck(this.offset+2);this.convUint8[0]=this.buffer[this.offset++];this.convUint8[1]=this.buffer[this.offset++];return this.convUint16[0]};Autodesk.Viewing.Private.CheckedInputStream.prototype.getInt16=function(){var a=this.getUint16();32767<a&&(a|=4294901760);return a};
Autodesk.Viewing.Private.CheckedInputStream.prototype.getInt32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convInt32[0]};Autodesk.Viewing.Private.CheckedInputStream.prototype.getUint32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convUint32[0]};
Autodesk.Viewing.Private.CheckedInputStream.prototype.getFloat32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convFloat32[0]};Autodesk.Viewing.Private.CheckedInputStream.prototype.getFloat64=function(){this.boundsCheck(this.offset+8);for(var a=this.buffer,b=this.convUint8,c=this.offset,e=0;8>e;e++)b[e]=a[c+e];this.offset+=8;return this.convFloat64[0]};
Autodesk.Viewing.Private.CheckedInputStream.prototype.getString=function(a){this.boundsCheck(this.offset+a);for(var b=this.buffer,c="",e=this.offset,d=this.offset+a;e<d;e++)c+=String.fromCharCode(b[e]);this.offset+=a;return decodeURIComponent(escape(c))};Autodesk.Viewing.Private.CheckedInputStream.prototype.reset=function(a){this.buffer=a;this.offset=0;this.byteLength=a.length};AutodeskNamespace("Autodesk.Viewing.Private");var VIEWER2D_NAVIGATION_MODE={PAN:1,ZOOM:2};Autodesk.Viewing.Private.Viewer2DImpl=function(a,b){this.api=a;this.config=b;this.parent=b.domElement;this.navigationMode=null};Autodesk.Viewing.Private.Viewer2DImpl.prototype.constructor=Autodesk.Viewing.Private.Viewer2DImpl;
Autodesk.Viewing.Private.Viewer2DImpl.prototype.initialize=function(){var a=document.createElement("canvas");a.width=1;a.height=1;this.selCtx=a.getContext("2d");this.selCtx.globalCompositeOperation="copy";this.selCtx.imageSmoothingEnabled=!1;this.container=document.createElement("div");this.container.style.width="100%";this.container.style.height="100%";this.parent.appendChild(this.container);return 0};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.load=function(a){var b=this.config.tileSize?this.config.tileSize:1024,c=this.config.maxZoom?this.config.maxZoom:6,e=a.indexOf("urn:");-1!=e&&(a=a.substr(0,e)+encodeURIComponent(a.substr(e)));var e=[a],d=[];for(a=0;a<e.length;a++){var g=L.tileLayer(e[a]+"/{z}/{x}/c{y}.png",{maxZoom:c,noWrap:!0,continuousWorld:!1,detectRetina:!0,tileSize:b});d.push(g)}var f=this.map=L.map(this.container,{center:new L.LatLng(0,0),zoom:0,zoomControl:!1,attributionControl:!1,
layers:[d[0]]});f.options.crs.scale=function(a){return b*Math.pow(2,a)};c={};for(a=0;a<e.length;a++)c[e[a]]=d[3*a];L.control.layers(c,void 0).addTo(f);c=document.getElementsByClassName("leaflet-control-layers");for(a=0;a<c.length;a++)c[a].style.visibility="hidden";f.on("baselayerchange",function(a){console.log(a);var b=[],c;for(c in f._layers){var d=f._layers[c];d!=a.layer&&b.push(d)}for(c=0;c<b.length;c++)f.removeLayer(b[c]);a.layer.idTileLayer&&(f.addLayer(a.layer.idTileLayer),f.addLayer(a.layer.canvasLayer))});
var h=this,k=!1,l,m,n,r,p;this.mousemove=function(a){if(k&&h.navigationMode===VIEWER2D_NAVIGATION_MODE.ZOOM){var b=a.clientX-l,c=a.clientY-m,c=-c;if(2<Math.abs(b)||2<Math.abs(c))b=Math.abs(b)>Math.abs(c)?b:c,b=Math.round(n+b/p),b=Math.max(f.getMinZoom(),Math.min(b,f.getMaxZoom())),f.setZoomAround(r,b,{animate:!0}),a.preventDefault(),a.stopPropagation()}};f.on("mousedown",function(a){k=!0;if(h.navigationMode===VIEWER2D_NAVIGATION_MODE.ZOOM){l=a.originalEvent.clientX;m=a.originalEvent.clientY;n=f.getZoom();
r=f.getCenter();var b=f.getSize(),b=b.x<b.y?b.x:b.y,c=f.getMaxZoom()-f.getMinZoom();p=b/(2*c);f.scrollWheelZoom.disable();window.addEventListener("mousemove",h.mousemove,!1);a.originalEvent.preventDefault();a.originalEvent.stopPropagation()}});f.on("mouseup",function(a){k=!1;h.navigationMode===VIEWER2D_NAVIGATION_MODE.ZOOM&&(f.scrollWheelZoom.enable(),window.removeEventListener("mousemove",h.mousemove,!1),a.originalEvent.preventDefault(),a.originalEvent.stopPropagation())});this.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN);
this.keyup=function(a){var b=document.activeElement.nodeName;if("INPUT"!==b&&"TEXTAREA"!==b){b=!1;if(27===a.keyCode)h.api.fireEvent({type:Autodesk.Viewing.ESCAPE_EVENT}),b=!0;else if(36===a.keyCode||70===a.keyCode||72===a.keyCode)h.goHome(),b=!0;b&&(a.preventDefault(),a.stopPropagation())}};window.addEventListener("keyup",this.keyup,!1);f.fitWorld();return!0};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.uninitialize=function(){window.removeEventListener("mousemove",this.mousemove,!1);window.removeEventListener("keyup",this.keyup,!1);this.map.remove()};Autodesk.Viewing.Private.Viewer2DImpl.prototype.resize=function(){this.map.invalidateSize(!1)};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.setNavigationMode=function(a){var b=!1;this.navigationMode!==a&&(this.navigationMode=a,this.map&&(a===VIEWER2D_NAVIGATION_MODE.PAN?(this.map.dragging.enable(),window.removeEventListener("mousemove",this.mousemove,!1)):a===VIEWER2D_NAVIGATION_MODE.ZOOM&&this.map.dragging.disable()),this.api.fireEvent({type:Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,value:a}),b=!0);return b};
Autodesk.Viewing.Private.Viewer2DImpl.prototype.goHome=function(){this.map.setView([0,0],0,{reset:!0})};var Xhr=function(){var a=function(a,c,e){this.xhr=new XMLHttpRequest;this.errorHandler=a;this.success=!1;this.viewing_url=e;this.auth=c};a.prototype.get=function(a,c,e,d){var g=a.indexOf("urn:");-1!=g&&(a=this.viewing_url+"/items/"+encodeURIComponent(a.substr(g)),c["Access-Control-Allow-Credentials"]=!0,c["Access-Control-Allow-Origin"]="*");try{this.xhr.open("GET",a,!!d);this.xhr.responseType=e;this.success=!1;this.auth&&(this.xhr.withCredentials=!0);d&&(this.xhr.onload=d);for(var f in c)this.xhr.setRequestHeader(f,
c[f]);this.xhr.send()}catch(h){return this.errorHandler&&this.errorHandler.networkFailure(a,h),null}this.errorCheck(a,200);return this.xhr.response};a.prototype.post=function(a,c,e,d){try{this.xhr.open("POST",a,!1);this.xhr.responseType=d;this.success=!1;this.auth&&(this.xhr.withCredentials=!0);for(var g in c)this.xhr.setRequestHeader(g,c[g]);this.xhr.send(e)}catch(f){return this.errorHandler&&this.errorHandler.networkFailure(a,f),null}this.errorCheck(a,200);return this.xhr.response};a.prototype.getRange=
function(a,c,e,d,g,f){var h=a.indexOf("urn:");-1!=h&&(a=this.viewing_url+"/items/"+encodeURIComponent(a.substr(h)),c["Access-Control-Allow-Credentials"]=!0,c["Access-Control-Allow-Origin"]="*");c.Range="bytes="+d+"-"+g;try{this.xhr.open("GET",a,!!f);this.xhr.responseType=e;this.success=!1;this.auth&&(this.xhr.withCredentials=!0);f&&(this.xhr.onload=f);for(var k in c)this.xhr.setRequestHeader(k,c[k]);this.xhr.send()}catch(l){return this.errorHandler&&this.errorHandler.networkFailure(a,l),null}this.errorCheck(a,
206);return this.xhr.response};a.prototype.head=function(a){var c=[],e=a.indexOf("urn:");-1!=e&&(a=this.viewing_url+"/items/"+encodeURIComponent(a.substr(e)),c["Access-Control-Allow-Credentials"]=!0,c["Access-Control-Allow-Origin"]="*");try{this.xhr.open("GET",a,!1);this.success=!1;this.auth&&(this.xhr.withCredentials=!0);for(var d in c)this.xhr.setRequestHeader(d,c[d]);this.xhr.send()}catch(g){return this.errorHandler&&this.errorHandler.networkFailure(a,g),null}this.errorCheck(a,200);c=[];c["Accept-Ranges"]=
this.xhr.getResponseHeader("Accept-Ranges");c["Content-Length"]=this.xhr.getResponseHeader("Content-Length");return c};a.prototype.errorCheck=function(a,c){4===this.xhr.readyState&&this.xhr.status&&this.xhr.status!=c?this.errorHandler&&this.errorHandler.unsuccessfulResponse(a,this.xhr.status,this.xhr.statusText):this.success=!0};return a}(),XhrErrorHandler=function(){var a=function(a){this.host=a;this.ignoreFileNotFound=!1};a.prototype.networkFailure=function(a,c){this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FAILURE,
"Network failure",{url:a,exception:c.toString(),stack:c.stack})};a.prototype.unsuccessfulResponse=function(a,c,e){403==c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED,"Access denied to remote resource",{url:a,httpStatus:c,httpStatusText:e}):404==c?this.ignoreFileNotFound||this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:a,httpStatus:c,httpStatusText:e}):500<=c&&600>c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR,
"Server error when accessing resource",{url:a,httpStatus:c,httpStatusText:e}):this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",{url:a,httpStatus:c,httpStatusText:e})};return a}();var propdb=null,propdbFailed=!1;function loadAsyncResource(a,b,c){}
function loadPropertyPacks(a,b){if(propdb)return!0;if(propdbFailed)return!1;var c=a.propertydb;if(!c)return!1;var e={ids:{},attrs:{},offsets:{},values:{},avs:{}},d=0,g,f;g=c.attrs.length?c.attrs[0]:"objects_attrs.json.gz";(f=requestFile(a.url+g,a))&&(e.attrs[g]=f);d+=!!f;g=c.values.length?c.values[0]:"objects_vals.json.gz";(f=requestFile(a.url+g,a))&&(e.values[g]=f);d+=!!f;g=c.avs.length?c.avs[0]:"objects_avs.json.gz";(f=requestFile(a.url+g,a))&&(e.avs[g]=f);d+=!!f;g=c.offsets.length?c.offsets[0]:
"objects_offs.json.gz";(f=requestFile(a.url+g,a))&&(e.offsets[g]=f);d+=!!f;if(4==d)return propdb=new PropertyDatabase(e),!0;g="objects_attrs.json";f=requestFile(a.url+g,a);e.attrs[g]=f;d+=!!f;g="objects_vals.json";f=requestFile(a.url+g,a);e.values[g]=f;d+=!!f;g="objects_avs.json";f=requestFile(a.url+g,a);e.avs[g]=f;d+=!!f;g="objects_offs.json";f=requestFile(a.url+g,a);e.offsets[g]=f;if(4==d+!!f)return propdb=new PropertyDatabase(e),!0;propdbFailed=!0;return!1}
function doPropertyGet(a,b){var c=b.dbId,e=null;loadPropertyPacks(b,c)&&(e=propdb.getObjectProperties(c));a.postMessage({result:e,dbId:c})}
function computeTreeBBoxes(a,b,c){var e=6*a.dbId;b[e]=b[e+1]=b[e+2]=Infinity;b[e+3]=b[e+4]=b[e+5]=-Infinity;var d=a.children;if(d)for(var g=0,f=d.length;g<f;g++){computeTreeBBoxes(d[g],b,c);for(var h=6*(d[g].dbId|0),k=0;3>k;k++)b[e+k]>b[h+k]&&(b[e+k]=b[h+k]),b[e+k+3]<b[h+k+3]&&(b[e+k+3]=b[h+k+3])}if(void 0!==a.fragIds)if(!Array.isArray(a.fragIds))for(d=6*(a.fragIds|0),k=0;3>k;k++)b[e+k]>c[d+k]&&(b[e+k]=c[d+k]),b[e+k+3]<c[d+k+3]&&(b[e+k+3]=c[d+k+3]);else if(a.fragIds.length)for(g=0;g<a.fragIds.length;g++)for(d=
6*(a.fragIds[g]|0),k=0;3>k;k++)b[e+k]>c[d+k]&&(b[e+k]=c[d+k]),b[e+k+3]<c[d+k+3]&&(b[e+k+3]=c[d+k+3])}function buildDbIdToFragMap(a){for(var b={},c=0,e=a.length;c<e;c++){var d=a[c],g=b[d];void 0===g?b[d]=c:Array.isArray(g)?g.push(c):b[d]=[g,c]}return b}
function doObjectTreeParse(a,b){if(loadPropertyPacks(b,null)){var c=buildDbIdToFragMap(b.fragToDbId),e=propdb.findRootNodes(),d,g=[0];if(1==e.length)d={dbId:e[0]},propdb.buildObjectTree(d,c,0,g);else{d={dbId:0,children:[]};for(var f=0;f<e.length;f++){var h={dbId:e[f]};d.children.push(h);propdb.buildObjectTree(h,c,0,g)}}a.postMessage({instanceTree:d,maxTreeDepth:g[0]});b.fragBoxes&&(c=new Float32Array(6*propdb.getObjectCount()),computeTreeBBoxes(d,c,b.fragBoxes),a.postMessage({instanceBoxes:c}))}}
function doPropertySearch(a,b){var c=[];loadPropertyPacks(b,null)&&(c=propdb.bruteForceSearch(b.searchText));a.postMessage(c)};function doGeomLoad(a,b){var c=new Xhr(b.errorHandler,b.auth,b.viewing_url),e=c.get(b.url,b.headers,"arraybuffer");if(c.success){a.postMessage({url:b.url,workerId:b.workerId,progress:0.5});try{var d=new Autodesk.Viewing.Private.PackFileReader(new Uint8Array(e))}catch(g){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while reading pack file",{url:b.url,exception:g.toString(),stack:g.stack});a.postMessage(null);return}for(var e=c=!1,f={packId:b.packId,meshIndex:0,mesh:null,workerId:b.workerId,
progress:0},h=0,k=d.getEntryCounts();h<k;h++){try{var l=readGeometry(d,h,null)}catch(m){e||(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while reading geometry",{url:b.url,exception:m.toString(),stack:m.stack}),c=e=!0),l=null}f.meshIndex=h;f.mesh=l;f.progress=0.5+(h+1)/k*0.5;if(l)if(_isIE11)a.postMessage(f);else{var n=[];n.push(l.vb.buffer);a.postMessage(f,n)}else c||(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unable to load geometry",{url:b.url}),c=!0),a.postMessage(f)}}else a.postMessage(null)}
;function doLoadSvf(a,b){b.basePath="";var c=b.url.lastIndexOf("/");-1!=c&&(b.basePath=b.url.substr(0,c+1));var c=new Xhr(b.errorHandler,b.auth,b.viewing_url),e=c.get(b.url,b.headers,"arraybuffer");if(c.success){a.postMessage({progress:0.5});var d=new Autodesk.Viewing.Private.Package;b.loadDoneCB=function(c){c?a.postMessage({svf:d}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Failure while loading SVF",{url:b.url}),a.postMessage(null))};try{d.load(b,new Uint8Array(e))}catch(g){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,
"Unhandled exception while loading SVF",{url:b.url,exception:g.toString(),stack:g.stack}),a.postMessage(null)}}else a.postMessage(null)};var ENABLE_OCTM_MG2=!1,IS_WORKER="undefined"!==typeof self&&"undefined"===typeof window;
if(IS_WORKER){IS_CONCAT_BUILD||(importScripts("../AutodeskNamespace.js"),importScripts("../compatibility.js"),importScripts("../render/adsk_three.js"),importScripts("../zlib/gunzip.min.js"),importScripts("../zlib/unzip.min.js"),ENABLE_OCTM_MG2&&(importScripts("../zlib/inflate.min.js"),importScripts("../lmvtk/octm_mg2.js")),importScripts("../lmvtk/InputStream.js"),importScripts("../lmvtk/VbUtils.js"),importScripts("../lmvtk/VertexBufferBuilder.js"),importScripts("../lmvtk/PackReader.js"),importScripts("../lmvtk/Geoms.js"),
importScripts("../lmvtk/Materials.js"),importScripts("../lmvtk/Lights.js"),importScripts("../lmvtk/Cameras.js"),importScripts("../lmvtk/Fragments.js"),importScripts("../lmvtk/Instances.js"),importScripts("../lmvtk/Package.js"),importScripts("../lmvtk/PackReader.js"),importScripts("../lmvtk/Propdb.js"),importScripts("../lmvtk/Fydo.js"),importScripts("../lmvtk/FydoProbe.js"),importScripts("../lmvtk/CheckedInputStream.js"),importScripts("../net/Xhr.js"),importScripts("GeomWorker.js"),importScripts("SvfWorker.js"),
importScripts("PropWorker.js"),importScripts("FydoParseWorker.js"),importScripts("FydoStreamWorker.js"),importScripts("../../api/Viewer.js"),importScripts("../../api/ErrorCodes.js"));self.addEventListener("message",function(a){var b=a.data;b.errorHandler=new XhrErrorHandler(self);a=a.data.operation;"LOAD_GEOMETRY"==a?doGeomLoad(self,b):"LOAD_SVF"==a?doLoadSvf(self,b):"GET_PROPERTIES"==a?doPropertyGet(self,b):"SEARCH_PROPERTIES"==a?doPropertySearch(self,b):"GET_OBJECT_TREE"==a?doObjectTreeParse(self,
b):"PARSE_FYDO"==a?doParseFydo(self,b):"PARSE_FYDO_FRAME"==a?doParseFydoFrame(self,b):"STREAM_FYDO"==a&&doStreamFydo(self,b)},!1);self.raiseError=function(a,b,c){self.postMessage({error:{code:a,msg:b,args:c}})};var requestFile=function(a,b){b.errorHandler.ignoreFileNotFound=!0;var c=new Xhr(b.errorHandler,b.auth,b.viewing_url);if(-1!==a.indexOf(".gz",a.length-3)){var e=c.get(a,b.headers,"arraybuffer");if(c.success)try{var d=new Uint8Array(e);31==d[0]&&139==d[1]&&(d=(new Zlib.Gunzip(d)).decompress());
return d}catch(g){return self.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:a,exception:g.toString(),stack:g.stack}),null}else return null}else return e=c.get(a,b.headers,"arraybuffer"),c.success?new Uint8Array(e):null},debug=function(a){self.postMessage({debug:1,message:a})}};function doLoadFydo(a,b){b.basePath="";var c=b.url.lastIndexOf("/");-1!=c&&(b.basePath=b.url.substr(0,c+1));var c=new Xhr(b.errorHandler,b.auth,b.viewing_url),e=c.get(b.url,b.headers,"arraybuffer");if(c.success){a.postMessage({progress:0.5});var d=new Fydo;b.loadDoneCB=function(c){c?a.postMessage({fydo:d}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Failure while loading FYDO",{url:b.url}),a.postMessage(null))};try{d.load(b,new Uint8Array(e))}catch(g){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,
"Unhandled exception while loading FYDO",{url:b.url,exception:g.toString(),stack:g.stack}),a.postMessage(null)}}else a.postMessage(null)}
function doParseFydo(a,b){if(b.data){a.postMessage({progress:0.5});var c=new Fydo(b.metadata);b.loadDoneCB=function(b){b?a.postMessage({fydo:c}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Failure while loading FYDO",{}),a.postMessage(null))};try{c.load(b,new Uint8Array(b.data))}catch(e){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while loading FYDO",{exception:e.toString(),stack:e.stack}),a.postMessage(null)}}else a.postMessage(null)}
function doParseFydoFrame(a,b){if(b.data){a.postMessage({progress:0.5});var c=new Fydo(b.metadata);b.loadDoneCB=function(b){b?a.postMessage({fydoframe:c}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Failure while loading FYDO",{}),a.postMessage(null))};try{c.loadFrames(b,new Uint8Array(b.data))}catch(e){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while loading FYDO",{exception:e.toString(),stack:e.stack}),a.postMessage(null)}}else a.postMessage(null)};function doStreamFydo(a,b){var c=b.url;b.basePath="";var e=b.url.lastIndexOf("/");-1!=e&&(b.basePath=b.url.substr(0,e+1));var d=new Xhr(null,b.auth,b.viewing_url),g=d.get(b.basePath+"/../../bubble.json",b.headers,"json");g&&(g=g.children[0].children[0].properties.hidden);if(e=d.get(b.basePath+"/../../json/metadata_layers.json",b.headers,"json"))g.layers=e.layers;try{d=new XMLHttpRequest;d.overrideMimeType("text/plain; charset=x-user-defined");var f=new FydoProbe;d.onreadystatechange=function(b,c){return function(){try{if(4==
d.readyState){debug("total op code count yield from probing: "+b.opCount);debug("fydo frame ends at offset: "+b.frameEnd);var c=textToArrayBuffer(d.responseText),e={type:"FYDOBLOB",metadata:g,buffer:c},f=[];f.push(c);a.postMessage(e,f)}}catch(h){debug(h.message)}}}(f,0);d.open("GET",c,!0);d.send()}catch(h){debug(h.message)}}function textToArrayBuffer(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b,0),e=0;e<a.length;e++)c[e]=a.charCodeAt(e)&255;return b}
function concatenateArrayBuffer(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer};function ViewController(a){function b(a){a=THREE.Math.degToRad(a);0>=a&&(a=1E-4);return Math.round(s/Math.tan(0.5*a))}function c(a){0>=a&&(a=1E-4);a=2*Math.atan(s/a);return THREE.Math.radToDeg(a)}function e(a,b){a=2*a-1;b=2*(1-b)-1;if(ua)return H.intersectGroundViewport(a,b);var c=H.castRayViewport(a,b,!1);return c?c.intersectPoint:null}function d(a,b,c){a=v.getPivotDistance();if(b=e(b,c))b=b.sub(v.getPosition()),c=v.getEyeVector().normalize(),a=Math.abs(c.dot(b));v.setTrackingDistance(a)}function g(a){var b=
A.domElement.getBoundingClientRect(),c=b.width,b=b.height,d={};d.x=a.reduce(function(a,b){return a+b.x},0)/a.length;d.y=a.reduce(function(a,b){return a+b.y},0)/a.length;d.scaledX=d.x/c;d.scaledY=d.y/b;return d}function f(a){var b=A.domElement.getBoundingClientRect(),c=b.width,d=b.height,b=a[0].x/c,e=a[0].y/d,c=a[1].x/c;a=a[1].y/d;return Math.sqrt((b-c)*(b-c)+(e-a)*(e-a))}function h(){for(var a=0;a<fa.length;++a)fa[a]=V[a]}function k(a){var b=Math.abs(a.endX-a.startX),c=Math.abs(a.endY-a.startY);a=
a.endTime-a.startTime<=B;return b<=y&&c<=y&&a}function l(a){return Date.now()-a.endTime>=D}function m(a,b){var c=b.startTime-a.endTime,d=Math.abs(b.endX-a.startX),e=Math.abs(b.endY-a.startY),c=c<=D;return d<=C&&e<=C&&c}function n(){null!==ma&&(clearTimeout(ma),ma=null);for(;0<wa.length;){var a=wa.shift();if(k(a))if(0<wa.length){var b=wa.shift();k(b)?m(a,b)?A.handleDoubleTap(a,b):(A.handleSingleTap(a),wa.unshift(b)):A.handleSingleTap(a)}else if(l(a))A.handleSingleTap(a);else{wa.unshift(a);ma=setTimeout(function(){ma=
null;n()},D);break}}}var r=0.5*Math.PI,p=2*Math.PI,t=-1!=navigator.userAgent.search("Mac OS"),s=12;this.setClickBehavior=function(a){this.clickConfig=a};var u=function(){var a=new THREE.Matrix4,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3;return function(e,f,g,h){var k=a.elements;d.subVectors(g,f).normalize();0===d.lengthSq()&&(d.z=1);b.crossVectors(h,d).normalize();0===b.lengthSq()&&(h.z>h.y?d.y-=1E-4:d.z+=1E-4,b.crossVectors(h,d).normalize());c.crossVectors(d,b);k[0]=b.x;k[4]=c.x;
k[8]=d.x;k[1]=b.y;k[5]=c.y;k[9]=d.y;k[2]=b.z;k[6]=c.z;k[10]=d.z;e.setRotationFromMatrix(a)}}();THREE.EventDispatcher.call(this);this.camera=a.camera;this.domElement=a.canvas;this.viewport={left:0,top:0,width:1,height:1};this.downY=this.downX=-1;this.inTouch=this.isDragging=!1;var v=new function(a){var b=0,c=0,d=0,e=0,f=4,g=0.025,h=!1,k=!1,l=null,m={left:0,top:0,width:1,height:1},n=new THREE.Vector3(0,0,0),q=a.position.clone(),s=new THREE.Vector2(0,0),t=a.up.clone();this.saveCOI=function(){l=this.getPivotPoint().clone()};
this.restoreCOI=function(){null!==l&&(this.setPivotPoint(l,!0),l=null)};this.isDirty=function(){return h};this.setScreenViewport=function(a){m=a};this.getPosition=function(){return q.clone().add(this.getViewOffset())};this.setPosition=function(a){this.setView(a,n)};this.getPivotDistance=function(){return d};this.setPivotPoint=function(a,b){if(b){var c=h,d=this.getPosition(),e=new THREE.Vector3;e.subVectors(a,d);var f=this.getCameraRightVector(),g=this.getCameraUpVector(),k=f.dot(e),e=g.dot(e);f.multiplyScalar(k);
g.multiplyScalar(e);d.add(f);d.add(g);this.setView(d,a,-k,-e);h=c}else this.setView(q,a)};this.getPivotPoint=function(){return n};this.getLookAtPoint=function(){return this.getEyeVector().add(q).add(this.getViewOffset())};this.getForwardLookAtPoint=function(b){var c=this.getEyeVector().normalize(),d=this.getPosition();b=(b=b(a,0.5,0.5))?b.sub(d).length():0.5*(a.near+a.far);return d.add(c.multiplyScalar(b))};this.getCameraUpVector=function(){var a=this.getCameraRightVector(),b=this.getEyeVector();
return a.crossVectors(b,a).normalize()};this.getCameraRightVector=function(){var a=new THREE.Vector3,b=this.getWorldUpVector(),c=this.getEyeVector();c.set(-c.x,-c.y,-c.z);a.crossVectors(c,b);0===a.lengthSq()&&(b.z>b.y?c.y-=1E-4:c.z+=1E-4,a.crossVectors(c,b));return a.normalize()};this.setWorldUpVector=function(b){t.copy(b);t.normalize();a.up=t;this.setView(q,n,s.x,s.y)};this.getWorldUpVector=function(){return t.clone()};this.getWorldRightVector=function(){var a=this.getWorldUpVector();Math.abs(a.z)<=
Math.abs(a.y)?a.set(a.y,-a.x,0):0<=a.z?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x);return a.normalize()};this.getEyeVector=function(){var a=new THREE.Vector3;a.subVectors(n,q);k&&a.set(-a.x,-a.y,-a.z);return a};this.setTrackingDistance=function(a){e=a};this.getTrackingSpeed=function(){var b=m.width/m.height,c=2*e*Math.tan(THREE.Math.degToRad(0.5*a.fov));return new THREE.Vector2(c*b,c)};this.trackRelative=function(a,b){var c=this.getTrackingSpeed();s.set(s.x+a*c.x,s.y+b*c.y);h=!0};this.getViewOffset=function(){var a=
this.getCameraUpVector(),b=this.getCameraRightVector().multiplyScalar(s.x),a=a.multiplyScalar(s.y);return b.add(a)};this.adjustDollyLookSpeed=function(a){0===a?(g=0.025,f=4):(g*=0<a?1.15:0.85,f*=0<a?1.05:0.95,1E-6>g&&(g=1E-6),1E-6>f&&(f=1E-6))};this.getDollySpeed=function(){var a=d*g;return 0.01>a?0.01:a};this.coiIsActive=function(){return!0};this.coiIsVisible=function(){if(k)return!1;var b=Math.abs(s.x),c=Math.abs(s.y),e=d*Math.tan(THREE.Math.degToRad(0.5*a.fov));return b<m.width/m.height*e&&c<e};
this.orbitRelative=function(a,e){(1E-6<Math.abs(a)||1E-6<Math.abs(e))&&this.look(b-a*f,c+e*f,d,!0)};this.dollyRelative=function(a,b){1E-6>=Math.abs(a)||(this.coiIsActive()&&this.coiIsVisible()?this.dollyRelativeTowardsCOI(a,b):this.dollyRelativeTowards(a,b,this.getForwardLookAtPoint(b)))};this.dollyRelativeTowards=function(a,b,c){1E-6>=Math.abs(a)||(this.saveCOI(),this.setPivotPoint(c,!0),this.dollyRelativeTowardsCOI(a,b),this.restoreCOI())};this.dollyRelativeTowardsCOI=function(a,b){if(!(1E-6>=Math.abs(a))){a*=
this.getDollySpeed();var c=n.clone().sub(q),d=c.length(),e=d+a;0.01>e&&(e=0.01);d=e/d;1E-6<Math.abs(d-1)&&(c.multiplyScalar(d),c.set(-c.x,-c.y,-c.z),c.add(n),this.setView(c,n,s.x*d,s.y*d))}};this.setView=function(a,b,c,d,e){var f=new THREE.Vector3;f.subVectors(a,b);var g=0,l=0,m=10,p=f.lengthSq();if(0<p){var l=this.getWorldUpVector(),g=this.getWorldRightVector(),m=g.clone().cross(l).normalize(),l=l.dot(f),g=g.dot(f),m=m.dot(f),r=(new THREE.Vector2(g,m)).length(),l=Math.atan2(l,r),g=Math.atan2(g,m),
m=Math.sqrt(p);k=e?!1:0<f.dot(this.getEyeVector())}n.copy(b);q.copy(a);s.set(c||0,d||0);h=!0;this.look(g,l,m,!1)};this.look=function(a,f,g,k){0.01>g&&(g=0.01);a>p?a-=p:0>a&&(a+=p);f>r?f=r-1E-6:f<-r&&(f=-r+1E-6);if(1E-6<Math.abs(b-a)||1E-6<Math.abs(c-f)||1E-6<Math.abs(d-g))h=!0;b=a;c=f;e=d=g;k&&(a=new THREE.Quaternion,f=this.getWorldUpVector(),g=this.getWorldRightVector(),k=g.clone().cross(f).normalize(),a.setFromAxisAngle(g,-c),k.applyQuaternion(a),a.setFromAxisAngle(f,b),k.applyQuaternion(a),q.set(n.x,
n.y,n.z),q.add(k.multiplyScalar(d)),h=!0)};this.updateCamera=function(){a.position=this.getPosition();u(a,this.getLookAtPoint(),a.position,a.up);h=!1};this.oneStepTowards=function(b,c,d,e){if(0<e){e=1/e;var f=new THREE.Vector2(-s.x,-s.y);b=b.clone().sub(q);c=c.clone().sub(n);d-=a.fov;f.multiplyScalar(e).add(s);b.multiplyScalar(e).add(q);c.multiplyScalar(e).add(n);a.fov+=d*e;this.setView(b,c,f.x,f.y,!0)}};this.changeFOV=function(e){6.88>e?e=6.88:100<e&&(e=100);if(e!==a.fov){if(this.coiIsVisible()){var f=
THREE.Math.degToRad(a.fov),g=THREE.Math.degToRad(e),f=d*Math.tan(0.5*f)/Math.tan(0.5*g);this.look(b,c,f,!0)}a.fov=e;h=!0}}}(this.camera),w=Math.cos(45*Math.PI/180),z=Math.tan(45*Math.PI/180),x=Math.tan(20*Math.PI/180),y=8,C=32,B=300,D=300,F=Autodesk.Viewing.NAVIGATION_MODE.ORBIT,O=!1,H=a,I=new THREE.Vector3,E=new THREE.Vector3,P=0,T=null,S=null,U=!1,N,aa,Q=new THREE.Vector3,R=[!1,!1,!1,!1,!1,!1],X=0,ga=0,K=0,ia=0,ha=0,ea=0,Aa=0,Ca=0,Ba=0,Ga=0,oa=0,Ma=0,da=-5,Ha=!1,ja=null,Da=new function(a){var b=
0,c=new THREE.SphereGeometry(1),d=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:0.6,transparent:!0}),e=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:0.6,transparent:!0}),f=new THREE.Mesh(c,e);a.createOverlayScene("pivot",d,e);this.shown=function(){return f.visible};this.show=function(c,g,h){f.scale.x=g;f.scale.y=g;f.scale.z=g;f.position.set(c.x,c.y,c.z);e.opacity=0.6;d.opacity=0.6;f.visible=!0;a.addOverlay("pivot",f);b=h?Date.now()+750:0};this.hide=function(){f.visible&&
(f.visible=!1,a.removeOverlay("pivot",f),b=0)};this.fade=function(){if(0<b){var a=b-Date.now();if(0>=a)return this.hide(),!0;a=a/750*0.6;d.opacity=a;e.opacity=a;return!0}return!1};this.fading=function(){return 0<b}}(a),Ia=new function(a,b){function c(a,b,d,e){a=new THREE.Vector3(a,b,d);b=e.dot(a);e=s.copy(e);e.multiplyScalar(b);return a.sub(e)}function d(a,b){var c=Math.abs(a-b);return c>p?c:Math.min(p-c,c)}function e(a){return a>p?a:0>=a?a+Math.PI:a-Math.PI}function f(a,b,g,h){if(!B){B=new THREE.Object3D;
var k=new THREE.RingGeometry(0.49,0.5,60);w=k=new THREE.Mesh(k,n);var l=new THREE.BoxGeometry(0.93,0.007,0.007),m=new THREE.BoxGeometry(0.007,0.93,0.007),q=new THREE.BoxGeometry(0.007,0.007,0.93);z=new THREE.Mesh(l,n);y=new THREE.Mesh(m,n);F=new THREE.Mesh(q,n);B.add(z);B.add(y);B.add(F);D=new THREE.Mesh(new THREE.CircleGeometry(0.005),n);B.add(D);O=Array(6);E=Array(6);for(l=0;6>l;++l)O[l]=new THREE.Mesh(new THREE.CircleGeometry(0.005,16),n),E[l]=new THREE.Mesh(new THREE.CircleGeometry(0.0025,16),
n),E[l].visible=!1,O[l].add(E[l]),k.add(O[l]);B.add(k)}u(w,b,v.position,h);k=g.clone().normalize();l=Array(3);g=Array(6);l[0]=c(1,0,0,k);l[1]=c(0,1,0,k);l[2]=c(0,0,1,k);m=h.clone().cross(k).normalize();for(k=0;3>k;++k)q=l[k],g[k]=q.length(),g[k]<T?C[k]=S:(q.multiplyScalar(1/g[k]),C[k]=Math.atan2(m.dot(q),h.dot(q)));C[3]=e(C[0]);C[4]=e(C[1]);C[5]=e(C[2]);g[3]=g[0];g[4]=g[1];g[5]=g[2];h=P+Q+2*Math.PI/180;for(k=0;6>k;++k)if(C[k]!==S)for(l=k+1;6>l;++l)if(C[l]!==S&&d(C[k],C[l])<h)if(g[k]<g[l]){C[k]=S;
break}else C[l]=S;for(k=0;6>k;++k)C[k]!==S?(h=s.set(0,0,1),t.setFromAxisAngle(h,C[k]),h=s.set(0,0.54,0),h.applyQuaternion(t),O[k].position.copy(h),O[k].visible=!0):O[k].visible=!1;B.scale.x=a;B.scale.y=a;B.scale.z=a;B.position.copy(b);return B}function g(a,b){for(var c=d(C[0],a),e=0,f=1;6>f;++f){var h=d(C[f],a);h<c&&(c=h,e=f)}return c<b?e:-1}function h(a,b,c){if(0!==a){var d=30*Math.PI/180;b=s.copy(v.position).sub(b).normalize();t.setFromAxisAngle(b,a);a=r.copy(v.up);b=Math.abs(b.angleTo(a));(b<d||
Math.PI-b<d)&&a.copy(c.getCameraUp());a.applyQuaternion(t);c.setWorldUp(a)}}function k(a,b){u(D,b,v.position,a);D.position.copy(a.multiplyScalar(0.495));z.visible=I;y.visible=I;for(var c=(F.visible=I)?Q:P,e=0;6>e;++e){var f=d(C[e],H),g=f<c,f=g?4:3*(1-3*f/Math.PI);1>f&&(f=1);f*=x;E[e].visible=g;g=O[e];g.scale.x=f;g.scale.y=f;g.scale.z=f}}function l(a,b,c){H+=a;H>Math.PI?H-=p:H<=-Math.PI&&(H=p+H);var d;a:{if(!I&&(d=g(H,P),0<=d)){I=!0;H=C[d];r.set(0,0,0);if(0<=d){var e=3<=d?-1:1;d%=3;0===d&&(r.x=e);
1===d&&(r.y=e);2===d&&(r.z=e)}d=r;break a}d=!1}d?(K=H,c.setWorldUp(d)):(I&&0>g(H,Q)?(I=!1,d=!0):d=!1,d?(h(H-K,b,c),K=0):I||h(a,b,c));return!0}var m=2*Math.tan(THREE.Math.degToRad(15)),n=new THREE.MeshPhongMaterial({color:12303291,opacity:0.5,transparent:!0}),q=new THREE.MeshPhongMaterial({color:12303291,opacity:0.5,transparent:!0}),r=new THREE.Vector3,s=new THREE.Vector3,t=new THREE.Quaternion,v=new THREE.PerspectiveCamera(b.fov,b.aspect,b.near,b.far),x=1,w=null,z=null,y=null,F=null,B=null,D=null,
O=null,E=null,C=Array(6),H=0,I=!0,K=0,P=5*Math.PI/180,Q=7*Math.PI/180,S=1E3,T=0.1;a.createOverlayScene("roll",n,q,v);this.updateRollCamera=function(a,c){v.position.copy(b.position);v.quaternion.copy(b.quaternion);v.up.copy(b.up);v.aspect=b.aspect;v.fov=30;a&&c&&(v.near=c-a,v.far=c+a);v.updateProjectionMatrix()};this.isSnapped=function(){return I};this.start=function(c,d){x=0.85/0.7;var e=r.copy(c).sub(b.position),g=e.length(),h=g*m*0.7;this.updateRollCamera(h,g);a.addOverlay("roll",f(h,c,e,d));K=
H=0;k(d,c)};this.handleRoll=function(a,b,c,d,e){this.updateRollCamera();k(e.getCameraUp(),d);B.position.copy(d);return 0!==a||0!==b?(a=c.x-a-0.5,b=c.y-b-0.5,l(Math.atan2(c.y-0.5,c.x-0.5)-Math.atan2(b,a),d,e)):!1};this.handleRollTouch=function(a,b,c,d,e,f){this.updateRollCamera();k(f.getCameraUp(),e);B.position.copy(e);a=Math.atan2(d.y-c.y,d.x-c.x)-Math.atan2(b.y-a.y,b.x-a.x);return l(a,e,f)};this.end=function(){a.removeOverlay("roll",B)}}(a,this.camera),Ra=!1,Sa=!1,sa=!1,pa=!1,Y=0,ya=null,xa=0,Ea=
null,va=null,ta=null,fa=[],V=[],za=null,la=null,ba=null,Z=null,Ua=0,q=new THREE.Projector,Va=-1,Wa=-1,Ka=-1,wa=[],ma=null,ua=!1,A=this;this.homePosition=new THREE.Vector3(0,0,1);this.homeTarget=new THREE.Vector3(0,0,0);this.homeUp=new THREE.Vector3(0,1,0);this.homeFov=this.camera.fov;this.setViewpoint=function(a,b){F!==Autodesk.Viewing.NAVIGATION_MODE.ROLL&&v.setView(a,b,0,0,!0)};this.setCOI=function(a,b){if(F!==Autodesk.Viewing.NAVIGATION_MODE.ROLL||b)v.setPivotPoint(a,b),Da.shown()&&this.activatePivot()};
this.setSelector=function(a){ja=a};this.getNavigationMode=function(){return F};this.setNavigationMode=function(a){if(a!==this.getNavigationMode())switch(oa=Ma=Ba=Ga=0,a){case Autodesk.Viewing.NAVIGATION_MODE.PAN:Ba=1;break;case Autodesk.Viewing.NAVIGATION_MODE.DOLLY:Ga=1;break;case Autodesk.Viewing.NAVIGATION_MODE.ROLL:Ma=1;break;case Autodesk.Viewing.NAVIGATION_MODE.FOV:oa=1}};this.recordHomeView=function(){this.homePosition.copy(v.getPosition());this.homeTarget.copy(v.getLookAtPoint());this.homeUp.copy(v.getWorldUpVector());
this.homeFov=this.camera.fov};this.goHome=function(){F!==Autodesk.Viewing.NAVIGATION_MODE.ROLL&&(this.changeWorldUp(this.homeUp.x,this.homeUp.y,this.homeUp.z),this.transitionView(this.homePosition,this.homeTarget,this.homeFov,10))};this.getBoundingBox=function(){var a;null!==ja&&(a=ja.getSelectionBounds());if(!a||a.empty())a=H.getVisibleBounds();return a};this.setWorldUp=function(a){a&&1E-5<v.getWorldUpVector().sub(a).lengthSq()&&(v.setWorldUpVector(a),Sa=!0)};this.getCOI=function(){return v.getPivotPoint()};
this.getLookAtPoint=function(){return v.getLookAtPoint()};this.changeWorldUp=function(a,b,c){ya=new THREE.Vector3(a,b,c);a=v.getWorldUpVector();Y=10;b=ya.clone().sub(a);b.multiplyScalar(1/Y);this.setWorldUp(a.add(b));--Y};this.getWorldUp=function(){return v.getWorldUpVector()};this.getCameraUp=function(){return v.getCameraUpVector()};this.getFOV=function(){return this.camera.fov};this.setFOV=function(a){v.changeFOV(a)};this.getFocalLength=function(){return b(this.camera.fov)};this.setFocalLength=
function(a){v.changeFOV(c(a))};this.transitionView=function(a,b,c,d){xa=d-1;Ea=a;va=b;ta=c;v.oneStepTowards(a,b,c,d);this.pivotActive(!1)};this.fitToView=function(a,b){var c=v.getLookAtPoint(),d=v.getPosition();if(F===Autodesk.Viewing.NAVIGATION_MODE.ROLL)return{position:d,target:c};b||(b=this.getBoundingBox());var e=b.center(),f=b.size(),f=0.5*Math.sqrt(f.x*f.x+f.y*f.y+f.z*f.z),g=Math.max(1,0.9+this.camera.fov/100*0.5),f=f*g,g=v.getPivotDistance(),f=f/Math.tan(THREE.Math.degToRad(0.5*this.camera.fov))/
g,g=v.getViewOffset();if(1E-5<Math.abs(f-1)||0<g.lengthSq())g=new THREE.Vector3,g.subVectors(c,d),g.set(-g.x,-g.y,-g.z),g.multiplyScalar(f),d=e.clone(),d.add(g),a?v.setView(d,e,0,0,!0):(this.transitionView(d,e,this.camera.fov,10),Ha=!0),Da.shown()&&this.activatePivot(Da.fading());return{position:d,target:e}};this.handleEvent=function(a){if("function"===typeof this[a.type])this[a.type](a)};this.setViewport=function(a){this.viewport=a;v.setScreenViewport(a)};this.activatePivot=function(a){var b=10*
v.getPivotDistance()*Math.tan(THREE.Math.degToRad(0.5*this.camera.fov))/(this.viewport.height*(window.devicePixelRatio||1));Da.show(v.getPivotPoint(),b,a)};this.pivotActive=function(a,b){ua||(b=b||!1,!a&&Da.shown()?Da.hide():a&&this.activatePivot(b))};this.interactionStart=function(a,b){if(b||a>da)da=a,pa=!0,this.pivotActive(!0,-1===a)};this.interactionEnd=function(a){a===da&&(-1!==a&&this.pivotActive(!1),pa=!1)};this.autoMove=function(a,b){0>a?R[0]=R[1]=R[2]=R[3]=R[4]=R[5]=b:R[a]=b;b?this.interactionStart(-4):
R[0]||R[1]||R[2]||R[3]||R[4]||R[5]||this.interactionEnd(-4)};this.getMotionDelta=function(a){R[0]&&(E.x+=0.01);R[1]&&(E.x-=0.01);R[2]&&(E.y+=0.01);R[3]&&(E.y-=0.01);R[4]&&(E.z+=2);R[5]&&(E.z-=2);var b=E.x-I.x,c=E.y-I.y,d=E.z-I.z;0.001>Math.abs(b)&&(b=0);0.001>Math.abs(c)&&(c=0);0.001>Math.abs(d)&&(d=0);a.set(b,c,d)};this.stepMotionDelta=function(a,b){b?(I.x+=0.6*a.x,I.y+=0.6*a.y,I.z+=0.6*a.z):I.copy(E)};this.getAccumulatedWheelDelta=function(){var a=Date.now(),b=0;S&&100<a-S?(b=0>P&&-3<P?-3:0<P&&
3>P?3:P,P=0,S=T=null,U=!1):T&&100<a-T&&(U?3<=Math.abs(P)&&(b=P,P=0):(b=0>P&&-3<P?-3:0<P&&3>P?3:P,U=!0,P=0));return b};this.adjustSpeed=function(a){v.adjustDollyLookSpeed(a)};this.checkInteractionMode=function(){var a;-2===da&&2===V.length&&(F===Autodesk.Viewing.NAVIGATION_MODE.TOUCH_PAN_DOLLY||F!==Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL&&Ua&12)?a=Autodesk.Viewing.NAVIGATION_MODE.TOUCH_PAN_DOLLY:-2===da&&2===V.length&&(F===Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL||F!==Autodesk.Viewing.NAVIGATION_MODE.TOUCH_PAN_DOLLY&&
Ua&16)?a=Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL:ga&&X||Ma?a=Autodesk.Viewing.NAVIGATION_MODE.ROLL:(a=t?!K&&X||oa:K&&X||oa,a=a?Autodesk.Viewing.NAVIGATION_MODE.FOV:2===da&&ga&&!X&&!Ga||1===da&&K&&!X||Ga&&2!==da||Aa||0!==Q.z?Autodesk.Viewing.NAVIGATION_MODE.DOLLY:1===da&&!K&&!X||2===da&&!ga&&!Ba||Ba&&2!==da||ea||ia?Autodesk.Viewing.NAVIGATION_MODE.PAN:Autodesk.Viewing.NAVIGATION_MODE.ORBIT);if(a!==F){if(F===Autodesk.Viewing.NAVIGATION_MODE.ROLL||F===Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL)Ia.end(),
v.restoreCOI(),Sa=!0;a!==Autodesk.Viewing.NAVIGATION_MODE.ORBIT&&this.interactionStart(-4);switch(a){case Autodesk.Viewing.NAVIGATION_MODE.ROLL:case Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL:var b=v.getLookAtPoint(),b=b.sub(this.camera.position),c=0.5*(this.camera.near+this.camera.far);b.normalize().multiplyScalar(c);b=b.add(this.camera.position);v.saveCOI();v.setPivotPoint(b,!0);this.pivotActive(!0);Ia.start(b,v.getCameraUpVector());Sa=!0;break;case Autodesk.Viewing.NAVIGATION_MODE.PAN:d(this.camera,
E.x,E.y);break;case Autodesk.Viewing.NAVIGATION_MODE.TOUCH_PAN_DOLLY:d(this.camera,ba.x,ba.y);break;case Autodesk.Viewing.NAVIGATION_MODE.FOV:P=0,S=T=null,U=!1}F!==a&&(H.api.fireEvent({type:Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,value:a}),F=a)}};this.update=function(){var a=!1;this.getMotionDelta(Q);var d=Q.x,k=Q.y,l=Q.z;la=za=Z=ba=null;Ua=0;if(-2===da){2===V.length&&(la=f(V),za=f(fa));Z=g(V);ba=g(fa);for(var m=Z,n=ba,p=V,r=fa,s=m.x-n.x,t=m.y-n.y,u=Math.sqrt(s*s+t*t),y=6<u,B=0,wb=0,yb=0,zb=
0,Ab=0,D=0,Za=r.length,C=0;C<Za;++C){var Pa=p[C].x-r[C].x,ab=p[C].y-r[C].y,Ta=Math.sqrt(Pa*Pa+ab*ab);6<Ta&&(B+=1,Ta=(s*Pa+t*ab)/(u*Ta),y&&Ta>w&&wb++);var Pa=p[C].x-m.x,ab=p[C].y-m.y,K=r[C].x-n.x,nb=r[C].y-n.y,P=Math.sqrt(K*K+nb*nb);0<P&&(Ta=(Pa*nb-ab*K)/P,Pa=(Pa*K+ab*nb)/P-P,6<Math.abs(Ta)&&Math.abs(Pa)<=Math.abs(Ta)*z&&(Ab++,0<Ta&&D++),7<Math.abs(Pa)&&Math.abs(Ta)<=Math.abs(Pa)*x&&(0<Pa?yb++:zb++))}m=0;0!=B||y?(m|=2,1==Za?m|=4:(0<B&&wb<Za&&yb+zb==Za&&(m|=8),Ab!=Za||0!=D&&D!=Za||(m|=16),y&&wb==Za&&
(m|=4))):m|=1;Ua=m}O||this.checkInteractionMode();O=-1<da;this.stepMotionDelta(Q,F!==Autodesk.Viewing.NAVIGATION_MODE.PAN&&F!==Autodesk.Viewing.NAVIGATION_MODE.ROLL);if(!((y=Ra)||(y=0!==d)||(y=0!==k)||(y=0!==l)))a:{for(y=0;y<V.length;++y)if(V[y].x!==fa[y].x||V[y].y!==fa[y].y){y=!0;break a}y=!1}if(y){xa=Y=0;Ra=Ha=!1;switch(F){case Autodesk.Viewing.NAVIGATION_MODE.ORBIT:v.orbitRelative(0.6*d,0.6*k);sa=!0;break;case Autodesk.Viewing.NAVIGATION_MODE.DOLLY:l*=0.6;if(0<=da||-3===da)k=-k,l=Math.abs(d)>Math.abs(k)?
d:k,l*=100;v.dollyRelative(l,e);break;case Autodesk.Viewing.NAVIGATION_MODE.PAN:this.pivotActive(pa);v.trackRelative(d,k);break;case Autodesk.Viewing.NAVIGATION_MODE.TOUCH_PAN_DOLLY:this.pivotActive(pa);d=e(Z.scaledX,Z.scaledY);d||(d=new THREE.Vector3(2*Z.scaledX-1,2-2*Z.scaledY,0),q.unprojectVector(d,this.camera),d=d.sub(v.getPosition()),k=v.getPivotDistance()/this.camera.near,d=d.multiplyScalar(k).add(v.getPosition()));v.dollyRelativeTowards(-60*(la-za),e,d);v.trackRelative(Z.scaledX-ba.scaledX,
Z.scaledY-ba.scaledY);h();break;case Autodesk.Viewing.NAVIGATION_MODE.ROLL:Ra=Ia.handleRoll(d,k,E,v.getLookAtPoint(),this);break;case Autodesk.Viewing.NAVIGATION_MODE.TOUCH_ROLL:Ra=Ia.handleRollTouch(fa[0],fa[1],V[0],V[1],v.getLookAtPoint(),this);h();break;case Autodesk.Viewing.NAVIGATION_MODE.FOV:0<=da||-3===da?(k=-k,l=Math.abs(d)>Math.abs(k)?d:k,0!==l&&(l*=-1,v.changeFOV(this.camera.fov*(1+l)))):(d=this.getAccumulatedWheelDelta()/3,0!==d&&v.changeFOV(c(b(this.camera.fov)+d)))}this.pivotActive(pa,
-1===da)}-1===da&&1E-6>Math.abs(l)&&(this.interactionEnd(-1),a=!0);!pa&&(a||-5<da)&&(sa&&!Ia.isSnapped()&&this.setWorldUp(v.getCameraUpVector()),-1<da&&I.copy(E),da=-5,sa=O=!1,this.checkInteractionMode(),0<V.length&&this.interactionStart(1===V.length?-3:-2));0<Y&&ya&&(a=v.getWorldUpVector(),l=ya.clone().sub(a),l.multiplyScalar(1/Y),this.setWorldUp(a.add(l)),--Y);0<xa&&Ea&&va&&(v.oneStepTowards(Ea,va,ta,xa),--xa,0==xa&&Ha&&(this.pivotActive(!0,!0),Ha=!1));Da.shown()&&Da.fade()&&(H.overlayDirty=!0);
a=!1;if(Sa||v.isDirty())v.updateCamera(),Sa=!1,a=!0;a?this.moveDelay=Date.now()+200:0!==this.moveDelay&&(0<this.moveDelay-Date.now()?a=!1:this.moveDelay=0);return a};this.clientToCanvasCoords=function(a,b){var c=this.domElement.getBoundingClientRect(),d=c.width,e=c.height,f=a.clientX-c.left,c=a.clientY-c.top;a.canvasX=f;a.canvasY=c;a.normalizedX=f/d*2-1;a.normalizedY=(e-c)/e*2-1;b&&b.set(f/d,c/e,0)};this.handleResize=function(){this.setViewport(H.api.container.getBoundingClientRect())};this.setCOIFromMouse=
function(a,b){if(ua){var c=H.intersectGround(a,b);this.setCOI(c,!0)}else c=H.castRay(a,b,!0),c.intersectPoint&&this.setCOI(c.intersectPoint,!0)};this.handleSingleClick=function(a){if(0==da){a=H.castRay(a.clientX,a.clientY,!1);var b="click";K&&(b+="Ctrl");X&&(b+="Shift");ga&&(b+="Alt");ia&&(b+="Space");ha&&(b+="F1");ea&&(b+="F2");Aa&&(b+="F3");Ca&&(b+="F4");var c="",c=a.node||a.intersectPoint?"onObject":"offObject";this.clickConfig&&this.clickConfig[b]&&this.clickConfig[b][c]&&this.handleAction(this.clickConfig[b][c],
a)}};this.handleAction=function(a,b){for(var c=0;c<a.length;++c)switch(a[c]){case "selectOnly":ja&&b.node&&ja.setSelection([b.node]);break;case "deselectAll":ja&&ja.setSelection([]);break;case "selectToggle":ja&&b.node&&ja.toggleSelection(b.node);break;case "isolate":b.node&&H.api.isolate(b.node);break;case "showAll":H.visibilityManager.isolateNone();break;case "setCOI":b.intersectPoint&&(this.setCOI(b.intersectPoint,!0),this.pivotActive(!0,!0));break;case "hide":b.node&&H.hideMultiple([b.node]);
break;case "show":b.node&&H.showMultiple([b.node]);break;case "toggleVisibility":b.node&&H.toggleVisibility(b.node);break;case "focus":ja&&(b.node?ja.setSelection([b.node]):ja.setSelection([]),this.fitToView())}};this.handleDoubleClick=function(a){null!=ja&&0==a.button&&(ja.clearSelection(),a=H.castRay(a.clientX,a.clientY,!1),a.node&&ja.toggleSelection(a.node),this.fitToView())};this.handleSingleTap=function(a){a=H.castRay((a.startX+a.endX)/2,(a.startY+a.endY)/2,!1);a.intersectPoint&&(this.setCOI(a.intersectPoint,
!0),this.pivotActive(!0,!0))};this.handleDoubleTap=function(a,b){var c=(a.startX+a.endX+b.startX+b.endX)/4,d=(a.startY+a.endY+b.startY+b.endY)/4;null!=ja&&(ja.clearSelection(),c=H.castRay(c,d,!1),c.node&&ja.toggleSelection(c.node),this.fitToView())};this.handleWheelInput=function(a){ua&&A.setCOIFromMouse(N,aa);t&&(a*=-1);E.z+=a;P+=a;var b=Date.now();T||(T=b);S=b;0!=a&&this.interactionStart(-1)};this.applyKepMappings=function(a){switch(a.keyCode){case 91:return 17;case 93:return 17;case 224:return 17;
case 17:if(t)return null;break;case 188:case 59:case 186:return 37;case 190:case 222:return 39;case 219:return 33;case 191:return 34;case 72:return 36;case 61:return 187;case 173:case 109:return 189}return a.keyCode};this.handleKeyDown=function(a){switch(this.applyKepMappings(a)){case 16:X=1;break;case 17:K=1;break;case 18:ga=1;break;case 32:ia=1;break;case 112:ha=1;break;case 113:ea=1;break;case 114:Aa=1;break;case 115:Ca=1;break;case 36:this.goHome();break;case 70:this.fitToView();break;case 187:this.adjustSpeed(1);
break;case 189:this.adjustSpeed(-1);break;case 48:this.adjustSpeed(0);break;case 88:this.changeWorldUp(1,0,0);break;case 89:this.changeWorldUp(0,1,0);break;case 90:this.changeWorldUp(0,0,1);break;case 37:this.autoMove(0,!0);break;case 39:this.autoMove(1,!0);break;case 33:this.autoMove(2,!0);break;case 34:this.autoMove(3,!0);break;case 38:this.autoMove(4,!0);break;case 40:this.autoMove(5,!0);break;default:return!1}return!0};this.handleKeyUp=function(b){switch(this.applyKepMappings(b)){case 16:X=0;
break;case 17:K=0;break;case 18:ga=0;break;case 32:ia=0;break;case 112:ha=0;break;case 113:ea=0;break;case 114:Aa=0;break;case 115:Ca=0;break;case 36:case 70:break;case 37:this.autoMove(0,!1);break;case 39:this.autoMove(1,!1);break;case 33:this.autoMove(2,!1);break;case 34:this.autoMove(3,!1);break;case 38:this.autoMove(4,!1);break;case 40:this.autoMove(5,!1);break;case 27:if(a.api.objectContextMenu&&a.api.objectContextMenu.hide())break;a.api.fireEvent({type:Autodesk.Viewing.ESCAPE_EVENT});this.autoMove(-1,
!1);this.interactionEnd(da);Ca=Aa=ea=ha=ia=ga=K=X=0;break;default:return!1}return!0};this.handleButtonDown=function(a){this.interactionStart(a)};this.handleButtonUp=function(a){this.interactionEnd(a)};this.handleTouchChange=function(a,b){0===a?this.interactionStart(1===b?-3:-2):this.interactionEnd(1===a?-3:-2)};this.resize=function(a){A.handleResize()};this.keydown=function(a){"INPUT"!=document.activeElement.nodeName&&"TEXTAREA"!=document.activeElement.nodeName&&A.handleKeyDown(a)&&(a.preventDefault(),
a.stopPropagation())};this.keyup=function(a){"INPUT"!=document.activeElement.nodeName&&"TEXTAREA"!=document.activeElement.nodeName&&A.handleKeyUp(a)&&(a.preventDefault(),a.stopPropagation())};this.updateModifierState=function(a){K=t&&a.metaKey||!t&&a.ctrlKey?1:0;X=a.shiftKey?1:0;ga=a.altKey?1:0};this.mousedown=function(a){function b(a){a.button===c&&(document.removeEventListener("mouseup",b),A.mouseup(a))}if(!A.isDragging&&!A.inTouch){_isIE11&&inFullscreen()||document.activeElement.blur();a.preventDefault();
a.stopPropagation();A.updateModifierState(a);A.clientToCanvasCoords(a,I);E.copy(I);A.handleButtonDown(a.button);A.downX=a.canvasX;A.downY=a.canvasY;A.isDragging=!0;var c=a.button;document.addEventListener("mouseup",b,!1)}};this.mousemove=function(a){if(!A.inTouch)if(A.isDragging){a.preventDefault();a.stopPropagation();A.updateModifierState(a);A.clientToCanvasCoords(a,E);var b=A.downY-a.canvasY;if(2<Math.abs(A.downX-a.canvasX)||2<Math.abs(b))A.downX=-1,A.downY=-1}else N=a.clientX,aa=a.clientY,ua&&
H.highlightObject(N,aa)};this.mouseup=function(a){a.preventDefault();a.stopPropagation();A.updateModifierState(a);A.clientToCanvasCoords(a,E);A.handleButtonUp(a.button);var b=A.downX-a.canvasX,c=A.downY-a.canvasY;A.downX=-1;A.downY=-1;A.isDragging=!1;2>=Math.abs(b)&&2>=Math.abs(c)&&A.handleSingleClick(a)};this.doubleclick=function(a){a.preventDefault();a.stopPropagation();A.clientToCanvasCoords(a,I);E.copy(I);A.downX=a.canvasX;A.downY=a.canvasY;A.handleDoubleClick(a)};this.mousewheel=function(a){a.preventDefault();
a.stopPropagation();if(!A.inTouch){var b=0;a.wheelDelta?b=a.wheelDelta/40:a.detail&&(b=-a.detail);A.handleWheelInput(b)}};this.touchstart=function(a){function b(a){V.length!==a.targetTouches.length&&A.handleTouchChange(V.length,a.targetTouches.length);fa=[];V=[];for(var c=0;c<a.targetTouches.length;++c){var d=a.targetTouches[c];d.clientX=d.pageX;d.clientY=d.pageY;A.clientToCanvasCoords(d);fa.push({x:d.canvasX,y:d.canvasY});V.push({x:d.canvasX,y:d.canvasY})}1===V.length&&(A.clientToCanvasCoords(a.targetTouches[0],
I),E.copy(I))}function c(a){a.preventDefault();a.stopPropagation();0===a.targetTouches.length?(A.handleTouchChange(V.length,0),document.removeEventListener("touchend",c),A.touchend(a)):b(a)}if(!A.isDragging){A.inTouch=!0;a.preventDefault();a.stopPropagation();b(a);if(1===V.length){var d=V[0];Va=d.x;Wa=d.y;Ka=Date.now()}else Va=Wa=Ka=-1;document.activeElement.blur();A.updateModifierState(a);1===a.targetTouches.length&&document.addEventListener("touchend",c,!1)}};this.touchmove=function(a){if(!A.isDragging){a.preventDefault();
a.stopPropagation();V=[];for(var b=0;b<a.targetTouches.length;++b){var c=a.targetTouches[b];c.clientX=c.pageX;c.clientY=c.pageY;A.clientToCanvasCoords(c);V.push({x:c.canvasX,y:c.canvasY})}2===V.length&&2===fa.length&&(b=Math.atan2(V[1].y-V[0].y,V[1].x-V[0].x),0>b&&(b+=p),c=Math.atan2(fa[1].y-fa[0].y,fa[1].x-fa[0].x),0>c&&(c+=p),b=Math.abs(b-c),b>Math.PI&&(b=p-b),2.9<b&&(b=V[1],V[1]=V[0],V[0]=b));1===V.length&&A.clientToCanvasCoords(a.targetTouches[0],E);A.updateModifierState(a)}};this.touchend=function(a){A.inTouch=
!1;if(-1!==Ka){var b=V[0],b={startX:Va,startY:Wa,startTime:Ka,endX:b.x,endY:b.y,endTime:Date.now()};wa.push(b)}n();fa=[];V=[];A.updateModifierState(a)};this.set2DMode=function(a){(ua=a)&&Da.hide()};this.domElement.addEventListener("mousedown",this.mousedown,!1);window.addEventListener("mousemove",this.mousemove,!1);this.domElement.addEventListener("dblclick",this.doubleclick,!1);this.domElement.addEventListener("mousewheel",this.mousewheel,!1);this.domElement.addEventListener("DOMMouseScroll",this.mousewheel,
!1);this.domElement.addEventListener("touchstart",function(a){A.touchstart(a)},!1);this.domElement.addEventListener("touchmove",function(a){A.touchmove(a)},!1);window.addEventListener("keydown",this.keydown,!1);window.addEventListener("keyup",this.keyup,!1);window.addEventListener("resize",this.resize,!1);this.handleResize();this.uninitialize=function(){window.removeEventListener("mousemove",this.mousemove,!1);window.removeEventListener("keydown",this.keydown,!1);window.removeEventListener("keyup",
this.keyup,!1);window.removeEventListener("resize",this.resize,!1)}}ViewController.prototype=Object.create(THREE.EventDispatcher.prototype);AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.Selector=function(a){function b(a){var c=a.dbId||a.fragIds;if(0<f[c]){if(f[c]--,0==f[c]&&(c=a.fragIds,"undefined"!=typeof c)){Array.isArray(c)||(c=[c]);for(var d=0;d<c.length;++d){var e=c[d],n=g.viewer.getRenderProxy(g.model,e);g.viewer.highlightFragment(g.model,e,!1);g.viewer.needsClear=!0;n.selectionProxy&&(g.viewer.removeOverlay("selection",n.selectionProxy),delete n.selectionProxy)}}}else if(0>f[c])throw"Selection State machine broken. Negatively selected object!";if(a.children)for(d=
0;d<a.children.length;d++)b(a.children[d])}function c(a,b){var d=a.dbId||a.fragIds;if(f[d])f[d]++;else{var e=a.fragIds;if("undefined"!=typeof e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;++n){var r=e[n],p=g.viewer.getRenderProxy(g.model,r);b?g.viewer.highlightFragment(g.model,r,!0):(p.selectionProxy=new THREE.Mesh(p.geometry,p.material,!0),p.selectionProxy.matrixWorld=p.matrixWorld,g.viewer.addOverlay("selection",p.selectionProxy))}}f[d]=1}if(a.children)for(n=0;n<a.children.length;n++)c(a.children[n],
!0);b&&(g.viewer.needsClear=!0)}function e(a){-1==g.findSelection(a)&&(g.selectedObjects.push(a),c(a))}function d(a){var c=g.findSelection(a);0<=c&&(b(a),g.selectedObjects.splice(c,1))}var g=this;this.viewer=a;this.model=null;this.selectedObjects=[];var f={};a.api.addEventListener(Autodesk.Viewing.ISOLATE_EVENT,function(a){g.deselectInvisible()});a.api.addEventListener(Autodesk.Viewing.HIDE_EVENT,function(a){g.deselectInvisible()});this.getSelectionLength=function(){return g.selectedObjects.length};
this.getSelection=function(){return g.selectedObjects.slice(0)};this.clearSelection=function(){if(0<this.selectedObjects.length){for(var a=0;a<g.selectedObjects.length;a++)b(g.selectedObjects[a]);g.selectedObjects.length=0;this.fireSelectionChangedEvent()}};this.fireSelectionChangedEvent=function(){for(var a=[],b=[],c=0;c<g.selectedObjects.length;c++)a.push(g.selectedObjects[c].dbId),b.push(g.selectedObjects[c].fragIds);a={type:Autodesk.Viewing.SELECTION_CHANGED_EVENT,dbIdArray:a,fragIdsArray:b,nodeArray:this.getSelection()};
this.viewer.api.fireEvent(a)};this.isSelected=function(a){return-1!=this.findSelection(a)};this.findSelection=function(a){return this.selectedObjects.indexOf(a)};this.toggleSelection=function(a){a&&(this.isSelected(a)?d(a):e(a),g.fireSelectionChangedEvent())};this.setSelectionIds=function(a){this.setSelection(this.model.getNodesByIds(a))};this.setSelection=function(a){this.clearSelection();if(null!=a){for(var b=0;b<a.length;b++)e(a[b]);0<a.length&&this.fireSelectionChangedEvent()}};this.deselectInvisible=
function(){for(var a=!1,b=0;b<g.selectedObjects.length;b++){var c=g.selectedObjects[b];!1==c.visible&&(d(c),a=!0)}a&&this.fireSelectionChangedEvent()};this.toggleSelectionId=function(a){this.toggleSelection(this.model.getNodeById(a))};this.isSelectedOrParentIsSelected=function(a){for(;a;){if(0<=this.findSelection(a))return!0;a=a.parent}return!1};this.getSelectionFragIds=function(){return this.getFragIds(g.selectedObjects)};this.getFragIdsFromObjectIds=function(a){Array.isArray(a)||(a=[a]);return this.getFragIds(this.model.getNodesByIds(a))};
this.getFragIds=function(a){for(var b=[],c=0;c<a.length;++c){var d=function(a){var c=a.fragIds;Array.isArray(c)||(c=[c]);for(var e=0;e<c.length;++e)b.push(c[e]);if(a.children)for(c=0;c<a.children.length;c++)d(a.children[c])};d(a[c])}return b};this.getSelectionBounds=function(){for(var a=new THREE.Box3,b=new THREE.Box3,c=this.getSelectionFragIds(),d=this.viewer,e=this.model,f=0;f<c.length;++f){var g=d.getRenderProxy(e,c[f]);g.geometry.boundingBox.getTransformedBox(g.matrixWorld,b);a.union(b)}return a}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.VisibilityManager=function(a){this.viewerImpl=a;this.model=null};Autodesk.Viewing.Private.VisibilityManager.prototype.isolate=function(a){a?this.isolateMultiple([a]):this.isolateNone()};
Autodesk.Viewing.Private.VisibilityManager.prototype.isolateNone=function(){this.viewerImpl.setModelVisibility(this.model,!0);var a=this.model?this.model.getRoot():null;a&&this.setVisibiltyOnNode(a,!0);this.viewerImpl.resetIsolation(this.model);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.ISOLATE_EVENT,nodeIdArray:[]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.isolateMultiple=function(a){if(a&&0!=a.length){var b=this.model?this.model.getRoot():null;b&&this.setVisibiltyOnNode(b,!1);this.viewerImpl.setModelVisibility(this.model,!1);for(b=0;b<a.length;b++)this.setVisibiltyOnNode(a[b],!0),this.viewerImpl.needGhostedPass=!0;this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.ISOLATE_EVENT,nodeIdArray:a})}else this.isolateNone();this.viewerImpl.needsClear=!0};
Autodesk.Viewing.Private.VisibilityManager.prototype.hideMultiple=function(a){for(var b=0;b<a.length;++b)this.setVisibiltyOnNode(a[b],!1);0<a.length&&this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:a})};Autodesk.Viewing.Private.VisibilityManager.prototype.hide=function(a){this.setVisibiltyOnNode(a,!1);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.showMultiple=function(a){for(var b=0;b<a.length;++b)this.setVisibiltyOnNode(a[b],!0);0<a.length&&this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:a})};Autodesk.Viewing.Private.VisibilityManager.prototype.show=function(a){this.setVisibiltyOnNode(a,!0);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.toggleVisibility=function(a){var b=Autodesk.Viewing.Private.VisibilityManager.isVisible(a);this.setVisibiltyOnNode(a,!b);this.viewerImpl.api.fireEvent(b?{type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:[a]}:{type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.setVisibiltyOnNode=function(a,b){var c=this.viewerImpl,e=this.model;(function g(a){a.visible=b;var h=a.fragIds;if(void 0!==h)if(Array.isArray(h))for(var k=0;k<h.length;k++)c.setFragmentVisibility(e,h[k],b);else c.setFragmentVisibility(e,h,b);if(a.children)for(h=0;h<a.children.length;h++)g(a.children[h])})(a);this.viewerImpl.needGhostedPass=!0;this.viewerImpl.needsClear=!0};
Autodesk.Viewing.Private.VisibilityManager.isVisible=function(a){return null!=a.visible?a.visible:!0};Autodesk.Viewing.Private.VisibilityManager.prototype.areAllVisible=function(){return this.viewerImpl.isWholeModelVisible(this.model)};var backimage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAwBJREFUeF7tl8GNIjEQRUmADIiADEiADIiAAAiABLgTAGfuBEAIG9I+8T2W1d2s5oNpadF/B9Qum5qpN2W7ZxE8/oRfEFkGkWUQWQaRZRBZBpFlEFkGkWUQWQaRZRBZBpFlEFkGkWUQWQaRZRBZBpFlEFkGkWUQWQaRZRBZBpFlEFkGkWUQWQaRZRBZBpFlEFkGkWUQWQaRZRBZBpFlEFkGkWXQX1bJOGKz2RwOh/v9Xtb15nK56AeV8QdQ/jlkifV6/SFf/7GsMvgBQefzeblcMrXb7Uq0K98jS+CLKZSVcVe+TRZMzlLndrtV38FqtaL7brdbmf6B9uTUY1bL2NGn06nMPZF1vV6Vtl35Mso/kyzVQ7Vl/ID69ZUBFNn6qmUPqJt6LKuvKVD+j8tqz6zj8Viij3q0nqAOfj55VnC/32sZ0EdE+EQKw3aZIgNZ3U2B8veX9Yy2fmBIcHzkEyHO24aG9bCT0Er79VbWJ0yB8s8ni7NpUPAk2ptVloZjpy1V1odMgfL3l1UGDRSDKaYmX7WIsIDy8IIjJamyFGFKw0mqLG1YoB/LXCeUdg5ZQmW3xxYl1QtuwGuyQH+V8bZ9EyWfT5Y2FMVoqMMIKAwjnEEsoGwte02Wdp/6a3BEvonyzy2rWlBPjS3o5K7Lnt0DLVXWYMiDIu+jhPPJ0h+8bkMtHtTD65VO6Crr2W0oI8TrM2gKpHjwWvcOyj+HLC6pepTUt011FnFFcMEmkimoskCW+axmMaiVasyxLLK1C95H+fvL+gftjc5ziTZgsL5wlnUP15P3APrUbmNZUPOP/3l6AaWaQxZVceiMf2kaRF0D6KALKL42BY7KukenMFuV8a32Vp2UBboc2iZ9GeXvKeuLiSyDyDKILIPIMogsg8gyiCyDyDKILIPIMogsg8gyiCyDyDKILIPIMogsg8gyiCyDyDKILIPIMogsg8gyiCyDyDKILIPIMogsg8gyiCyDyDKILIPIMogsg8gyiCyDyDKILIPIMogsgyIr/IrF4i9O3m/GBVQ86AAAAABJRU5ErkJggg==",
frontimage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAkhJREFUeF7t18Ft4kAcRnEaoINUQAc0QAdUQAEUQAPcKYAz9xRACVvSfsl/MrLW68gvjiJE3u+AmPEw4CfjkJWYP5rBWICxAGMBxgKMBRgLMBZgLMBYgLEAYwHGAowFGAswFmAswFiAsQBjAcYCjAUYCzAWYCzAWICxAGMBxgKMBRgLMBZgLMBYgLEAYwHGAn5FrPv93p4t852x2l7TttttW/pTrtfry8tLHtt4mXYabbRM22vaz8fKO+Z9HzdWGzwGYwHPEOt4PGZlzuFwONSrht/QzO92u/V6nfk87vf72+3Wjr3LgnpJ7tw5OlzZ7+X1FkOZqUNf1jZqo2Xmb1VnkiL1ksjz4aGx8/lcC6Ji5c5dmYYyWb2eLVbUtRCvr6+Zv1wufb5m8tib9uurYkVi9Yin06km86Rm4tG/hlOGn7hi5VTb+MNms8l8v8q6OucUrGGPlbg1U7JguCyeJ9bwPhW5vmplXVNDdcX1uD1WDbvxto8eqw0+VWeVxzZ+N5WgDA/Vyn9ah7Ga4SFjGWvCf2PRe9avjhWf/zXs88Z6g35nzY81fqOvefsQ0UbLzN9qKlbUobHxL/g5seqXV1merG3URsvM3+qTWJEW/WrKfSonPPW/YRt/GMfKfbBvNf52U7XP98R6esYCjAUYCzAWYCzAWICxAGMBxgKMBRgLMBZgLMBYgLEAYwHGAowFGAswFmAswFiAsQBjAcYCjAUYCzAWYCzAWICxAGMBxgKMBRgLMBZgLMBYgLEAYwHGAowFtFiaZbX6C2hay0Y0gxV3AAAAAElFTkSuQmCC",
leftimage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAh5JREFUeF7t1sGt2kAYRWEaoAMqoAMaoAMqoAAKoAH2FJA1ewqghJSUK//ziGWZxEexF3k+Z4GYwYzlTxjPxlg/bUJigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBZILJBYILFAYoHEAokFEgskFkgskFggsUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBZILNA3wXq9Xu3dki2LNfviQTkej9vttlb+0bXb7fLajliyOul/g3U4HGrNKkY1I9ZIteD1em3jLz6xRqoF+zRrxMqf0eVy2e/39ZW8ybB91jW4AUcbfGX22mnaaO4mLh6pN1O/TL4fc2K1CiI09/u9ZvKm+PLsq5mqW2/Ft+Hj8cgxefwP9koZ1hbh+Xy2KbFy7+SY0TvofD7no/6zr1tvxVh//TPqO9aMWB8T63d1tRMfZLXgerHqj+l0OrXxH6sF14uVXUIdlsdim/qqdg+3262NxUp1wdkoxKU2EIHLDiuTgy1Ft94I1sS7+B+rsy+L9alcZx0WjtEdfPgGP7ea72Pl/q3JtDRZO00bzV1b/UNvrBSvXOqbLD+oKPS3o1V92sfKF+s3mAbb/dmrsyyF9c0SCyQWSCyQWCCxQGKBxAKJBRILJBZILJBYILFAYoHEAokFEgskFkgskFggsUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBZILJBYILFAYoHEAokFalg2qc3mF7emV+lhX3Y0AAAAAElFTkSuQmCC",
rightimage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAwdJREFUeF7tl8GV4jAQREmADIiADEiADIiAAAiABLgTAGfuBEAIhLQ1rqafVzaMa+RZDFv/MM/dljTSpyXEzGjczAAsS8CyBCxLwLIELEvAsgQsS8CyBCxLwLIELEvAsgQsS8CyBCxLwLIELEvAsgQsS8CyBCxLwLIELEvAsgQsS8CyBCxLwLIELEvAsgQsS8CyBCxLwLIELEvAsgQsS+DzZV2v13iqZjRZMVAfi8Vis9mcz+doeodvIxjM6XRCr9VqFfFj0BL/Gn8jroYT/l1ZyfF4jNYNTEYwmOGy0AYtpysrgr+Bo+Vyibfz+TxSFXy4LICDA6bQoH7qny8LdKfe2yXLEKzXa5x0u90Oz2knZeEDwCucSgjxSeBYzLOcXdogw1c1xFgRVfB8nN7K6nbZbrdMJugFZXgoZEFoOk2Qoa93lYXZHw4HLgxVENmGogstACyMa0aVUTEoZAG8wshsud/vmUSGzUC3livhvxhN1hOwtuL2wHwEtxsrCMUVcQO6sFlXVtsLwDZEst39LWWhrLAGlkAbvo3gHl4ul4jv9G5DwDDh1stmYOqyImjAJ49qAo/Oi3aXRwpAYYEt21LIe8sCqaDYXISv+GxZX3ANoLi+A+b5bFkBvwqxH4tjq+jCcOCZ9bGysmqKzchkBHcpWHPEDXDHZv+LLABNbNC+PTATQcspls0aRIYXdPBjWYX9Gr7mASKq4Pk4WDy2IRpgS0aqr0s6TdCrqLjhsnjzIqMoi7EiquDbcXCTYBvctplhyOfk0W/DH8jCJ0TRAA+RrYBDjSDr92CBjFIaldDVJGRxJsUNI/dv9+bx7+EMJyGLWwZ7ML1gD3JLFr/AX0WjahqyoIZFVIBk+zv0hcSEIno1uFXhhMrrAh4Qdq+pr4KzmvQBPx0sS8CyBCxLwLIELEvAsgQsS8CyBCxLwLIELEvAsgQsS8CyBCxLwLIELEvAsgQsS8CyBCxLwLIELEvAsgQsS8CyBCxLwLIELEvAsgQsS8CyBCxLwLIELEvAsgRClhnEbPYH0gUbEtCHMj0AAAAASUVORK5CYII=",
topimage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAldJREFUeF7t10FxAkEYRGEM4AAFOMAADlCAAARggDsCOHNHABIiKV30ZGprIcl2yGSS1HsndpnwL18NsJlR1gtNCKwgsILACgIrCKwgsILACgIrCKwgsILACgIrCKwgsILACgIrCKwgsILACgIrCKwgsILACgIrCKwgsILACgIrCKwgsILACgIrCKwgsILACgIrCKwgsILACmqLtdvtyoDPKn/wu2t7rWA91Wq10jghluM/la3AmpStfgXW5XLZbDaLxcKXtF6vj8djee7W6XTyU3qsV/DK+Xyuv7per17TNE/vjyUXvW1fzDBBlBUDLJ30g5r+VtZlXbPKsHLUvodYep+WWi6X5/NZZ7RTtOZ2abP9fu9lFUtp31lHJ73F9Mpe1i6P7oy13W51Uu959Gmyl877sGKNXOTr84Zul6d0xtKG0snD4VCO35Ld7eqKQsXSAy+oaaPp/Ohlvz1P74zla7gnUF7vpyqWnxrmPSiyctwmT/8nWFpcjtvk6f8Ea/jT2SJP74yVfmfdf5H7O6v+bjbK0ztjffxrqLsKH1as0Q6qv4atb7U8pTPWF+6z9Kxl691s68+g8ujOWCq6g/fHdpjOjHZli8qwctS+97CU9pdoKtkH/xvKRZ/cuhkfvlqLPP3nsJ6pYpXjH8/TwZqUp4M1KU8Ha1KeDtakPP1vYHUPrCCwgsAKAisIrCCwgsAKAisIrCCwgsAKAisIrCCwgsAKAisIrCCwgsAKAisIrCCwgsAKAisIrCCwgsAKAisIrCCwgsAKAisIrCCwgsAKKlg0qdnsFfMOaseS92wDAAAAAElFTkSuQmCC",
bottomimage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAxtJREFUeF7tlssN4kAQREmADIiADEiADIiAAAiABLgTAGfuBEAIhLS1rnZvawzGhVbCEvUOiJnp+T33jL0wGg8zAcsSsCwByxKwLAHLErAsAcsSsCwByxKwLAHLErAsAcsSsCwByxKwLAHLErAsAcsSsCwByxKwLAHLErAsAcsSsCwByxKwLAHLErAsAcsSsCwByxKwLAHLErAsgRnJut/v8a9nWPNdNFkRPWCz2RwOh4/3drlcVqsVfqPccTwel8tlFOZB7DZK74joF6zX6898wTW6N7I4ZhTmAZekyYpCDwSdz2dkAZp2u13UKvyQLAJfaPrs4PycLPC09Xa7Id1wJbF1u91Ca7Q9HrjpWJ+ghu4q1SP+YxAmMn4x+PV6jbYOjolBkPJoZSQWkPPiNuR62H361YEuf4nSO0aCsQc0YRFR7sjj2ZCnVZU1jCen04kBgDG4QAFbE6wHU0ehB9NFz3dEhyi942lwvbPw0KK2yylWYtF8+IjM3dbIiccQs7ASG8bgqMEvsoyVmV85Rb5hEUZxuUhmE/50gf/6jsNgTdYr9vt9xHWgiEqsuMlzbqbm4ERZ3DDsRLmH3YfZWhUw8QFao6qDY9YnNwJH+D+ysI3qheuoB4QghvG5mSmyshdzqsKMQ9awSFmYncWk690mEaduDL6CI2iyolDAPnkcsMT0xeBGAWnsTJGF1qamUpsoC2OymNSY5AuyCCfOlGawZT2Hq8w7hcGW9Zxmld+9s+Yuq3mzjL8Nc29giizA8V+9DbN+7rKQI7zgoSCfPP7wuwabZBLBGncC6tv66YoZVg1K31lzkTVCc+jyY7Uhv4lI/arOdSMlo6ooS9cNwy/4+cpC7uTTbkAlmlIZEgEGo60HGZcJkqcJmcJzB2oaQlwGY1gMnjlF5iLrx7EsAcsSsCwByxKwLAHLErAsAcsSsCwByxKwLAHLErAsAcsSsCwByxKwLAHLErAsAcsSsCwByxKwLAHLErAsAcsSsCwByxKwLAHLErAsAcsSsCwByxKwLAHLErAsAcsSsCwByxKwLAHLEghZZhKLxR8vGE8Vs0exkQAAAABJRU5ErkJggg==";
function ViewCube(a,b){var c=new FireflyWebGLRenderer({alpha:!0});c.setSize(150,150);a.appendChild(c.domElement);var e=new THREE.PerspectiveCamera(45,1,1,1E3);e.position.z=600;var d=new THREE.Scene,g=new THREE.Vector3(0,0,0),f=new THREE.BoxGeometry(200,200,200),h=c.getMaxAnisotropy(),k=[];k.push(new THREE.MeshBasicMaterial({map:textureFromString(rightimage),anisotropy:h}));k.push(new THREE.MeshBasicMaterial({map:textureFromString(leftimage),anisotropy:h}));k.push(new THREE.MeshBasicMaterial({map:textureFromString(topimage),
anisotropy:h}));k.push(new THREE.MeshBasicMaterial({map:textureFromString(bottomimage),anisotropy:h}));k.push(new THREE.MeshBasicMaterial({map:textureFromString(frontimage),anisotropy:h}));k.push(new THREE.MeshBasicMaterial({map:textureFromString(backimage),anisotropy:h}));var h=new THREE.MeshFaceMaterial(k),l=new THREE.Mesh(f,h);d.add(l);b.addEventListener("cameraChanged",function(a){var b=a.camera.matrixWorldInverse.elements;g.set(b[2],b[6],b[10]);e.position.set(600*g.x,600*g.y,600*g.z);g.set(0,
0,0);e.lookAt(g);e.up=a.camera.up;g.set(0,1,0);a=g.angleTo(e.up);b=g.cross(e.up).normalize();0==b.lengthSq()&&b.set(0,0,1);l.setRotationFromAxisAngle(b,a);c.render(d,e)});c.render(d,e)}function textureFromString(a){var b=document.createElement("img"),c=new THREE.Texture(b);b.addEventListener("load",function(a){c.needsUpdate=!0});b.src=a;return c};AutodeskNamespace("Autodesk.Viewing.Private");var USE_SERVER_SIDE_SEARCH=!1,NUM_WORKER_THREADS=3,NUM_PARALLEL_DOWNLOADS=2,WORKER_SCRIPT=null;LMV_WORKER_URL||(LMV_WORKER_URL="src/workers/mainworker.js");void 0==ENABLE_INLINE_WORKER&&(ENABLE_INLINE_WORKER=!1);ENABLE_DEBUG&&(NUM_PARALLEL_DOWNLOADS=NUM_WORKER_THREADS=6);
var WORKER_LOAD_GEOMETRY="LOAD_GEOMETRY",WORKER_LOAD_SVF="LOAD_SVF",WORKER_SEARCH="SEARCH",WORKER_GET_PROPERTIES="GET_PROPERTIES",WORKER_SEARCH_PROPERTIES="SEARCH_PROPERTIES",WORKER_GET_OBJECT_TREE="GET_OBJECT_TREE",WORKER_PARSE_FYDO="PARSE_FYDO",WORKER_STREAM_FYDO="STREAM_FYDO",WORKER_PARSE_FYDO_FRAME="PARSE_FYDO_FRAME";Autodesk.Viewing.Private.SvfLoader=function(a){this.viewer3DImpl=a;this.next_pack=0;this.loading=!1;this.tmpMatrix=new THREE.Matrix4;this.getObjectTreeCallbacks=[]};
Autodesk.Viewing.Private.SvfLoader.prototype.uninitialize=function(){this.viewer3DImpl=this.svf=null};Autodesk.Viewing.Private.SvfLoader.prototype.pathToURL=function(a){if("http://"==a.substr(0,7)||"https://"==a.substr(0,8)||"file:///"==a.substr(0,8)||"urn:"==a.substr(0,4))return a;var b=window.location.pathname,c=b.lastIndexOf("/"),b=b.substr(0,c+1);return window.location.protocol+"//"+window.location.host+b+a};
Autodesk.Viewing.Private.SvfLoader.prototype.loadSvf=function(a,b,c,e,d){if(this.loading)return stderr("loading of SVF already in progress."),!1;this.sharedDbPath=c;var g=-1!=a.indexOf(".fydo");if(ENABLE_INLINE_WORKER){var f=new XMLHttpRequest;f.open("GET",RESOURCE_ROOT+LMV_WORKER_URL,!0);f.setRequestHeader("Access-Control-Allow-Origin","*");var h=this;f.onload=function(){WORKER_SCRIPT=f.responseText;g?h.loadFydoCB(a,b,e,d):h.loadSvfCB(a,b,e,d)};f.send();return!0}return g?this.loadFydoCB(a,b,e,d):
this.loadSvfCB(a,b,e,d)};
Autodesk.Viewing.Private.SvfLoader.prototype.loadSvfCB=function(a,b,c,e){this.t0=(new Date).getTime();this.failedToLoadSomeGeometryPacks=null;var d=createWorker(),g=this,f=function(b){if(b.data&&b.data.svf){b=g.svf=b.data.svf;b.geomPolyCount=0;b.instancePolyCount=0;b.geomMemory=0;b.fragments.numLoaded=0;b.meshCount=0;b.gpuNumMeshes=0;b.gpuMeshMemory=0;b.basePath="";var h=a.lastIndexOf("/");-1!=h&&(b.basePath=a.substr(0,h+1));g.failedToLoadSomeGeometryPacks&&(e&&e(g.failedToLoadSomeGeometryPacks.code,g.failedToLoadSomeGeometryPacks.msg),
g.failedToLoadSomeGeometryPacks=null);g.onSvfLoadDone(b);c&&c(b);if(h=b.geompacks.length)for(var h=Math.min(h,NUM_PARALLEL_DOWNLOADS),m=0;m<h;m++){var n=b.geompacks[m];g.loadGeometryPack(n.id,n.uri);g.next_pack=m+1}else g.onGeomLoadDone();g.loading=!1;d.removeEventListener("message",f);d.terminate();d=null}else b.data&&b.data.progress||(b.data&&b.data.error?(g.loading=!1,d.removeEventListener("message",f),d.terminate(),d=null,e&&e(b.data.error.code,b.data.error.msg)):b.data&&b.data.debug?stderr(b.data.message):
(stderr("SVF download failed."),g.loading=!1,d.terminate(),d=null))};d.addEventListener("message",f,!1);var h=this.pathToURL(a);d.postMessage({operation:WORKER_LOAD_SVF,url:h,headers:{},objectIds:b,auth:auth,viewing_url:VIEWING_URL});return!0};
Autodesk.Viewing.Private.SvfLoader.prototype.loadFydoCB=function(a,b,c,e){this.t0=(new Date).getTime();var d=createWorker(),g=createWorker(),f=this;d.addEventListener("message",function(a){a.data&&"FYDOBLOB"==a.data.type?(a={operation:WORKER_PARSE_FYDO,data:a.data.buffer,metadata:a.data.metadata},g.postMessage(a)):a.data&&"FYDOSTREAM"==a.data.type?(a={operation:WORKER_PARSE_FYDO_FRAME,data:a.data.frames,metadata:a.data.metadata},g.postMessage(a)):a.data&&!0==a.data.finished?d.terminate():a.data&&
a.data.debug?stderr(a.data.message):a.data&&a.data.error?(f.loading=!1,d.terminate(),e&&e.call(a.data.error.code,a.data.error.msg)):(stderr("FYDO download failed."),f.loading=!1,d.terminate())},!1);g.addEventListener("message",function(b){if(b.data&&b.data.fydo){b=f.svf=b.data.fydo;stderr("Num polylines: "+b.numPolylines);stderr("Line segments: "+b.numLineSegs);stderr("Circular arcs: "+b.numCircles);stderr("Ellipitcal arcs:"+b.numEllipses);stderr("Total # of op codes generated by fydo.parse: "+b.opCount);
b.basePath="";var d=a.lastIndexOf("/");-1!=d&&(b.basePath=a.substr(0,d+1));f.onSvfLoadDone(b);c&&c(b);for(d=0;d<b.meshes.length;d++){var h={mesh:b.meshes[d],packId:"0",meshIndex:d};b.fragments.materials[d]=f.viewer3DImpl.create2DMaterial(b.meshes[d].material);f.processReceivedMesh(h)}f.onGeomLoadDone();b.loadDone=!0;f.loading=!1;g.terminate()}else b.data&&b.data.fydoframe?stderr("# of op codes generated by fydo.parseFrame: "+b.data.fydoframe.opCount):b.data&&b.data.progress||(b.data&&b.data.debug?
stderr(b.data.message):b.data&&b.data.error?(f.loading=!1,g.terminate(),e&&e.call(b.data.error.code,b.data.error.msg)):(stderr("FYDO download failed."),f.loading=!1,g.terminate()))},!1);var h=this.pathToURL(a);d.postMessage({operation:WORKER_STREAM_FYDO,url:h,headers:{},objectIds:b,auth:auth,viewing_url:VIEWING_URL});return!0};
Autodesk.Viewing.Private.SvfLoader.prototype.loadGeometryPack=function(a,b){var c,e,d,g=this;if(!this.pack_workers){this.pack_workers=[];var f=function(a){if(a.data&&a.data.mesh){if(g.processReceivedMesh(a.data),1<=a.data.progress){g.pack_workers[a.data.workerId].queued-=1;a=!0;for(d=0;d<g.pack_workers.length;d++)if(0!=g.pack_workers[d].queued){a=!1;break}if(a){for(d=0;d<NUM_WORKER_THREADS;d++)g.pack_workers[d].terminate(),g.pack_workers[d].removeEventListener("message",f);g.pack_workers=null}g.svf.fragments.numLoaded==
g.svf.fragments.length&&(g.onGeomLoadDone(),g.loadTextures())}}else a.data&&a.data.progress?(g.pack_workers[a.data.workerId].queued-=1,g.next_pack<g.svf.geompacks.length&&(a=g.svf.geompacks[g.next_pack++],g.loadGeometryPack(a.id,a.uri))):a.data&&a.data.debug?stderr(a.data.message):a.data&&a.data.error?g.failedToLoadSomeGeometryPacks={code:a.data.error.code,msg:a.data.error.msg}:g.pack_workers[a.data.workerId].queued-=2};for(c=0;c<NUM_WORKER_THREADS;c++)e=createWorker(),e.addEventListener("message",
f,!1),e.queued=0,this.pack_workers.push(e)}e=0;var h=this.pack_workers[0].queued;for(c=1;c<NUM_WORKER_THREADS;c++)this.pack_workers[c].queued<h&&(e=c);c=this.pack_workers[e];c.queued+=2;h=this.pathToURL(this.svf.basePath+b);e={operation:WORKER_LOAD_GEOMETRY,url:h,packId:parseInt(a),headers:{},workerId:e,auth:auth,viewing_url:VIEWING_URL};c.postMessage(e)};
Autodesk.Viewing.Private.SvfLoader.prototype.convertMaterials=function(){var a=this.svf;if(a.materials){var b=a.materials.materials,c;for(c in b)if(b=a.simplemats[c]){b.color=(new THREE.Color).copy(b.color);b.ambient=(new THREE.Color).copy(b.ambient);b.specular=(new THREE.Color).copy(b.specular);b.emissive=(new THREE.Color).copy(b.emissive);var e=new THREE.MeshPhongMaterial(b);e.metal=b.metal;!_isIE11&&(b.doubleSided||a.metadata&&a.metadata.hasOwnProperty("double sided geometry")&&a.metadata["double sided geometry"].value)&&
(e.side=THREE.DoubleSide);for(var d in b)0==d.indexOf("uri_")&&(e[d]=b[d]),0==d.indexOf("uscale_")&&(e[d]=b[d]),0==d.indexOf("vscale_")&&(e[d]=b[d]);this.viewer3DImpl.addMaterial(c,e)}else this.viewer3DImpl.addMaterial(c,new THREE.MeshPhongMaterial({ambient:197379,color:7829367,specular:3355443,shininess:30,shading:THREE.SmoothShading}))}};
Autodesk.Viewing.Private.SvfLoader.prototype.loadTextures=function(){var a=this.svf,b=this;b.textures={};for(var c in b.viewer3DImpl.materials){var e=b.viewer3DImpl.materials[c];if(e){var d=function(a){for(var c=b.textures[a.name],d=0;d<c.mats.length;d++)c.mats[d][c.slots[d]]=a;b.viewer3DImpl.addTexture(c)},g=["map","bumpMap","specularMap","normalMap","envMap"];e.bumpScale&&1<=e.bumpScale&&(e.bumpScale=0.03);for(var f=0;f<g.length;f++){var h=e["uri_"+g[f]];if(h)if(b.textures[h])b.textures[h].mats.push(e),
b.textures[h].slots.push(g[f]);else{var k="envMap"==g[f],h=h.replace(/\\/g,"/"),l=b.pathToURL(a.basePath+h),m=l.indexOf("urn:");-1!=m&&(l=l.substr(0,m)+encodeURIComponent(l.substr(m)));var m=e["uscale_"+g[f]],n=e["vscale_"+g[f]];m||(m=1);n||(n=1);auth&&(-1!=l.indexOf("/items/")?THREE.ImageUtils.crossOrigin="use-credentials":THREE.ImageUtils.crossOrigin="");l=k?THREE.ImageUtils.loadTexture(l,new THREE.SphericalReflectionMapping,d):THREE.ImageUtils.loadTexture(l,new THREE.UVMapping,d);l.name=h;b.textures[h]=
{mats:[e],slots:[g[f]],tex:l};l.anisotropy="bumpMap"==g[f]||"normalMap"==g[f]?0:b.viewer3DImpl.renderer.getMaxAnisotropy();l.repeat.set(m,n);l.wrapS=THREE.RepeatWrapping;l.wrapT=THREE.RepeatWrapping;l.flipY=!k;k&&(a.envMap=l)}}}}};
function meshToGeometry(a){var b=a.mesh,c=new THREE.BufferGeometry;a.byteSize=0;c.vb=b.vb;c.vbstride=b.vbstride;c.isLines=b.isLines;for(var e in b.vblayout){var d=b.vblayout[e];c.attributes[e]={itemSize:d.itemSize,itemOffset:d.offset,bytesPerItem:d.bytesPerItem,normalize:d.normalize,isPattern:d.isPattern}}a.byteSize+=b.vb.byteLength;c.attributes.index={itemSize:1,array:b.indices};a.byteSize+=b.indices.byteLength;c.freeCPUBuffers=!1;65535<b.vb.length/b.vbstride&&stderr("Mesh with >65535 vertices. It will fail to draw.");
c.boundingBox=(new THREE.Box3).copy(b.boundingBox);c.boundingSphere=(new THREE.Sphere).copy(b.boundingSphere);a.geometry=c;a.geometry.isLines=!0===a.mesh.isLines;delete a.mesh}function getFragmentTransform(a,b,c){c*=16;b=b.transforms;if(!b)return null;for(var e=!0,d=0;16>d;d++)if(d%5&&0!=b[c+d]||!(d%5)&&1!=b[c+d]){e=!1;break}if(e)return null;for(e=0;16>e;e++)a.elements[e]=b[c+e];return a}
Autodesk.Viewing.Private.SvfLoader.prototype.processReceivedMesh=function(a){meshToGeometry(a);var b=a.packId+":"+a.meshIndex,c=this.svf,e=c.fragments,d=e.mesh2frag[b];if(void 0===d)stderr("Mesh "+b+" was not referenced by any fragments.");else{c.meshCount++;var g=MAX_FRAGS_PER_GROUP;if(67108864>c.gpuMeshMemory&&c.gpuNumMeshes<g)a.geometry.streamingDraw=!1,a.geometry.streamingIndex=!1;else if(134217728<c.gpuMeshMemory||2E3<c.gpuNumMeshes)a.geometry.streamingDraw=!0,a.geometry.streamingIndex=!0;else{var f;
Array.isArray(d)?f=d.length*a.byteSize:300>(0|d)?(a.geometry.streamingDraw=!1,a.geometry.streamingIndex=!1):f=a.byteSize;1E5>f&&(a.geometry.streamingDraw=!0,a.geometry.streamingIndex=!0)}a.geometry.streamingDraw||(c.gpuMeshMemory+=a.byteSize,c.gpuNumMeshes+=1);if(Array.isArray(d))for(f=0;f<d.length;f++){var h=0|d[f],g=e.materials[h];this.viewer3DImpl.addMeshInstance(a.geometry,h,g,getFragmentTransform(this.tmpMatrix,e,h))}else f=getFragmentTransform(this.tmpMatrix,e,0|d),g=e.materials[d],this.viewer3DImpl.addMeshInstance(a.geometry,
0|d,g,f);delete e.mesh2frag[b];b=a.geometry.attributes.index.array.length/3;c.geomPolyCount+=b;c.instancePolyCount+=b*(d.length||1);c.geomMemory+=a.byteSize;a=!e.numLoaded;e.numLoaded+=d.length||1;d=e.numLoaded;e=e.length;c=d/e;b=0|e/d;if(a||0==(b&b-1)&&this.lastRepaintFract!=b)this.lastRepaintFract=b,this.viewer3DImpl.needsRender=!0;1>c&&0==d%10&&this.viewer3DImpl.signalProgress(100*c,"fragment "+d+" / "+e)}};
Autodesk.Viewing.Private.SvfLoader.prototype.onSvfLoadDone=function(a){var b=Date.now();stderr("SVF load: "+(b-this.t0));this.convertMaterials();this.t0=b;a.bbox=new THREE.Box3(a.bbox.min,a.bbox.max);stderr("scene bounds: "+JSON.stringify(a.bbox));this.viewer3DImpl.signalProgress(5,"Hold on, getting the model...")};
Autodesk.Viewing.Private.SvfLoader.prototype.onGeomLoadDone=function(){this.svf.loadDone=!0;delete this.svf.fragments.entityIndexes;delete this.svf.fragments.packIds;var a="Fragments load time: "+(Date.now()-this.t0);this.viewer3DImpl.signalProgress(100,a);this.viewer3DImpl.api.fireEvent({type:Autodesk.Viewing.GEOMETRY_LOADED_EVENT});stderr(a);stderr("Total geometry size: "+this.svf.geomMemory/1048576+" MB");stderr("Number of meshes: "+this.svf.meshCount);stderr("Num Meshes on GPU: "+this.svf.gpuNumMeshes);
stderr("Net GPU geom memory used: "+this.svf.gpuMeshMemory)};
Autodesk.Viewing.Private.SvfLoader.prototype.getProperties=function(a,b,c){this.propWorker||(this.propWorker=createWorker());var e=this,d=function(f){f.data&&f.data.error?c&&c(f.data.error.code,f.data.error.msg,f.data.error.args):f.data&&f.data.debug?stderr(f.data.message):f.data&&f.data.dbId===a&&(b(f.data.result),e.propWorker.removeEventListener("message",d))};this.propWorker.addEventListener("message",d,!1);var g=this.pathToURL(this.svf.basePath);this.sharedDbPath&&!this.svf.propertydb.values.length&&
(g=this.sharedDbPath,stderr("Using shared property db: "+g));this.propWorker.postMessage({operation:WORKER_GET_PROPERTIES,url:g,propertydb:this.svf.propertydb,dbId:a,headers:{},auth:auth,viewing_url:VIEWING_URL})};
Autodesk.Viewing.Private.SvfLoader.prototype.searchProperties=function(a,b,c){var e=this;if(USE_SERVER_SIDE_SEARCH){this.searchWorker||(this.searchWorker=createWorker());var d=function(a){a.data&&a.data.error?c&&c(a.data.error.code,a.data.error.msg):a.data&&a.data.debug?stderr(a.data.message):(a=JSON.parse(a.data),"debug"==a.type?stderr(a.debug):"response"==a.type&&(b&&b(a.response),e.searchWorker.removeEventListener("message",d)))};this.searchWorker.addEventListener("message",d,!1);this.searchWorker.postMessage({operation:WORKER_SEARCH,
keyword:a,url:this.pathToURL(this.svf.basePath),id:this.svf.manifest.adskID})}else{this.propWorker||(this.propWorker=createWorker());d=function(a){a.data&&a.data.error?c&&c(a.data.error.code,a.data.error.msg):a.data&&a.data.debug?stderr(a.data.message):(b&&b(a.data),e.propWorker.removeEventListener("message",d))};this.propWorker.addEventListener("message",d,!1);var g=this.pathToURL(this.svf.basePath);this.sharedDbPath&&!this.svf.propertydb.values.length&&(g=this.sharedDbPath,stderr("Using shared property db: "+
g));this.propWorker.postMessage({operation:WORKER_SEARCH_PROPERTIES,url:g,propertydb:this.svf.propertydb,searchText:a,headers:{},auth:auth,viewing_url:VIEWING_URL})}};Autodesk.Viewing.Private.SvfLoader.prototype.createFragToNodeMapping=function(){var a=this.svf,b=a.fragments.fragId2dbId;if(a.instanceTree&&b){var c=a.fragments.fragToDbNode=Array(b.length);(function d(a){var b=a.fragIds;if(void 0!==b)if(Array.isArray(b))for(var h=0;h<b.length;h++)c[b[h]]=a;else c[b]=a;if(a.children)for(b=0;b<a.children.length;b++)d(a.children[b])})(a.instanceTree)}};
Autodesk.Viewing.Private.SvfLoader.prototype.getObjectTree=function(a,b){function c(){for(var a=0;a<e.getObjectTreeCallbacks.length;a++)e.getObjectTreeCallbacks[a](e.svf.instanceTree);e.getObjectTreeCallbacks=[]}var e=this;this.propWorker||(this.propWorker=createWorker());this.getObjectTreeCallbacks.push(a);if(e.svf.instanceTree)c();else{var d=function(a){if(!a.data||!a.data.error)if(a.data&&a.data.debug)stderr(a.data.message);else{var b=a.data.instanceTree,g=a.data.instanceBoxes;b&&(e.svf.instanceTree||
(e.svf.instanceTree=b,e.svf.maxTreeDepth=a.data.maxTreeDepth,e.createFragToNodeMapping()),c());g&&(e.svf.instanceBoxes=g,e.propWorker.removeEventListener("message",d))}};this.propWorker.addEventListener("message",d,!1);var g=this.pathToURL(this.svf.basePath);this.sharedDbPath&&!this.svf.propertydb.values.length&&(g=this.sharedDbPath,stderr("Using shared property db: "+g));this.propWorker.postMessage({operation:WORKER_GET_OBJECT_TREE,url:g,propertydb:this.svf.propertydb,headers:{},fragToDbId:this.svf.fragments.fragId2dbId,
fragBoxes:this.svf.fragments.boxes,auth:auth,viewing_url:VIEWING_URL})}};function createWorker(){if(ENABLE_DEBUG||!ENABLE_INLINE_WORKER)return new Worker(LMV_WORKER_URL);if(_isIE11){var a=new Worker("eval.js");a.postMessage(WORKER_SCRIPT);return a}window.URL=window.URL||window.webkitURL;try{a=new Blob([WORKER_SCRIPT],{type:"application/javascript"})}catch(b){a=new BlobBuilder,a.append(WORKER_SCRIPT),a=a.getBlob()}return new Worker(URL.createObjectURL(a))};var Stats=function(){var a=Date.now(),b=a,c=0,e=Infinity,d=0,g=0,f=Infinity,h=0,k=0,l=0,m=document.createElement("div");m.id="stats";m.addEventListener("mousedown",function(a){a.preventDefault();w(++l%2)},!1);m.style.cssText="width:80px;opacity:0.9;cursor:pointer";var n=document.createElement("div");n.id="fps";n.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002";m.appendChild(n);var r=document.createElement("div");r.id="fpsText";r.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";
r.innerHTML="FPS";n.appendChild(r);var p=document.createElement("div");p.id="fpsGraph";p.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff";for(n.appendChild(p);74>p.children.length;){var t=document.createElement("span");t.style.cssText="width:1px;height:30px;float:left;background-color:#113";p.appendChild(t)}var s=document.createElement("div");s.id="ms";s.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none";m.appendChild(s);var u=document.createElement("div");
u.id="msText";u.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";u.innerHTML="MS";s.appendChild(u);var v=document.createElement("div");v.id="msGraph";v.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0";for(s.appendChild(v);74>v.children.length;)t=document.createElement("span"),t.style.cssText="width:1px;height:30px;float:left;background-color:#131",v.appendChild(t);var w=function(a){l=a;switch(l){case 0:n.style.display=
"block";s.style.display="none";break;case 1:n.style.display="none",s.style.display="block"}};return{REVISION:11,domElement:m,setMode:w,begin:function(){a=Date.now()},end:function(){var l=Date.now();c=l-a;e=Math.min(e,c);d=Math.max(d,c);u.textContent=c+" MS ("+e+"-"+d+")";var m=Math.min(30,30-c/200*30);v.appendChild(v.firstChild).style.height=m+"px";k++;l>b+2E3&&(g=Math.round(1E3*k/(l-b)),f=Math.min(f,g),h=Math.max(h,g),r.textContent=g+" FPS ("+f+"-"+h+")",m=Math.min(30,30-g/100*30),p.appendChild(p.firstChild).style.height=
m+"px",b=l,k=0,e=Infinity,d=0);return l},update:function(){a=this.end()}}};var MAX_FRAGS_PER_GROUP=333;
function RenderQueue(a,b,c){function e(a,b){var c=n,d=0,e=c.length;if(b)for(;d<e;d++)c[d]|=a;else for(var f=~a;d<e;d++)c[d]&=f}var d=0,g=-1,f=!0,h=!1,k=new THREE.Box3,l=new THREE.Box3,m=Array(a),n=new Uint8Array(a),r=new THREE.Raycaster;this.prototypeScene=b;var p=0,t=!1;a=0|(a+MAX_FRAGS_PER_GROUP-1)/MAX_FRAGS_PER_GROUP;for(var s=Array(a),u=0;u<a;u++)(s[u]=new THREE.Scene(!0)).__lights=b.__lights;this.visibleBoundsDirty=!1;c&&k.copy(c);this.addMesh=function(a,b){var c=m[a];c&&(stderr("duplicate fragment."),
c.parent.remove(c));m[a]=b;n[a]=1;b.fragId=a;var c=0|a/MAX_FRAGS_PER_GROUP,d=s[c];d||(s[c]=d=new THREE.Scene(!0),d.__lights=this.prototypeScene.__lights);l.copy(b.geometry.boundingBox);l.applyMatrix4(b.matrixWorld);k.union(l);d.add(b)};this.renderSome=function(a,b){var c=d,e=s.length,f=n,h=Date.now(),k=!0,l=0==c;l&&!t&&(g=-1,t=!0);for(;c<e;c++){var m=s[c],r=!1;l&&0<g?(c==g&&(r=!0),k=!1):k?(0>=b&&(r=!0),k=!1):b<=0.5*m.avgFrameTime&&(r=!0);if(r)break;var r=m.children,u=!0;if(2==p)for(var I=0,E=r.length;I<
E;I++){var P=r[I],T=!(f[P.fragId]&1);P.visible=T;u=u&&!T}else if(1==p)for(I=0,E=r.length;I<E;I++)P=r[I],T=!!(f[P.fragId]&2),P.visible=T,u=u&&!T;else for(I=0,E=r.length;I<E;I++)P=r[I],T=1==f[P.fragId],P.visible=T,u=u&&!T;u||a(m);r=Date.now();u=r-h;h=r;m.avgFrameTime=void 0===m.avgFrameTime?u:0.95*m.avgFrameTime+0.05*u;d=c+1;b-=m.avgFrameTime}l&&-1==g&&(g=c);c!=e&&l||(g=-1,t=!1);return b};this.isDone=function(){return d==s.length};this.reset=function(a){d=0};this.drawNormalObjectsOnly=function(){p=
0};this.drawHighlightedObjectsOnly=function(){p=1};this.drawHiddenObjectsOnly=function(){p=2};this.setOverrideMaterial=function(a){for(var b=0,c=s.length;b<c;b++)s[b].overrideMaterial=a};this.setHightlighted=function(a,b){var c=n[a];n[a]=b?c|2:c&-3;this.visibleBoundsDirty=!0};this.setVisibility=function(a,b){var c=n[a];n[a]=b?c|1:c&-2;this.visibleBoundsDirty=h=!0};this.setAllHighlighted=function(a){e(2,a);this.visibleBoundsDirty=!0};this.setAllVisibility=function(a){e(1,a);f=a;h=!1;this.visibleBoundsDirty=
!0};this.hideLines=function(a){var b=n,c=0,d=b.length;if(a)for(;c<d;c++)m[c].isLine&&(b[c]|=4);else for(;c<d;c++)m[c].isLine&&(b[c]&=-5);h=!0};this.isFragVisible=function(a){return 1==(n[a]&3)};this.areAllVisible=function(){if(h){f=!0;h=!1;for(var a=n,b=0,c=a.length;b<c;b++)if(0==(a[b]&1)){f=!1;break}}return f};this.getVisibleBounds=function(){if(!this.visibleBoundsDirty)return k;var a=n;k.makeEmpty();for(var b=0,c=a.length;b<c;b++)if(a[b]&1){var d=m[b];d.geometry.boundingBox.getTransformedBox(d.matrixWorld,
l);k.union(l)}this.visibleBoundsDirty=!1;return k};this.rayIntersect=function(a,b,c){r.set(a,b);a=r.intersectObjects(s,!0);for(var d=b=null,e=0;e<a.length;e++){var f=a[e].object,g=f.visible;void 0!==f.fragId&&(g=this.isFragVisible(f.fragId));if(g&&(!c||!a[e].object.material.transparent)){b=a[e].object;d=a[e].point;break}}return[b,d]};this.getRenderProgress=function(){return d/s.length};this.getVizmesh=function(a){return m[a]};this.getSceneCount=function(){return s.length}};function RenderContext(){var a,b,c,e,d,g,f,h,k,l,m,n,r=null,p=null,t=null,s=null,u=null,v=null,w=1.7,z=0,x,y,C=new Uint8Array(4),B={r:0,g:0,b:0},D={antialias:!0,sao:!1,useHdrTarget:!1,haveTwoSided:!1,useSSAA:!1,idbuffer:!1};this.settings=D;this.init=function(a,c,d){b=a;x=c;y=d;this.initPostPipeline(!1)};this.beginScene=function(b,c,g){e=c;g&&(a.setClearColor(B,0),a.clearTarget(p,!1,!0,!1),d.render(a,p,null));v&&(a.setClearColor(B,0),a.clearTarget(v,!0,!1,!1));D.sao&&(g&&(a.setClearColor(B,0),a.clearTarget(n,
!0,!1,!1)),f.uniforms.cameraNear.value=c.near,f.uniforms.cameraFar.value=c.far,k.uniforms.cameraNear.value=c.near,k.uniforms.cameraInvNearFar.value=1/(c.near-c.far),c=c.projectionMatrix.elements,f.uniforms.projInfo.value.set(-2/(p.width*c[0]),-2/(p.height*c[5]),(1-c[8])/c[0],(1-c[9])/c[5]),f.uniforms.projScale.value=0.125*p.height*c[5]);this.renderScenePart(b,!1)};this.renderScenePart=function(b,d){if(this.hasMRT())D.idbuffer?a.render(b,e,[p,v]):D.sao?a.render(b,e,[p,n]):a.render(b,e,p);else if(a.render(b,
e,p),D.sao&&!d){var f=b.overrideMaterial;b.overrideMaterial=c;a.render(b,e,n);b.overrideMaterial=f}};this.clearAllOverlays=function(){a.clearTarget(t,!0,!1,!1)};this.renderOverlays=function(b){var c=0,d;for(d in b)if(b.hasOwnProperty(d)){var f=b[d],g=f.scene,h=f.camera?f.camera:e;g.children.length&&(c||(c=1,a.setClearColor(B,0),a.clearTarget(t,!0,!1,!1)),f.materialPre&&(g.overrideMaterial=f.materialPre,a.render(g,h,t,!1)),f.materialPost&&(g.overrideMaterial=f.materialPost,a.context.depthFunc(a.context.GREATER),
a.render(g,h,t,!1),a.context.depthFunc(a.context.LEQUAL)),g.overrideMaterial=null)}m.uniforms.useOverlay.value=c};this.composeFinalFrame=function(b){if(!b&&D.sao){if(r){b=r[0];k.uniforms.resolution.value.set(1/b.width,1/b.height);k.render(a,b,n);for(var c=1;c<r.length;c++){var d=r[c];h.uniforms.resolution.value.set(1/d.width,1/d.height);h.render(a,d,b);b=d}}f.render(a,s,p);g.uniforms.axis.value.set(1,0);g.render(a,u,s);g.uniforms.axis.value.set(0,1);g.render(a,s,u)}l?(m.render(a,u,p),l.render(a,null,
u)):m.render(a,null,p);a.endFrame()};this.setSize=function(b,c,d){x=b;y=c;a.setSize(b,c);var e=0|b*a.devicePixelRatio,h=0|c*a.devicePixelRatio;D.logicalWidth=b;D.logicalHeight=c;D.deviceWidth=e;D.deviceHeight=h;b=!1;if(D.useSSAA){if(D.antialias){e*=3/a.devicePixelRatio;h*=3/a.devicePixelRatio;for(b=1;b<e;)b*=2;for(c=1;c<h;)c*=2;e=b;h=c}d=b=!0}if(d||!p||p.width!=e||p.height!=h)p=new THREE.WebGLRenderTarget(e,h,{minFilter:b?THREE.LinearMipMapLinearFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,
format:THREE.RGBFormat,type:D.useHdrTarget?THREE.FloatType:THREE.UnsignedByteType,stencilBuffer:!1,generateMipmaps:b}),t=new THREE.WebGLRenderTarget(e,h,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),t.shareDepthFrom=p;if(D.sao){if(d||!n||n.width!=e||n.height!=h){n=new THREE.WebGLRenderTarget(e,h,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat,type:THREE.FloatType,stencilBuffer:!1});n.shareDepthFrom=p;r=[];
for(c=0;5>c;c++){var k=new THREE.WebGLRenderTarget(0|e/(2<<c),0|h/(2<<c),{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,depthBuffer:!1,stencilBuffer:!1});k.generateMipmaps=!1;r.push(k);f.uniforms["tDepth_mip"+(c+1)].value=k}a.verifyMRTWorks([p,n]);s=new THREE.WebGLRenderTarget(e,h,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1,depthBuffer:!1});u=s.clone()}v=null}!D.idbuffer||!d&&v&&v.width==e&&v.height==h||
(v=new THREE.WebGLRenderTarget(e,h,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat,type:THREE.UnsignedByteType,stencilBuffer:!1,generateMipmaps:b}),v.shareDepthFrom=p,a.verifyMRTWorks([p,v]),r=n=null);f&&(f.uniforms.size.value.set(e,h),f.uniforms.tDepth.value=n,g.uniforms.size.value.set(e,h),g.uniforms.resolution.value.set(1/e,1/h));l&&l.uniforms.resolution.value.set(1/e,1/h);m.uniforms.tOverlay.value=t;m.uniforms.tAO.value=s;m.uniforms.useAO.value=D.sao?1:0;m.uniforms.resolution.value.set(1/
e,1/h);m.uniforms.tID.value=v};this.getMaxAnisotropy=function(){return a.getMaxAnisotropy()};this.hasMRT=function(){return a.supportsMRT()};this.initPostPipeline=function(e,n,p){function r(a){a.blending=THREE.NoBlending;a.depthWrite=!1;a.depthTest=!1}D.sao=e&&!_isIE11;D.antialias=n&&!_isIE11;if(D.idbuffer=p)D.sao=!1;a||((e=window.devicePixelRatio)||(e=1),a=new FireflyWebGLRenderer({canvas:b,antialias:!1,alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1,depth:!1,devicePixelRatio:e}),
a.autoClear=!1,a.sortObjects=!1);D.sao&&!f&&(e=NormalsShader,c=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:THREE.UniformsUtils.clone(e.uniforms)}),c.blending=THREE.NoBlending,D.haveTwoSided&&(c.side=THREE.DoubleSide),f=new THREE.ShaderPass(SAOShader),r(f.material),g=new THREE.ShaderPass(SAOBlurShader),r(g.material),k=new THREE.ShaderPass(SAOMinifyFirstShader),r(k.material),h=new THREE.ShaderPass(SAOMinifyShader),r(h.material));D.antialias?l||(l=new THREE.ShaderPass(FXAAShader),
r(l.material)):l=null;m||(m=new THREE.ShaderPass(BlendShader),r(m.material));d||(d=new THREE.ShaderPass(BackgroundShader),r(d.material));this.setSize(x,y)};this.setClearColors=function(a,b){d.uniforms.color2.value.copy(a);b?d.uniforms.color1.value.copy(b):d.uniforms.color1.value.set(0,0,0,1)};this.setAOOptions=function(a,b){f&&(f.uniforms.radius.value=0.1*a,f.uniforms.intensity.value=0.01*b)};this.setGamma=function(a){m&&(w=a,m.uniforms.gamma.value=1/a)};this.getGamma=function(){return w};this.setExposureBias=
function(a){m&&(z=a,m.uniforms.exposureBias.value=Math.pow(2,a),d.uniforms.luminance.value=Math.pow(2,-a))};this.getExposureBias=function(){return z};this.setWhiteScale=function(a){m&&(m.uniforms.whiteScale.value=a)};this.getWhiteScale=function(){return m.uniforms.whiteScale.value};this.setTonemapMethod=function(b){m&&(0==b?(D.useHdrTarget&&(D.useHdrTarget=!1,this.setSize(x,y,!0)),a.gammaInput=!1):(D.useHdrTarget||(D.useHdrTarget=!0,this.setSize(x,y,!0)),a.gammaInput=!0),m.uniforms.toneMapMethod.value=
b)};this.getToneMapMethod=function(){return m.uniforms.toneMapMethod.value};this.toggleTwoSided=function(a){D.haveTwoSided!=a&&c&&(c.side=a?THREE.DoubleSide:THREE.FrontSide,c.needsUpdate=!0);D.haveTwoSided=a};this.idAtPixel=function(b,c){if(!v)return 0;a.readPixels(v,0.5*(b+1)*v.width,0.5*(c+1)*v.height,1,1,C);return C[2]<<16|C[1]<<8|C[0]};this.highlightObjectViewport=function(a,b){var c=this.idAtPixel(a,b);0==c&&(C[0]=C[1]=C[2]=C[3]=0);m.uniforms.objID.value=c;m.uniforms.objIDv3.value.set(C[0]/255,
C[1]/255,C[2]/255)}};FXAAShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvarying vec2 vUv;\n#define FXAA_SPAN_MAX     8.0\n#define FXAA_EDGE_THRESHOLD_MIN (1.0/24.0)\n#define FXAA_EDGE_THRESHOLD (1.0/8.0)\n#define FXAA_SEARCH_THRESHOLD (1.0/4.0)\n#define FXAA_SEARCH_STEPS 24\n#define FXAA_SUBPIX_TRIM (1.0/4.0)\n#define FXAA_SUBPIX_TRIM_SCALE (1.0/(1.0 - FXAA_SUBPIX_TRIM))\n#define FXAA_SUBPIX_CAP (3.0/4.0)\nvec4 getColor(sampler2D tex, vec2 uv) {\nvec4 c = texture2D(tex, uv);\nreturn c;\n}\nfloat FxaaLuma(vec3 rgb) {\nreturn rgb.y * (0.587/0.299) + rgb.x; }\nvec4 FxaaFilterReturn(vec4 rgba) {\nreturn rgba;}\nvec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\nreturn (vec3(-amountOfA) * b) +\n((a * vec3(amountOfA)) + b); }\nvec4 FxaaTex(sampler2D tex, vec2 pos) {\nreturn getColor(tex, pos.xy);}\nvec4 FxaaTexOff(sampler2D tex, vec2 pos, vec2 offset, vec2 resolution) {\nvec2 uv = pos.xy + offset * resolution;\nreturn getColor(tex, uv);}\nvoid main() {\nvec3 rgbN = FxaaTexOff( tDiffuse, vUv, vec2(0.0,-1.0), resolution ).xyz;\nvec3 rgbE = FxaaTexOff( tDiffuse, vUv, vec2(1.0, 0.0), resolution ).xyz;\nvec3 rgbW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,0.0), resolution ).xyz;\nvec3 rgbS = FxaaTexOff( tDiffuse, vUv, vec2(0.0, 1.0), resolution ).xyz;\nvec4 rgbaM = FxaaTex( tDiffuse, vUv);\nvec3 rgbM  = rgbaM.xyz;\nfloat lumaN = FxaaLuma(rgbN);\nfloat lumaE = FxaaLuma(rgbE);\nfloat lumaW = FxaaLuma(rgbW);\nfloat lumaS = FxaaLuma(rgbS);\nfloat lumaM = FxaaLuma(rgbM);\nfloat rangeMin = min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\nfloat rangeMax = max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\nfloat range = rangeMax - rangeMin;\nif(range < max(FXAA_EDGE_THRESHOLD_MIN, rangeMax * FXAA_EDGE_THRESHOLD)) {\ngl_FragColor = FxaaFilterReturn(rgbaM); return;}\nvec3 rgbL = rgbN + rgbW + rgbM + rgbE + rgbS;\nfloat lumaL = (lumaN + lumaW + lumaE + lumaS) * 0.25;\nfloat rangeL = abs(lumaL - lumaM);\nfloat blendL = max(0.0, (rangeL / range) - FXAA_SUBPIX_TRIM) * FXAA_SUBPIX_TRIM_SCALE;\nblendL = min(FXAA_SUBPIX_CAP, blendL);\nvec3 rgbNW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,-1.0), resolution ).xyz;\nvec3 rgbNE = FxaaTexOff( tDiffuse, vUv, vec2(1.0,-1.0), resolution ).xyz;\nvec3 rgbSW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,1.0), resolution ).xyz;\nvec3 rgbSE = FxaaTexOff( tDiffuse, vUv, vec2(1.0,1.0), resolution ).xyz;\nfloat opacity  = rgbaM.w;\nrgbL += (rgbNW + rgbNE + rgbSW + rgbSE);\nrgbL *= vec3(1.0/9.0);\nfloat lumaNW = FxaaLuma( rgbNW);\nfloat lumaNE = FxaaLuma( rgbNE);\nfloat lumaSW = FxaaLuma( rgbSW);\nfloat lumaSE = FxaaLuma( rgbSE);\nfloat edgeVert = abs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\nabs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\nabs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\nfloat edgeHorz = abs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\nabs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\nabs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\nbool horzSpan = edgeHorz >= edgeVert;\nfloat lengthSign = horzSpan ? -resolution.y : -resolution.x;\nif(!horzSpan) lumaN = lumaW;\nif(!horzSpan) lumaS = lumaE;\nfloat gradientN = abs(lumaN - lumaM);\nfloat gradientS = abs(lumaS - lumaM);\nlumaN = (lumaN + lumaM) * 0.5;\nlumaS = (lumaS + lumaM) * 0.5;\nbool pairN = gradientN >= gradientS;\nif(!pairN) lumaN = lumaS;\nif(!pairN) gradientN = gradientS;\nif(!pairN) lengthSign *= -1.0;\nvec2 posN;\nposN.x = vUv.x + (horzSpan ? 0.0 : lengthSign * 0.5);\nposN.y = vUv.y + (horzSpan ? lengthSign * 0.5 : 0.0);\ngradientN *= FXAA_SEARCH_THRESHOLD;\nvec2 posP = posN;\nvec2 offNP = horzSpan ? vec2(resolution.x, 0.0) : vec2(0.0, resolution.y);\nfloat lumaEndN = lumaN;\nfloat lumaEndP = lumaN;\nbool doneN = false;\nbool doneP = false;\nposN += offNP * vec2(-1.0, -1.0);\nposP += offNP * vec2( 1.0,  1.0);\nfor(int i = 0; i < FXAA_SEARCH_STEPS; i++) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTex( tDiffuse, posN.xy).xyz);\nif(!doneP) lumaEndP = FxaaLuma(FxaaTex( tDiffuse, posP.xy).xyz);\ndoneN = doneN || (abs(lumaEndN - lumaN) >= gradientN);\ndoneP = doneP || (abs(lumaEndP - lumaN) >= gradientN);\nif(doneN && doneP) break;\nif(!doneN) posN -= offNP;\nif(!doneP) posP += offNP; }\nfloat dstN = horzSpan ? vUv.x - posN.x : vUv.y - posN.y;\nfloat dstP = horzSpan ? posP.x - vUv.x : posP.y - vUv.y;\nbool directionN = dstN < dstP;\nlumaEndN = directionN ? lumaEndN : lumaEndP;\nif(((lumaM - lumaN) < 0.0) == ((lumaEndN - lumaN) < 0.0))\nlengthSign = 0.0;\nfloat spanLength = (dstP + dstN);\ndstN = directionN ? dstN : dstP;\nfloat subPixelOffset = (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\nvec3 rgbF = FxaaTex(tDiffuse, vec2(\nvUv.x + (horzSpan ? 0.0 : subPixelOffset),\nvUv.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\ngl_FragColor = FxaaFilterReturn(vec4(FxaaLerp3(rgbL, rgbF, blendL), opacity));\n}"};TonemapShaderChunk="float luminance_post(vec3 rgb) {\nreturn dot(rgb, vec3(0.299, 0.587, 0.114));\n}\nfloat luminance_pre(vec3 rgb) {\nreturn dot(rgb, vec3(0.212671, 0.715160, 0.072169));\n}\nvec3 xyz2rgb(vec3 xyz) {\nvec3 R = vec3( 3.240479, -1.537150, -0.498535);\nvec3 G = vec3(-0.969256,  1.875992,  0.041556);\nvec3 B = vec3( 0.055648, -0.204043,  1.057311);\nvec3 rgb;\nrgb.b = dot(xyz, B);\nrgb.g = dot(xyz, G);\nrgb.r = dot(xyz, R);\nreturn rgb;\n}\nvec3 rgb2xyz(vec3 rgb) {\nvec3 X = vec3(0.412453, 0.35758, 0.180423);\nvec3 Y = vec3(0.212671, 0.71516, 0.0721688);\nvec3 Z = vec3(0.0193338, 0.119194, 0.950227);\nvec3 xyz;\nxyz.x = dot(rgb, X);\nxyz.y = dot(rgb, Y);\nxyz.z = dot(rgb, Z);\nreturn xyz;\n}\nvec3 xyz2xyY(vec3 xyz) {\nfloat sum = xyz.x + xyz.y + xyz.z;\nsum = 1.0 / sum;\nvec3 xyY;\nxyY.z = xyz.y;\nxyY.x = xyz.x * sum;\nxyY.y = xyz.y * sum;\nreturn xyY;\n}\nvec3 xyY2xyz(vec3 xyY) {\nfloat x = xyY.x;\nfloat y = xyY.y;\nfloat Y = xyY.z;\nvec3 xyz;\nxyz.y = Y;\nxyz.x = x * (Y / y);\nxyz.z = (1.0 - x - y) * (Y / y);\nreturn xyz;\n}\nvec3 toneMapUncharted2(vec3 x)\n{\nfloat A = 0.22;\nfloat B = 0.30;\nfloat C = 0.10;\nfloat D = 0.20;\nfloat E = 0.01;\nfloat F = 0.30;\nreturn ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\nvec3 toneMapReinhard(vec3 rgb, float scale, float Lmax) {\nfloat L = luminance_pre(rgb);\nfloat sL = L * scale;\nfloat tmL = scale * (1.0 + sL / (Lmax * Lmax))/ (1.0 + sL);\nrgb *= tmL;\nreturn rgb;\n}\nvec3 toneMapReinhardYxy(vec3 rgb, float scale, float Lmax) {\nvec3 xyY = xyz2xyY(rgb2xyz(rgb));\nfloat L = xyY.z;\nfloat sL = L * scale;\nfloat tmL = scale * (1.0 + sL / (Lmax * Lmax))/ (1.0 + sL);\nxyY.z *= tmL;\nreturn xyz2rgb(xyY2xyz(xyY));\n}\nvec3 toneMapExpRgb(vec3 rgb) {\nrgb = vec3(1.0) - vec3(exp(rgb * vec3(exposure)));\nreturn rgb;\n}\nfloat TonemapMin = -2.152529302052785809;\nfloat TonemapMax = 1.163792197947214113;\nvec3 log10(vec3 x) { return log(x) * (1.0 / log(10.0));}\nfloat toneMapCanon(float x) {\nfloat x2 = x  * x;\nfloat x3 = x  * x2;\nfloat x4 = x2 * x2;\nfloat x5 = x2 * x3;\nfloat x6 = x3 * x3;\nvec3 coeff1 = vec3( 23.921, -70.678,  71.943);\nvec4 coeff2 = vec4(-29.707,  5.9189, -0.4027, 0.0071);\nreturn dot(coeff1, vec3(x6, x5, x4)) + dot(coeff2, vec4(x3, x2, x, 1.0));\n}";BlendShader={uniforms:{tDiffuse:{type:"t",value:null},tAO:{type:"t",value:null},useAO:{type:"i",value:0},tOverlay:{type:"t",value:null},useOverlay:{type:"i",value:0},tID:{type:"t",value:null},objID:{type:"i",value:0},objIDv3:{type:"v3",value:new THREE.Vector3(0,0,0)},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)},gamma:{type:"f",value:1},whiteScale:{type:"f",value:1},exposureBias:{type:"f",value:1},toneMapMethod:{type:"i",value:0}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:["uniform sampler2D tDiffuse;\nuniform sampler2D tAO;\nuniform int useAO;\nuniform sampler2D tOverlay;\nuniform int useOverlay;\nuniform vec2 resolution;\nuniform float whiteScale;\nuniform float gamma;\nuniform float exposureBias;\nuniform int toneMapMethod;\nuniform int objID;\nuniform vec3 objIDv3;\nuniform sampler2D tID;\nvarying vec2 vUv;\nfloat exposure = log(1.0 - 0.6) / (whiteScale * 0.5);",TonemapShaderChunk,"vec4 fetchOverlayTexel(vec2 uv, vec2 offset) {\nreturn texture2D(tOverlay, uv + resolution * offset);\n}\nvec4 overlayEdgeDetect(vec2 vUv) {\nint has_zero = 0;\nvec4 center;\nvec4 non_zero_pixel;\nfloat max_alpha = 0.0;\nfor (int j=-1; j<=1; j++) {\nfor (int i=-1; i<=1; i++) {\nvec4 c = fetchOverlayTexel(vUv, vec2(i, j));\nmax_alpha = max(max_alpha, c.a);\nif (i==0 && j==0)\ncenter = c;\nif (c.a == 0.0)\nhas_zero++;\nelse\nnon_zero_pixel = c;\n}\n}\nif (has_zero != 0 && has_zero != 9)\n{\nif (center == vec4(0.0))\ncenter = non_zero_pixel;\nfloat maxComponent = max(center.r, max(center.g, center.b));\ncenter.rgb /= maxComponent;\ncenter.rgb = sqrt(center.rgb);\ncenter.a = 0.5 + 0.5 * max_alpha * 0.125 * float(has_zero);\n}\nif (has_zero == 0) {\ncenter.a = -center.a;\n}\nreturn center;\n}\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\nfloat ao = (useAO != 0) ? texture2D(tAO, vUv).r : 1.0;\ntexel.rgb *= ao;\nif (toneMapMethod == 1) {\ntexel.rgb *= exposureBias / whiteScale;\n} else if (toneMapMethod == 2) {\ntexel.rgb = toneMapReinhard(texel.rgb, exposureBias, whiteScale);\n} else if (toneMapMethod == 3) {\ntexel.rgb = toneMapUncharted2(texel.rgb * exposureBias);\ntexel.rgb *= 1.0 / toneMapUncharted2(vec3(whiteScale));\n} else if (toneMapMethod == 4) {\ntexel.rgb = toneMapExpRgb(texel.rgb * exposureBias);\n} else if (toneMapMethod == 5) {\nvec3 indexColor = log10(max(vec3(0.000000001), texel.rgb * exposureBias));\nindexColor = min(vec3(1.0), max(vec3(0.0), (indexColor.rgb - TonemapMin) / (TonemapMax - TonemapMin)));\ntexel.rgb = vec3(toneMapCanon(indexColor.r), toneMapCanon(indexColor.g), toneMapCanon(indexColor.b));\n}\ntexel.rgb = pow(texel.rgb, vec3(gamma));\nif (useOverlay!=0) {\nvec4 overlay = overlayEdgeDetect(vUv);\nif (overlay.a < 0.0) {\noverlay.a = -overlay.a;\nif (overlay.a >= 0.99) {\noverlay.a = 0.75;\ntexel.rgb = vec3(luminance_post(texel.rgb));\n}\n}\ntexel.rgb = mix(texel.rgb, overlay.rgb, overlay.a);\n}\nif (objID != 0) {\nvec4 idAtPixel = texture2D(tID, vUv);\nvec3 idDelta = abs(idAtPixel.rgb - objIDv3.rgb);\nif (max(max(idDelta.r, idDelta.g), idDelta.b) < 1e-3) {\ntexel.rgb = mix(texel.rgb, vec3(1.0,1.0,0.0), 0.25);\n}\n}\ngl_FragColor = texel;\n}"].join("\n")};THREE.ShaderPass=function(a,b){this.textureID=void 0!==b?b:"tDiffuse";this.uniforms=THREE.UniformsUtils.clone(a.uniforms);this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader});this.renderToScreen=!1;this.needsSwap=this.enabled=!0;this.clear=!1;this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1);var c=new THREE.BufferGeometry,e=new Float32Array(9);e[0]=-1;e[1]=-1;e[2]=0;e[3]=3;e[4]=-1;e[5]=0;e[6]=-1;e[7]=3;e[8]=0;var d=new Float32Array(6);
d[0]=0;d[1]=0;d[2]=2;d[3]=0;d[4]=0;d[5]=2;c.attributes.position={itemSize:3,array:e};c.attributes.uv={itemSize:2,array:d};this.quad=new THREE.Mesh(c,this.material);this.scene=new THREE.Scene;this.scene.add(this.quad)};THREE.ShaderPass.prototype={render:function(a,b,c,e){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=c);this.renderToScreen||!b?a.render(this.scene,this.camera):a.render(this.scene,this.camera,b,this.clear)}};SAOShader={uniforms:{tDepth:{type:"t",value:null},size:{type:"v2",value:new THREE.Vector2(512,512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},radius:{type:"f",value:10},bias:{type:"f",value:0.01},projScale:{type:"f",value:500},projInfo:{type:"v4",value:new THREE.Vector4(0,0,0,0)},intensity:{type:"f",value:0.75},tDepth_mip1:{type:"t",value:null},tDepth_mip2:{type:"t",value:null},tDepth_mip3:{type:"t",value:null},tDepth_mip4:{type:"t",value:null},tDepth_mip5:{type:"t",value:null}},
vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#extension GL_OES_standard_derivatives : enable\n#define USE_MIPMAP 1\nuniform float cameraNear;\nuniform float cameraFar;\nuniform vec2 size;\nuniform float lumInfluence;\nvarying vec2 vUv;\n#define NUM_SAMPLES (17)\n#define LOG_MAX_OFFSET (3)\n#define MAX_MIP_LEVEL (5)\n#define NUM_SPIRAL_TURNS (7)\nuniform float           projScale;\nuniform sampler2D tDepth;\n#ifdef USE_MIPMAP\nuniform sampler2D tDepth_mip1;\nuniform sampler2D tDepth_mip2;\nuniform sampler2D tDepth_mip3;\nuniform sampler2D tDepth_mip4;\nuniform sampler2D tDepth_mip5;\n#endif\nuniform float radius;\nuniform float bias;\nuniform float intensity;\nfloat intensityDivR6 = intensity / pow(radius, 6.0);\nvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\nfloat alpha = float(float(sampleNumber) + 0.5) * (1.0 / float(NUM_SAMPLES));\nfloat angle = alpha * (float(NUM_SPIRAL_TURNS) * 6.28) + spinAngle;\nssR = alpha;\nreturn vec2(cos(angle), sin(angle));\n}\nfloat CSZToKey(float z) {\nreturn clamp(z * (1.0 / -cameraFar), 0.0, 1.0);\n}\nvoid packKey(float key, out vec2 p) {\nfloat temp = floor(key * 256.0);\np.x = temp * (1.0 / 256.0);\np.y = key * 256.0 - temp;\n}\nfloat unpackDepth( const in vec4 rgba_depth ) {\nfloat depth = dot( rgba_depth, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0) );\nif (depth == 0.0)\nreturn -cameraFar * 1.0e10;\nreturn depth * (cameraNear - cameraFar) - cameraNear;\n}\nuniform vec4 projInfo;\nvec3 reconstructCSPosition(vec2 S, float z) {\nreturn vec3((S.xy * projInfo.xy + projInfo.zw) * z, z);\n}\nvec3 reconstructCSFaceNormal(vec3 C) {\nreturn normalize(cross(dFdy(C), dFdx(C)));\n}\nvec3 reconstructNonUnitCSFaceNormal(vec3 C) {\nreturn cross(dFdy(C), dFdx(C));\n}\nvec2 sizeM1 = vec2(1.0/(size.x), 1.0/(size.y));\nvec3 getPosition(ivec2 ssP, float depth) {\nvec3 P;\nP = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);\nreturn P;\n}\nvec3 getOffsetPosition(ivec2 ssC, vec2 unitOffset, float ssR) {\nivec2 ssP = ivec2(ssR * unitOffset) + ssC;\nvec3 P;\nvec2 screenUV = (vec2(ssP) + vec2(0.5)) * sizeM1;\n#ifdef USE_MIPMAP\nint mipLevel = int(max(0.0, min(floor(log2(ssR)) - float(LOG_MAX_OFFSET), float(MAX_MIP_LEVEL))));\nif (mipLevel == 0) {\nP.z = texture2D(tDepth, screenUV).z;\nif (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n}\nelse if (mipLevel == 1)\nP.z = unpackDepth(texture2D(tDepth_mip1, screenUV));\nelse if (mipLevel == 2)\nP.z = unpackDepth(texture2D(tDepth_mip2, screenUV));\nelse if (mipLevel == 3)\nP.z = unpackDepth(texture2D(tDepth_mip3, screenUV));\nelse if (mipLevel == 4)\nP.z = unpackDepth(texture2D(tDepth_mip4, screenUV));\nelse if (mipLevel == 5)\nP.z = unpackDepth(texture2D(tDepth_mip5, screenUV));\n#else\nP.z = texture2D(tDepth, screenUV).z;\nif (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n#endif\nP = reconstructCSPosition(vec2(ssP) + vec2(0.5), P.z);\nreturn P;\n}\nfloat radius2 = radius * radius;\nfloat invRadius2 = 1.0 / radius2;\nfloat sampleAO(in ivec2 ssC, in vec3 C, in vec3 n_C, in float ssDiskRadius, in int tapIndex, in float randomPatternRotationAngle) {\nfloat ssR;\nvec2 unitOffset = tapLocation(tapIndex, randomPatternRotationAngle, ssR);\nssR *= ssDiskRadius;\nvec3 Q = getOffsetPosition(ssC, unitOffset, ssR);\nvec3 v = Q - C;\nfloat vv = dot(v, v);\nfloat vn = dot(v, n_C);\nconst float epsilon = 0.01;\nfloat f = max(radius2 - vv, 0.0); return f * f * f * max((vn - bias) / (epsilon + vv), 0.0);\n}\nconst bool useNoise = true;\nvec2 rand( const vec2 coord ) {\nvec2 noise;\nif ( useNoise ) {\nfloat nx = dot ( coord, vec2( 12.9898, 78.233 ) );\nfloat ny = dot ( coord, vec2( 12.9898, 78.233 ) * 2.0 );\nnoise = clamp( fract ( 43758.5453 * sin( vec2( nx, ny ) ) ), 0.0, 1.0 );\n} else {\nfloat ff = fract( 1.0 - coord.s * ( size.x / 2.0 ) );\nfloat gg = fract( coord.t * ( size.y / 2.0 ) );\nnoise = vec2( 0.25, 0.75 ) * vec2( ff ) + vec2( 0.75, 0.25 ) * gg;\n}\nreturn ( noise * 2.0  - 1.0 );\n}\nfloat getRandomAngle(vec2 pos) {\nvec2 rnd = rand(pos);\nreturn atan(rnd.y, rnd.x);\n}\nvoid main() {\nivec2 ssC = ivec2(gl_FragCoord.xy);\nvec4 nrmz = texture2D(tDepth, vUv);\nif (nrmz.z == 0.0) {\ngl_FragColor.r = 1.0;\ngl_FragColor.a = 0.0;\npackKey(1.0, gl_FragColor.gb);\nreturn;\n}\nvec3 C = getPosition(ssC, nrmz.z);\npackKey(CSZToKey(C.z), gl_FragColor.gb);\nfloat randomPatternRotationAngle = getRandomAngle(vUv);\nvec3 n_C = vec3(nrmz.x, nrmz.y, sqrt(1.0 - dot(nrmz.xy, nrmz.xy)));\nfloat ssDiskRadius = -projScale * radius / C.z;\nfloat sum = 0.0;\nfor (int i = 0; i < NUM_SAMPLES; ++i) {\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, i, randomPatternRotationAngle);\n}\nfloat A = max(0.0, 1.0 - sum * intensityDivR6 * (5.0 / float(NUM_SAMPLES)));\nif (abs(dFdx(C.z)) < 0.02) {\nA -= dFdx(A) * (mod(float(ssC.x), 2.0) - 0.5);\n}\nif (abs(dFdy(C.z)) < 0.02) {\nA -= dFdy(A) * (mod(float(ssC.y), 2.0) - 0.5);\n}\ngl_FragColor.r = A;\ngl_FragColor.a = 1.0;\n}"};SAOBlurShader={uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new THREE.Vector2(512,512)},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)},axis:{type:"v2",value:new THREE.Vector2(1,0)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#define EDGE_SHARPNESS     (1.0)\n#define SCALE               (2)\n#define R                   (4)\n#define VALUE_TYPE        float\n#define VALUE_COMPONENTS   r\n#define VALUE_IS_KEY       0\n#define KEY_COMPONENTS     gb\n#if __VERSION__ >= 330\nconst float gaussian[R + 1] =\nfloat[](0.153170, 0.144893, 0.122649, 0.092902, 0.062970);  // stddev = 2.0\n#endif\nuniform sampler2D   tDiffuse;\nuniform vec2 size;\nuniform vec2 resolution;\nuniform vec2       axis;\nivec2 axisi = ivec2(axis);\n#define  result         gl_FragColor.VALUE_COMPONENTS\n#define  keyPassThrough gl_FragColor.KEY_COMPONENTS\nfloat unpackKey(vec2 p) {\nreturn p.x * (256.0 / 257.0) + p.y * (1.0 / 257.0);\n}\nvarying vec2 vUv;\nvoid main() {\n#   if __VERSION__ < 330\nfloat gaussian[R + 1];\n#       if R == 3\ngaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902;  // stddev = 2.0\n#       elif R == 4\ngaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902; gaussian[4] = 0.062970;  // stddev = 2.0\n#       elif R == 6\ngaussian[0] = 0.111220; gaussian[1] = 0.107798; gaussian[2] = 0.098151; gaussian[3] = 0.083953; gaussian[4] = 0.067458; gaussian[5] = 0.050920; gaussian[6] = 0.036108;\n#       endif\n#   endif\nivec2 ssC = ivec2(gl_FragCoord.xy);\nvec4 temp = texture2D(tDiffuse, vUv);\ngl_FragColor.gb = temp.KEY_COMPONENTS;\ngl_FragColor.a = temp.a;\nVALUE_TYPE sum = temp.VALUE_COMPONENTS;\nif (temp.a == 0.0) {\nresult = sum;\nreturn;\n}\nfloat key = unpackKey(keyPassThrough);\nfloat BASE = gaussian[0];\nfloat totalWeight = BASE;\nsum *= totalWeight;\nfor (int r = -R; r <= R; ++r) {\nif (r != 0) {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[r<0?-r:r];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\n}\nconst float epsilon = 0.0001;\nresult = sum / (totalWeight + epsilon);\n}"};SAOMinifyFirstShader={uniforms:{tDiffuse:{type:"t",value:null},cameraNear:{type:"f",value:1},cameraInvNearFar:{type:"f",value:100},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nuniform float cameraNear;\nuniform float cameraInvNearFar;\nvarying vec2 vUv;\nvec4 packDepth( const in float depth ) {\nvec4 enc = vec4(1.0, 255.0, 65025.0, 160581375.0) * depth;\nenc = fract(enc);\nenc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);\nreturn enc;\n}\nvoid main() {\nvec2 ssP = vec2(gl_FragCoord.xy);\nssP = ssP * 2.0 + mod(ssP, 2.0);\nssP = (ssP + 0.5) * resolution * 0.5;\nfloat depth = texture2D(tDiffuse, ssP).z;\nif (depth != 0.0)\ndepth = (depth + cameraNear) * cameraInvNearFar;\ngl_FragColor = packDepth(depth);\n}"};
SAOMinifyShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvarying vec2 vUv;\nvoid main() {\nvec2 ssP = vec2(gl_FragCoord.xy);\nssP = ssP * 2.0 + mod(ssP, 2.0);\nssP = (ssP + 0.5) * resolution * 0.5;\ngl_FragColor = texture2D(tDiffuse, ssP);\n}"};NormalsShader={uniforms:{},vertexShader:"varying vec3 vNormal;\nvarying float depth;\nvoid main() {\nvNormal = normalize( normalMatrix * normal );\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ndepth = mvPosition.z;\nvec4 p_Position = projectionMatrix * mvPosition;\ngl_Position = p_Position;\n}",fragmentShader:"varying vec3 vNormal;\nvarying float depth;\nvoid main() {\nvec3 n = vNormal;\nn = n * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nn = normalize( n );\ngl_FragColor = vec4(n.x, n.y, depth, 1.0);\n}"};BackgroundShader={uniforms:{color1:{type:"v4",value:new THREE.Vector4(1/255,2/255,3/255,1)},color2:{type:"v4",value:new THREE.Vector4(41/255,76/255,120/255,1)},luminance:{type:"f",value:1}},vertexShader:"uniform vec4 color1;\nuniform vec4 color2;\nuniform float luminance;\nvarying vec4 vcolor;\nvoid main() {\nif (uv.y == 0.0)\nvcolor = color1;\nelse\nvcolor = color2;\nvcolor *= luminance;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"const vec4 c0 = vec4(1.0, 13.0, 4.0, 16.0);\nconst vec4 c1 = vec4(9.0, 5.0, 12.0, 8.0);\nconst vec4 c2 = vec4(3.0, 15.0, 2.0, 14.0);\nconst vec4 c3 = vec4(11.0, 7.0, 10.0, 6.0);\nvarying vec4 vcolor;\nvoid main() {\nvec4 c = vcolor;\nint i = int(mod(float(gl_FragCoord.x), 4.0));\nint j = int(mod(float(gl_FragCoord.y), 4.0));\nvec4 col;\nif (i==0) col = c0; else if (i==1) col = c1; else if (i==2) col = c2; else col = c3;\nfloat bias;\nif (j==0) bias = col.x; else if (j==1) bias = col.y; else if (j==2) bias = col.z; else bias = col.w;\nc.xyz += bias * (1.0/(17.0*256.0));\ngl_FragColor = c;\n}"};LineShader={uniforms:{pixelsPerUnit:{type:"f",value:1},unitsPerPixel:{type:"f",value:1},highlightId:{type:"v4",value:new THREE.Vector4(0,0,0,0)},tLayerMask:{type:"t",value:null},tRaster:{type:"t",value:null}},attributes:{flags4b:0,color4b:0,dbId4b:0,extraParams:0},defines:{},vertexShader:"#define TAU 6.28318530718\n#define PI 3.14159265358979\n#define HALF_PI 1.57079632679\n#define VBB_LINE_SEGMENT     16.0\n#define VBB_ARC_CIRCULAR     32.0\n#define VBB_ARC_ELLIPTICAL   48.0\n#define VBB_TEX_QUAD         64.0\n#define VBB_SEG_START_RIGHT  1.0\n#define VBB_SEG_START_LEFT   2.0\n#define VBB_SEG_END_RIGHT    3.0\n#define VBB_SEG_END_LEFT     4.0\nattribute vec4 color4b;\nattribute vec4 dbId4b;\nattribute vec4 flags4b;\nattribute vec4 extraParams;\nuniform float pixelsPerUnit;\nuniform float unitsPerPixel;\nvarying vec4 outColor;\nvarying vec4 dbId;\nvarying vec2 centralVertex;\nvarying vec2 offsetPosition;\nvarying vec4 multipurpose;\nuniform sampler2D tLayerMask;\nvarying float halfWidth;\nvoid strokeLineSegment(float vertexId) {\nfloat distanceAlong = uv.x;\nbool isStartCapVertex = (vertexId < VBB_SEG_END_RIGHT);\nfloat isLeftSide = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? 1.0 : -1.0;\nfloat angleTransverse = position.z + isLeftSide * HALF_PI;\nmultipurpose.y = distanceAlong;\nfloat st = sin(angleTransverse);\nfloat ct = cos(angleTransverse);\nfloat moveDist = halfWidth + 0.5 * unitsPerPixel;\nvec2 offset = vec2(ct, st) * moveDist;\noffsetPosition.xy += offset;\nmultipurpose.z = 0.0;\nif (isStartCapVertex) {\noffsetPosition.xy += isLeftSide * vec2(-offset.y, offset.x);\ncentralVertex.xy += isLeftSide * vec2(-offset.y, offset.x);\nmultipurpose.x = -moveDist;\n}\nelse {\nvec2 along = vec2(cos(position.z), sin(position.z));\noffsetPosition.xy += distanceAlong * along;\ncentralVertex.xy += distanceAlong * along;\noffsetPosition.xy += isLeftSide * vec2(offset.y, -offset.x);\ncentralVertex.xy += isLeftSide * vec2(offset.y, -offset.x);\nmultipurpose.x = multipurpose.y + moveDist;\n}\n}\nvoid strokeTexQuad(float vertexId) {\nfloat distanceAlong = uv.x;\nbool isStartCapVertex = (vertexId < VBB_SEG_END_RIGHT);\nfloat isLeftSide = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? 1.0 : -1.0;\nfloat angleTransverse = position.z + isLeftSide * HALF_PI;\nmultipurpose.y = distanceAlong;\nfloat st = sin(angleTransverse);\nfloat ct = cos(angleTransverse);\nfloat moveDist = halfWidth;\nvec2 offset = vec2(ct, st) * moveDist;\noffsetPosition.xy += offset;\nmultipurpose.z = 1.0;\nhalfWidth = 0.0;\nif (isStartCapVertex) {\noffsetPosition.xy += isLeftSide * vec2(0.0, offset.x);\nmultipurpose.x = 0.0;\nmultipurpose.y = max(0.0, isLeftSide);\n}\nelse {\nvec2 along = vec2(cos(position.z), sin(position.z));\noffsetPosition.xy += distanceAlong * along;\ncentralVertex.xy += distanceAlong * along;\noffsetPosition.xy += isLeftSide * vec2(0.0, -offset.x);\nmultipurpose.x = 1.0;\nmultipurpose.y = max(0.0, isLeftSide);\n}\n}\nvoid strokeCircularArc(float vertexId) {\nvec2 angles = vec2(position.z, uv.x);\nfloat r = extraParams.x;\nbool isStart = (vertexId < VBB_SEG_END_RIGHT);\nbool isLeft = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT);\nvec2 minPt;\nvec2 maxPt;\nvec2 endsX = vec2(position.x) + r * cos(angles);\nvec2 endsY = vec2(position.y) + r * sin(angles);\nminPt = maxPt = vec2(endsX.x, endsY.x);\nminPt = min(minPt, vec2(endsX.y, endsY.y));\nmaxPt = max(maxPt, vec2(endsX.y, endsY.y));\nfloat start = angles.x;\nfloat end = angles.y;\nif (end > start) {\nif (start < (0.5 * PI) && end > (0.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y + r));\nmaxPt = max(maxPt, vec2(position.x, position.y + r));\n}\nif (start < PI && end > PI) {\nminPt = min(minPt, vec2(position.x - r, position.y));\nmaxPt = max(maxPt, vec2(position.x - r, position.y));\n}\nif (start < (1.5 * PI) && end > (1.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y - r));\nmaxPt = max(maxPt, vec2(position.x, position.y - r));\n}\n}\nelse {\nminPt = min(minPt, vec2(position.x + r, position.y));\nmaxPt = max(maxPt, vec2(position.x + r, position.y));\nif (start < (0.5 * PI) || end > (0.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y + r));\nmaxPt = max(maxPt, vec2(position.x, position.y + r));\n}\nif (start < PI || end > PI) {\nminPt = min(minPt, vec2(position.x - r, position.y));\nmaxPt = max(maxPt, vec2(position.x - r, position.y));\n}\nif (start < (1.5 * PI) || end > (1.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y - r));\nmaxPt = max(maxPt, vec2(position.x, position.y - r));\n}\n}\nminPt -= halfWidth + 0.5 * unitsPerPixel;\nmaxPt += halfWidth + 0.5 * unitsPerPixel;\nif (isStart)\noffsetPosition.x = minPt.x;\nelse\noffsetPosition.x = maxPt.x;\nif (isLeft)\noffsetPosition.y = minPt.y;\nelse\noffsetPosition.y = maxPt.y;\nmultipurpose.x = angles.x;\nmultipurpose.y = -r;\nmultipurpose.z = angles.y;\nmultipurpose.w = -r;\n}\nvoid strokeEllipticalArc(float vertexId) {\nvec2 angles = vec2(position.z, uv.x);\nfloat isStart = (vertexId < VBB_SEG_END_RIGHT) ? -1.0 : 1.0;\nfloat isLeft = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? -1.0 : 1.0;\nfloat major = extraParams.x;\nfloat minor = extraParams.y;\nvec2 minPt;\nvec2 maxPt;\nvec2 endsX = vec2(position.x) + major * cos(angles);\nvec2 endsY = vec2(position.y) + minor * sin(angles);\nminPt = maxPt = vec2(endsX.x, endsY.x);\nminPt = min(minPt, vec2(endsX.y, endsY.y));\nmaxPt = max(maxPt, vec2(endsX.y, endsY.y));\nfloat start = angles.x;\nfloat end = angles.y;\nif (end > start) {\nif (start < (0.5 * PI) && end > (0.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y + minor));\nmaxPt = max(maxPt, vec2(position.x, position.y + minor));\n}\nif (start < PI && end > PI) {\nminPt = min(minPt, vec2(position.x - major, position.y));\nmaxPt = max(maxPt, vec2(position.x - major, position.y));\n}\nif (start < (1.5 * PI) && end > (1.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y - minor));\nmaxPt = max(maxPt, vec2(position.x, position.y - minor));\n}\n}\nelse {\nminPt = min(minPt, vec2(position.x + major, position.y));\nmaxPt = max(maxPt, vec2(position.x + major, position.y));\nif (start < (0.5 * PI) || end > (0.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y + minor));\nmaxPt = max(maxPt, vec2(position.x, position.y + minor));\n}\nif (start < PI || end > PI) {\nminPt = min(minPt, vec2(position.x - major, position.y));\nmaxPt = max(maxPt, vec2(position.x - major, position.y));\n}\nif (start < (1.5 * PI) || end > (1.5 * PI)) {\nminPt = min(minPt, vec2(position.x, position.y - minor));\nmaxPt = max(maxPt, vec2(position.x, position.y - minor));\n}\n}\nminPt -= halfWidth + 0.5 * unitsPerPixel;\nmaxPt += halfWidth + 0.5 * unitsPerPixel;\nif (isStart < 0.0)\noffsetPosition.x = minPt.x;\nelse\noffsetPosition.x = maxPt.x;\nif (isLeft < 0.0)\noffsetPosition.y = minPt.y;\nelse\noffsetPosition.y = maxPt.y;\nmultipurpose.x = angles.x;\nmultipurpose.y = -major;\nmultipurpose.z = angles.y;\nmultipurpose.w = minor;\n}\nvoid main() {\noffsetPosition = position.xy;\ncentralVertex = position.xy;\nvec4 layerBit = texture2D(tLayerMask, flags4b.ba / 255.0);\nif (layerBit.r == 0.0) {\noutColor = vec4(0.0);\n}\nelse {\nfloat vertexId = mod(flags4b.x, 16.0);\nfloat geomType = flags4b.x - vertexId;\nfloat lineWeight = uv.y;\nif (lineWeight > 0.0) {\nif (lineWeight * pixelsPerUnit < 0.33)\nlineWeight = 0.33 * unitsPerPixel;\n}\nelse {\nlineWeight = abs(lineWeight);\n}\nhalfWidth = lineWeight;\noutColor = color4b;\ndbId = dbId4b;\nif (geomType == VBB_LINE_SEGMENT)\nstrokeLineSegment(vertexId);\nelse if (geomType == VBB_ARC_CIRCULAR)\nstrokeCircularArc(vertexId);\nelse if (geomType == VBB_ARC_ELLIPTICAL)\nstrokeEllipticalArc(vertexId);\nelse if (geomType == VBB_TEX_QUAD)\nstrokeTexQuad(vertexId);\nelse\nhalfWidth = 0.0;\n}\ngl_Position = projectionMatrix * modelViewMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\n}",
fragmentShader:"#extension GL_OES_standard_derivatives : enable\n#define TAU 6.28318530718\n#define PI 3.14159265358979\nuniform float pixelsPerUnit;\nuniform float unitsPerPixel;\nfloat aaRange = 0.5 * unitsPerPixel;\nuniform sampler2D tRaster;\nvarying vec4 outColor;\nvarying vec4 dbId;\n#ifdef MRT_ID_BUFFER\n#extension GL_EXT_draw_buffers : enable\n#define gl_FragColor gl_FragData[0]\n#endif\nvarying vec2 centralVertex;\nvarying vec2 offsetPosition;\nvarying vec4 multipurpose;\nvarying float halfWidth;\nfloat curveGaussian(float r, float width) {\nfloat amt = clamp(abs(r / (width * 1.0)), 0.0, 1.0);\namt = max(amt - 0.0, 0.0);\nfloat exponent = amt * 3.5;\nexponent *= -exponent;\nreturn clamp(exp(exponent), 0.0, 1.0);\n}\nvoid fillLineSegment() {\nfloat radius = halfWidth;\nfloat parametricDistance = multipurpose.x;\nfloat segmentLength = multipurpose.y;\nif (parametricDistance < 0.0) {\nradius = sqrt(max(0.0, radius * radius - parametricDistance * parametricDistance));\n} else if (parametricDistance >= segmentLength) {\nfloat d = parametricDistance - segmentLength;\nradius = sqrt(max(0.0, radius * radius - d * d));\n}\nfloat dist = distance(centralVertex, offsetPosition);\nfloat range =  dist - radius;\nif (range > aaRange) {\ndiscard;\n}\nelse if (range < -aaRange) {\ngl_FragColor = outColor;\n}\nelse {\ngl_FragColor = outColor;\ngl_FragColor.a = curveGaussian(range+aaRange, 2.0 * unitsPerPixel);\n}\n}\nvoid fillCircularArc() {\nfloat dist = distance(centralVertex, offsetPosition);\nfloat radius = abs(multipurpose.y);\nfloat range =  abs(dist - radius);\nif (range > aaRange + halfWidth) {\ndiscard;\n}\nvec2 angles = multipurpose.xz;\nvec2 direction = offsetPosition - centralVertex;\nfloat angle = atan(direction.y, direction.x);\nif (angles.x > angles.y)\nangles.x -= TAU;\nelse if (angle < 0.0)\nangle += TAU;\nif (angle > angles.x && angle < angles.y) {\nif (range < halfWidth - aaRange) {\ngl_FragColor = outColor;\n}\nelse {\ngl_FragColor = outColor;\ngl_FragColor.a = curveGaussian(range-halfWidth+aaRange, 2.0 * unitsPerPixel);\n}\n}\nelse {\ndiscard;\n}\n}\nfloat DistancePointEllipseApprox(vec2 e, vec2 pos) { \nvec2 dx = dFdx(pos);\nvec2 dy = dFdy(pos);\nvec2 esqr = e * e;\nvec2 possqr = pos * pos;\nvec2 posDivEsqr = pos / esqr;\nvec2 pos2DivE2 = pos * posDivEsqr;\nvec2 dPos = 2.0 * posDivEsqr;\nvec2 dPosx = dPos * dx;\nvec2 dPosy = dPos * dy;\nvec2 dfdxy = vec2(dPosx.x + dPosx.y, dPosy.x + dPosy.y);\nfloat sd = (pos2DivE2.x + pos2DivE2.y - 1.0) / length(dfdxy);\nreturn abs(sd) * unitsPerPixel * 0.745;\n}\nfloat DistancePointEllipseSpecial (vec2 e, vec2 y, out vec2 x, float width, float aaRange) {\nfloat dist;\nvec2 esqr = e * e;\nvec2 ey = e * y;\nfloat t0 = -esqr[1] + ey[1];\nfloat t1 = -esqr[1] + length(ey);\nfloat t;\nvec2 r;\nfor (int i = 0; i < 6; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nif (dist > max(2.0 * (width + aaRange), e[0] * 0.05))\nreturn dist;\nfor (int i = 0; i < 6; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nfloat ecc = 1.0 +  0.1 * e[0] / e[1];\nif (dist > max(ecc * (width + aaRange), e[0] * 0.001))\nreturn dist;\nif (dist < (width - aaRange) / ecc)\nreturn dist;\nfor (int i = 0; i < 10; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nreturn dist;\n}\nfloat DistancePointEllipse(vec2 e, vec2 y, out vec2 locX, float width, float aaRange) {\nvec2 locE, locY;\nfloat diff = sign(e[0] - e[1]);\nvec2 swizzle = vec2(max(diff, 0.0), -min(diff, 0.0));\nlocE.x = dot(e, swizzle.xy);\nlocE.y = dot(e, swizzle.yx);\nlocY.x = dot(y, swizzle.xy);\nlocY.y = dot(y, swizzle.yx);\nvec2 refl = sign(locY);\nlocY *= refl;\nvec2 x;\nfloat distance = DistancePointEllipseSpecial(locE, locY, x, width, aaRange);\nx *= refl;\nlocX.x = dot(x, swizzle.xy);\nlocX.y = dot(x, swizzle.yx);\nreturn distance;\n}\nvoid fillEllipticalArc() {\nvec2 radii = abs(multipurpose.yw);\nvec2 dir = offsetPosition - centralVertex;\nfloat lenDirSq = dot(dir, dir);\nfloat minRad = min(radii.x, radii.y) - (halfWidth + aaRange);\nif (lenDirSq < minRad * minRad)\ndiscard;\nvec2 pos;\nfloat range = DistancePointEllipse(radii, dir, pos, halfWidth, aaRange);\nif (range > halfWidth + aaRange)\ndiscard;\nfloat ar = radii[0] / radii[1];\nvec2 angles = multipurpose.xz;\nfloat angle = atan(ar * pos.y, pos.x);\nif (angles.x > angles.y)\nangles.x -= TAU;\nelse if (angle < 0.0)\nangle += TAU;\nif (angle > angles.x && angle < angles.y) {\nif (range < halfWidth - aaRange) {\ngl_FragColor = outColor;\n}\nelse {\ngl_FragColor = outColor;\ngl_FragColor.a = curveGaussian(range-halfWidth+aaRange, 2.0 * unitsPerPixel);\n}\n}\nelse {\ndiscard;\n}\n}\nvoid main() {\nif (outColor.a == 0.0) {\ndiscard;\n}\nif (halfWidth == 0.0) {\nif (multipurpose.z != 0.0)\ngl_FragColor = texture2D(tRaster, multipurpose.xy);\nelse\ngl_FragColor = outColor;\n}\nelse if (multipurpose.y >= 0.0)\nfillLineSegment();\nelse if (multipurpose.y == multipurpose.w)\nfillCircularArc();\nelse\nfillEllipticalArc();\n#ifdef MRT_ID_BUFFER\ngl_FragData[1] = vec4(dbId.rgb, 1.0);\n#elif defined(ID_COLOR)\noutColor = vec4(dbId.rgba);\n#endif\n}"};FireflyWebGLRenderer=function(a){function b(a,b){var f=b.geometry,g=a.faces3,h=3*g.length,k=1*g.length,l=3*g.length,g=c(b,a),m=d(g),n=e(g),p=g.vertexColors?g.vertexColors:!1;a.__vertexArray=new Float32Array(3*h);n&&(a.__normalArray=new Float32Array(3*h));f.hasTangents&&(a.__tangentArray=new Float32Array(4*h));p&&(a.__colorArray=new Float32Array(3*h));m&&(0<f.faceVertexUvs.length&&(a.__uvArray=new Float32Array(2*h)),1<f.faceVertexUvs.length&&(a.__uv2Array=new Float32Array(2*h)));b.geometry.skinWeights.length&&
b.geometry.skinIndices.length&&(a.__skinIndexArray=new Float32Array(4*h),a.__skinWeightArray=new Float32Array(4*h));a.__faceArray=new Uint16Array(3*k);a.__lineArray=new Uint16Array(2*l);a.__webglFaceCount=3*k;a.__webglLineCount=2*l;if(g.attributes){void 0===a.__webglCustomAttributesList&&(a.__webglCustomAttributesList=[]);for(var r in g.attributes){var f=g.attributes[r],k={},s;for(s in f)k[s]=f[s];if(!k.__webglInitialized||k.createUniqueBuffers)k.__webglInitialized=!0,l=1,"v2"===k.type?l=2:"v3"===
k.type?l=3:"v4"===k.type?l=4:"c"===k.type&&(l=3),k.size=l,k.array=new Float32Array(h*l),k.buffer=q.createBuffer(),k.buffer.belongsToAttribute=r,f.needsUpdate=!0,k.__original=f;a.__webglCustomAttributesList.push(k)}}a.__inittedArrays=!0}function c(a,b){return a.material instanceof THREE.MeshFaceMaterial?a.material.materials[b.materialIndex]:a.material}function e(a){return a instanceof THREE.MeshBasicMaterial&&!a.envMap||a instanceof THREE.MeshDepthMaterial?!1:a&&void 0!==a.shading&&a.shading===THREE.SmoothShading?
THREE.SmoothShading:THREE.FlatShading}function d(a){return a.map||a.lightMap||a.bumpMap||a.normalMap||a.specularMap||a instanceof THREE.ShaderMaterial?!0:!1}function g(a,b,c,d){var e,g,h,k=!1;if(c.vb){if(c.streamingDraw){var l=fa.interleavedVB;l||(l=q.createBuffer(),fa.interleavedVB=l);q.bindBuffer(q.ARRAY_BUFFER,l);q.bufferData(q.ARRAY_BUFFER,c.vb,q.STREAM_DRAW)}else q.bindBuffer(q.ARRAY_BUFFER,c.vbbuffer);l=c.vbstride;for(h in b)if("index"!=h&&(g=b[h],e=c.attributes[h],0<=g&&e))if(void 0!==e.itemOffset){var m=
q.FLOAT;e.hasOwnProperty("bytesPerItem")&&1==e.bytesPerItem&&(m=q.UNSIGNED_BYTE);f(g);q.vertexAttribPointer(g,e.itemSize,m,e.normalize,4*l,4*(e.itemOffset+d*l))}else k=!0}else k=!0;if(k)for(h in b)"index"!=h&&(g=b[h],e=c.attributes[h],0<=g&&(e?void 0===e.itemOffset&&(c.streamingDraw?(l=fa[h],l||(l=q.createBuffer(),fa[h]=l),q.bindBuffer(q.ARRAY_BUFFER,l),q.bufferData(q.ARRAY_BUFFER,e.array,q.DYNAMIC_DRAW)):q.bindBuffer(q.ARRAY_BUFFER,e.buffer),m=q.FLOAT,e.hasOwnProperty("bytesPerItem")&&1==e.bytesPerItem&&
(m=q.UNSIGNED_BYTE),f(g),q.vertexAttribPointer(g,e.itemSize,m,e.normalize,0,d*e.itemSize*4)):a.defaultAttributeValues&&(2===a.defaultAttributeValues[h].length?q.vertexAttrib2fv(g,a.defaultAttributeValues[h]):3===a.defaultAttributeValues[h].length&&q.vertexAttrib3fv(g,a.defaultAttributeValues[h]))))}function f(a){ta[a]||(q.enableVertexAttribArray(a),ta[a]=!0)}function h(){for(var a=0,b=ta.length;a<b;a++)ta[a]&&(q.disableVertexAttribArray(a),ta[a]=!1)}function k(a,b){return a.z!==b.z?b.z-a.z:a.id-b.id}
function l(a,b,c){if(a.length)for(var d=0,e=a.length;d<e;d++)ea=ga=null,ia=ha=Ga=Ba=Da=ja=oa=-1,Z=!0,a[d].render(b,c,Ea,va),ea=ga=null,ia=ha=Ga=Ba=Da=ja=oa=-1,Z=!0}function m(a,b,c,d,e,f,g,h){var k,l,m,n;b?(l=a.length-1,n=b=-1):(l=0,b=a.length,n=1);for(var q=l;q!==b;q+=n)if(k=a[q],k.render){l=k.object;m=k.buffer;if(h)k=h;else{k=k[c];if(!k)continue;g&&Q.setBlending(k.blending,k.blendEquation,k.blendSrc,k.blendDst);Q.setDepthTest(k.depthTest);Q.setDepthWrite(k.depthWrite);x(k.polygonOffset,k.polygonOffsetFactor,
k.polygonOffsetUnits)}Q.setMaterialFaces(k);m instanceof THREE.BufferGeometry?Q.renderBufferDirect(d,e,f,k,m,l):Q.renderBuffer(d,e,f,k,m,l)}}function n(a,c){var d,e,f,g;if(void 0===a.__webglInit&&(a.__webglInit=!0,a._modelViewMatrix=new THREE.Matrix4,a._normalMatrix=new THREE.Matrix3,void 0!==a.geometry&&void 0===a.geometry.__webglInit&&(a.geometry.__webglInit=!0,a.geometry.addEventListener("dispose",fb)),e=a.geometry,void 0!==e))if(e instanceof THREE.BufferGeometry)if(e.streamingDraw)!e.streamingIndex&&
(e=e.attributes.index)&&(e.buffer=q.createBuffer(),q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,e.buffer),q.bufferData(q.ELEMENT_ARRAY_BUFFER,e.array,q.STATIC_DRAW));else{e.vb&&(e.vbbuffer=q.createBuffer(),q.bindBuffer(q.ARRAY_BUFFER,e.vbbuffer),q.bufferData(q.ARRAY_BUFFER,e.vb,q.STATIC_DRAW));var h,k;for(h in e.attributes)g=e.attributes[h],g.array&&(k="index"===h?q.ELEMENT_ARRAY_BUFFER:q.ARRAY_BUFFER,g.buffer=q.createBuffer(),q.bindBuffer(k,g.buffer),q.bufferData(k,g.array,q.STATIC_DRAW))}else if(a instanceof
THREE.Mesh){f=a.material;if(void 0===e.geometryGroups){k=e;var l,m,n;h={};var p=k.morphTargets.length,s=k.morphNormals.length,t=f instanceof THREE.MeshFaceMaterial;k.geometryGroups={};f=0;for(l=k.faces.length;f<l;f++)m=k.faces[f],m=t?m.materialIndex:0,void 0===h[m]&&(h[m]={hash:m,counter:0}),n=h[m].hash+"_"+h[m].counter,void 0===k.geometryGroups[n]&&(k.geometryGroups[n]={faces3:[],materialIndex:m,vertices:0,numMorphTargets:p,numMorphNormals:s}),65535<k.geometryGroups[n].vertices+3&&(h[m].counter+=
1,n=h[m].hash+"_"+h[m].counter,void 0===k.geometryGroups[n]&&(k.geometryGroups[n]={faces3:[],materialIndex:m,vertices:0,numMorphTargets:p,numMorphNormals:s})),k.geometryGroups[n].faces3.push(f),k.geometryGroups[n].vertices+=3;k.geometryGroupsList=[];for(g in k.geometryGroups)k.geometryGroups[g].id=Aa++,k.geometryGroupsList.push(k.geometryGroups[g])}for(d in e.geometryGroups)g=e.geometryGroups[d],g.__webglVertexBuffer||(k=g,k.__webglVertexBuffer=q.createBuffer(),k.__webglNormalBuffer=q.createBuffer(),
k.__webglTangentBuffer=q.createBuffer(),k.__webglColorBuffer=q.createBuffer(),k.__webglUVBuffer=q.createBuffer(),k.__webglUV2Buffer=q.createBuffer(),k.__webglSkinIndicesBuffer=q.createBuffer(),k.__webglSkinWeightsBuffer=q.createBuffer(),k.__webglFaceBuffer=q.createBuffer(),k.__webglLineBuffer=q.createBuffer(),Q.info.memory.geometries++,b(g,a),e.verticesNeedUpdate=!0,e.morphTargetsNeedUpdate=!0,e.elementsNeedUpdate=!0,e.uvsNeedUpdate=!0,e.normalsNeedUpdate=!0,e.tangentsNeedUpdate=!0,e.colorsNeedUpdate=
!0)}else if(a instanceof THREE.Line&&!e.__webglVertexBuffer){g=e;g.__webglVertexBuffer=q.createBuffer();g.__webglColorBuffer=q.createBuffer();g.__webglLineDistanceBuffer=q.createBuffer();Q.info.memory.geometries++;g=e;h=g.vertices.length;g.__vertexArray=new Float32Array(3*h);g.__colorArray=new Float32Array(3*h);g.__lineDistanceArray=new Float32Array(1*h);g.__webglLineCount=h;h=g.vertices.length;p=a.material;if(p.attributes)for(k in void 0===g.__webglCustomAttributesList&&(g.__webglCustomAttributesList=
[]),p.attributes){s=p.attributes[k];if(!s.__webglInitialized||s.createUniqueBuffers)s.__webglInitialized=!0,f=1,"v2"===s.type?f=2:"v3"===s.type?f=3:"v4"===s.type?f=4:"c"===s.type&&(f=3),s.size=f,s.array=new Float32Array(h*f),s.buffer=q.createBuffer(),s.buffer.belongsToAttribute=k,s.needsUpdate=!0;g.__webglCustomAttributesList.push(s)}e.verticesNeedUpdate=!0;e.colorsNeedUpdate=!0;e.lineDistancesNeedUpdate=!0}if(void 0===a.__webglActive){if(a instanceof THREE.Mesh)if(e=a.geometry,e instanceof THREE.BufferGeometry)r(c.__webglObjects,
e,a);else{if(e instanceof THREE.Geometry)for(d in e.geometryGroups)g=e.geometryGroups[d],r(c.__webglObjects,g,a)}else a instanceof THREE.Line&&(e=a.geometry,r(c.__webglObjects,e,a));a.__webglActive=!0}}function r(a,b,c){a.push({id:null,buffer:b,object:c,opaque:null,transparent:null,z:0})}function p(a){for(var b in a.attributes)if(a.attributes[b].needsUpdate)return!0;return!1}function t(a){for(var b in a.attributes)a.attributes[b].needsUpdate=!1}function s(a,b){if(a instanceof THREE.Mesh||a instanceof
THREE.Line)for(var c=b.__webglObjects,d=c.length-1;0<=d;d--)c[d].object===a&&c.splice(d,1);delete a.__webglActive}function u(a,b,c,d,e){Ca=0;d.needsUpdate&&(d.program&&gb(d),Q.initMaterial(d,b,c,e),d.needsUpdate=!1);var f=!1,g=d.program,h=g.uniforms,k=d.uniforms;g!==ga&&(q.useProgram(g),ga=g,f=!0);d.id!==ia&&(ia=d.id,f=!0);if(f||a!==ea)q.uniformMatrix4fv(h.projectionMatrix,!1,a.projectionMatrix.elements),a!==ea&&(ea=a);if(f){c&&d.fog&&(k.fogColor.value=c.color,c instanceof THREE.Fog?(k.fogNear.value=
c.near,k.fogFar.value=c.far):c instanceof THREE.FogExp2&&(k.fogDensity.value=c.density));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d.lights){if(Z){var l,m=0,n=0,p=0,r,s,t,u=Ua,x=u.directional.colors,y=u.directional.positions,C=u.point.colors,E=u.point.positions,F=u.point.distances,H=u.spot.colors,I=u.spot.positions,K=u.spot.distances,P=u.spot.directions,S=u.spot.anglesCos,T=u.spot.exponents,A=u.hemi.skyColors,N=u.hemi.groundColors,U=u.hemi.positions,R=0,V=0,
X=0,aa=0,fa=0,da=0,ha=0,ca=0,W=l=0;c=t=W=0;for(f=b.length;c<f;c++)if(l=b[c],!l.onlyShadow)if(r=l.color,s=l.intensity,t=l.distance,l instanceof THREE.AmbientLight)l.visible&&(Q.gammaInput?(m+=r.r*r.r,n+=r.g*r.g,p+=r.b*r.b):(m+=r.r,n+=r.g,p+=r.b));else if(l instanceof THREE.DirectionalLight){if(fa+=1,l.visible&&(ba.setFromMatrixPosition(l.matrixWorld),la.setFromMatrixPosition(l.target.matrixWorld),ba.sub(la),ba.normalize(),0!==ba.x||0!==ba.y||0!==ba.z))l=3*R,y[l]=ba.x,y[l+1]=ba.y,y[l+2]=ba.z,Q.gammaInput?
w(x,l,r,s*s):z(x,l,r,s),R+=1}else l instanceof THREE.PointLight?(da+=1,l.visible&&(W=3*V,Q.gammaInput?w(C,W,r,s*s):z(C,W,r,s),la.setFromMatrixPosition(l.matrixWorld),E[W]=la.x,E[W+1]=la.y,E[W+2]=la.z,F[V]=t,V+=1)):l instanceof THREE.SpotLight?(ha+=1,l.visible&&(W=3*X,Q.gammaInput?w(H,W,r,s*s):z(H,W,r,s),la.setFromMatrixPosition(l.matrixWorld),I[W]=la.x,I[W+1]=la.y,I[W+2]=la.z,K[X]=t,ba.copy(la),la.setFromMatrixPosition(l.target.matrixWorld),ba.sub(la),ba.normalize(),P[W]=ba.x,P[W+1]=ba.y,P[W+2]=ba.z,
S[X]=Math.cos(l.angle),T[X]=l.exponent,X+=1)):l instanceof THREE.HemisphereLight&&(ca+=1,l.visible&&(ba.setFromMatrixPosition(l.matrixWorld),ba.normalize(),0!==ba.x||0!==ba.y||0!==ba.z))&&(t=3*aa,U[t]=ba.x,U[t+1]=ba.y,U[t+2]=ba.z,r=l.color,l=l.groundColor,Q.gammaInput?(s*=s,w(A,t,r,s),w(N,t,l,s)):(z(A,t,r,s),z(N,t,l,s)),aa+=1);c=3*R;for(f=Math.max(x.length,3*fa);c<f;c++)x[c]=0;c=3*V;for(f=Math.max(C.length,3*da);c<f;c++)C[c]=0;c=3*X;for(f=Math.max(H.length,3*ha);c<f;c++)H[c]=0;c=3*aa;for(f=Math.max(A.length,
3*ca);c<f;c++)A[c]=0;c=3*aa;for(f=Math.max(N.length,3*ca);c<f;c++)N[c]=0;u.directional.length=R;u.point.length=V;u.spot.length=X;u.hemi.length=aa;u.ambient[0]=m;u.ambient[1]=n;u.ambient[2]=p;Z=!1}c=Ua;k.ambientLightColor.value=c.ambient;k.directionalLightColor.value=c.directional.colors;k.directionalLightDirection.value=c.directional.positions;k.pointLightColor.value=c.point.colors;k.pointLightPosition.value=c.point.positions;k.pointLightDistance.value=c.point.distances;k.spotLightColor.value=c.spot.colors;
k.spotLightPosition.value=c.spot.positions;k.spotLightDistance.value=c.spot.distances;k.spotLightDirection.value=c.spot.directions;k.spotLightAngleCos.value=c.spot.anglesCos;k.spotLightExponent.value=c.spot.exponents;k.hemisphereLightSkyColor.value=c.hemi.skyColors;k.hemisphereLightGroundColor.value=c.hemi.groundColors;k.hemisphereLightDirection.value=c.hemi.positions}if(d instanceof THREE.MeshBasicMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial){k.opacity.value=
d.opacity;Q.gammaInput?k.diffuse.value.copyGammaToLinear(d.color):k.diffuse.value.copy(d.color);k.map.value=d.map;k.lightMap.value=d.lightMap;k.specularMap.value=d.specularMap;d.bumpMap&&(k.bumpMap.value=d.bumpMap,k.bumpScale.value=d.bumpScale);d.normalMap&&(k.normalMap.value=d.normalMap,k.normalScale.value.copy(d.normalScale));var J,Y;d.map?J=d.map:d.specularMap&&(J=d.specularMap);void 0!==J&&(c=J.offset,J=J.repeat,k.offsetRepeat.value.set(c.x,c.y,J.x,J.y));d.normalMap?Y=d.normalMap:d.bumpMap&&(Y=
d.bumpMap);void 0!==Y&&(c=Y.offset,J=Y.repeat,k.offsetRepeatBump.value.set(c.x,c.y,J.x,J.y));k.envMap.value=d.envMap;k.irradianceMap&&(k.irradianceMap.value=d.irradianceMap);k.reflectivity.value=Q.gammaInput?d.reflectivity*d.reflectivity:d.reflectivity;k.refractionRatio.value=d.refractionRatio;k.combine.value=d.combine;k.useRefract.value=d.envMap&&d.envMap.mapping instanceof THREE.CubeRefractionMapping}d instanceof THREE.LineBasicMaterial?(k.diffuse.value=d.color,k.opacity.value=d.opacity):d instanceof
THREE.LineDashedMaterial?(k.diffuse.value=d.color,k.opacity.value=d.opacity,k.dashSize.value=d.dashSize,k.totalSize.value=d.dashSize+d.gapSize,k.scale.value=d.scale):d instanceof THREE.MeshPhongMaterial?(k.shininess.value=d.shininess,Q.gammaInput?(k.ambient.value.copyGammaToLinear(d.ambient),k.emissive.value.copyGammaToLinear(d.emissive),k.specular.value.copyGammaToLinear(d.specular)):(k.ambient.value.copy(d.ambient),k.emissive.value.copy(d.emissive),k.specular.value.copy(d.specular)),d.wrapAround&&
k.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshLambertMaterial?(Q.gammaInput?(k.ambient.value.copyGammaToLinear(d.ambient),k.emissive.value.copyGammaToLinear(d.emissive)):(k.ambient.value.copy(d.ambient),k.emissive.value.copy(d.emissive)),d.wrapAround&&k.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshDepthMaterial?(k.mNear.value=a.near,k.mFar.value=a.far,k.opacity.value=d.opacity):d instanceof THREE.MeshNormalMaterial&&(k.opacity.value=d.opacity);if(e.receiveShadow&&!d._shadowPass&&
k.shadowMatrix)for(J=Y=0,c=b.length;J<c;J++)f=b[J],f.castShadow&&(f instanceof THREE.SpotLight||f instanceof THREE.DirectionalLight&&!f.shadowCascade)&&(k.shadowMap.value[Y]=f.shadowMap,k.shadowMapSize.value[Y]=f.shadowMapSize,k.shadowMatrix.value[Y]=f.shadowMatrix,k.shadowDarkness.value[Y]=f.shadowDarkness,k.shadowBias.value[Y]=f.shadowBias,Y++);b=d.uniformsList;k=0;for(Y=b.length;k<Y;k++)if(c=g.uniforms[b[k][1]])if(J=b[k][0],f=J.type,n=J.value,"i"===f)q.uniform1i(c,n);else if("f"===f)q.uniform1f(c,
n);else if("v2"===f)q.uniform2f(c,n.x,n.y);else if("v3"===f)q.uniform3f(c,n.x,n.y,n.z);else if("v4"===f)q.uniform4f(c,n.x,n.y,n.z,n.w);else if("c"===f)q.uniform3f(c,n.r,n.g,n.b);else if("iv1"===f)q.uniform1iv(c,n);else if("iv"===f)q.uniform3iv(c,n);else if("fv1"===f)q.uniform1fv(c,n);else if("fv"===f)q.uniform3fv(c,n);else if("v2v"===f){void 0===J._array&&(J._array=new Float32Array(2*n.length));f=0;for(m=n.length;f<m;f++)p=2*f,J._array[p]=n[f].x,J._array[p+1]=n[f].y;q.uniform2fv(c,J._array)}else if("v3v"===
f){void 0===J._array&&(J._array=new Float32Array(3*n.length));f=0;for(m=n.length;f<m;f++)p=3*f,J._array[p]=n[f].x,J._array[p+1]=n[f].y,J._array[p+2]=n[f].z;q.uniform3fv(c,J._array)}else if("v4v"===f){void 0===J._array&&(J._array=new Float32Array(4*n.length));f=0;for(m=n.length;f<m;f++)p=4*f,J._array[p]=n[f].x,J._array[p+1]=n[f].y,J._array[p+2]=n[f].z,J._array[p+3]=n[f].w;q.uniform4fv(c,J._array)}else if("m4"===f)void 0===J._array&&(J._array=new Float32Array(16)),n.flattenToArray(J._array),q.uniformMatrix4fv(c,
!1,J._array);else if("m4v"===f){void 0===J._array&&(J._array=new Float32Array(16*n.length));f=0;for(m=n.length;f<m;f++)n[f].flattenToArrayOffset(J._array,16*f);q.uniformMatrix4fv(c,!1,J._array)}else if("t"===f){if(p=n,n=v(),q.uniform1i(c,n),p)if(p.image instanceof Array&&6===p.image.length){if(J=p,c=n,6===J.image.length)if(J.needsUpdate){J.image.__webglTextureCube||(J.addEventListener("dispose",$a),J.image.__webglTextureCube=q.createTexture(),Q.info.memory.textures++);q.activeTexture(q.TEXTURE0+c);
q.bindTexture(q.TEXTURE_CUBE_MAP,J.image.__webglTextureCube);q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,J.flipY);c=J instanceof THREE.CompressedTexture;f=[];for(m=0;6>m;m++)Q.autoScaleCubemaps&&!c?(n=f,p=m,u=J.image[m],y=ub,u.width<=y&&u.height<=y||(C=Math.max(u.width,u.height),x=Math.floor(u.width*y/C),y=Math.floor(u.height*y/C),C=document.createElement("canvas"),C.width=x,C.height=y,C.getContext("2d").drawImage(u,0,0,u.width,u.height,0,0,x,y),u=C),n[p]=u):f[m]=J.image[m];m=f[0];n=B(m.width)&&B(m.height);
p=O(J.format);u=O(J.type);D(q.TEXTURE_CUBE_MAP,J,n&&u!=q.FLOAT);for(m=0;6>m;m++)if(c)for(y=f[m].mipmaps,C=0,E=y.length;C<E;C++)x=y[C],J.format!==THREE.RGBAFormat?q.compressedTexImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_X+m,C,p,x.width,x.height,0,x.data):q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_X+m,C,p,x.width,x.height,0,p,u,x.data);else f[m].data?q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,p,f[m].width,f[m].height,0,p,u,f[m].data):q.texImage2D(q.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,p,p,u,f[m]);J.generateMipmaps&&
n&&q.generateMipmap(q.TEXTURE_CUBE_MAP);J.needsUpdate=!1;if(J.onUpdate)J.onUpdate()}else q.activeTexture(q.TEXTURE0+c),q.bindTexture(q.TEXTURE_CUBE_MAP,J.image.__webglTextureCube)}else Q.setTexture(p,n)}else if("tv"===f){void 0===J._array&&(J._array=[]);f=0;for(m=J.value.length;f<m;f++)J._array[f]=v();q.uniform1iv(c,J._array);f=0;for(m=J.value.length;f<m;f++)p=J.value[f],n=J._array[f],p&&Q.setTexture(p,n)}else console.warn("THREE.WebGLRenderer: Unknown uniform type: "+f);(d instanceof THREE.ShaderMaterial||
d instanceof THREE.MeshPhongMaterial||d.envMap)&&null!==h.cameraPosition&&(la.setFromMatrixPosition(a.matrixWorld),q.uniform3f(h.cameraPosition,la.x,la.y,la.z));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.ShaderMaterial||d.skinning)null!==h.viewMatrix&&q.uniformMatrix4fv(h.viewMatrix,!1,a.matrixWorldInverse.elements),null!==h.viewMatrixInverse&&q.uniformMatrix4fv(h.viewMatrixInverse,!1,a.matrixWorld.elements)}q.uniformMatrix4fv(h.modelViewMatrix,
!1,e._modelViewMatrix.elements);h.normalMatrix&&q.uniformMatrix3fv(h.normalMatrix,!1,e._normalMatrix.elements);null!==h.modelMatrix&&q.uniformMatrix4fv(h.modelMatrix,!1,e.matrixWorld.elements);return g}function v(){var a=Ca;a>=cb&&console.warn("WebGLRenderer: trying to use "+a+" texture units while this GPU supports only "+cb);Ca+=1;return a}function w(a,b,c,d){a[b]=c.r*c.r*d;a[b+1]=c.g*c.g*d;a[b+2]=c.b*c.b*d}function z(a,b,c,d){a[b]=c.r*d;a[b+1]=c.g*d;a[b+2]=c.b*d}function x(a,b,c){Ia!==a&&(a?q.enable(q.POLYGON_OFFSET_FILL):
q.disable(q.POLYGON_OFFSET_FILL),Ia=a);!a||Ra===b&&Sa===c||(q.polygonOffset(b,c),Ra=b,Sa=c)}function y(a){a=a.split("\n");for(var b=0,c=a.length;b<c;b++)a[b]=b+1+": "+a[b];return a.join("\n")}function C(a,b){var c;"fragment"===a?c=q.createShader(q.FRAGMENT_SHADER):"vertex"===a&&(c=q.createShader(q.VERTEX_SHADER));q.shaderSource(c,b);q.compileShader(c);return q.getShaderParameter(c,q.COMPILE_STATUS)?c:(console.error(q.getShaderInfoLog(c)),console.error(y(b)),null)}function B(a){return 0===(a&a-1)}
function D(a,b,c){c?(q.texParameteri(a,q.TEXTURE_WRAP_S,O(b.wrapS)),q.texParameteri(a,q.TEXTURE_WRAP_T,O(b.wrapT)),q.texParameteri(a,q.TEXTURE_MAG_FILTER,O(b.magFilter)),q.texParameteri(a,q.TEXTURE_MIN_FILTER,O(b.minFilter))):(q.texParameteri(a,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(a,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.texParameteri(a,q.TEXTURE_MAG_FILTER,F(b.magFilter)),q.texParameteri(a,q.TEXTURE_MIN_FILTER,F(b.minFilter)));wa&&b.type!==THREE.FloatType&&(1<b.anisotropy||b.__oldAnisotropy)&&
(q.texParameterf(a,wa.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,db)),b.__oldAnisotropy=b.anisotropy)}function F(a){return a===THREE.NearestFilter||a===THREE.NearestMipMapNearestFilter||a===THREE.NearestMipMapLinearFilter?q.NEAREST:q.LINEAR}function O(a){if(a===THREE.RepeatWrapping)return q.REPEAT;if(a===THREE.ClampToEdgeWrapping)return q.CLAMP_TO_EDGE;if(a===THREE.MirroredRepeatWrapping)return q.MIRRORED_REPEAT;if(a===THREE.NearestFilter)return q.NEAREST;if(a===THREE.NearestMipMapNearestFilter)return q.NEAREST_MIPMAP_NEAREST;
if(a===THREE.NearestMipMapLinearFilter)return q.NEAREST_MIPMAP_LINEAR;if(a===THREE.LinearFilter)return q.LINEAR;if(a===THREE.LinearMipMapNearestFilter)return q.LINEAR_MIPMAP_NEAREST;if(a===THREE.LinearMipMapLinearFilter)return q.LINEAR_MIPMAP_LINEAR;if(a===THREE.UnsignedByteType)return q.UNSIGNED_BYTE;if(a===THREE.UnsignedShort4444Type)return q.UNSIGNED_SHORT_4_4_4_4;if(a===THREE.UnsignedShort5551Type)return q.UNSIGNED_SHORT_5_5_5_1;if(a===THREE.UnsignedShort565Type)return q.UNSIGNED_SHORT_5_6_5;
if(a===THREE.ByteType)return q.BYTE;if(a===THREE.ShortType)return q.SHORT;if(a===THREE.UnsignedShortType)return q.UNSIGNED_SHORT;if(a===THREE.IntType)return q.INT;if(a===THREE.UnsignedIntType)return q.UNSIGNED_INT;if(a===THREE.FloatType)return q.FLOAT;if(a===THREE.HalfFloatType)return 36193;if(a===THREE.AlphaFormat)return q.ALPHA;if(a===THREE.RGBFormat)return q.RGB;if(a===THREE.RGBAFormat)return q.RGBA;if(a===THREE.LuminanceFormat)return q.LUMINANCE;if(a===THREE.LuminanceAlphaFormat)return q.LUMINANCE_ALPHA;
if(a===THREE.AddEquation)return q.FUNC_ADD;if(a===THREE.SubtractEquation)return q.FUNC_SUBTRACT;if(a===THREE.ReverseSubtractEquation)return q.FUNC_REVERSE_SUBTRACT;if(a===THREE.ZeroFactor)return q.ZERO;if(a===THREE.OneFactor)return q.ONE;if(a===THREE.SrcColorFactor)return q.SRC_COLOR;if(a===THREE.OneMinusSrcColorFactor)return q.ONE_MINUS_SRC_COLOR;if(a===THREE.SrcAlphaFactor)return q.SRC_ALPHA;if(a===THREE.OneMinusSrcAlphaFactor)return q.ONE_MINUS_SRC_ALPHA;if(a===THREE.DstAlphaFactor)return q.DST_ALPHA;
if(a===THREE.OneMinusDstAlphaFactor)return q.ONE_MINUS_DST_ALPHA;if(a===THREE.DstColorFactor)return q.DST_COLOR;if(a===THREE.OneMinusDstColorFactor)return q.ONE_MINUS_DST_COLOR;if(a===THREE.SrcAlphaSaturateFactor)return q.SRC_ALPHA_SATURATE;if(void 0!==ma){if(a===THREE.RGB_S3TC_DXT1_Format)return ma.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT1_Format)return ma.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT3_Format)return ma.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===THREE.RGBA_S3TC_DXT5_Format)return ma.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}
console.log("THREE.WebGLRenderer",THREE.REVISION);a=a||{};var H=void 0!==a.canvas?a.canvas:document.createElement("canvas"),I=void 0!==a.precision?a.precision:"highp",E=void 0!==a.alpha?a.alpha:!1,P=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,T=void 0!==a.antialias?a.antialias:!1,S=void 0!==a.stencil?a.stencil:!0,U=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,N=new THREE.Color(0),aa=0;this.domElement=H;this.context=null;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:
void 0!==self.devicePixelRatio?self.devicePixelRatio:1;this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.shadowMapEnabled=this.gammaOutput=this.gammaInput=!1;this.shadowMapAutoUpdate=!0;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapCascade=this.shadowMapDebug=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.renderPluginsPre=[];this.renderPluginsPost=
[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var Q=this,R=[],X=0,ga=null,K=null,ia=-1,ha=null,ea=null,Aa=0,Ca=0,Ba=-1,Ga=-1,oa=-1,Ma=-1,da=-1,Ha=-1,ja=-1,Da=-1,Ia=null,Ra=null,Sa=null,sa=null,pa=0,Y=0,ya=H.width,xa=H.height,Ea=0,va=0,ta=[],fa={},V=new THREE.Frustum,za=new THREE.Matrix4;new THREE.Matrix4;var la=new THREE.Vector3,ba=new THREE.Vector3,Z=!0,Ua={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],
positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},q,Va,Wa,Ka,wa,ma,ua,A=!1;(function(){try{var a={alpha:E,premultipliedAlpha:P,antialias:T,stencil:S,preserveDrawingBuffer:U};q=H.getContext("webgl",a)||H.getContext("experimental-webgl",a);if(null===q)throw"Error creating WebGL context.";}catch(b){console.error(b)}Va=q.getExtension("OES_texture_float");Wa=q.getExtension("OES_texture_half_float");
q.getExtension("OES_texture_float_linear");Ka=q.getExtension("OES_standard_derivatives");ua=q.getExtension("WEBGL_draw_buffers");q.getExtension("OES_element_index_uint");A=!!ua;wa=q.getExtension("EXT_texture_filter_anisotropic")||q.getExtension("MOZ_EXT_texture_filter_anisotropic")||q.getExtension("WEBKIT_EXT_texture_filter_anisotropic");ma=q.getExtension("WEBGL_compressed_texture_s3tc")||q.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||q.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");Va||
console.log("THREE.WebGLRenderer: Float textures not supported.");Wa||console.log("THREE.WebGLRenderer: Half float textures not supported.");Ka||console.log("THREE.WebGLRenderer: Standard derivatives not supported.");wa||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");ma||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");ua||console.log("THREE.WebGLRenderer: Multiple render targets not supported.");void 0===q.getShaderPrecisionFormat&&(q.getShaderPrecisionFormat=
function(){return{rangeMin:1,rangeMax:1,precision:1}})})();q.clearColor(0,0,0,1);q.clearDepth(1);q.clearStencil(0);q.enable(q.DEPTH_TEST);q.depthFunc(q.LEQUAL);q.frontFace(q.CCW);q.cullFace(q.BACK);q.enable(q.CULL_FACE);q.enable(q.BLEND);q.blendEquation(q.FUNC_ADD);q.blendFunc(q.SRC_ALPHA,q.ONE_MINUS_SRC_ALPHA);q.viewport(pa,Y,ya,xa);q.clearColor(N.r,N.g,N.b,aa);this.context=q;var cb=q.getParameter(q.MAX_TEXTURE_IMAGE_UNITS);a=q.getParameter(q.MAX_VERTEX_TEXTURE_IMAGE_UNITS);q.getParameter(q.MAX_TEXTURE_SIZE);
var ub=q.getParameter(q.MAX_CUBE_MAP_TEXTURE_SIZE),db=wa?q.getParameter(wa.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,eb=0<a;ma&&q.getParameter(q.COMPRESSED_TEXTURE_FORMATS);var Ya=q.getShaderPrecisionFormat(q.VERTEX_SHADER,q.HIGH_FLOAT);a=q.getShaderPrecisionFormat(q.VERTEX_SHADER,q.MEDIUM_FLOAT);q.getShaderPrecisionFormat(q.VERTEX_SHADER,q.LOW_FLOAT);var vb=q.getShaderPrecisionFormat(q.FRAGMENT_SHADER,q.HIGH_FLOAT),Cb=q.getShaderPrecisionFormat(q.FRAGMENT_SHADER,q.MEDIUM_FLOAT);q.getShaderPrecisionFormat(q.FRAGMENT_SHADER,
q.LOW_FLOAT);q.getShaderPrecisionFormat(q.VERTEX_SHADER,q.HIGH_INT);q.getShaderPrecisionFormat(q.VERTEX_SHADER,q.MEDIUM_INT);q.getShaderPrecisionFormat(q.VERTEX_SHADER,q.LOW_INT);q.getShaderPrecisionFormat(q.FRAGMENT_SHADER,q.HIGH_INT);q.getShaderPrecisionFormat(q.FRAGMENT_SHADER,q.MEDIUM_INT);q.getShaderPrecisionFormat(q.FRAGMENT_SHADER,q.LOW_INT);Ya=0<Ya.precision&&0<vb.precision;a=0<a.precision&&0<Cb.precision;"highp"!==I||Ya||(a?(I="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):
(I="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));"mediump"!==I||a||(I="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return q};this.supportsVertexTextures=function(){return eb};this.supportsFloatTextures=function(){return Va};this.supportsStandardDerivatives=function(){return Ka};this.supportsCompressedTextureS3TC=function(){return ma};this.supportsMRT=function(){return A};this.getMaxAnisotropy=function(){return db};
this.getPrecision=function(){return I};this.setSize=function(a,b,c){H.width=a*this.devicePixelRatio;H.height=b*this.devicePixelRatio;1!==this.devicePixelRatio&&!1!==c&&(H.style.width=a+"px",H.style.height=b+"px");this.setViewport(0,0,a,b)};this.setViewport=function(a,b,c,d){pa=a*this.devicePixelRatio;Y=b*this.devicePixelRatio;ya=c*this.devicePixelRatio;xa=d*this.devicePixelRatio;q.viewport(pa,Y,ya,xa)};this.setScissor=function(a,b,c,d){q.scissor(a,b,c,d)};this.enableScissorTest=function(a){a?q.enable(q.SCISSOR_TEST):
q.disable(q.SCISSOR_TEST)};this.setClearColor=function(a,b){N.set(a);aa=void 0!==b?b:1;q.clearColor(N.r,N.g,N.b,aa)};this.setClearColorHex=function(a,b){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(a,b)};this.getClearColor=function(){return N};this.getClearAlpha=function(){return aa};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=q.COLOR_BUFFER_BIT;if(void 0===b||b)d|=q.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=q.STENCIL_BUFFER_BIT;
q.clear(d)};this.clearColor=function(){q.clear(q.COLOR_BUFFER_BIT)};this.clearDepth=function(){q.clear(q.DEPTH_BUFFER_BIT)};this.clearStencil=function(){q.clear(q.STENCIL_BUFFER_BIT)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.addPostPlugin=function(a){a.init(this);this.renderPluginsPost.push(a)};this.addPrePlugin=function(a){a.init(this);this.renderPluginsPre.push(a)};this.updateShadowMap=function(a,b){ga=null;ia=ha=Da=ja=oa=-1;Z=!0;Ga=Ba=-1;this.shadowMapPlugin.update(a,
b)};var fb=function(a){a=a.target;a.removeEventListener("dispose",fb);a.__webglInit=void 0;if(a instanceof THREE.BufferGeometry){void 0!==a.vbbuffer&&q.deleteBuffer(a.vbbuffer);var b=a.attributes,c;for(c in b)void 0!==b[c].buffer&&q.deleteBuffer(b[c].buffer);Q.info.memory.geometries--}else if(void 0!==a.geometryGroups)for(b in a.geometryGroups)mb(a.geometryGroups[b]);else mb(a)},$a=function(a){a=a.target;a.removeEventListener("dispose",$a);a.image&&a.image.__webglTextureCube?q.deleteTexture(a.image.__webglTextureCube):
a.__webglInit&&(a.__webglInit=!1,q.deleteTexture(a.__webglTexture));Q.info.memory.textures--},kb=function(a){a=a.target;a.removeEventListener("dispose",kb);a&&a.__webglTexture&&(q.deleteTexture(a.__webglTexture),q.deleteFramebuffer(a.__webglFramebuffer),q.deleteRenderbuffer(a.__webglRenderbuffer));Q.info.memory.textures--},lb=function(a){a=a.target;a.removeEventListener("dispose",lb);gb(a)},mb=function(a){void 0!==a.__webglVertexBuffer&&q.deleteBuffer(a.__webglVertexBuffer);void 0!==a.__webglNormalBuffer&&
q.deleteBuffer(a.__webglNormalBuffer);void 0!==a.__webglTangentBuffer&&q.deleteBuffer(a.__webglTangentBuffer);void 0!==a.__webglColorBuffer&&q.deleteBuffer(a.__webglColorBuffer);void 0!==a.__webglUVBuffer&&q.deleteBuffer(a.__webglUVBuffer);void 0!==a.__webglUV2Buffer&&q.deleteBuffer(a.__webglUV2Buffer);void 0!==a.__webglSkinIndicesBuffer&&q.deleteBuffer(a.__webglSkinIndicesBuffer);void 0!==a.__webglSkinWeightsBuffer&&q.deleteBuffer(a.__webglSkinWeightsBuffer);void 0!==a.__webglFaceBuffer&&q.deleteBuffer(a.__webglFaceBuffer);
void 0!==a.__webglLineBuffer&&q.deleteBuffer(a.__webglLineBuffer);void 0!==a.__webglLineDistanceBuffer&&q.deleteBuffer(a.__webglLineDistanceBuffer);if(void 0!==a.__webglCustomAttributesList)for(var b in a.__webglCustomAttributesList)q.deleteBuffer(a.__webglCustomAttributesList[b].buffer);Q.info.memory.geometries--},gb=function(a){var b=a.program;if(void 0!==b){a.program=void 0;var c,d,e=!1;a=0;for(c=R.length;a<c;a++)if(d=R[a],d.program===b){d.usedTimes--;0===d.usedTimes&&(e=!0);break}if(!0===e){e=
[];a=0;for(c=R.length;a<c;a++)d=R[a],d.program!==b&&e.push(d);R=e;q.deleteProgram(b);Q.info.memory.programs--}}};this.renderBufferDirect=function(a,b,c,d,e,f){if(!1!==d.visible){var k=u(a,b,c,d,f);a=k.attributes;c=e.attributes;b=!1;k=16777215*e.id+2*k.id+(d.wireframe?1:0);k!==ha&&(ha=k,b=!0);b&&h();if(f instanceof THREE.Mesh)if(f=c.index){(c=e.offsets)&&1<c.length&&(b=!0);k=0;do{var l,m,n;c?(l=c[k].index,m=c[k].start,n=c[k].count):(m=l=0,n=f.array.length);b&&(g(d,a,e,l),!f.buffer&&e.streamingDraw?
(l=fa.index,l||(l=q.createBuffer(),fa.index=l),q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,null),q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,l),q.bufferData(q.ELEMENT_ARRAY_BUFFER,f.array,q.DYNAMIC_DRAW)):q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,f.buffer));q.drawElements(e.isLines?q.LINES:q.TRIANGLES,n,q.UNSIGNED_SHORT,2*m)}while(c&&++k<c.length)}else b&&g(d,a,e,l),q.drawArrays(e.isLines?q.LINE_STRIP:q.TRIANGLES,0,e.attributes.position.array.length/3);else console.log("Only THREE.Mesh can be rendered by the Firefly renderer. Use THREE.Mesh to draw lines.")}};
this.renderBuffer=function(a,b,c,d,e,g){if(!1!==d.visible){var k,l;c=u(a,b,c,d,g);b=c.attributes;a=!1;c=16777215*e.id+2*c.id+(d.wireframe?1:0);c!==ha&&(ha=c,a=!0);a&&h();!d.morphTargets&&0<=b.position&&a&&(q.bindBuffer(q.ARRAY_BUFFER,e.__webglVertexBuffer),f(b.position),q.vertexAttribPointer(b.position,3,q.FLOAT,!1,0,0));if(a){if(e.__webglCustomAttributesList)for(k=0,l=e.__webglCustomAttributesList.length;k<l;k++)c=e.__webglCustomAttributesList[k],0<=b[c.buffer.belongsToAttribute]&&(q.bindBuffer(q.ARRAY_BUFFER,
c.buffer),f(b[c.buffer.belongsToAttribute]),q.vertexAttribPointer(b[c.buffer.belongsToAttribute],c.size,q.FLOAT,!1,0,0));0<=b.color&&(0<g.geometry.colors.length||0<g.geometry.faces.length?(q.bindBuffer(q.ARRAY_BUFFER,e.__webglColorBuffer),f(b.color),q.vertexAttribPointer(b.color,3,q.FLOAT,!1,0,0)):d.defaultAttributeValues&&q.vertexAttrib3fv(b.color,d.defaultAttributeValues.color));0<=b.normal&&(q.bindBuffer(q.ARRAY_BUFFER,e.__webglNormalBuffer),f(b.normal),q.vertexAttribPointer(b.normal,3,q.FLOAT,
!1,0,0));0<=b.tangent&&(q.bindBuffer(q.ARRAY_BUFFER,e.__webglTangentBuffer),f(b.tangent),q.vertexAttribPointer(b.tangent,4,q.FLOAT,!1,0,0));0<=b.uv&&(g.geometry.faceVertexUvs[0]?(q.bindBuffer(q.ARRAY_BUFFER,e.__webglUVBuffer),f(b.uv),q.vertexAttribPointer(b.uv,2,q.FLOAT,!1,0,0)):d.defaultAttributeValues&&q.vertexAttrib2fv(b.uv,d.defaultAttributeValues.uv));0<=b.uv2&&(g.geometry.faceVertexUvs[1]?(q.bindBuffer(q.ARRAY_BUFFER,e.__webglUV2Buffer),f(b.uv2),q.vertexAttribPointer(b.uv2,2,q.FLOAT,!1,0,0)):
d.defaultAttributeValues&&q.vertexAttrib2fv(b.uv2,d.defaultAttributeValues.uv2));0<=b.lineDistance&&(q.bindBuffer(q.ARRAY_BUFFER,e.__webglLineDistanceBuffer),f(b.lineDistance),q.vertexAttribPointer(b.lineDistance,1,q.FLOAT,!1,0,0))}g instanceof THREE.Mesh?d.wireframe?(d=d.wireframeLinewidth,d!==sa&&(q.lineWidth(d),sa=d),a&&q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),q.drawElements(q.LINES,e.__webglLineCount,q.UNSIGNED_SHORT,0)):(a&&q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),
q.drawElements(q.TRIANGLES,e.__webglFaceCount,q.UNSIGNED_SHORT,0)):g instanceof THREE.Line&&(g=g.type===THREE.LineStrip?q.LINE_STRIP:q.LINES,d=d.linewidth,d!==sa&&(q.lineWidth(d),sa=d),q.drawArrays(g,0,e.__webglLineCount))}};this.render=function(a,b,c,d){if(!1===b instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var e,f,g,h,n=a.__lights,p=a.fog;ia=-1;Z=!0;!0===a.autoUpdate&&a.updateMatrixWorld();void 0===b.parent&&b.updateMatrixWorld();
b.matrixWorldInverse.getInverse(b.matrixWorld);za.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);V.setFromMatrix(za);this.autoUpdateObjects&&this.initWebGLObjects(a);l(this.renderPluginsPre,a,b);this.setRenderTarget(c);(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);h=a.__webglObjects;d=0;for(e=h.length;d<e;d++)if(f=h[d],g=f.object,f.id=d,f.render=!1,g.visible&&(!(g instanceof THREE.Mesh&&g.frustumCulled)||V.intersectsObject(g))){var r=g;r._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,
r.matrixWorld);r._normalMatrix.getNormalMatrix(r._modelViewMatrix);var r=f,s=r.object,t=r.buffer,u=s.geometry,s=s.material;s instanceof THREE.MeshFaceMaterial?(s=s.materials[u instanceof THREE.BufferGeometry?0:t.materialIndex],s.transparent?(r.transparent=s,r.opaque=null):(r.opaque=s,r.transparent=null)):s&&(s.transparent?(r.transparent=s,r.opaque=null):(r.opaque=s,r.transparent=null));f.render=!0;!0===this.sortObjects&&(null!==g.renderDepth?f.z=g.renderDepth:(la.setFromMatrixPosition(g.matrixWorld),
la.applyProjection(za),f.z=la.z))}this.sortObjects&&h.sort(k);a.overrideMaterial?(d=a.overrideMaterial,this.setBlending(d.blending,d.blendEquation,d.blendSrc,d.blendDst),this.setDepthTest(d.depthTest),this.setDepthWrite(d.depthWrite),x(d.polygonOffset,d.polygonOffsetFactor,d.polygonOffsetUnits),m(a.__webglObjects,!1,"",b,n,p,!0,d)):(d=null,this.setBlending(THREE.NoBlending),m(a.__webglObjects,!0,"opaque",b,n,p,!1,d),m(a.__webglObjects,!1,"transparent",b,n,p,!0,d));l(this.renderPluginsPost,a,b);c&&
c.generateMipmaps&&c.minFilter!==THREE.NearestFilter&&c.minFilter!==THREE.LinearFilter&&(q.bindTexture(q.TEXTURE_2D,c.__webglTexture),q.generateMipmap(q.TEXTURE_2D),q.bindTexture(q.TEXTURE_2D,null));this.setDepthTest(!0);this.setDepthWrite(!0)}};this.endFrame=function(){};this.initWebGLObjects=function(a){a.__webglObjects||(a.__webglObjects=[]);for(;a.__objectsAdded.length;)n(a.__objectsAdded[0],a),a.__objectsAdded.splice(0,1);for(;a.__objectsRemoved.length;)s(a.__objectsRemoved[0],a),a.__objectsRemoved.splice(0,
1);for(var f=0,g=a.__webglObjects.length;f<g;f++){var h=a.__webglObjects[f].object;void 0===h.__webglInit&&(void 0!==h.__webglActive&&s(h,a),n(h,a));var k=h,l=k.geometry,m=void 0,r=void 0,u=void 0;if(l instanceof THREE.BufferGeometry){var v=l,x=q.DYNAMIC_DRAW,y=l.freeCPUBuffers;if(!v.streamingDraw){var w=v.attributes,z=!1,C=void 0,B=void 0;for(C in w)B=w[C],B.needsUpdate&&("index"===C?(q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,B.buffer),q.bufferData(q.ELEMENT_ARRAY_BUFFER,B.array,x)):B.array?(q.bindBuffer(q.ARRAY_BUFFER,
B.buffer),q.bufferData(q.ARRAY_BUFFER,B.array,x)):z=!0,B.needsUpdate=!1),y&&B.freeCPUBuffers&&(B.array=null);z&&(q.bindBuffer(q.ARRAY_BUFFER,v.vbbuffer),q.bufferData(q.ARRAY_BUFFER,v.vb,x),y&&v.freeCPUBuffers&&(v.vb=null))}}else if(k instanceof THREE.Mesh){for(var D=0,E=l.geometryGroupsList.length;D<E;D++)if(m=l.geometryGroupsList[D],u=c(k,m),l.buffersNeedUpdate&&b(m,k),r=u.attributes&&p(u),l.verticesNeedUpdate||l.morphTargetsNeedUpdate||l.elementsNeedUpdate||l.uvsNeedUpdate||l.normalsNeedUpdate||
l.colorsNeedUpdate||l.tangentsNeedUpdate||r){var F=m,H=k,I=q.DYNAMIC_DRAW,O=l.freeCPUBuffers,K=u;if(F.__inittedArrays){var P=e(K),Q=K.vertexColors?K.vertexColors:!1,S=d(K),T=P===THREE.SmoothShading,A=void 0,N=void 0,U=void 0,R=void 0,V=void 0,X=void 0,Y=void 0,ba=void 0,aa=void 0,ea=void 0,fa=void 0,ca=void 0,W=void 0,J=void 0,da=void 0,ga=void 0,ha=void 0,ia=void 0,ja=void 0,la=void 0,Z=void 0,sa=void 0,ta=void 0,xa=void 0,Ca=void 0,oa=0,pa=0,Aa=0,Ba=0,Da=0,va=0,ma=0,ya=0,ua=0,M=0,La=void 0,wa=F.__vertexArray,
Ga=F.__uvArray,Ha=F.__uv2Array,Ea=F.__normalArray,Na=F.__tangentArray,za=F.__colorArray,Ma=F.__webglCustomAttributesList,G=void 0,Ka=F.__faceArray,Ia=F.__lineArray,Qa=H.geometry,Sa=Qa.elementsNeedUpdate,Ra=Qa.uvsNeedUpdate,Ua=Qa.normalsNeedUpdate,Va=Qa.tangentsNeedUpdate,Wa=Qa.colorsNeedUpdate,Ya=Qa.vertices,ka=F.faces3,Xa=Qa.faces,$a=Qa.faceVertexUvs[0],cb=Qa.faceVertexUvs[1];if(Qa.verticesNeedUpdate){A=0;for(N=ka.length;A<N;A++)R=Xa[ka[A]],ca=Ya[R.a],W=Ya[R.b],J=Ya[R.c],wa[pa]=ca.x,wa[pa+1]=ca.y,
wa[pa+2]=ca.z,wa[pa+3]=W.x,wa[pa+4]=W.y,wa[pa+5]=W.z,wa[pa+6]=J.x,wa[pa+7]=J.y,wa[pa+8]=J.z,pa+=9;q.bindBuffer(q.ARRAY_BUFFER,F.__webglVertexBuffer);q.bufferData(q.ARRAY_BUFFER,wa,I)}if(Wa&&Q){A=0;for(N=ka.length;A<N;A++)R=Xa[ka[A]],Y=R.vertexColors,ba=R.color,3===Y.length&&Q===THREE.VertexColors?(ia=Y[0],ja=Y[1],la=Y[2]):la=ja=ia=ba,za[ua]=ia.r,za[ua+1]=ia.g,za[ua+2]=ia.b,za[ua+3]=ja.r,za[ua+4]=ja.g,za[ua+5]=ja.b,za[ua+6]=la.r,za[ua+7]=la.g,za[ua+8]=la.b,ua+=9;0<ua&&(q.bindBuffer(q.ARRAY_BUFFER,
F.__webglColorBuffer),q.bufferData(q.ARRAY_BUFFER,za,I))}if(Va&&Qa.hasTangents){A=0;for(N=ka.length;A<N;A++)R=Xa[ka[A]],aa=R.vertexTangents,da=aa[0],ga=aa[1],ha=aa[2],Na[ma]=da.x,Na[ma+1]=da.y,Na[ma+2]=da.z,Na[ma+3]=da.w,Na[ma+4]=ga.x,Na[ma+5]=ga.y,Na[ma+6]=ga.z,Na[ma+7]=ga.w,Na[ma+8]=ha.x,Na[ma+9]=ha.y,Na[ma+10]=ha.z,Na[ma+11]=ha.w,ma+=12;q.bindBuffer(q.ARRAY_BUFFER,F.__webglTangentBuffer);q.bufferData(q.ARRAY_BUFFER,Na,I)}if(Ua&&P){A=0;for(N=ka.length;A<N;A++)if(R=Xa[ka[A]],V=R.vertexNormals,X=
R.normal,3===V.length&&T)for(Z=0;3>Z;Z++)ta=V[Z],Ea[va]=ta.x,Ea[va+1]=ta.y,Ea[va+2]=ta.z,va+=3;else for(Z=0;3>Z;Z++)Ea[va]=X.x,Ea[va+1]=X.y,Ea[va+2]=X.z,va+=3;q.bindBuffer(q.ARRAY_BUFFER,F.__webglNormalBuffer);q.bufferData(q.ARRAY_BUFFER,Ea,I)}if(Ra&&$a&&S){A=0;for(N=ka.length;A<N;A++)if(U=ka[A],ea=$a[U],void 0!==ea)for(Z=0;3>Z;Z++)xa=ea[Z],Ga[Aa]=xa.x,Ga[Aa+1]=xa.y,Aa+=2;0<Aa&&(q.bindBuffer(q.ARRAY_BUFFER,F.__webglUVBuffer),q.bufferData(q.ARRAY_BUFFER,Ga,I))}if(Ra&&cb&&S){A=0;for(N=ka.length;A<N;A++)if(U=
ka[A],fa=cb[U],void 0!==fa)for(Z=0;3>Z;Z++)Ca=fa[Z],Ha[Ba]=Ca.x,Ha[Ba+1]=Ca.y,Ba+=2;0<Ba&&(q.bindBuffer(q.ARRAY_BUFFER,F.__webglUV2Buffer),q.bufferData(q.ARRAY_BUFFER,Ha,I))}if(Sa){A=0;for(N=ka.length;A<N;A++)Ka[Da]=oa,Ka[Da+1]=oa+1,Ka[Da+2]=oa+2,Da+=3,Ia[ya]=oa,Ia[ya+1]=oa+1,Ia[ya+2]=oa,Ia[ya+3]=oa+2,Ia[ya+4]=oa+1,Ia[ya+5]=oa+2,ya+=6,oa+=3;q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,F.__webglFaceBuffer);q.bufferData(q.ELEMENT_ARRAY_BUFFER,Ka,I);q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,F.__webglLineBuffer);q.bufferData(q.ELEMENT_ARRAY_BUFFER,
Ia,I)}if(Ma)for(Z=0,sa=Ma.length;Z<sa;Z++)if(G=Ma[Z],G.__original.needsUpdate){M=0;if(1===G.size)if(void 0===G.boundTo||"vertices"===G.boundTo)for(A=0,N=ka.length;A<N;A++)R=Xa[ka[A]],G.array[M]=G.value[R.a],G.array[M+1]=G.value[R.b],G.array[M+2]=G.value[R.c],M+=3;else{if("faces"===G.boundTo)for(A=0,N=ka.length;A<N;A++)La=G.value[ka[A]],G.array[M]=La,G.array[M+1]=La,G.array[M+2]=La,M+=3}else if(2===G.size)if(void 0===G.boundTo||"vertices"===G.boundTo)for(A=0,N=ka.length;A<N;A++)R=Xa[ka[A]],ca=G.value[R.a],
W=G.value[R.b],J=G.value[R.c],G.array[M]=ca.x,G.array[M+1]=ca.y,G.array[M+2]=W.x,G.array[M+3]=W.y,G.array[M+4]=J.x,G.array[M+5]=J.y,M+=6;else{if("faces"===G.boundTo)for(A=0,N=ka.length;A<N;A++)J=W=ca=La=G.value[ka[A]],G.array[M]=ca.x,G.array[M+1]=ca.y,G.array[M+2]=W.x,G.array[M+3]=W.y,G.array[M+4]=J.x,G.array[M+5]=J.y,M+=6}else if(3===G.size){var ra;ra="c"===G.type?["r","g","b"]:["x","y","z"];if(void 0===G.boundTo||"vertices"===G.boundTo)for(A=0,N=ka.length;A<N;A++)R=Xa[ka[A]],ca=G.value[R.a],W=G.value[R.b],
J=G.value[R.c],G.array[M]=ca[ra[0]],G.array[M+1]=ca[ra[1]],G.array[M+2]=ca[ra[2]],G.array[M+3]=W[ra[0]],G.array[M+4]=W[ra[1]],G.array[M+5]=W[ra[2]],G.array[M+6]=J[ra[0]],G.array[M+7]=J[ra[1]],G.array[M+8]=J[ra[2]],M+=9;else if("faces"===G.boundTo)for(A=0,N=ka.length;A<N;A++)J=W=ca=La=G.value[ka[A]],G.array[M]=ca[ra[0]],G.array[M+1]=ca[ra[1]],G.array[M+2]=ca[ra[2]],G.array[M+3]=W[ra[0]],G.array[M+4]=W[ra[1]],G.array[M+5]=W[ra[2]],G.array[M+6]=J[ra[0]],G.array[M+7]=J[ra[1]],G.array[M+8]=J[ra[2]],M+=
9;else if("faceVertices"===G.boundTo)for(A=0,N=ka.length;A<N;A++)La=G.value[ka[A]],ca=La[0],W=La[1],J=La[2],G.array[M]=ca[ra[0]],G.array[M+1]=ca[ra[1]],G.array[M+2]=ca[ra[2]],G.array[M+3]=W[ra[0]],G.array[M+4]=W[ra[1]],G.array[M+5]=W[ra[2]],G.array[M+6]=J[ra[0]],G.array[M+7]=J[ra[1]],G.array[M+8]=J[ra[2]],M+=9}else if(4===G.size)if(void 0===G.boundTo||"vertices"===G.boundTo)for(A=0,N=ka.length;A<N;A++)R=Xa[ka[A]],ca=G.value[R.a],W=G.value[R.b],J=G.value[R.c],G.array[M]=ca.x,G.array[M+1]=ca.y,G.array[M+
2]=ca.z,G.array[M+3]=ca.w,G.array[M+4]=W.x,G.array[M+5]=W.y,G.array[M+6]=W.z,G.array[M+7]=W.w,G.array[M+8]=J.x,G.array[M+9]=J.y,G.array[M+10]=J.z,G.array[M+11]=J.w,M+=12;else if("faces"===G.boundTo)for(A=0,N=ka.length;A<N;A++)J=W=ca=La=G.value[ka[A]],G.array[M]=ca.x,G.array[M+1]=ca.y,G.array[M+2]=ca.z,G.array[M+3]=ca.w,G.array[M+4]=W.x,G.array[M+5]=W.y,G.array[M+6]=W.z,G.array[M+7]=W.w,G.array[M+8]=J.x,G.array[M+9]=J.y,G.array[M+10]=J.z,G.array[M+11]=J.w,M+=12;else if("faceVertices"===G.boundTo)for(A=
0,N=ka.length;A<N;A++)La=G.value[ka[A]],ca=La[0],W=La[1],J=La[2],G.array[M]=ca.x,G.array[M+1]=ca.y,G.array[M+2]=ca.z,G.array[M+3]=ca.w,G.array[M+4]=W.x,G.array[M+5]=W.y,G.array[M+6]=W.z,G.array[M+7]=W.w,G.array[M+8]=J.x,G.array[M+9]=J.y,G.array[M+10]=J.z,G.array[M+11]=J.w,M+=12;q.bindBuffer(q.ARRAY_BUFFER,G.buffer);q.bufferData(q.ARRAY_BUFFER,G.array,I)}O&&(delete F.__inittedArrays,delete F.__colorArray,delete F.__normalArray,delete F.__tangentArray,delete F.__uvArray,delete F.__uv2Array,delete F.__faceArray,
delete F.__vertexArray,delete F.__lineArray,delete F.__skinIndexArray,delete F.__skinWeightArray)}}l.verticesNeedUpdate=!1;l.morphTargetsNeedUpdate=!1;l.elementsNeedUpdate=!1;l.uvsNeedUpdate=!1;l.normalsNeedUpdate=!1;l.colorsNeedUpdate=!1;l.tangentsNeedUpdate=!1;l.buffersNeedUpdate=!1;u.attributes&&t(u)}else if(k instanceof THREE.Line){u=c(k,l);r=u.attributes&&p(u);if(l.verticesNeedUpdate||l.colorsNeedUpdate||l.lineDistancesNeedUpdate||r){var Oa=l,ob=q.DYNAMIC_DRAW,hb=void 0,ib=void 0,jb=void 0,pb=
void 0,qa=void 0,qb=void 0,db=Oa.vertices,eb=Oa.colors,fb=Oa.lineDistances,kb=db.length,lb=eb.length,mb=fb.length,rb=Oa.__vertexArray,sb=Oa.__colorArray,gb=Oa.__lineDistanceArray,ub=Oa.colorsNeedUpdate,vb=Oa.lineDistancesNeedUpdate,xb=Oa.__webglCustomAttributesList,tb=void 0,Bb=void 0,Fa=void 0,bb=void 0,Ja=void 0,na=void 0;if(Oa.verticesNeedUpdate){for(hb=0;hb<kb;hb++)pb=db[hb],qa=3*hb,rb[qa]=pb.x,rb[qa+1]=pb.y,rb[qa+2]=pb.z;q.bindBuffer(q.ARRAY_BUFFER,Oa.__webglVertexBuffer);q.bufferData(q.ARRAY_BUFFER,
rb,ob)}if(ub){for(ib=0;ib<lb;ib++)qb=eb[ib],qa=3*ib,sb[qa]=qb.r,sb[qa+1]=qb.g,sb[qa+2]=qb.b;q.bindBuffer(q.ARRAY_BUFFER,Oa.__webglColorBuffer);q.bufferData(q.ARRAY_BUFFER,sb,ob)}if(vb){for(jb=0;jb<mb;jb++)gb[jb]=fb[jb];q.bindBuffer(q.ARRAY_BUFFER,Oa.__webglLineDistanceBuffer);q.bufferData(q.ARRAY_BUFFER,gb,ob)}if(xb)for(tb=0,Bb=xb.length;tb<Bb;tb++)if(na=xb[tb],na.needsUpdate&&(void 0===na.boundTo||"vertices"===na.boundTo)){qa=0;bb=na.value.length;if(1===na.size)for(Fa=0;Fa<bb;Fa++)na.array[Fa]=na.value[Fa];
else if(2===na.size)for(Fa=0;Fa<bb;Fa++)Ja=na.value[Fa],na.array[qa]=Ja.x,na.array[qa+1]=Ja.y,qa+=2;else if(3===na.size)if("c"===na.type)for(Fa=0;Fa<bb;Fa++)Ja=na.value[Fa],na.array[qa]=Ja.r,na.array[qa+1]=Ja.g,na.array[qa+2]=Ja.b,qa+=3;else for(Fa=0;Fa<bb;Fa++)Ja=na.value[Fa],na.array[qa]=Ja.x,na.array[qa+1]=Ja.y,na.array[qa+2]=Ja.z,qa+=3;else if(4===na.size)for(Fa=0;Fa<bb;Fa++)Ja=na.value[Fa],na.array[qa]=Ja.x,na.array[qa+1]=Ja.y,na.array[qa+2]=Ja.z,na.array[qa+3]=Ja.w,qa+=4;q.bindBuffer(q.ARRAY_BUFFER,
na.buffer);q.bufferData(q.ARRAY_BUFFER,na.array,ob)}}l.verticesNeedUpdate=!1;l.colorsNeedUpdate=!1;l.lineDistancesNeedUpdate=!1;u.attributes&&t(u)}}};this.initMaterial=function(a,b,c,d){a.addEventListener("dispose",lb);var e,f;a instanceof THREE.MeshDepthMaterial?f="depth":a instanceof THREE.MeshNormalMaterial?console.log("MeshNormalMaterial is turned off."):a instanceof THREE.MeshBasicMaterial?f="basic":a instanceof THREE.MeshLambertMaterial?console.log("MeshLambertMaterial is turned off."):a instanceof
THREE.MeshPhongMaterial?f="phong":a instanceof THREE.LineBasicMaterial?f="basic":a instanceof THREE.LineDashedMaterial&&(f="dashed");if(f){var g=THREE.ShaderLib[f];a.uniforms=THREE.UniformsUtils.clone(g.uniforms);a.vertexShader=g.vertexShader;a.fragmentShader=g.fragmentShader}for(var h=0,k=0,l=0,m=0,g=0,n=b.length;g<n;g++){var p=b[g];p.onlyShadow||(p instanceof THREE.DirectionalLight&&h++,p instanceof THREE.PointLight&&k++,p instanceof THREE.SpotLight&&l++,p instanceof THREE.HemisphereLight&&m++)}for(var r=
0,g=0,n=b.length;g<n;g++)p=b[g],p.castShadow&&(p instanceof THREE.SpotLight&&r++,p instanceof THREE.DirectionalLight&&!p.shadowCascade&&r++);var s;a:{n=a.fragmentShader;p=a.vertexShader;g=a.uniforms;b=a.attributes;var t=a.defines;d={map:!!a.map,envMap:!!a.envMap,irradianceMap:!!a.irradianceMap,envIsSpherical:a.envMap&&a.envMap.mapping instanceof THREE.SphericalReflectionMapping,envLogLuv:a.envMap&&a.envMap.LogLuv,irrLogLuv:a.irradianceMap&&a.irradianceMap.LogLuv,lightMap:!!a.lightMap,bumpMap:Ka&&
!!a.bumpMap,normalMap:Ka&&!!a.normalMap,specularMap:!!a.specularMap,vertexColors:a.vertexColors,fog:c,useFog:a.fog,fogExp:c instanceof THREE.FogExp2,sizeAttenuation:a.sizeAttenuation,maxDirLights:h,maxPointLights:k,maxSpotLights:l,maxHemiLights:m,maxShadows:r,shadowMapEnabled:this.shadowMapEnabled&&d.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:a.alphaTest,metal:a.metal,clearcoat:a.clearcoat,wrapAround:a.wrapAround,
doubleSided:a.side===THREE.DoubleSide,flipSided:a.side===THREE.BackSide,mrtNormals:A&&a.mrtNormals};c=a.index0AttributeName;var u,v,x,h=[];f?h.push(f):(h.push(n),h.push(p));for(v in t)h.push(v),h.push(t[v]);for(u in d)h.push(u),h.push(d[u]);f=h.join();u=0;for(v=R.length;u<v;u++)if(h=R[u],h.code===f){h.usedTimes++;s=h.program;break a}u="SHADOWMAP_TYPE_BASIC";d.shadowMapType===THREE.PCFShadowMap?u="SHADOWMAP_TYPE_PCF":d.shadowMapType===THREE.PCFSoftShadowMap&&(u="SHADOWMAP_TYPE_PCF_SOFT");v=[];for(x in t)h=
t[x],!1!==h&&(h="#define "+x+" "+h,v.push(h));t=v.join("\n");x=q.createProgram();v=["precision "+I+" float;","precision "+I+" int;",t,eb?"#define VERTEX_TEXTURES":"",Q.gammaInput?"#define GAMMA_INPUT":"",Q.gammaOutput?"#define GAMMA_OUTPUT":"",d.mrtNormals?"#define MRT_NORMALS":"","#define MAX_DIR_LIGHTS "+d.maxDirLights,"#define MAX_POINT_LIGHTS "+d.maxPointLights,"#define MAX_SPOT_LIGHTS "+d.maxSpotLights,"#define MAX_HEMI_LIGHTS "+d.maxHemiLights,"#define MAX_SHADOWS "+d.maxShadows,"#define MAX_BONES "+
d.maxBones,d.map?"#define USE_MAP":"",d.envMap?"#define USE_ENVMAP":"",d.irradianceMap?"#define USE_IRRADIANCEMAP":"",d.lightMap?"#define USE_LIGHTMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.specularMap?"#define USE_SPECULARMAP":"",d.vertexColors?"#define USE_COLOR":"",d.wrapAround?"#define WRAP_AROUND":"",d.doubleSided?"#define DOUBLE_SIDED":"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+u:
"",d.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",d.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",d.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n"].join("\n");u=["precision "+I+" float;",
"precision "+I+" int;",d.bumpMap||d.normalMap?"#extension GL_OES_standard_derivatives : enable":"",t,"#define MAX_DIR_LIGHTS "+d.maxDirLights,"#define MAX_POINT_LIGHTS "+d.maxPointLights,"#define MAX_SPOT_LIGHTS "+d.maxSpotLights,"#define MAX_HEMI_LIGHTS "+d.maxHemiLights,"#define MAX_SHADOWS "+d.maxShadows,d.alphaTest?"#define ALPHATEST "+d.alphaTest:"",d.mrtNormals?"#define MRT_NORMALS":"",Q.gammaInput?"#define GAMMA_INPUT":"",Q.gammaOutput?"#define GAMMA_OUTPUT":"",d.useFog&&d.fog?"#define USE_FOG":
"",d.useFog&&d.fogExp?"#define FOG_EXP2":"",d.map?"#define USE_MAP":"",d.envMap?"#define USE_ENVMAP":"",d.irradianceMap?"#define USE_IRRADIANCEMAP":"",d.envLogLuv?"#define ENV_LOGLUV":"",d.irrLogLuv?"#define IRR_LOGLUV":"",d.lightMap?"#define USE_LIGHTMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.specularMap?"#define USE_SPECULARMAP":"",d.vertexColors?"#define USE_COLOR":"",d.metal?"#define METAL":"",d.clearcoat?"#define CLEARCOAT":"",d.wrapAround?"#define WRAP_AROUND":
"",d.doubleSided?"#define DOUBLE_SIDED":"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+u:"",d.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",d.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n#ifdef USE_ENVMAP\nuniform mat4 viewMatrixInverse;\n#endif\n"].join("\n");p=C("vertex",v+p);n=C("fragment",u+n);q.attachShader(x,p);q.attachShader(x,n);c&&q.bindAttribLocation(x,0,c);q.linkProgram(x);
q.getProgramParameter(x,q.LINK_STATUS)||(console.error("Could not initialise shader\nVALIDATE_STATUS: "+q.getProgramParameter(x,q.VALIDATE_STATUS)+", gl error ["+q.getError()+"]"),console.error("Program Info Log: "+q.getProgramInfoLog(x)));q.deleteShader(n);q.deleteShader(p);x.uniforms={};x.attributes={};var y,n="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition viewMatrixInverse".split(" ");for(y in g)n.push(y);y=n;g=0;for(n=y.length;g<n;g++)p=y[g],x.uniforms[p]=
q.getUniformLocation(x,p);n="position normal uv uv2 color lineDistance".split(" ");for(s in b)n.push(s);s=n;y=0;for(b=s.length;y<b;y++)g=s[y],x.attributes[g]=q.getAttribLocation(x,g);x.id=X++;R.push({program:x,code:f,usedTimes:1});Q.info.memory.programs=R.length;s=x}a.program=s;a.uniformsList=[];for(e in a.uniforms)a.uniformsList.push([a.uniforms[e],e])};this.setFaceCulling=function(a,b){a===THREE.CullFaceNone?q.disable(q.CULL_FACE):(b===THREE.FrontFaceDirectionCW?q.frontFace(q.CW):q.frontFace(q.CCW),
a===THREE.CullFaceBack?q.cullFace(q.BACK):a===THREE.CullFaceFront?q.cullFace(q.FRONT):q.cullFace(q.FRONT_AND_BACK),q.enable(q.CULL_FACE))};this.setMaterialFaces=function(a){var b=a.side===THREE.DoubleSide;a=a.side===THREE.BackSide;Ba!==b&&(b?q.disable(q.CULL_FACE):q.enable(q.CULL_FACE),Ba=b);Ga!==a&&(a?q.frontFace(q.CW):q.frontFace(q.CCW),Ga=a)};this.setDepthTest=function(a){ja!==a&&(a?q.enable(q.DEPTH_TEST):q.disable(q.DEPTH_TEST),ja=a)};this.setDepthWrite=function(a){Da!==a&&(q.depthMask(a),Da=
a)};this.setBlending=function(a,b,c,d){a!==oa&&(a===THREE.NoBlending?q.disable(q.BLEND):a===THREE.AdditiveBlending?(q.enable(q.BLEND),q.blendEquation(q.FUNC_ADD),q.blendFunc(q.SRC_ALPHA,q.ONE)):a===THREE.SubtractiveBlending?(q.enable(q.BLEND),q.blendEquation(q.FUNC_ADD),q.blendFunc(q.ZERO,q.ONE_MINUS_SRC_COLOR)):a===THREE.MultiplyBlending?(q.enable(q.BLEND),q.blendEquation(q.FUNC_ADD),q.blendFunc(q.ZERO,q.SRC_COLOR)):a===THREE.CustomBlending?q.enable(q.BLEND):(q.enable(q.BLEND),q.blendEquationSeparate(q.FUNC_ADD,
q.FUNC_ADD),q.blendFuncSeparate(q.SRC_ALPHA,q.ONE_MINUS_SRC_ALPHA,q.ONE,q.ONE_MINUS_SRC_ALPHA)),oa=a);if(a===THREE.CustomBlending){if(b!==Ma&&(q.blendEquation(O(b)),Ma=b),c!==da||d!==Ha)q.blendFunc(O(c),O(d)),da=c,Ha=d}else Ha=da=Ma=null};this.setTexture=function(a,b){if(a.needsUpdate){a.__webglInit||(a.__webglInit=!0,a.addEventListener("dispose",$a),a.__webglTexture=q.createTexture(),Q.info.memory.textures++);q.activeTexture(q.TEXTURE0+b);q.bindTexture(q.TEXTURE_2D,a.__webglTexture);q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,
a.flipY);q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);q.pixelStorei(q.UNPACK_ALIGNMENT,a.unpackAlignment);var c=a.image,d=B(c.width)&&B(c.height),e=O(a.format),f=O(a.type);D(q.TEXTURE_2D,a,d);var g=a.mipmaps;if(a instanceof THREE.DataTexture)if(0<g.length&&d){for(var h=0,k=g.length;h<k;h++)c=g[h],q.texImage2D(q.TEXTURE_2D,h,e,c.width,c.height,0,e,f,c.data);a.generateMipmaps=!1}else q.texImage2D(q.TEXTURE_2D,0,e,c.width,c.height,0,e,f,c.data);else if(a instanceof THREE.CompressedTexture)for(h=
0,k=g.length;h<k;h++)c=g[h],a.format!==THREE.RGBAFormat?q.compressedTexImage2D(q.TEXTURE_2D,h,e,c.width,c.height,0,c.data):q.texImage2D(q.TEXTURE_2D,h,e,c.width,c.height,0,e,f,c.data);else if(0<g.length&&d){h=0;for(k=g.length;h<k;h++)c=g[h],q.texImage2D(q.TEXTURE_2D,h,e,e,f,c);a.generateMipmaps=!1}else q.texImage2D(q.TEXTURE_2D,0,e,e,f,a.image);a.generateMipmaps&&d&&q.generateMipmap(q.TEXTURE_2D);a.needsUpdate=!1;if(a.onUpdate)a.onUpdate()}else q.activeTexture(q.TEXTURE0+b),q.bindTexture(q.TEXTURE_2D,
a.__webglTexture)};this.initFrameBufferMRT=function(a,b){var c=a[0],d=!1;if(c&&!c.__webglFramebuffer){void 0===c.depthBuffer&&(c.depthBuffer=!0);void 0===c.stencilBuffer&&(c.stencilBuffer=!0);c.__webglFramebuffer=q.createFramebuffer();q.bindFramebuffer(q.FRAMEBUFFER,c.__webglFramebuffer);var e;c.shareDepthFrom?e=c.__webglRenderbuffer=c.shareDepthFrom.__webglRenderbuffer:c.depthBuffer&&!c.stencilBuffer?(e=c.__webglRenderbuffer=q.createRenderbuffer(),q.bindRenderbuffer(q.RENDERBUFFER,e),q.renderbufferStorage(q.RENDERBUFFER,
q.DEPTH_COMPONENT16,c.width,c.height)):c.depthBuffer&&c.stencilBuffer&&(e=c.__webglRenderbuffer=q.createRenderbuffer(),q.bindRenderbuffer(q.RENDERBUFFER,e),q.renderbufferStorage(q.RENDERBUFFER,q.DEPTH_STENCIL,c.width,c.height));c.depthBuffer&&!c.stencilBuffer?q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_ATTACHMENT,q.RENDERBUFFER,e):c.depthBuffer&&c.stencilBuffer&&q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_STENCIL_ATTACHMENT,q.RENDERBUFFER,e);d=!0}e=K;q.bindFramebuffer(q.FRAMEBUFFER,c.__webglFramebuffer);
for(var f=0;f<a.length;f++){var g=a[f];if(!g.__webglTexture){var h=B(g.width)&&B(g.height),k=O(g.format),l=O(g.type);g.addEventListener("dispose",kb);g.__webglTexture=q.createTexture();Q.info.memory.textures++;q.bindTexture(q.TEXTURE_2D,g.__webglTexture);D(q.TEXTURE_2D,g,h);q.texImage2D(q.TEXTURE_2D,0,k,g.width,g.height,0,k,l,null);h&&g.generateMipmaps&&q.generateMipmap(q.TEXTURE_2D)}q.framebufferTexture2D(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0+f,q.TEXTURE_2D,g.__webglTexture,0)}A&&1<a.length&&ua.drawBuffersWEBGL([ua.COLOR_ATTACHMENT0_WEBGL,
ua.COLOR_ATTACHMENT1_WEBGL]);b&&(f=q.checkFramebufferStatus(q.FRAMEBUFFER),f!==q.FRAMEBUFFER_COMPLETE&&(console.log("Can't use multiple render targets. Falling back to two passes. "+f),delete c.__webglFramebuffer,b=!1));q.bindFramebuffer(q.FRAMEBUFFER,e);d&&(q.bindTexture(q.TEXTURE_2D,null),q.bindRenderbuffer(q.RENDERBUFFER,null),q.bindFramebuffer(q.FRAMEBUFFER,null));return b};this.setRenderTarget=function(a){var b;Array.isArray(a)?(this.initFrameBufferMRT(a),b=a[0]):a&&(this.initFrameBufferMRT([a]),
b=a);var c,d,e;b?(a=b.__webglFramebuffer,c=b.width,b=b.height,e=d=0):(a=null,c=ya,b=xa,d=pa,e=Y);a!==K&&(q.bindFramebuffer(q.FRAMEBUFFER,a),q.viewport(d,e,c,b),K=a);Ea=c;va=b};this.readPixels=function(a,b,c,d,e,f){this.setRenderTarget(a);q.readPixels(b,c,d,e,q.RGBA,q.UNSIGNED_BYTE,f)};this.verifyMRTWorks=function(a){ua&&(A=this.initFrameBufferMRT(a,!0));return A};this.shadowMapPlugin=new THREE.ShadowMapPlugin;this.addPrePlugin(this.shadowMapPlugin)};AutodeskNamespace("Autodesk.Viewing.Private");void 0===ENABLE_DEBUG&&(ENABLE_DEBUG=!0);void 0===ENABLE_TRACE&&(ENABLE_TRACE=!0);var ENABLE_AUTOCAM=!0,MAX_FRAME_TIME=50,MIN_FRAME_TIME=1E3/30;
Autodesk.Viewing.Private.Viewer3DImpl=function(a,b){this.canvas=a;this.api=b;this.svfloader=new Autodesk.Viewing.Private.SvfLoader(this);var c=a.clientWidth,e=a.clientHeight;this.postProcess=!1;this.renderer=new RenderContext;this.renderer.init(a,c,e);this.RENDER_NORMAL=0;this.RENDER_HIGHLIGHTED=1;this.RENDER_HIDDEN=2;this.RENDER_FINISHED=3;this.phase=this.RENDER_NORMAL;this.camera=new THREE.PerspectiveCamera(45,c/e,0.1,1E4);this.cameraChangedEvent={type:Autodesk.Viewing.CAMERA_CHANGE_EVENT,camera:this.camera};
this.scene=new THREE.Scene;this.scene.add(this.camera);this.overlayScenes={};this.projector=new THREE.Projector;this.selectionMaterialBase=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:1,transparent:!1});this.selectionMaterialTop=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:0.15,transparent:!0});this.createOverlayScene("selection",this.selectionMaterialBase,this.selectionMaterialTop);this.materials={};
this.texturesToUpdate=[];this.modelQueue=null;this.fadeMaterial=new THREE.MeshPhongMaterial({color:16777215,opacity:0.1,reflectivity:0,transparent:!0});this.addMaterial("__fadeMaterial__",this.fadeMaterial,!0);this.highlightMaterial=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:1,transparent:!1});this.needsResize=this.needsClear=this.needsRender=!1;this.moveDelay=0;this.progressiveRender=!0;this.maxFrameTime=MAX_FRAME_TIME;this.minFrameTime=MIN_FRAME_TIME;
this.targetFrameRate=2E3/(MIN_FRAME_TIME+MAX_FRAME_TIME);ENABLE_AUTOCAM?this.controls=new ViewController(this):(this.controls=new THREE.TrackballControls(this.camera,this.canvas),this.controls.rotateSpeed=1,this.controls.zoomSpeed=1,this.controls.panSpeed=0.5,this.controls.dynamicDampingFactor=0.5,this.controls.owner=this);this.selector=new Autodesk.Viewing.Private.Selector(this);this.controls.setSelector(this.selector);this.visibilityManager=new Autodesk.Viewing.Private.VisibilityManager(this);var d=
this;this.useEnvMap=!1;this.showOverlaysWhileMoving=this.showGhosting=!0;this.lastTickMoved=!1;this.setClearColors(230,230,230,150,150,150);this.renderer.beginScene(this.scene,this.camera,!0);this.renderer.composeFinalFrame();this.reqid=0;(function f(a){d.reqid=window.requestAnimationFrame(f);d.tick(a)})()};Autodesk.Viewing.Private.Viewer3DImpl.prototype.constructor=Autodesk.Viewing.Private.Viewer3DImpl;
function isMultiSelect(a){var b=-1!==navigator.userAgent.search("Mac OS");return b&&a.metaKey||!b&&a.ctrlKey}function isRightClick(a){return-1!==navigator.userAgent.search("Mac OS")&&a.ctrlKey||2===a.button}Autodesk.Viewing.Private.Viewer3DImpl.prototype.toggleProgressive=function(a){this.progressiveRender=a;this.needsClear=!0};Autodesk.Viewing.Private.Viewer3DImpl.prototype.toggleGhosting=function(a){this.showGhosting=a;this.needsClear=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.toggleOverlaysWhileMoving=function(a){this.showOverlaysWhileMoving=a};Autodesk.Viewing.Private.Viewer3DImpl.prototype.togglePostProcess=function(a,b,c){this.renderer.initPostPipeline(a,b,c);this.fireRenderOptionChanged();this.needsClear=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.tick=function(a){(a=this.stats)&&a.begin();this.needsResize&&(this.camera.aspect=this.newWidth/this.newHeight,this.renderer.setSize(this.newWidth,this.newHeight),this.overlayDirty=this.needsClear=this.needsRender=!0,this.needsResize=!1);var b=this.controls.update()||this.cameraUpdated,c=b||this.needsClear;this.cameraUpdated=!1;for(this.overlayDirty=this.overlayDirty||b;this.texturesToUpdate.length;)for(var e=this.texturesToUpdate.pop(),d=0;d<e.mats.length;d++)e.mats[d][e.slot]=
e.tex,this.needsRender=e.mats[d].needsUpdate=!0;var g=this.model&&this.model.isLoadDone(),e=c||this.needsRender,f=this.modelQueue,h=d=this.progressiveRender?0.5*(this.maxFrameTime+this.minFrameTime):1E10;e&&(g&&this.model.getData().fragments.length&&this.signalProgress(0,null),this.updateCameraMatrices(),this.renderer.beginScene(this.scene,this.camera,c),b&&this.api.fireEvent(this.cameraChangedEvent),this.needGhostedPass&&f.setOverrideMaterial(null),f&&(0<this.selector.getSelectionLength()?(this.phase=
this.RENDER_HIGHLIGHTED,f.reset(this.camera),f.drawHighlightedObjectsOnly(),f.setOverrideMaterial(this.highlightMaterial)):(this.phase=this.RENDER_NORMAL,f.reset(this.camera),f.drawNormalObjectsOnly(),f.setOverrideMaterial(null))));if(f&&!f.isDone()){var k=this,c=function(a){k.renderer.renderScenePart(a,k.phase!==k.RENDER_NORMAL)},h=f.renderSome(c,h);f.isDone()&&this.phase===this.RENDER_HIGHLIGHTED&&(this.phase=this.RENDER_NORMAL,f.reset(this.camera),f.drawNormalObjectsOnly(),f.setOverrideMaterial(null),
h=f.renderSome(c,h));b||this.overlayDirty||this.renderer.composeFinalFrame();f.isDone()?(this.phase===this.RENDER_NORMAL&&!f.areAllVisible()&&this.showGhosting?(this.phase=this.RENDER_HIDDEN,f.reset(this.camera),f.drawHiddenObjectsOnly(),f.setOverrideMaterial(this.fadeMaterial)):(this.phase=this.RENDER_FINISHED,this.renderer.composeFinalFrame()),g&&this.signalProgress(100,null)):g&&this.signalProgress(100*f.getRenderProgress(),null)}this.overlayDirty&&(f&&f.isDone()||this.showOverlaysWhileMoving?
((c=this.lightsOn)||this.toggleLights(!0),this.renderer.renderOverlays(this.overlayScenes),c||this.toggleLights(!1),this.overlayDirty=!1):this.renderer.clearAllOverlays(),this.renderer.composeFinalFrame(!b&&!e));h<d&&a&&a.end();this.lastTickMoved=b;this.needsClear=this.needsRender=!1};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.updateCameraMatrices=function(){var a=this.camera;a.updateMatrixWorld();a.matrixWorldInverse.getInverse(a.matrixWorld);if(this.model){var b=this.getVisibleBounds(),c=new THREE.Box3;b.getTransformedBox(a.matrixWorldInverse,c);var e=-c.max.z,c=-c.min.z,e=Math.max(e,Math.min(1,1E-4*Math.abs(c-e))),c=Math.max(c,e);a.near=e;a.far=c;a.updateProjectionMatrix();this.model.is2d()&&(b=(e=this.intersectGroundViewport(0,0))?a.position.distanceTo(e):a.position.distanceTo(b.center()),
a=this.renderer.settings.deviceHeight/(2*b*Math.tan(0.5*a.fov)),this.materials.__lineMaterial__.uniforms.unitsPerPixel.value=1/a,this.materials.__lineMaterial__.uniforms.pixelsPerUnit.value=a)}};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.initLights=function(a){this.lightNode=new THREE.Object3D;this.dir_light1=new THREE.DirectionalLight((new THREE.Color).setRGB(1,0.84,0.67),1);this.dir_light1.position.set(-1,0,1);this.dir_light1.position.multiplyScalar(1E3*a);this.lightNode.add(this.dir_light1);this.amb_light=new THREE.AmbientLight((new THREE.Color).setRGB(0.8,0.9,1));this.irradianceMap||this.toggleLights(!0)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.toggleLights=function(a){a&&!this.lightsOn?(this.scene.add(this.amb_light),this.camera.add(this.lightNode),this.lightsOn=!0):!a&&this.lightsOn&&(this.amb_light&&this.scene.remove(this.amb_light),this.lightNode&&this.camera.remove(this.lightNode),this.lightsOn=!1)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.initCamera=function(a){var b=a.getUpVector(),b=b?(new THREE.Vector3).fromArray(b):null,c=!1,e=a.getDefaultCamera();ENABLE_AUTOCAM&&null!==e?(a=e.fov,e.isPerspective||(a=10,c=!0),this.camera.isPerspective=!0,this.camera.fov=a,this.camera.position.copy(e.position),this.camera.up.copy(e.up),this.camera.target=(new THREE.Vector3).copy(e.target),e.inst&&e.inst.transform&&(a=(new THREE.Matrix4).copy(e.inst.transform),this.camera.position.applyMatrix4(a),this.camera.target.applyMatrix4(a),
this.camera.up.transformDirection(a)),b?this.camera.up.copy(b):this.camera.up=this.getNearestAxis(this.camera.up)):(e=a.getBoundingBox(),this.camera.target=e.center(),e=e.size(),this.camera.position.copy(this.camera.target),this.camera.position.z+=Math.max(e.x,Math.max(e.y,e.z)),this.camera.isPerspective=!0,b?this.camera.up.copy(b):a.is2d()&&(this.camera.up.set(0,0,1),this.camera.target.y+=1E-6*e.y));this.camera.lookAt(this.camera.target);this.syncCamera();c&&this.controls.fitToView(!0);this.controls.recordHomeView()};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.syncCamera=function(){this.camera.updateProjectionMatrix();ENABLE_AUTOCAM?(this.controls.setWorldUp(this.camera.up),this.controls.setViewpoint(this.camera.position,this.camera.target)):this.controls.resetScene(this.model.getBoundingBox());this.cameraUpdated=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.getNearestAxis=function(a){a=a.clone();0>a.x&&(a.x=-a.x);0>a.y&&(a.y=-a.y);0>a.z&&(a.z=-a.z);a.x>a.y&&a.x>a.z?a.set(0<a.x?1:-1,0,0):a.y>a.x&&a.y>a.z?a.set(0,0<a.y?1:-1,0):a.set(0,0,0<a.z?1:-1);return a};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setViewFromFile=function(a){var b={},c=!0,e=a.getUpVector(),e=e?(new THREE.Vector3).fromArray(e):null,d=a.getDefaultCamera();d?(c=d.isPerspective,b.isPerspective=!0,b.fov=c?d.fov:10,b.position=(new THREE.Vector3).copy(d.position),b.target=(new THREE.Vector3).copy(d.target),b.up=(new THREE.Vector3).copy(d.up),d.inst&&d.inst.transform&&(a=(new THREE.Matrix4).copy(d.inst.transform),b.position.applyMatrix4(a),b.target.applyMatrix4(a),b.up.transformDirection(a)),
b.up=e?e:this.getNearestAxis(b.up)):(b.isPerspective=!0,b.fov=this.camera.fov,b.target=a.getBoundingBox().center(),b.up=e?e:this.camera.up.clone(),b.position=b.target.clone(),a=a.getBoundingBox().size(),b.position.z+=Math.max(a.x,a.y,a.z));this.applyCamera(b,!c)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setViewFromArray=function(a){a={position:new THREE.Vector3(a[0],a[1],a[2]),target:new THREE.Vector3(a[3],a[4],a[5]),up:new THREE.Vector3(a[6],a[7],a[8]),aspect:a[9],fov:THREE.Math.radToDeg(a[10]),orthoHeight:a[11],isPerspective:!a[12]};var b=a.isPerspective;b||(a.fov=10);var c=this.model?this.model.getUpVector():null,c=c?(new THREE.Vector3).fromArray(c):null;a.up=c?c:this.getNearestAxis(a.up);this.applyCamera(a,!b)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.applyCamera=function(a,b){if(b){var c=this.camera.position.clone(),e=this.camera.target.clone(),d=this.camera.up.clone(),g=this.camera.fov;this.camera.position.copy(a.position);this.camera.target.copy(a.target);this.camera.up.copy(a.up);this.camera.fov=a.fov;this.camera.lookAt(a.target);this.syncCamera();var f=this.controls.fitToView(!0,this.model.getBoundingBox());this.camera.position.copy(c);this.camera.target.copy(e);this.camera.up.copy(d);this.camera.fov=
g;this.camera.lookAt(e);this.syncCamera();this.controls.setWorldUp(a.up);this.controls.transitionView(f.position,f.target,a.fov,10)}else this.controls.setWorldUp(a.up),this.controls.transitionView(a.position,a.target,a.fov,10);this.cameraUpdated=!0};Autodesk.Viewing.Private.Viewer3DImpl.prototype.setModel=function(a){a&&(this.model=a,this.selector.model=this.model,this.visibilityManager.model=this.model,this.model.setLoader(this.svfloader),this.initScene())};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.initScene=function(){if(this.model){this.model.is2d()&&(this.initLayerTexture(this.model),this.enter2DMode());this.modelQueue=new RenderQueue(this.model.getData().fragments.length,this.scene,this.model.getBoundingBox());this.initCamera(this.model);var a=this.model.getBoundingBox();this.initLights(0.5*a.size().length());this.needsRender=this.needsClear=!0}};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.initLayerTexture=function(a){var b=a.getLayersList();a=0|Math.ceil(b.length/256);for(var c=new Uint8Array(1024*a),e=0,b=b.length;e<b;e++)c[4*e]=255,c[4*e+1]=255,c[4*e+2]=255,c[4*e+3]=255;a=new THREE.DataTexture(c,256,a,THREE.RGBAFormat,THREE.UnsignedByteType,new THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,0);a.generateMipmaps=!1;a.flipY=!1;a.needsUpdate=!0;this.layerMaskTex=a};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.create2DMaterial=function(a){var b="__lineMaterial__";a.image&&(b+="|image:"+a.image.name);a.clip&&(b+="|clip:"+JSON.stringify(a.clip));if(!this.materials.hasOwnProperty(b)){var c=new THREE.ShaderMaterial({fragmentShader:LineShader.fragmentShader,vertexShader:LineShader.vertexShader,uniforms:THREE.UniformsUtils.clone(LineShader.uniforms),attributes:LineShader.attributes,defines:LineShader.defines,transparent:!0});c.depthWrite=!1;c.depthTest=!1;c.blending=
THREE.NormalBlending;c.side=THREE.DoubleSide;c.uniforms.tLayerMask.value=this.layerMaskTex;if(a.image){var e;a.image.dataURI?(e=new Image,e.src=a.image.dataURI,e=new THREE.Texture(e,new THREE.UVMapping),e.name=a.image.name,a.image.isPng&&(c.transparent=!0)):a.image.bits&&(e=new THREE.DataTexture(a.image.bits,a.image.width,a.image.height,THREE.RGBAFormat));e.wrapS=THREE.ClampToEdgeWrapping;e.wrapT=THREE.ClampToEdgeWrapping;e.anisotropy=1;e.flipY=!0;e.needsUpdate=!0;c.uniforms.tRaster.value=e}this.materials[b]=
c}return b};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.addMaterial=function(a,b,c){function e(a){return 0.299*a.r+0.587*a.g+0.114*a.b}var d=this.svfloader.svf;if(!c){var g=d?d.proteinMaterials:null;b.metal?(b.reflectivity||(b.reflectivity=e(b.specular)),g&&(1===b.reflectivity&&(b.reflectivity=e(b.specular)),0===b.color.r&&0===b.color.g&&0===b.color.b?(b.color.r=0.1*b.specular.r,b.color.g=0.1*b.specular.g,b.color.b=0.1*b.specular.b):(b.color.r*=0.1,b.color.g*=0.1,b.color.b*=0.1))):!g&&b.reflectivity?(b.metal=
!0,b.specular.r=b.color.r*b.reflectivity,b.specular.g=b.color.g*b.reflectivity,b.specular.b=b.color.b*b.reflectivity,b.color.r*=0.1,b.color.g*=0.1,b.color.b*=0.1):1!==b.color.r||1!==b.color.g||1!==b.color.b||1!==b.specular.r||1!==b.specular.g||1!==b.specular.b||b.uri_map||b.uri_specularMap?(b.reflectivity||(b.reflectivity=0.01+0.06*e(b.specular)),b.specular.r*=b.reflectivity,b.specular.g*=b.reflectivity,b.specular.b*=b.reflectivity):(b.metal=!0,b.reflectivity=0.7,b.specular.r=b.specular.g=b.specular.b=
b.reflectivity,b.color.r*=0.1,b.color.g*=0.1,b.color.b*=0.1);b.ambient.copy(b.color);b.ambient.r*=0.3;b.ambient.g*=0.3;b.ambient.b*=0.3;b.combine=THREE.MixOperation;if(b.transparent||b.uri_map&&-1!=b.uri_map.toLowerCase().indexOf(".png")||b.uri_opacityMap)b.alphaTest=0.01}if(b.uri_normalMap){c=b.bumpScale;if(void 0===c||1<=c)c=1;b.normalScale=new THREE.Vector2(c,c)}else void 0===b.bumpScale&&(b.uri_map||b.uri_bumpMap)?b.bumpScale=0.03:1<b.bumpScale&&(b.bumpScale=0.03);g&&g.materials&&(g=g.materials[a])&&
(g=g.materials[g.userassets[0]],g.categories&&-1!=g.categories.indexOf("Paint")&&(b.clearcoat=!0));this.reflectionCube&&(b.envMap=this.reflectionCube);this.irradianceMap&&(b.irradianceMap=this.irradianceMap);b.mrtNormals=this.renderer.hasMRT()&&this.renderer.settings.sao;b.side==THREE.DoubleSide&&this.renderer.toggleTwoSided(!0);this.materials[a]=b};Autodesk.Viewing.Private.Viewer3DImpl.prototype.addTexture=function(a){this.texturesToUpdate.push(a)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.addMeshInstance=function(a,b,c,e){var d=this.model.getData();if(0!==b||-1==d.basePath.indexOf("SaRang")){if(a.isLines){var g=!!a.attributes.color,d=new THREE.LineBasicMaterial({vertexColors:g,polygonOffset:!0,polygonOffsetFactor:2,polygonOffsetUnits:1});g||(d.color=this.materials[c].color);a=new THREE.Mesh(a,d,!0);a.isLine=!0}else{d=this.materials[c];if(!d)for(g in stderr("Unknown material "+c),this.materials){d=this.materials[g];break}a.attributes.color&&
(d.vertexColors=THREE.VertexColors,d.needsUpdate=!0);a.attributes.uv&&a.attributes.uv.isPattern&&(d.map&&!d.bumpMap&&(d.bumpMap=d.map,d.needsUpdate=!0),d.uri_map&&!d.uri_bumpMap&&(d.uri_bumpMap=d.uri_map,d.needsUpdate=!0));a=new THREE.Mesh(a,d,!0)}e&&(a.matrix?a.matrix.copy(e):a.matrixWorld.copy(e));a.matrixAutoUpdate=!1;this.modelQueue.addMesh(b,a)}};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.signalProgress=function(a,b){this.api.fireEvent({type:Autodesk.Viewing.PROGRESS_UPDATE_EVENT,percent:a,message:b})};Autodesk.Viewing.Private.Viewer3DImpl.prototype.resize=function(a,b){this.needsResize=!0;this.newWidth=a;this.newHeight=b};Autodesk.Viewing.Private.Viewer3DImpl.prototype.enter2DMode=function(){this.controls.setWorldUp(new THREE.Vector3(0,0,1));this.controls.set2DMode(!0);this.togglePostProcess(!1,!1,!0)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.loadSvf=function(a,b,c,e,d){return this.svfloader.loadSvf(a,b,c,e,d)};Autodesk.Viewing.Private.Viewer3DImpl.prototype.createOverlayScene=function(a,b,c,e){b&&(b.depthWrite=!1,b.depthTest=!0);c&&(c.depthWrite=!1,c.depthTest=!1);var d=new THREE.Scene(!0);d.__lights=this.scene.__lights;this.overlayScenes[a]={scene:d,camera:e,materialPre:b,materialPost:c}};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.addOverlay=function(a,b){this.overlayScenes[a].scene.add(b);this.overlayDirty=!0};Autodesk.Viewing.Private.Viewer3DImpl.prototype.removeOverlay=function(a,b){this.overlayScenes[a].scene.remove(b);this.overlayDirty=!0};Autodesk.Viewing.Private.Viewer3DImpl.prototype.clearOverlay=function(a){this.overlayScenes[a].scene.clear();this.overlayDirty=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setClearColors=function(a,b,c,e,d,g){this.clearColorTop=new THREE.Vector4(a/255,b/255,c/255,1);this.clearColorBottom=new THREE.Vector4(e/255,d/255,g/255,1);this.reflectionCube&&!this.reflectionCube.isBgColor||this.setCubeMapFromColors(this.clearColorTop,this.clearColorBottom);this.renderer.setClearColors(this.clearColorTop,this.clearColorBottom);this.needsClear=!0;this.fireRenderOptionChanged()};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.getVisibleBounds=function(){return this.modelQueue?this.modelQueue.getVisibleBounds():null};Autodesk.Viewing.Private.Viewer3DImpl.prototype.getRenderProxy=function(a,b){return this.modelQueue.getVizmesh(b)};Autodesk.Viewing.Private.Viewer3DImpl.prototype.setFragmentVisibility=function(a,b,c){this.modelQueue.setVisibility(b,c)};Autodesk.Viewing.Private.Viewer3DImpl.prototype.setModelVisibility=function(a,b){this.modelQueue.setAllVisibility(b)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.isWholeModelVisible=function(a){return this.modelQueue.areAllVisible()};Autodesk.Viewing.Private.Viewer3DImpl.prototype.resetIsolation=function(a){this.modelQueue.setOverrideMaterial(null);this.needGhostedPass=!1;this.needsClear=!0};Autodesk.Viewing.Private.Viewer3DImpl.prototype.highlightFragment=function(a,b,c){this.modelQueue.setHightlighted(b,c)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.explode=function(a){var b=this,c=this.model,e=c.getData(),d=this.getVisibleBounds().center(),g=e.fragments,f=g.transforms,h=a*(e.maxTreeDepth-1)+1,k=0|h,l=h-k;a*=2;if(e.instanceTree&&e.instanceBoxes&&0!=a){var m=e.instanceBoxes;(function v(d,e,g,h,n,p,r,s){var t=2*a;e==k&&(t*=l);var H=6*d.dbId,I=0.5*(m[H]+m[H+3]),E=0.5*(m[H+1]+m[H+4]),H=0.5*(m[H+2]+m[H+5]);0<e&&e<=k&&(p+=(I-g)*t,r+=(E-h)*t,s+=(H-n)*t);if(g=d.children)for(h=0,n=g.length;h<n;h++)v(g[h],
e+1,I,E,H,p,r,s);d=d.fragIds;if(void 0!==d)if(Array.isArray(d))for(e=0;e<d.length;e++)I=0|d[e],H=16*I,E=b.getRenderProxy(c,I).matrixWorld.elements,E[12]=f[H+12]+p,E[13]=f[H+13]+r,E[14]=f[H+14]+s;else I=d|0,E=b.getRenderProxy(c,I).matrixWorld.elements,H=16*I,E[12]=f[H+12]+p,E[13]=f[H+13]+r,E[14]=f[H+14]+s})(e.instanceTree,0,d.x,d.y,d.x,0,0,0)}else for(e=g.boxes,h=0,g=g.length;h<g;h++){var n=6*h,r=16*h,p=0.5*(e[n]+e[n+3]),t=0.5*(e[n+1]+e[n+4]),n=0.5*(e[n+2]+e[n+5]),p=a*(p-d.x),t=a*(t-d.y),n=a*(n-d.z),
s=b.getRenderProxy(c,h).matrixWorld.elements;s[12]=f[r+12]+p;s[13]=f[r+13]+t;s[14]=f[r+14]+n}this.overlayDirty=this.needsClear=this.modelQueue.visibleBoundsDirty=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setCubeMapFromColors=function(a,b){for(var c=255*a.x,e=255*a.y,d=255*a.z,g=255*b.x,f=255*b.y,h=255*b.z,k=new Uint8Array(16),l=new Uint8Array(16),m=new Uint8Array(16),n=0;4>n;n++)k[4*n]=c,k[4*n+1]=e,k[4*n+2]=d,k[4*n+3]=255,l[4*n]=g,l[4*n+1]=f,l[4*n+2]=h,l[4*n+3]=255,0|n/2?(m[4*n]=c,m[4*n+1]=e,m[4*n+2]=d):(m[4*n]=g,m[4*n+1]=f,m[4*n+2]=h),m[4*n+3]=255;c=new THREE.DataTexture(m,2,2,THREE.RGBAFormat);e=new THREE.DataTexture(m,2,2,THREE.RGBAFormat);l=new THREE.DataTexture(l,
2,2,THREE.RGBAFormat);k=new THREE.DataTexture(k,2,2,THREE.RGBAFormat);d=new THREE.DataTexture(m,2,2,THREE.RGBAFormat);g=new THREE.DataTexture(m,2,2,THREE.RGBAFormat);m=new THREE.Texture(null,new THREE.CubeReflectionMapping,THREE.RepeatWrapping,THREE.RepeatWrapping,THREE.LinearFilter,THREE.LinearFilter,THREE.RGBAFormat);m.image=[e.image,c.image,k.image,l.image,g.image,d.image];m.needsUpdate=!0;this.reflectionCube=m;this.reflectionCube.isBgColor=!0;for(var r in this.materials)k=this.materials[r],k.envMap=
m,k.needsUpdate=!0;this.needsClear=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setCubeMap=function(a){var b=this,c=function(a){var c=b.model?b.model.getData():null;b.reflectionCube=void 0===a&&c?c.envMap:a;if(b.reflectionCube)for(var g in b.materials)a=b.materials[g],a.envMap=b.reflectionCube,a.needsUpdate=!0;else b.setCubeMapFromColors(b.clearColorTop,b.clearColorBottom);b.needsClear=!0};Array.isArray(a)?(this.reflectionCube=THREE.ImageUtils.loadTextureCube(a,new THREE.CubeReflectionMapping,c),this.reflectionCube.format=THREE.RGBFormat):
"string"==typeof a?-1!=a.toLowerCase().indexOf(".dds")?(this.reflectionCube=THREE.ImageUtils.loadCompressedTextureCube(a,new THREE.CubeReflectionMapping,c),this.reflectionCube.LogLuv=-1!=a.indexOf("logluv")):(this.reflectionCube=THREE.ImageUtils.loadTexture(a,new THREE.SphericalReflectionMapping,c),this.reflectionCube.format=THREE.RGBFormat):a?c(a):c(null)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setIrradianceMap=function(a){var b=this,c=function(a){if(a){for(var c in b.materials){var g=b.materials[c];g.irradianceMap=a;g.needsUpdate=!0}b.irradianceMap=a;b.toggleLights(!1)}else if(b.irradianceMap){for(c in b.materials)g=b.materials[c],g.irradianceMap=null,g.needsUpdate=!0;b.irradianceMap=null;b.toggleLights(!0)}b.needsClear=!0};THREE.ImageUtils.crossOrigin="";Array.isArray(a)?(this.irradianceMap=THREE.ImageUtils.loadTextureCube(a,new THREE.CubeReflectionMapping,
c),this.irradianceMap.format=THREE.RGBFormat):"string"==typeof a?-1!=a.toLowerCase().indexOf(".dds")&&(this.irradianceMap=THREE.ImageUtils.loadCompressedTextureCube(a,new THREE.CubeReflectionMapping,c),this.irradianceMap.LogLuv=-1!=a.indexOf("logluv")):a?c(a):c(null)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.LightPresets=[{name:"- none - ",path:null,exposure:0},{name:"Generic",path:"scGeneric",exposure:0},{name:"Gradient",path:"scGradient",exposure:0},{name:"Bloom",path:"scIDBloom",exposure:0},{name:"Lobby",path:"IDViz",exposure:0},{name:"River bank",path:"riverbank",exposure:-5.7},{name:"Field",path:"field",exposure:-2.9},{name:"Exhibit Hall",path:"ExhibitHall",exposure:2},{name:"Crossroads",path:"crossroads",exposure:-5.5},{name:"Glacier",path:"glacier",
exposure:0},{name:"Sepulveda",path:"Sepulveda",exposure:0.7},{name:"Sea port",path:"seaport",exposure:-6.5},{name:"Boardwalk",path:"boardwalk",exposure:-7}];
Autodesk.Viewing.Private.Viewer3DImpl.prototype.setLightPreset=function(a){this.currentLightPreset=a;var b=this.LightPresets[a];if(b&&b.path){var c=RESOURCE_ROOT+"environments/"+b.path+"_mipdrop.logluv.dds";this.setIrradianceMap(RESOURCE_ROOT+"environments/"+b.path+"_irr.logluv.dds");this.setCubeMap(c);this.renderer.setExposureBias(b.exposure);this.lastLightPreset=a;0!=b.exposure&&0==this.renderer.getToneMapMethod()&&(this.renderer.setTonemapMethod(3),this.renderer.setGamma(1.7))}else this.setIrradianceMap(null),
this.setCubeMap(null),this.renderer.setExposureBias(0);this.fireRenderOptionChanged()};Autodesk.Viewing.Private.Viewer3DImpl.prototype.uninitialize=function(){window.cancelAnimationFrame(this.reqid);this.controls.uninitialize();this.controls=null};Autodesk.Viewing.Private.Viewer3DImpl.prototype.hideLines=function(a){this.modelQueue.hideLines(a);this.needsClear=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.toggleLayerVisibility=function(a,b){var c=this.materials.__lineMaterial__,e=c.uniforms.tLayerMask.value,d=e.image.data,g=b?255:0;d[4*a]=g;d[4*a+1]=g;d[4*a+2]=g;d[4*a+3]=g;e.needsUpdate=!0;this.needsClear=c.needsUpdate=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.fireRenderOptionChanged=function(){var a=this.renderer.hasMRT()&&this.renderer.settings.sao,b;for(b in this.materials){var c=this.materials[b];c.mrtNormals!==a&&(c.mrtNormals=a,c.needsUpdate=!0)}this.api.fireEvent({type:Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT})};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.castRayViewport=function(a,b,c){if(this.modelQueue)return a=new THREE.Vector3(a,b,1),b=this.camera,this.projector.unprojectVector(a,b),a=this.modelQueue.rayIntersect(b.position,a.sub(b.position).normalize(),c),c=a[0],a=a[1],b=null,c&&(b=(b=this.model.getData())?b.fragments:null,c=c.fragId,b.fragToCachedNode||(b.fragToCachedNode=[]),b.fragToDbNode&&b.fragToDbNode[c]?b=b.fragToDbNode[c]:(b.fragToCachedNode[c]||(b.fragToCachedNode[c]={dbId:0,fragIds:c}),
b=b.fragToCachedNode[c])),{node:b,intersectPoint:a}};Autodesk.Viewing.Private.Viewer3DImpl.prototype.castRay=function(a,b,c){var e=this.canvas.getBoundingClientRect();return this.castRayViewport((a+0.5-e.left)/e.width*2-1,2*-((b+0.5-e.top)/e.height)+1,c)};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.intersectGroundViewport=function(a,b){var c=this.camera,e="z";1==c.up.x?e="x":1==c.up.y&&(e="y");var d=new THREE.Vector3(a,b,1);this.projector.unprojectVector(d,c);d.sub(c.position);d.normalize();if(1E-6>Math.abs(d[e]))return null;e=((this.model?this.model.getBoundingBox().min[e]:0)-c.position[e])/d[e];d.multiplyScalar(e);d.add(c.position);return d};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.intersectGround=function(a,b){var c=this.canvas.getBoundingClientRect();return this.intersectGroundViewport((a+0.5-c.left)/c.width*2-1,2*-((b+0.5-c.top)/c.height)+1)};Autodesk.Viewing.Private.Viewer3DImpl.prototype.highlightObjectViewport=function(a,b){this.renderer.highlightObjectViewport(a,b);this.overlayDirty=!0};
Autodesk.Viewing.Private.Viewer3DImpl.prototype.highlightObject=function(a,b){var c=this.canvas.getBoundingClientRect();this.highlightObjectViewport((a+0.5-c.left)/c.width*2-1,2*-((b+0.5-c.top)/c.height)+1)};/*
 Copyright (c) 2014 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing.UI");Autodesk.Viewing.UI.DockingPanel=function(a,b,c,e){this.visibilityCallbacks=[];this.parentContainer=a;this.container=document.createElement("div");this.container.id=b;this.container.lastWidth="";this.container.dock=!1;this.titleLabel=c;this.container.className=e&&e.shadow?"dockingPanel shadow":"dockingPanel";a.appendChild(this.container);this.setVisible(!1);this.initialize()};
Autodesk.Viewing.UI.DockingPanel.prototype.initialize=function(){this.title=this.createTitleBar(this.titleLabel||this.container.id);this.container.appendChild(this.title);this.initializeMoveHandlers(this.title);this.closer=this.createCloseButton();this.container.appendChild(this.closer)};Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize=function(){};Autodesk.Viewing.UI.DockingPanel.prototype.addVisibilityListener=function(a){this.visibilityCallbacks.push(a)};
Autodesk.Viewing.UI.DockingPanel.prototype.isVisible=function(){return"none"!==this.container.style.display&&""!==this.container.style.display};
Autodesk.Viewing.UI.DockingPanel.prototype.setVisible=function(a){this.container.style.display=a?"block":"none";if(a){if(this.container.dock){var b=this.parentContainer.getBoundingClientRect().width,c=""==this.container.style.width?this.container.lastWidth:this.container.style.width,c=""===c?300:parseInt(c);this.container.style.left=b-c+"px"}}else this.container.lastWidth=this.parentContainer.style.width;for(b=0;b<this.visibilityCallbacks.length;b++)this.visibilityCallbacks[b](a)};
Autodesk.Viewing.UI.DockingPanel.prototype.initializeMoveHandlers=function(a){function b(a){var b=m.parentContainer.getBoundingClientRect();l.style.maxWidth&&parseInt(l.style.width)>parseInt(l.style.maxWidth)&&(l.style.width=l.style.maxWidth);l.style.maxHeight&&parseInt(l.style.height)>parseInt(l.style.maxHeight)&&(l.style.height=l.style.maxHeight);100>parseInt(l.style.width)&&(l.style.width="100px");100>parseInt(l.style.height)&&(l.style.height="100px");h+=a.screenX-e;k+=a.screenY-d;var c=g+h,t=
f+k,s=parseInt(l.style.width),u=parseInt(l.style.height);isNaN(s)&&(s=m.container.getBoundingClientRect().width);isNaN(u)&&(u=m.container.getBoundingClientRect().height);5>c&&(c=0);5>t&&(t=0);l.dock=!1;b.width-5<c+s&&(c=b.width-s,l.dock=!0);b.height-5<t+u&&(t=b.height-u,l.dock=!0);l.style.left=c+"px";l.style.top=t+"px";l.style.maxWidth=b.width-c+"px";l.style.maxHeight=b.height-t+"px";e=a.screenX;d=a.screenY}function c(a){window.removeEventListener("mousemove",b);window.removeEventListener("mouseup",
c)}var e,d,g,f,h,k,l=this.container,m=this;a.addEventListener("mousedown",function(a){e=a.screenX;d=a.screenY;k=h=0;g=m.container.offsetLeft;f=m.container.offsetTop;window.addEventListener("mousemove",b,!1);window.addEventListener("mouseup",c,!1);a.preventDefault()},!1)};Autodesk.Viewing.UI.DockingPanel.prototype.initializeCloseHandler=function(a){var b=this;a.addEventListener("click",function(a){b.setVisible(!1)},!1)};
Autodesk.Viewing.UI.DockingPanel.prototype.createScrollContainer=function(a){var b=document.createElement("div");b.className=a&&a.left?"dockingPanelScroll left":"dockingPanelScroll right";a&&a.heightAdjustment&&(b.style.height="calc(100% - "+a.heightAdjustment+"px)");return b};Autodesk.Viewing.UI.DockingPanel.prototype.createTitleBar=function(a){var b=document.createElement("div");b.className="dockingPanelTitle";b.textContent=a;return b};
Autodesk.Viewing.UI.DockingPanel.prototype.createCloseButton=function(){var a=document.createElement("div");a.className="dockingPanelClose";a.innerHTML="&times;";this.initializeCloseHandler(a);return a};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.addClass=function(a,b){a&&(a.className=a.className.replace(" "+b,""),a.className+=" "+b)};Autodesk.Viewing.Private.removeClass=function(a,b){a&&(a.className=a.className.replace(" "+b,""))};Autodesk.Viewing.Private.hasClass=function(a,b){return a?-1<a.className.indexOf(b):!1};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.PropertyPanel=function(a){var b=this;this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"PropertyPanel","Object Properties Loading...",{shadow:!1});this.table=document.createElement("table");this.table.id="propertygrid";this.table.className="tftable";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.scrollpanel=this.createScrollContainer({heightAdjustment:50});this.container.appendChild(this.scrollpanel);this.scrollpanel.appendChild(this.table);
this.container.style.width="300px";this.container.style.height="200px";this.container.style.top="180px";this.container.style.left="220px";this.container.dock=!0;this.setOpenOnSelect=function(a){this.openOnSelect=a};this.lastSelected=[];a.addEventListener(Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(a){b.lastSelected=a.dbIdArray;b.pullCorrectProperties();b.openOnSelect&&b.setVisible(0<a.dbIdArray.length)});a.addEventListener(Autodesk.Viewing.ISOLATE_EVENT,function(a){for(var e=[],d=0;d<a.nodeIdArray.length;d++){var g=
a.nodeIdArray[d].dbId;g&&e.push(g)}b.lastSelected=e;b.pullCorrectProperties();b.openOnSelect&&b.setVisible(0<a.nodeIdArray.length)});a.addEventListener(Autodesk.Viewing.HIDE_EVENT,function(a){b.pullCorrectProperties()});a.addEventListener(Autodesk.Viewing.SHOW_EVENT,function(a){b.pullCorrectProperties();b.openOnSelect&&b.setVisible(0<a.nodeIdArray.length)});this.pullCorrectProperties=function(){if(0<this.lastSelected.length)this.setNodeId(this.lastSelected[this.lastSelected.length-1]);else{if(!a.areAllVisible())for(var b=
[a.model.getRoot()];0<b.length;){var e=b.shift();if(e){if(Autodesk.Viewing.Private.VisibilityManager.isVisible(e)){this.setNodeId(e.dbId);return}if(e.children)for(var d=0;d<e.children.length;d++)b.push(e.children[d])}}b=a.model.getRoot()?a.model.getRootId():null;this.setNodeId(b)}};this.getNodeId=function(){return this.currentID};this.setDefaultProperties=function(){a.model.getRoot()?this.setNodeId(a.model.getRootId()):this.setNodeId(null)};this.setNodeId=function(c){b.tbody.innerHTML="";c||(c=a.model&&
a.model.getRoot()?a.model.getRootId():null);c?(this.currentID=c,a.getProperties(c,function(c){b.tbody.innerHTML="";if(c.properties)for(var d=0;d<c.properties.length;d++){var g=c.properties[d],f=g.displayValue,h=b.tbody.insertRow(-1),k=h.insertCell(0);k.textContent=g.displayName;k.style.fontStyle="italic";k=h.insertCell(1);k.textContent=f;g=k;f=a.searchText;""!==f&&(f=RegExp("(\\b"+f+"\\b)","gim"),h=g.innerHTML.replace(/(<highlight>|<\/highlight>)/igm,""),g.innerHTML=h,f=h.replace(f,"<highlight>$1</highlight>"),
g.innerHTML=f)}b.title.textContent=c.name?c.name:"Object Properties";b.scrollpanel.scrollTop=0;c=b.viewer.canvas.clientHeight;d=b.table.offsetHeight+b.title.offsetHeight+parseInt(b.scrollpanel.style.marginBottom);b.container.style.height=(d>c-180?c-180:d)+"px"})):(this.currentID=null,b.title.textContent="Object Properties")}};Autodesk.Viewing.Private.PropertyPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.Private.PropertyPanel.prototype.constructor=Autodesk.Viewing.Private.PropertyPanel;
Autodesk.Viewing.Private.PropertyPanel.prototype.uninitialize=function(){this.container.parentNode.removeChild(this.container);this.viewer=this.scrollpanel=this.tbody=this.table=this.viewer=this.title=this.closer=this.container=null};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.OptionSlider=function(a,b,c,e){function d(a){a.target!=g.stepperElement&&(g.stepperElement.value=g.sliderElement.value);g.fireChangeEvent()}var g=this;this.tbody=e;this.sliderRow=this.tbody.insertRow(-1);e=this.sliderRow.insertCell(0);e.style.fontStyle="italic";this.caption=document.createElement("div");this.caption.innerHTML=a+":";this.sliderElement=document.createElement("input");this.sliderElement.type="range";this.sliderElement.id=a+"_slider";this.sliderElement.min=b;
this.sliderElement.max=c;this.sliderElement.style.width="100%";e.appendChild(this.caption);e.appendChild(this.sliderElement);e=this.sliderRow.insertCell(1);this.stepperElement=document.createElement("input");this.stepperElement.type="number";this.stepperElement.id=a+"_stepper";this.stepperElement.min=b;this.stepperElement.max=c;this.stepperElement.step=1;this.stepperElement.style.resize="none";e.appendChild(this.stepperElement);e.style.width="32px";this.blockEvent=!1;this.stepperElement.addEventListener("change",
function(a){a.target!=g.sliderElement&&(g.sliderElement.value=g.stepperElement.value);g.fireChangeEvent()},!1);this.sliderElement.addEventListener("change",d,!1);this.sliderElement.addEventListener("input",d,!1)};Autodesk.Viewing.Private.OptionSlider.prototype=Object.create(THREE.EventDispatcher.prototype);
Autodesk.Viewing.Private.OptionSlider.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.value=this.sliderElement.value;var a=new CustomEvent("change",{detail:{target:this,value:this.sliderElement.value}});this.dispatchEvent(a)}};Autodesk.Viewing.Private.OptionSlider.prototype.setValue=function(a){this.blockEvent=!0;this.value=a;this.sliderElement.value=a;this.stepperElement.value=a;this.blockEvent=!1};
Autodesk.Viewing.Private.OptionSlider.prototype.setDisabled=function(a){this.sliderElement.disabled=a;this.stepperElement.disabled=a;this.caption.disabled=a};
Autodesk.Viewing.Private.OptionCheckbox=function(a,b,c){THREE.EventDispatcher.call(this.prototype);var e=this;this.tbody=b;this.sliderRow=this.tbody.insertRow(-1);b=this.sliderRow.insertCell(0);b.style.fontStyle="italic";this.caption=document.createElement("div");this.caption.innerHTML=a;b.appendChild(this.caption);b=this.sliderRow.insertCell(1);this.checkElement=document.createElement("input");this.checkElement.type="checkbox";this.checkElement.id=a+"_check";this.checkElement.checked=c;b.appendChild(this.checkElement);
this.blockEvent=!1;this.checked=c;this.checkElement.addEventListener("change",function(a){e.fireChangeEvent()},!1)};Autodesk.Viewing.Private.OptionCheckbox.prototype=Object.create(THREE.EventDispatcher.prototype);Autodesk.Viewing.Private.OptionCheckbox.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.checked=this.checkElement.checked;var a=new CustomEvent("change",{detail:{target:this,value:this.checkElement.checked}});this.dispatchEvent(a)}};
Autodesk.Viewing.Private.OptionCheckbox.prototype.setValue=function(a){this.blockEvent=!0;this.checked=a;this.checkElement.checked=a;this.blockEvent=!1};Autodesk.Viewing.Private.OptionCheckbox.prototype.setDisabled=function(a){this.checkElement.disabled=a;this.caption.disabled=a};
Autodesk.Viewing.Private.OptionDropDown=function(a,b,c,e){THREE.EventDispatcher.call(this.prototype);var d=this;this.tbody=b;this.sliderRow=this.tbody.insertRow(-1);b=this.sliderRow.insertCell(0);b.style.fontStyle="italic";this.caption=document.createElement("div");this.caption.innerHTML=a+":";b.appendChild(this.caption);b=this.sliderRow.insertCell(1);this.dropdownElement=document.createElement("select");this.dropdownElement.id=a+"_dropdown";for(a=0;a<c.length;a++){var g=document.createElement("option");
g.value=a;g.text=c[a];this.dropdownElement.add(g)}this.selectedIndex=this.dropdownElement.selectedIndex=e;b.appendChild(this.dropdownElement);this.blockEvent=!1;this.dropdownElement.addEventListener("change",function(a){d.fireChangeEvent()},!1)};Autodesk.Viewing.Private.OptionDropDown.prototype=Object.create(THREE.EventDispatcher.prototype);
Autodesk.Viewing.Private.OptionDropDown.prototype.setSelectedIndex=function(a){this.blockEvent=!0;stderr("selected "+a);this.selectedIndex=this.dropdownElement.selectedIndex=a;this.blockEvent=!1};Autodesk.Viewing.Private.OptionDropDown.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.selectedIndex=this.dropdownElement.selectedIndex;var a=new CustomEvent("change",{detail:{target:this,value:this.selectedIndex}});this.dispatchEvent(a)}};
Autodesk.Viewing.Private.OptionDropDown.prototype.setDisabled=function(a){this.dropdownElement.disabled=a;this.caption.disabled=a};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.ProgressBar=function(a){this.bg=document.createElement("div");this.bg.className="progressbg";this.fg=document.createElement("div");this.fg.className="progressfg";this.bg.appendChild(this.fg);a.appendChild(this.bg);this.widthScale=this.fg.clientWidth};
Autodesk.Viewing.Private.ProgressBar.prototype.setPercent=function(a){99<=a?this.bg.style.visibility="hidden":(this.bg.style.visibility="visible",this.fg.style.width=this.widthScale*a*0.01+"px")};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.DocumentStructurePanel=function(a){Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"DocumentStructurePanel","Document Structure Loading ...",{shadow:!1});var b=this;this.viewer=a;this.container.style.width="300px";this.baselist=document.createElement("ul");this.scrollpanel=this.createScrollContainer({left:!0,heightAdjustment:50});this.container.appendChild(this.scrollpanel);this.innercontainer=document.createElement("div");this.innercontainer.className="documentStructure";
this.scrollpanel.appendChild(this.innercontainer);this.innercontainer.appendChild(this.baselist);this.container.style.left="0px";this.container.style.top="4em";var c=this.viewer.getDimensions().height;this.container.style.height=(800<c-100?800:c-100)+"px";this.container.style.minHeight="100px";this.container.backgroundColor="rgba(0,0,0,0)";this.items={};a.getObjectTree(function(a){b.rootNode=a;b.treeLoaded(b.baselist,a)});this.container.style.display="none";a.container.appendChild(this.container);
this.lastKnownSelectionList=[];a.addEventListener(Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(a){b.setSelectedNodes(a.nodeArray)});a.addEventListener(Autodesk.Viewing.HIGHLIGHT_EVENT,function(a){b.setHighlightNode(a.dbNode)});a.addEventListener(Autodesk.Viewing.ISOLATE_EVENT,function(a){b.setIsolatedNodes(a.nodeIdArray)});a.addEventListener(Autodesk.Viewing.HIDE_EVENT,function(a){b.hideNodes(a.nodeIdArray)});a.addEventListener(Autodesk.Viewing.SHOW_EVENT,function(a){b.showNodes(a.nodeIdArray)})};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.Private.DocumentStructurePanel.prototype.constructor=Autodesk.Viewing.Private.DocumentStructurePanel;
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.uninitialize=function(){this.container&&(this.container.parentNode.removeChild(this.container),this.container=null);this.viewer=this.title=this.scrollpanel=this.rootNode=this.items=this.innercontainer=this.closer=this.baselist=null};Autodesk.Viewing.Private.DocumentStructurePanel.prototype.setClickBehavior=function(a){this.clickConfig=a};
function ctrlDown(a){var b=-1!==navigator.userAgent.search("Mac OS");return b&&a.metaKey||!b&&a.ctrlKey}Autodesk.Viewing.Private.DocumentStructurePanel.prototype.clickItem=function(a,b){var c="click";ctrlDown(a)&&(c+="Ctrl");a.shiftKey&&(c+="Shift");a.altKey&&(c+="Alt");this.clickConfig&&this.clickConfig[c]&&this.handleAction(this.clickConfig[c].onObject,b.data)};Autodesk.Viewing.Private.DocumentStructurePanel.prototype.doubleClickItem=function(a,b){this.handleAction(["focus"],b.data)};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.handleAction=function(a,b){for(var c in a)switch(a[c]){case "selectOnly":this.viewer.select([b.dbId]);break;case "deselectAll":this.viewer.select([]);break;case "selectToggle":this.viewer.toggleSelect(b.dbId);break;case "isolate":this.viewer.isolate(b);break;case "showAll":this.viewer.isolate(null);break;case "focus":this.viewer.impl.controls.fitToView();break;case "hide":this.viewer.hide(b);break;case "show":this.viewer.show(b);break;case "toggleVisibility":this.viewer.toggleVisibility(b)}};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.showContextMenu=function(a,b,c){var e=a.viewer.impl;this.viewer.show(c.data);-1===e.selector.findSelection(c.data)&&(ctrlDown(b)||this.viewer.select(c.data.dbId));return a.viewer.objectContextMenu.show(b)};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.setHighlightNode=function(a){if(this.lastHighlightNode){var b=this.lastKnownSelectionList.indexOf(this.lastHighlightNode),c=this.items[this.lastHighlightNode.dbId];setHighlighted(c,!1);setSelected(c,0<=b)}if(this.lastHighlightNode=a)b=this.lastKnownSelectionList.indexOf(a),c=this.items[a.dbId],setHighlighted(c,!0),setSelected(c,0<=b)};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.setSelectedNodes=function(a){this.clearExtraState();this.lastKnownSelectionList=a;this.appendExtraState(a)};Autodesk.Viewing.Private.DocumentStructurePanel.prototype.setIsolatedNodes=function(a){0<a.length?(this.setVisibleStateOnAll(!1),this.setVisibleStateOnNodes(a,!0)):this.setVisibleStateOnAll(!0)};Autodesk.Viewing.Private.DocumentStructurePanel.prototype.hideNodes=function(a){this.setVisibleStateOnNodes(a,!1)};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.showNodes=function(a){this.setVisibleStateOnNodes(a,!0)};function setHighlighted(a,b){b?Autodesk.Viewing.Private.addClass(a.header,"highlighted"):Autodesk.Viewing.Private.removeClass(a.header,"highlighted")}
function setSelected(a,b){b?(Autodesk.Viewing.Private.addClass(a.header,"selected"),Autodesk.Viewing.Private.addClass(a.childContainer,"selected")):(Autodesk.Viewing.Private.removeClass(a.header,"selected"),Autodesk.Viewing.Private.removeClass(a.childContainer,"selected"))}function setVisible(a,b){b?Autodesk.Viewing.Private.removeClass(a.header,"hidden"):Autodesk.Viewing.Private.addClass(a.header,"hidden")}
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.clearExtraState=function(){for(var a=0;a<this.lastKnownSelectionList.length;a++){var b=this.lastKnownSelectionList[a],c=this.items[b.dbId];c&&(setSelected(c,!1),setHighlighted(c,b===this.lastHighlightNode));for(b=b.parent;b;)this.items[b.dbId]&&Autodesk.Viewing.Private.removeClass(this.items[b.dbId].marker,"mselected"),b=b.parent}};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.setVisibleStateOnAll=function(a){for(var b in this.items){var c=this.items[b];c&&setVisible(c,a)}};Autodesk.Viewing.Private.DocumentStructurePanel.prototype.setVisibleStateOnNodes=function(a,b){for(var c=0;c<a.length;c++){var e=a[c],d=this.items[e.dbId];d&&(setVisible(d,b),e.children&&this.setVisibleStateOnNodes(e.children,b))}};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.appendExtraState=function(a){for(var b=0;b<a.length;b++){var c=a[b],e=this.items[c.dbId];e&&(setSelected(e,!0),setHighlighted(e,c===this.lastHighlightNode));for(c=c.parent;c;)this.items[c.dbId]&&Autodesk.Viewing.Private.addClass(this.items[c.dbId].marker,"mselected"),c=c.parent}};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.createItem=function(a,b){var c=this,e=b.children&&0<b.children.length,d=document.createElement("li");d.className="item";d.data=b;a.appendChild(d);var g=document.createElement("div");g.className="header";g.data=b;d.appendChild(g);d.header=g;d.marker=document.createElement("div");d.marker.className="marker";g.appendChild(d.marker);if(e){var f=document.createElement("input");f.type="button";f.className="toggleButtonMax";g.appendChild(f);d.toggleButton=
f;f.addEventListener("click",function(a){c.toggleExpand(d);a.stopPropagation();return!1},!0)}f=document.createElement("label");f.textContent=b.name;e||(f.style.paddingLeft="0px");g.appendChild(f);e&&(e=document.createElement("ul"),d.childContainer=e,d.childContainer.className="childContainer",d.appendChild(e));g.addEventListener("click",function(a){c.clickItem(a,d);return!1},!1);g.addEventListener("dblclick",function(a){c.doubleClickItem(a,d);return!1},!1);g.addEventListener("contextmenu",function(a){c.showContextMenu(c,
a,d);return!1},!1);g.addEventListener("mouseover",function(a){c.viewer.fireEvent({type:Autodesk.Viewing.HIGHLIGHT_EVENT,dbNode:d.data})});g.addEventListener("mouseout",function(a){d.data===c.lastHighlightNode&&c.viewer.fireEvent({type:Autodesk.Viewing.HIGHLIGHT_EVENT,dbNode:void 0})});setVisible(d,Autodesk.Viewing.Private.VisibilityManager.isVisible(b));this.items[b.dbId]=d};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.createChildren=function(a,b){for(var c=a.children?a.children.length:0,e=0;e<c;e++)this.createItem(b,a.children[e])};Autodesk.Viewing.Private.DocumentStructurePanel.prototype.toggleExpand=function(a){a.expanded?this.minimize(a):this.expand(a)};Autodesk.Viewing.Private.DocumentStructurePanel.prototype.expand=function(a){a.expanded||(this.createChildren(a.data,a.childContainer),a.toggleButton.className="toggleButtonMin",a.expanded=!0,this.setSelectedNodes(this.lastKnownSelectionList))};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.minimize=function(a){a.childContainer.textContent="";a.toggleButton.className="toggleButtonMax";a.expanded=!1};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.setTitleNode=function(a){var b=this.viewer.config.defaultModelStructureTitle;b||(b=a.name);b||(b="Model Structure");this.title.textContent=b;this.title.data=a;var c=this;this.title.addEventListener("click",function(a){c.clickItem(a,c.title);return!1},!1);this.title.addEventListener("dblclick",function(a){c.doubleClickItem(a,c.title);return!1},!1);this.items[a.dbId]=this.title};
Autodesk.Viewing.Private.DocumentStructurePanel.prototype.treeLoaded=function(a,b){this.setTitleNode(b);this.createChildren(b,a)};"undefined"!==typeof window&&function(a,b,c){function e(b){if(a.event&&a.event.contentOverflow!==c)return{x:a.event.offsetX,y:a.event.offsetY};if(b.offsetX!==c&&b.offsetY!==c)return{x:b.offsetX,y:b.offsetY};var d=b.target.parentNode.parentNode;return{x:b.layerX-d.offsetLeft,y:b.layerY-d.offsetTop}}function d(a,c,d){a=b.createElementNS(v,a);for(var e in c)a.setAttribute(e,c[e]);"[object Array]"!=Object.prototype.toString.call(d)&&(d=[d]);c=0;for(e=d[0]&&d.length||0;c<e;c++)a.appendChild(d[c]);return a}
function g(a){var b,c,d,e,f=a.h%360/60;e=a.v*a.s;d=e*(1-Math.abs(f%2-1));b=c=a=a.v-e;f=~~f;b+=[e,d,0,0,d,e][f];c+=[d,e,e,d,0,0][f];a+=[0,0,d,e,e,d][f];d=Math.floor(255*b);c=Math.floor(255*c);a=Math.floor(255*a);return{r:d,g:c,b:a,hex:"#"+(16777216|a|c<<8|d<<16).toString(16).slice(1)}}function f(a){var b=a.r,c=a.g,d=a.b;if(1<a.r||1<a.g||1<a.b)b/=255,c/=255,d/=255;var e;a=Math.max(b,c,d);e=a-Math.min(b,c,d);b=(0==e?0:a==b?(c-d)/e+(c<d?6:0):a==c?(d-b)/e+2:(b-c)/e+4)%6*60;return{h:b,s:0==e?0:e/a,v:a}}
function h(b,d,f){return function(h){h=h||a.event;h=e(h);b.h=h.y/d.offsetHeight*360+u;b.s=b.v=1;var k=g({h:b.h,s:1,v:1});f.style.backgroundColor=k.hex;b.callback&&b.callback(k.hex,{h:b.h-u,s:b.s,v:b.v},{r:k.r,g:k.g,b:k.b},c,h)}}function k(b,c){return function(d){d=d||a.event;d=e(d);var f=c.offsetHeight;b.s=d.x/c.offsetWidth;b.v=(f-d.y)/f;f=g(b);b.callback&&b.callback(f.hex,{h:b.h-u,s:b.s,v:b.v},{r:f.r,g:f.g,b:f.b},d)}}function l(a,b,c){if(!(this instanceof l))return new l(a,b,c);this.h=0;this.v=this.s=
1;if(c)this.callback=c,this.pickerElement=b,this.slideElement=a;else{a.innerHTML=w;this.slideElement=a.getElementsByClassName("slide")[0];this.pickerElement=a.getElementsByClassName("picker")[0];var d=a.getElementsByClassName("slide-indicator")[0],e=a.getElementsByClassName("picker-indicator")[0];l.fixIndicators(d,e);this.callback=function(a,c,f,g,h){l.positionIndicators(d,e,h,g);b(a,c,f)}}if("SVG"==p){a=s.cloneNode(!0);c=t.cloneNode(!0);var f=a.getElementById("gradient-hsv"),g=a.getElementsByTagName("rect")[0];
f.id="gradient-hsv-"+z;g.setAttribute("fill","url(#"+f.id+")");f=[c.getElementById("gradient-black"),c.getElementById("gradient-white")];g=c.getElementsByTagName("rect");f[0].id="gradient-black-"+z;f[1].id="gradient-white-"+z;g[0].setAttribute("fill","url(#"+f[1].id+")");g[1].setAttribute("fill","url(#"+f[0].id+")");this.slideElement.appendChild(a);this.pickerElement.appendChild(c);z++}else this.slideElement.innerHTML=s,this.pickerElement.innerHTML=t;m(this.slideElement,"click",h(this,this.slideElement,
this.pickerElement));m(this.pickerElement,"click",k(this,this.pickerElement));n(this,this.slideElement,h(this,this.slideElement,this.pickerElement));n(this,this.pickerElement,k(this,this.pickerElement))}function m(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,!1)}function n(a,b,c){var d=!1;m(b,"mousedown",function(a){d=!0});m(b,"mouseup",function(a){d=!1});m(b,"mouseout",function(a){d=!1});m(b,"mousemove",function(a){d&&c(a)})}function r(a,b,c,d){a.h=b.h%
360;a.s=b.s;a.v=b.v;b=g(a);var e={y:a.h*a.slideElement.offsetHeight/360,x:0},f=a.pickerElement.offsetHeight,f={x:a.s*a.pickerElement.offsetWidth,y:f-a.v*f};a.pickerElement.style.backgroundColor=g({h:a.h,s:1,v:1}).hex;a.callback&&a.callback(d||b.hex,{h:a.h,s:a.s,v:a.v},c||{r:b.r,g:b.g,b:b.b},f,e);return a}var p=a.SVGAngle||b.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",t,s,u=15,v="http://www.w3.org/2000/svg",w='<div class="picker-wrapper"><div class="picker"></div><div class="picker-indicator"></div></div><div class="slide-wrapper"><div class="slide"></div><div class="slide-indicator"></div></div>';
"SVG"==p?(s=d("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[d("defs",{},d("linearGradient",{id:"gradient-hsv",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[d("stop",{offset:"0%","stop-color":"#FF0000","stop-opacity":"1"}),d("stop",{offset:"13%","stop-color":"#FF00FF","stop-opacity":"1"}),d("stop",{offset:"25%","stop-color":"#8000FF","stop-opacity":"1"}),d("stop",{offset:"38%","stop-color":"#0040FF","stop-opacity":"1"}),d("stop",{offset:"50%","stop-color":"#00FFFF","stop-opacity":"1"}),
d("stop",{offset:"63%","stop-color":"#00FF40","stop-opacity":"1"}),d("stop",{offset:"75%","stop-color":"#0BED00","stop-opacity":"1"}),d("stop",{offset:"88%","stop-color":"#FFFF00","stop-opacity":"1"}),d("stop",{offset:"100%","stop-color":"#FF0000","stop-opacity":"1"})])),d("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-hsv)"})]),t=d("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[d("defs",{},[d("linearGradient",{id:"gradient-black",x1:"0%",
y1:"100%",x2:"0%",y2:"0%"},[d("stop",{offset:"0%","stop-color":"#000000","stop-opacity":"1"}),d("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})]),d("linearGradient",{id:"gradient-white",x1:"0%",y1:"100%",x2:"100%",y2:"100%"},[d("stop",{offset:"0%","stop-color":"#FFFFFF","stop-opacity":"1"}),d("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})])]),d("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-white)"}),d("rect",{x:"0",y:"0",width:"100%",height:"100%",
fill:"url(#gradient-black)"})])):"VML"==p&&(s='<DIV style="position: relative; width: 100%; height: 100%"><v:rect style="position: absolute; top: 0; left: 0; width: 100%; height: 100%" stroked="f" filled="t"><v:fill type="gradient" method="none" angle="0" color="red" color2="red" colors="8519f fuchsia;.25 #8000ff;24903f #0040ff;.5 aqua;41287f #00ff40;.75 #0bed00;57671f yellow"></v:fill></v:rect></DIV>',t='<DIV style="position: relative; width: 100%; height: 100%"><v:rect style="position: absolute; left: -1px; top: -1px; width: 101%; height: 101%" stroked="f" filled="t"><v:fill type="gradient" method="none" angle="270" color="#FFFFFF" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill></v:rect><v:rect style="position: absolute; left: 0px; top: 0px; width: 100%; height: 101%" stroked="f" filled="t"><v:fill type="gradient" method="none" angle="0" color="#000000" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill></v:rect></DIV>',
b.namespaces.v||b.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"));var z=0;l.hsv2rgb=function(a){a=g(a);delete a.hex;return a};l.hsv2hex=function(a){return g(a).hex};l.rgb2hsv=f;l.rgb2hex=function(a){return g(f(a)).hex};l.hex2hsv=function(a){return f(l.hex2rgb(a))};l.hex2rgb=function(a){return{r:parseInt(a.substr(1,2),16),g:parseInt(a.substr(3,2),16),b:parseInt(a.substr(5,2),16)}};l.prototype.setHsv=function(a){return r(this,a)};l.prototype.setRgb=function(a){return r(this,f(a),
a)};l.prototype.setHex=function(a){return r(this,l.hex2hsv(a),c,a)};l.positionIndicators=function(a,b,c,d){c&&(b.style.left="auto",b.style.right="0px",b.style.top="0px",a.style.top=c.y-a.offsetHeight/2+"px");d&&(b.style.top=d.y-b.offsetHeight/2+"px",b.style.left=d.x-b.offsetWidth/2+"px")};l.fixIndicators=function(a,b){b.style.pointerEvents="none";a.style.pointerEvents="none"};a.ColorPicker=l}(window,window.document);AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.ContextMenu=function(a){this.viewer=a;this.menus=[];this.open=!1;this.itemWidth=100;this.itemHeight=25};Autodesk.Viewing.Private.ContextMenu.prototype.constructor=Autodesk.Viewing.Private.ContextMenu;
Autodesk.Viewing.Private.ContextMenu.prototype.show=function(a,b){var c=this.viewer.api.container.getBoundingClientRect(),e=a.clientX-c.left,c=a.clientY-c.top;if(!1==this.open){var d=this;this.showMenu(b,0,e,c);this.open=!0;this.hideEventListener=function(a){"menuItem"!=a.target.className&&d.hide(a)};document.body.addEventListener("mousedown",this.hideEventListener,!0)}};
Autodesk.Viewing.Private.ContextMenu.prototype.showMenu=function(a,b,c,e){0>c&&(c=0);0>e&&(e=0);c+this.itemWidth+10>this.viewer.canvas.width&&(c=this.viewer.canvas.width-this.itemWidth-10);e+Object.keys(a).length*this.itemHeight>this.viewer.canvas.height&&(e=this.viewer.canvas.height-Object.keys(a).length*this.itemHeight);var d=document.createElement("div");d.width=this.itemWidth;d.className="menu";d.style.top=e+"px";d.style.left=c+"px";d.style.zIndex=10;this.viewer.api.container.appendChild(d);var g=
0,f;for(f in a){var h=this.createMenuItem(d,f,g),g=g+this.itemHeight;"object"==typeof a[f]?this.addSubMenuClickToMenuItem(h,b,a[f],c+this.itemWidth+10,e+g):"function"==typeof a[f]?this.addCallbackToMenuItem(h,a[f]):console.warn("Invalid option",a,f)}d.style.height=g+"px";null!=this.menus[b]&&this.menus[b].parentNode.removeChild(this.menus[b]);this.menus[b]=d};
Autodesk.Viewing.Private.ContextMenu.prototype.createMenuItem=function(a,b,c){var e=document.createElement("div");e.className="menuItem";e.innerHTML=b;e.style.top=c+"px";a.appendChild(e);return e};Autodesk.Viewing.Private.ContextMenu.prototype.addSubMenuClickToMenuItem=function(a,b,c,e,d){var g=this;a.addEventListener("click",function(){g.showMenu(c,b+1,e,d)})};
Autodesk.Viewing.Private.ContextMenu.prototype.addCallbackToMenuItem=function(a,b){var c=this;a.addEventListener("click",function(a){c.hide();b();a.preventDefault();return!1})};Autodesk.Viewing.Private.ContextMenu.prototype.hide=function(){if(this.open){for(var a=0;a<this.menus.length;++a)this.menus[a]&&this.menus[a].parentNode.removeChild(this.menus[a]);this.menus=[];this.open=!1;document.body.removeEventListener("mousedown",this.hideEventListener);return!0}return!1};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.ObjectContextMenu=function(a){this.viewerImpl=a;this.contextMenu=new Autodesk.Viewing.Private.ContextMenu(a)};Autodesk.Viewing.Private.ObjectContextMenu.prototype.constructor=Autodesk.Viewing.Private.ObjectContextMenu;
Autodesk.Viewing.Private.ObjectContextMenu.prototype.show=function(a){for(var b=this,c={},e=b.viewerImpl.selector.selectedObjects.length,d=!1,g=!1,f=0;f<e&&(Autodesk.Viewing.Private.VisibilityManager.isVisible(b.viewerImpl.selector.selectedObjects[f])?d=!0:g=!0,!d||!g);f++);0<e&&(c.Isolate=function(){var a=b.viewerImpl.selector.getSelection();b.viewerImpl.selector.clearSelection();b.viewerImpl.visibilityManager.isolateMultiple(a)},d&&(c["Hide Selected"]=function(){var a=b.viewerImpl.selector.getSelection();
b.viewerImpl.selector.clearSelection();b.viewerImpl.visibilityManager.hideMultiple(a)}),g&&(c["Show Selected"]=function(){var a=b.viewerImpl.selector.getSelection();b.viewerImpl.selector.clearSelection();b.viewerImpl.visibilityManager.showMultiple(a)}));c["Show All"]=function(){b.viewerImpl.visibilityManager.isolate(null)};0<e&&(c.Focus=function(){b.viewerImpl.controls.fitToView()});this.contextMenu.show(a,c);return!1};Autodesk.Viewing.Private.ObjectContextMenu.prototype.hide=function(){return this.contextMenu.hide()};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.RenderOptionsPanel=function(a){var b=this;this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"RenderOptionsPanel","Rendering Options",{shadow:!0});this.table=document.createElement("table");this.table.className="tftable";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.container.appendChild(this.table);this.bgSelect=new Autodesk.Viewing.Private.OptionDropDown("Background Color",this.tbody,Autodesk.Viewing.Private.RenderOptionsPanel.color_list,
-1);this.updateBgColorIndex();this.bgSelect.addEventListener("change",function(c){c=Autodesk.Viewing.Private.RenderOptionsPanel.color_def[b.bgSelect.selectedIndex];a.updateSetting("backgroundColorPreset",JSON.stringify(c));a.impl.setClearColors(c[0],c[1],c[2],c[3],c[4],c[5])});this.saoToggle=new Autodesk.Viewing.Private.OptionCheckbox("AO Enabled:",this.tbody,!0);this.saoToggle.addEventListener("change",function(c){a.setQualityLevel(b.saoToggle.checked,a.impl.renderer.settings.antialias)});this.saoRadius=
new Autodesk.Viewing.Private.OptionSlider("AO Radius",0,300,this.tbody);this.saoRadius.setValue(100);this.saoRadius.addEventListener("change",function(c){a.impl.renderer.setAOOptions(b.saoRadius.value,b.saoIntensity.value);a.impl.renderer.composeFinalFrame(!1)});this.saoIntensity=new Autodesk.Viewing.Private.OptionSlider("AO Intensity",0,300,this.tbody);this.saoIntensity.setValue(75);this.saoIntensity.addEventListener("change",function(c){a.impl.renderer.setAOOptions(b.saoRadius.value,b.saoIntensity.value);
a.impl.renderer.composeFinalFrame(!1)});for(var c=[],e=0;e<a.impl.LightPresets.length;e++)c.push(a.impl.LightPresets[e].name);this.envSelect=new Autodesk.Viewing.Private.OptionDropDown("Environment Light",this.tbody,c,a.impl.currentLightPreset);this.envSelect.addEventListener("change",function(c){c=b.envSelect.selectedIndex;a.updateSetting("lightPreset",c);a.impl.setLightPreset(c)});c=a.impl.renderer.getToneMapMethod();this.toneMapMethod=new Autodesk.Viewing.Private.OptionDropDown("Tonemap method",
this.tbody,"None Linear Reinhard Filmic Exp Canon".split(" "),c);this.toneMapMethod.addEventListener("change",function(c){c=a.impl.renderer.getToneMapMethod();var e=b.toneMapMethod.selectedIndex;a.impl.renderer.setTonemapMethod(e);if(0==e&&0!=c||0==c&&0!=e)c=0==e?1:1.7,b.gamma.setValue(c),a.impl.renderer.setGamma(c);a.impl.fireRenderOptionChanged();a.impl.needsClear=!0});this.gamma=new Autodesk.Viewing.Private.OptionSlider("Gamma",0,5,this.tbody);this.gamma.setValue(a.impl.renderer.getGamma());this.gamma.sliderElement.step=
this.gamma.stepperElement.step=0.05;this.gamma.addEventListener("change",function(c){a.impl.renderer.setGamma(b.gamma.value);a.impl.renderer.composeFinalFrame(!1)});this.gamma.setDisabled(0==c);this.exposureBias=new Autodesk.Viewing.Private.OptionSlider("Exposure bias",-10,10,this.tbody);this.exposureBias.setValue(a.impl.renderer.getExposureBias());this.exposureBias.sliderElement.step=this.exposureBias.stepperElement.step=0.1;this.exposureBias.addEventListener("change",function(c){a.impl.renderer.setExposureBias(b.exposureBias.value);
a.impl.renderer.composeFinalFrame(!1)});this.exposureBias.setDisabled(0==c);this.fovAngle=new Autodesk.Viewing.Private.OptionSlider("Field of View (degrees)",6.88,100,this.tbody);this.fovAngle.setValue(a.getFOV());this.fovAngle.addEventListener("change",function(c){a.setFOV(parseFloat(b.fovAngle.value))});this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(c){c=parseFloat(b.fovAngle.value);var e=a.getFOV();c!=e&&b.fovAngle.setValue(e)});this.container.style.width="300px";this.container.style.top=
"360px";this.container.style.left="220px";this.container.style.height="420px";this.container.dock=!0;this.viewer.addEventListener(Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,function(a){b.syncUI()})};Autodesk.Viewing.Private.RenderOptionsPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.Private.RenderOptionsPanel.prototype.constructor=Autodesk.Viewing.Private.RenderOptionsPanel;
Autodesk.Viewing.Private.RenderOptionsPanel.color_list=["Grey","Blue (light)","Blue (dark)","Custom"];Autodesk.Viewing.Private.RenderOptionsPanel.color_def=[[230,230,230,150,150,150],[200,233,255,100,116,127],[41,76,120,1,2,3],[0,0,0,0,0,0]];
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.updateBgColorIndex=function(){for(var a=this.viewer.impl.clearColorTop,b=this.viewer.impl.clearColorBottom,a=[255*a.x|0,255*a.y|0,255*a.z|0,255*b.x|0,255*b.y|0,255*b.z|0],c=Autodesk.Viewing.Private.RenderOptionsPanel.color_def,b=-1,e=0;e<c.length-1;e++){var d;for(d=0;6>d&&c[e][d]==a[d];d++);if(6==d){b=e;break}}if(-1==b)for(b=c.length-1,c=c[c.length-1],e=0;6>e;e++)c[e]=a[e];this.bgSelect.setSelectedIndex(b)};
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.syncUI=function(){var a=this.viewer.impl;this.whiteScale&&this.whiteScale.setValue(a.renderer.getWhiteScale());this.exposureBias.setValue(a.renderer.getExposureBias());this.gamma.setValue(a.renderer.getGamma());this.updateBgColorIndex();var b=a.renderer.getToneMapMethod();this.toneMapMethod.setSelectedIndex(b);this.envSelect.setSelectedIndex(a.currentLightPreset);this.gamma.setDisabled(0==b);this.exposureBias.setDisabled(0==b);this.saoToggle.setValue(a.renderer.settings.sao);
this.saoRadius.setDisabled(!a.renderer.settings.sao);this.saoIntensity.setDisabled(!a.renderer.settings.sao)};Autodesk.Viewing.Private.RenderOptionsPanel.prototype.uninitialize=function(){this.container.parentNode.removeChild(this.container);this.viewer=this.fovAngle=this.whiteScale=this.exposureBias=this.gamma=this.toneMapMethod=this.envSelect=this.saoIntensity=this.saoRadius=this.saoToggle=this.bgSelect=this.tbody=this.table=this.viewer=this.title=this.closer=this.container=null};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.LayersPanel=function(a){var b=this;this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"LayersPanel","Layer Manager",{shadow:!0});this.table=document.createElement("table");this.table.className="tftable";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.scrollpanel=this.createScrollContainer({heightAdjustment:50});this.container.appendChild(this.scrollpanel);this.scrollpanel.appendChild(this.table);this.container.style.width=
"300px";this.container.style.top="180px";this.container.style.left="220px";this.container.style.height="460px";this.container.dock=!0;this.container.style.display="none";this.viewer.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,function(){b.syncUI()})};Autodesk.Viewing.Private.LayersPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.Private.LayersPanel.prototype.constructor=Autodesk.Viewing.Private.LayersPanel;
Autodesk.Viewing.Private.LayersPanel.prototype.syncUI=function(){this.tbody.innerHTML="";if(this.viewer.model&&this.viewer.model){this.layerCheckboxes=[];var a=this.viewer.model.getLayersList();if(a)for(var b=this,c=0;c<a.length;c++){var e=this.layerCheckboxes[c]=new Autodesk.Viewing.Private.OptionCheckbox(a[c].name||"Layer "+a[c].index,this.tbody,!0);e.layer=a[c].index;e.addEventListener("change",function(a){b.viewer.impl.toggleLayerVisibility(a.detail.target.layer,a.detail.target.checked)},!1)}}};
Autodesk.Viewing.Private.LayersPanel.prototype.uninitialize=function(){this.container.parentNode.removeChild(this.container);this.viewer=this.scrollpanel=this.tbody=this.table=this.viewer=this.title=this.closer=this.container=null};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.AlertBox=function(){};Autodesk.Viewing.Private.AlertBox.instances=[];
Autodesk.Viewing.Private.AlertBox.displayError=function(a,b,c,e,d){var g=document.createElement("div");g.className="alertBox error";a.appendChild(g);e||(e=RESOURCE_ROOT+"icons/error_item_not_found.png");var f=document.createElement("img");f.className="alertBoxImage";f.src=e;g.appendChild(f);e=document.createElement("div");e.className="alertBoxMsg";g.appendChild(e);c||(c="Error Occurred");f=document.createElement("div");f.className="alertBoxTitle";f.textContent=c;e.appendChild(f);c=document.createElement("div");
c.className="alertBoxText";c.textContent=b;e.appendChild(c);d&&(b=document.createElement("div"),b.className="alertBoxContent",b.appendChild(d),e.appendChild(b));d=document.createElement("div");d.className="alertBoxOK";d.textContent="OK";var h={alertBox:g,container:a};d.addEventListener("click",function(b){g.style.visibility="hidden";a.removeChild(g);Autodesk.Viewing.Private.AlertBox.instances.splice(Autodesk.Viewing.Private.AlertBox.instances.indexOf(h),1)});g.appendChild(d);g.style.visibility="visible";
Autodesk.Viewing.Private.AlertBox.instances.push(h)};Autodesk.Viewing.Private.AlertBox.dismiss=function(){if(0<Autodesk.Viewing.Private.AlertBox.instances.length){var a=Autodesk.Viewing.Private.AlertBox.instances.pop();a.alertBox.style.visibility="hidden";a.container.removeChild(a.alertBox);return!0}return!1};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.TreeDelegate=function(){};Autodesk.Viewing.Private.TreeDelegate.prototype.constructor=Autodesk.Viewing.Private.TreeDelegate;Autodesk.Viewing.Private.TreeDelegate.prototype.isTreeNodeGroup=function(a,b){throw"isGroup is not implemented.";};Autodesk.Viewing.Private.TreeDelegate.prototype.getTreeNodeId=function(a){throw"getId is not implemented.";};Autodesk.Viewing.Private.TreeDelegate.prototype.getTreeNodeLabel=function(a){return a.name};
Autodesk.Viewing.Private.TreeDelegate.prototype.shouldCreateTreeNode=function(a){return!0};Autodesk.Viewing.Private.TreeDelegate.prototype.onTreeNodeClick=function(a,b,c){};Autodesk.Viewing.Private.TreeDelegate.prototype.onTreeNodeHover=function(a,b,c){};Autodesk.Viewing.Private.TreeDelegate.prototype.getTreeNodeClass=function(a){return""};
Autodesk.Viewing.Private.Tree=function(a,b,c,e){this.myDelegate=a;this.mySelectedIds=[];this.myParentContainerId=c;this.myRootContainerId=c+"-treeview";this.myInternalIds=[];this.myInternalIdCounter=0;this.jQuery=(this.myOptions=e)&&e.jQuery?e.jQuery:$;this.jQuery('<div id="'+this.myRootContainerId+'" class="treeview"></div>').appendTo("#"+c);this.createElement(b,this.myRootContainerId)};Autodesk.Viewing.Private.Tree.prototype.constructor=Autodesk.Viewing.Private.Tree;
Autodesk.Viewing.Private.Tree.prototype.show=function(a){a?this.jQuery("#"+this.myRootContainerId).fadeIn():this.jQuery("#"+this.myRootContainerId).hide()};Autodesk.Viewing.Private.Tree.prototype.getRootContainerId=function(){return this.myRootContainerId};Autodesk.Viewing.Private.Tree.prototype.delegate=function(){return this.myDelegate};Autodesk.Viewing.Private.Tree.prototype.isCollapsed=function(a){a="#"+this.getInternalId(a,!1);return this.jQuery(a).hasClass("collapsed")};
Autodesk.Viewing.Private.Tree.prototype.setCollapsed=function(a,b){var c="#"+this.getInternalId(a,!1);if(b){if(!this.jQuery(c).hasClass("collapsed"))return this.jQuery(c).addClass("collapsed"),this.jQuery(c).removeClass("expanded"),!0}else if(this.jQuery(c).hasClass("collapsed"))return this.jQuery(c).removeClass("collapsed"),this.jQuery(c).addClass("expanded"),!0;return!1};
Autodesk.Viewing.Private.Tree.prototype.addToSelection=function(a){for(var b in a){var c=a[b],e;e=c;-1==this.mySelectedIds.indexOf(e)?(this.mySelectedIds.push(e),e=!0):e=!1;e&&(c=this.getInternalId(c,!1),this.jQuery("#"+c).addClass("selected"))}};Autodesk.Viewing.Private.Tree.prototype.removeFromSelection=function(a){for(var b in a){var c=a[b],e;e=this.mySelectedIds.indexOf(c);-1!=e?(this.mySelectedIds.splice(e,1),e=!0):e=!1;e&&(c=this.getInternalId(c,!1),this.jQuery("#"+c).removeClass("selected"))}};
Autodesk.Viewing.Private.Tree.prototype.setSelection=function(a){this.removeFromSelection(this.mySelectedIds);this.addToSelection(a);return this.mySelectedIds};Autodesk.Viewing.Private.Tree.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)};Autodesk.Viewing.Private.Tree.prototype.isSelected=function(a){a=this.getInternalId(a,!1);return this.jQuery("#"+a).hasClass("selected")};
Autodesk.Viewing.Private.Tree.prototype.getInternalId=function(a,b){void 0===this.myInternalIds[a]&&b&&(this.myInternalIds[a]=this.myRootContainerId+"-node-"+this.myInternalIdCounter,this.myInternalIdCounter++);return this.myInternalIds[a]};
Autodesk.Viewing.Private.Tree.prototype.createElement=function(a,b){if(a){var c=this;if(this.myDelegate.shouldCreateTreeNode(a)){var e=c.myDelegate.getTreeNodeId(a),e=this.getInternalId(e,!0),d="#"+e;if(c.myDelegate.isTreeNodeGroup(a)){this.jQuery('<group id="'+e+'" class="expanded"></group>').appendTo(this.jQuery("#"+b));var g="#header"+e;this.jQuery('<header id="header'+e+'"></header>').appendTo(this.jQuery(d)).click(function(b){c.myDelegate.onTreeNodeClick(c,a,b)}).hover(function(b){c.myDelegate.onTreeNodeHover(c,
a,b)});this.jQuery("<icon></icon>").appendTo(this.jQuery(g)).click(function(a){a.stopPropagation();c.jQuery(d).toggleClass("collapsed");c.jQuery(d).toggleClass("expanded")});this.jQuery("<label>"+c.myDelegate.getTreeNodeLabel(a)+"</label>").appendTo(this.jQuery(g));for(var g=a.children?a.children.length:0,f=0;f<g;++f)c.createElement(a.children[f],e)}else this.jQuery('<leaf id="'+e+'"></leaf>').appendTo(this.jQuery("#"+b)),g="#header"+e,this.jQuery('<header id="header'+e+'"></header>').appendTo(this.jQuery(d)).click(function(b){c.myDelegate.onTreeNodeClick(c,
a,b)}).hover(function(b){c.myDelegate.onTreeNodeHover(c,a,b)}),this.jQuery("<icon></icon>").appendTo(this.jQuery(g)),this.jQuery("<label>"+c.myDelegate.getTreeNodeLabel(a)+"</label>").appendTo(this.jQuery(g));this.jQuery(d).addClass(c.myDelegate.getTreeNodeClass(a))}}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.BrowserDelegate=function(){};Autodesk.Viewing.Private.BrowserDelegate.prototype.constructor=Autodesk.Viewing.Private.BrowserDelegate;Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeId=function(a){throw"getId is not implemented.";};Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeLabel=function(a){return a.name};Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeClass=function(a){return""};
Autodesk.Viewing.Private.BrowserDelegate.prototype.hasThumbnail=function(a){return!1};Autodesk.Viewing.Private.BrowserDelegate.prototype.getThumbnail=function(a){return null};Autodesk.Viewing.Private.BrowserDelegate.prototype.onNodeClick=function(a,b,c){};Autodesk.Viewing.Private.BrowserDelegate.prototype.onNodeHover=function(a,b,c){};Autodesk.Viewing.Private.BrowserDelegate.prototype.hasContent=function(a){return!1};Autodesk.Viewing.Private.BrowserDelegate.prototype.addContent=function(a,b){};
Autodesk.Viewing.Private.Browser=function(a,b,c,e){this.myDelegate=a;this.mySelectedIds=[];this.myParentContainderId=c;this.myRootContainerId=c+"-browserview";this.myInternalIds=[];this.myInternalIdCounter=0;this.jQuery=(this.myOptions=e)&&e.jQuery?e.jQuery:$;this.jQuery('<div id="'+this.myRootContainerId+'" class="browserview"></div>').appendTo("#"+this.myParentContainderId);this.createElements(b,this.myRootContainerId)};Autodesk.Viewing.Private.Browser.prototype.constructor=Autodesk.Viewing.Private.Browser;
Autodesk.Viewing.Private.Browser.prototype.show=function(a){a?this.jQuery("#"+this.myRootContainerId).fadeIn():this.jQuery("#"+this.myRootContainerId).hide()};Autodesk.Viewing.Private.Browser.prototype.getRootContainerId=function(){return this.myRootContainerId};Autodesk.Viewing.Private.Browser.prototype.delegate=function(){return this.myDelegate};
Autodesk.Viewing.Private.Browser.prototype.addToSelection=function(a){for(var b in a){var c=a[b],e;e=c;-1==this.mySelectedIds.indexOf(e)?(this.mySelectedIds.push(e),e=!0):e=!1;e&&(c=this.getInternalId(c,!1),this.jQuery("#"+c).addClass("selected"))}};Autodesk.Viewing.Private.Browser.prototype.removeFromSelection=function(a){for(var b in a){var c=a[b],e;e=this.mySelectedIds.indexOf(c);-1!=e?(this.mySelectedIds.splice(e,1),e=!0):e=!1;e&&(c=this.getInternalId(c,!1),this.jQuery("#"+c).removeClass("selected"))}};
Autodesk.Viewing.Private.Browser.prototype.setSelection=function(a){this.removeFromSelection(this.mySelectedIds);this.addToSelection(a);return this.mySelectedIds};Autodesk.Viewing.Private.Browser.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)};Autodesk.Viewing.Private.Browser.prototype.getInternalId=function(a,b){void 0===this.myInternalIds[a]&&b&&(this.myInternalIds[a]=this.myRootContainerId+"-node-"+this.myInternalIdCounter,this.myInternalIdCounter++);return this.myInternalIds[a]};
Autodesk.Viewing.Private.Browser.prototype.createElements=function(a,b){if(a)for(var c=0;c<a.length;c++)this.createElement(a[c],b)};
Autodesk.Viewing.Private.Browser.prototype.createElement=function(a,b){var c=this,e=c.myDelegate.getNodeId(a),e=c.getInternalId(e,!0),d="#"+e;this.jQuery('<item id="'+e+'"></item>').appendTo(this.jQuery("#"+b)).hover(function(){c.myDelegate.onNodeHover(c,a)});this.jQuery("#"+e).click(function(b){c.jQuery(".flipped").removeClass("flipped");c.myDelegate.onNodeClick(c,a,b)});var g=this.jQuery('<div id="card'+e+'" class="card"></div>');g.appendTo(this.jQuery(d));var f=this.jQuery('<div class="browserElement"></div>');
f.appendTo(g);g=c.myDelegate.getNodeLabel(a);this.jQuery("<label>"+g+"</label>").appendTo(f).click(function(b){c.myDelegate.onNodeClick(c,a,b)});(g=c.myDelegate.getThumbnail(a))&&this.jQuery('<img class="thumb" src="'+g+'" ></img>').appendTo(f).click(function(b){c.myDelegate.onNodeClick(c,a,b)});c.myDelegate.hasContent(a)&&c.myDelegate.addContent(a,e);this.jQuery(d).addClass(c.myDelegate.getNodeClass(a))};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.ErrorInfoData={1:{img:"icons/error_reload_in_viewer.png",header:"Oops",text:"Sorry. We seem to have some technical difficulties and couldn't complete your request.",content:"<ul><li>Try loading the item again.</li><li>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</li></ul>"},2:{img:"icons/error_unsupported_file_type.png",header:"Oops",text:"Sorry. The item you are trying to view was not processed completely.",content:"<ul><li>Try loading the item again.</li><li>Please upload the file again to see if that fixes the issue.</li></ul>"},
3:{img:"icons/error_reload_in_viewer.png",header:"Oops",text:"Sorry. We seem to have some technical difficulties and couldn't complete your request.",content:"<ul><li>Try loading the item again.</li><li>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</li></ul>"},4:{img:"icons/error_unlock_upload.png",header:"No access",text:"Sorry. You don\u2019t have the required privileges to access this item.",content:"<ul><li>Please contact the author.</li></ul>"},
5:{img:"icons/error_item_not_found.png",header:"Oops",text:"Sorry. We can\u2019t display the item you are looking for. It may not have been processed yet. It may have been moved, deleted, or you may be using a corrupt file or unsupported file format.",content:'<ul><li>Try loading the item again.</li><li>Try uploading the file again to see if that fixes the issue.</li><li><a href="http://help.autodesk.com/view/ADSK360/ENU/?guid=GUID-488804D0-B0B0-4413-8741-4F5EE0FACC4A" target="_blank">See a list of supported formats.</a></li></ul>'},
6:{img:"icons/error_reload_in_viewer.png",header:"Oops",text:"Sorry. We seem to have some technical difficulties and couldn't complete your request.",content:"<ul><li>Try loading the item again.</li><li>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</li></ul>"},7:{img:"icons/error_reload_in_viewer.png",header:"Network problem",text:"Sorry. We seem to have some technical difficulties and couldn't complete your request.",content:"<ul><li>Try loading the item again.</li><li>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</li></ul>"},
8:{img:"icons/error_unsupported_file_type.png",header:"Oops",text:"Sorry. We couldn\u2019t show the item because your browser doesn\u2019t support 3D viewing.",content:'<ul><li>Please use Google Chrome, Firefox or another browser that supports WebGL 3D graphics.</li><li><a href="http://help.autodesk.com/view/ADSK360/ENU/?guid=GUID-6BD255B4-FB67-4909-9332-3A5905076E0A" target="_blank">See a list of browsers supporting WebGL 3D graphics.</a></li></ul>'},9:{img:"icons/error_item_not_found.png",header:"No viewable content",
text:"There\u2019s nothing to display for this item. It may not have been processed or it may not have content we can display.",content:"<ul><li>Please contact the author.</li><li>Try uploading the file again to see if that fixes the issue.</li></ul>"}};Autodesk.Viewing.Private.ErrorHandler=function(){};Autodesk.Viewing.Private.ErrorHandler.prototype.constructor=Autodesk.Viewing.Private.ErrorHandler;
Autodesk.Viewing.Private.ErrorHandler.reportError=function(a,b,c){var e=Autodesk.Viewing.Private.ErrorInfoData[b];if(e){c=e.text;b=e.header;var d=RESOURCE_ROOT+e.img,e=e.content,g=null;e&&(g=document.createElement("div"),g.innerHTML=e);Autodesk.Viewing.Private.AlertBox.displayError(a,c,b,d,g)}else Autodesk.Viewing.Private.AlertBox.displayError(a,c)};
Autodesk.Viewing.Private.ErrorHandler.getErrorCode=function(a){return 403===a||401===a?Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED:404===a?Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND:500<=a?Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR:Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE};/*
 Copyright (c) 2014 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing.UI");Autodesk.Viewing.UI.ToolBar=function(a){this.parentContainer=a;this.container=document.createElement("div");this.container.className="toolbar-menuplacer";this.menu=document.createElement("ul");this.menu.className="toolbar-menu";this.container.appendChild(this.menu);this.parentContainer.appendChild(this.container);this.subToolbars={}};Autodesk.Viewing.UI.ToolBar.prototype.constructor=Autodesk.Viewing.UI.ToolBar;
Autodesk.Viewing.UI.ToolBar.createMenuButton=function(a,b,c){var e=document.createElement("li");e.className="toolbar-generic-button";e.id=a;b&&e.setAttribute("tooltip",b);c&&e.addEventListener("click",c);return e};Autodesk.Viewing.UI.ToolBar.prototype.addSubToolbar=function(a,b){var c=new Autodesk.Viewing.UI.SubToolbar(this.menu,a,b);return this.subToolbars[a]=c};Autodesk.Viewing.UI.ToolBar.prototype.getSubToolbars=function(){return this.subToolbars};
Autodesk.Viewing.UI.ToolBar.prototype.getSubToolbarById=function(a){return a in this.subToolbars?this.subToolbars[a]:null};Autodesk.Viewing.UI.ToolBar.prototype.removeSubToolbar=function(a){if(a in this.subToolbars){var b=this.subToolbars[a];b&&(this.menu.removeChild(b.subtoolbar),delete this.subToolbars[a])}};Autodesk.Viewing.UI.ToolBar.prototype.removeAllSubToolbars=function(){for(;this.menu.firstChild;)this.menu.removeChild(this.menu.firstChild);this.subToolbars={}};
Autodesk.Viewing.UI.ToolBar.prototype.addToSubToolbar=function(a,b){this.subToolbars[a]&&this.subToolbars[a].addTool(b)};Autodesk.Viewing.UI.ToolBar.prototype.removeFromSubToolbar=function(a,b){this.subToolbars[a]&&this.subToolbars[a].removeTool(b.id)};Autodesk.Viewing.UI.ToolBar.prototype.attachSubMenu=function(a,b){a.appendChild(b)};
Autodesk.Viewing.UI.ToolBar.prototype.collapse=function(a){a?Autodesk.Viewing.Private.addClass(this.container,"toolbar-menu-collapsed"):Autodesk.Viewing.Private.removeClass(this.container,"toolbar-menu-collapsed")};Autodesk.Viewing.UI.ToolBar.prototype.isCollapsed=function(){return Autodesk.Viewing.Private.hasClass(this.container,"toolbar-menu-collapsed")};Autodesk.Viewing.UI.ToolBar.prototype.addEventListener=function(a,b){this.menu.addEventListener(a,b)};
Autodesk.Viewing.UI.ToolBar.prototype.removeEventListener=function(a,b){this.menu.removeEventListener(a,b)};Autodesk.Viewing.UI.SubToolbar=function(a,b,c){this.parentContainer=a;this.subtoolbar=document.createElement("div");this.subtoolbar.className="toolbar-submenu";this.subtoolbar.id=b;this.parentContainer.appendChild(this.subtoolbar);this.buttons={};this.isRadio=c};Autodesk.Viewing.UI.SubToolbar.prototype.constructor=Autodesk.Viewing.SubToolbar;
Autodesk.Viewing.UI.SubToolbar.prototype.addTool=function(a){this.buttons[a.id]=a;this.subtoolbar.appendChild(a)};Autodesk.Viewing.UI.SubToolbar.prototype.removeTool=function(a){a in this.buttons&&(this.subtoolbar.removeChild(this.buttons[a]),delete this.buttons[a])};Autodesk.Viewing.UI.SubToolbar.prototype.getTool=function(a){return a in this.buttons?this.buttons[a]:null};
Autodesk.Viewing.UI.SubToolbar.prototype.getToolCount=function(){return this.subtoolbar.children?this.subtoolbar.children.length:0};Autodesk.Viewing.UI.SubToolbar.prototype.select=function(a){this.isRadio&&this.deselectAll();this.buttons[a].style.opacity=1};Autodesk.Viewing.UI.SubToolbar.prototype.deselect=function(a){a in this.buttons&&(this.buttons[a].style.opacity=0.4)};
Autodesk.Viewing.UI.SubToolbar.prototype.deselectAll=function(){for(var a in this.buttons)this.buttons.hasOwnProperty(a)&&(this.buttons[a].style.opacity=0.4)};Autodesk.Viewing.UI.SubToolbar.prototype.setToolVisibility=function(a,b){a in this.buttons&&(this.buttons[a].style.display=b?"list-item":"none")};Autodesk.Viewing.UI.SubToolbar.prototype.isToolVisible=function(a){return a in this.buttons?!(this.buttons[a].style.display&&"none"===this.buttons[a].style.display):!1};
Autodesk.Viewing.UI.SubToolbar.prototype.setVisibility=function(a){this.subtoolbar.style.display=a?"":"none"};Autodesk.Viewing.UI.SubToolbar.prototype.isVisible=function(){return!(this.subtoolbar.style.display&&"none"===this.subtoolbar.style.display)};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.GEOMETRY_LOADED_EVENT="geometry_loaded";Autodesk.Viewing.SELECTION_CHANGED_EVENT="selection";Autodesk.Viewing.ISOLATE_EVENT="isolate";Autodesk.Viewing.HIDE_EVENT="hide";Autodesk.Viewing.SHOW_EVENT="show";Autodesk.Viewing.HIGHLIGHT_EVENT="highlight";Autodesk.Viewing.CAMERA_CHANGE_EVENT="cameraChanged";Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT="renderOptionChanged";
Autodesk.Viewing.NAVIGATION_MODE={ORBIT:0,PAN:1,DOLLY:2,ROLL:3,FOV:4,TOUCH_PAN_DOLLY:5,TOUCH_ROLL:6,OTHER:7};Autodesk.Viewing.BaseViewer3D=function(a,b){Autodesk.Viewing.Viewer.call(this,a,b);if("CANVAS"===this.container.nodeName)throw"Viewer must be initialized on a div [temporary]";this.canvas=document.createElement("canvas");this.canvas.tabIndex=0;var c=this.getDimensions();this.canvas.width=c.width;this.canvas.height=c.height;this.container.appendChild(this.canvas);this.canvas.viewer=this};
Autodesk.Viewing.BaseViewer3D.prototype=Object.create(Autodesk.Viewing.Viewer.prototype);Autodesk.Viewing.BaseViewer3D.prototype.constructor=Autodesk.Viewing.BaseViewer3D;Autodesk.Viewing.BaseViewer3D.kDefaultCanvasConfig={click:{onObject:["setCOI"],offObject:["deselectAll"]},clickCtrl:{onObject:["selectToggle"]},clickCtrlShift:{onObject:["deselectAll"],offObject:["deselectAll"]}};
Autodesk.Viewing.BaseViewer3D.prototype.initialize=function(){var a=this.detectWebGL();if(0>=a)return Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED;Autodesk.Viewing.Viewer.prototype.initialize.call(this);this.impl=new Autodesk.Viewing.Private.Viewer3DImpl(this.canvas,this);this.model=null;if(4096==a)return Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED;this.setCanvasClickBehavior(this.config&&this.config.canvasConfig?this.config.canvasConfig:Autodesk.Viewing.BaseViewer3D.kDefaultCanvasConfig);
this.loader=document.createElement("div");this.loader.id="loader";this.loader.className="spinner";this.container.appendChild(this.loader);for(a=1;3>=a;a++){var b=document.createElement("div");b.className="bounce"+a;this.loader.appendChild(b)}return 0};Autodesk.Viewing.BaseViewer3D.prototype.load=function(a,b,c,e){return this.loadModel(a,null,b,c,e)};
Autodesk.Viewing.BaseViewer3D.prototype.uninitialize=function(a){this.canvas.parentNode.removeChild(this.canvas);this.canvas=this.canvas.viewer=null;this.impl&&(this.impl.uninitialize(),this.impl=null);this.model=this.loader=null;Autodesk.Viewing.Viewer.prototype.uninitialize.call(this)};
Autodesk.Viewing.BaseViewer3D.prototype.detectWebGL=function(){if(_isIE11&&!ENABLE_DEBUG)return 4096;if(window.WebGLRenderingContext){for(var a=document.createElement("canvas"),b=["webgl","experimental-webgl","moz-webgl","webkit-3d"],c=!1,e=0;4>e;e++)try{if((c=a.getContext(b[e]))&&"function"===typeof c.getParameter)return 1}catch(d){}return 0}return-1};
Autodesk.Viewing.BaseViewer3D.prototype.loadModel=function(a,b,c,e,d){var g=this;this.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,function(a){this.impl.needsRender=!0;g.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT)});return this.impl.loadSvf(a,b,c,function(a){g.model=new Autodesk.Viewing.Model(a);g.impl.setModel(g.model);g.loader.style.display="None";e&&e()},function(a,b){g.loader.style.display="None";d&&d(a,b)})};
Autodesk.Viewing.BaseViewer3D.prototype.resize=function(){Autodesk.Viewing.Viewer.prototype.resize.call(this);return this.impl.resize(this.container.clientWidth,this.container.clientHeight)};Autodesk.Viewing.BaseViewer3D.prototype.getCamera=function(){return this.impl.camera};Autodesk.Viewing.BaseViewer3D.prototype.setViewFromArray=function(a){this.impl.setViewFromArray(a)};Autodesk.Viewing.BaseViewer3D.prototype.setViewFromFile=function(){this.impl.setViewFromFile(this.model)};
Autodesk.Viewing.BaseViewer3D.prototype.getProperties=function(a,b,c){this.model?this.model.getProperties(a,b,c):c&&c(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Properties failed to load since model does not exist.")};Autodesk.Viewing.BaseViewer3D.prototype.getObjectTree=function(a,b){this.model?this.model.getObjectTree(a,b):b&&b(Autodesk.Viewing.ErrorCodes.BAD_DATA,"ObjectTree failed to load since model does not exist.")};Autodesk.Viewing.BaseViewer3D.prototype.setCanvasClickBehavior=function(a){this.impl.controls.setClickBehavior(a)};
Autodesk.Viewing.BaseViewer3D.prototype.search=function(a,b,c){this.searchText=a;this.model?this.model.search(a,b,c):c&&c(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Search failed since model does not exist.")};Autodesk.Viewing.BaseViewer3D.prototype.isolate=function(a){Array.isArray(a)?this.impl.visibilityManager.isolateMultiple(a):this.impl.visibilityManager.isolate(a)};
Autodesk.Viewing.BaseViewer3D.prototype.isolateById=function(a){function b(b){(e=d.model.getNodesByIds(Array.isArray(a)?a:[a]))&&d.isolate(e)}function c(a){this.getObjectTree(b);d.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,c)}var e=[],d=this;this.model&&this.model.isLoadDone()?this.getObjectTree(b):this.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,c)};Autodesk.Viewing.BaseViewer3D.prototype.setBackgroundColor=function(a,b,c,e,d,g){this.impl.setClearColors(a,b,c,e,d,g)};
Autodesk.Viewing.BaseViewer3D.prototype.toggleSelect=function(a){this.impl.selector.toggleSelectionId(a)};Autodesk.Viewing.BaseViewer3D.prototype.select=function(a){"number"===typeof a&&(a=[a]);this.impl.selector.setSelectionIds(a)};Autodesk.Viewing.BaseViewer3D.prototype.deselect=function(a){throw Error("not implemented yet");};Autodesk.Viewing.BaseViewer3D.prototype.clearSelection=function(){this.impl.selector.clearSelection()};
Autodesk.Viewing.BaseViewer3D.prototype.hide=function(a){Array.isArray(a)?this.impl.visibilityManager.hideMultiple(a):this.impl.visibilityManager.hide(a)};Autodesk.Viewing.BaseViewer3D.prototype.show=function(a){Array.isArray(a)?this.impl.visibilityManager.showMultiple(a):this.impl.visibilityManager.show(a)};Autodesk.Viewing.BaseViewer3D.prototype.showAll=function(){this.impl.visibilityManager.isolateNone()};
Autodesk.Viewing.BaseViewer3D.prototype.hideAll=function(){throw Error("not implemented yet");};Autodesk.Viewing.BaseViewer3D.prototype.toggleVisibility=function(a){this.impl.visibilityManager.toggleVisibility(a)};Autodesk.Viewing.BaseViewer3D.prototype.areAllVisible=function(){return this.impl.visibilityManager.areAllVisible()};Autodesk.Viewing.BaseViewer3D.prototype.explode=function(a){this.impl.explode(a)};
Autodesk.Viewing.BaseViewer3D.prototype.setQualityLevel=function(a,b){this.impl.togglePostProcess(a,b)};Autodesk.Viewing.BaseViewer3D.prototype.setEnvironmentMap=function(a){this.impl.setCubeMap(a)};Autodesk.Viewing.BaseViewer3D.prototype.setGhosting=function(a){this.impl.toggleGhosting(a)};Autodesk.Viewing.BaseViewer3D.prototype.setProgressiveRendering=function(a){this.impl.toggleProgressive(a)};Autodesk.Viewing.BaseViewer3D.prototype.getNavigationMode=function(){if("getNavigationMode"in this.impl.controls)return this.impl.controls.getNavigationMode()};
Autodesk.Viewing.BaseViewer3D.prototype.setNavigationMode=function(a){"setNavigationMode"in this.impl.controls&&this.impl.controls.setNavigationMode(a)};Autodesk.Viewing.BaseViewer3D.prototype.getFOV=function(){return"getFOV"in this.impl.controls?this.impl.controls.getFOV():this.impl.camera.fov};Autodesk.Viewing.BaseViewer3D.prototype.setFOV=function(a){"setFOV"in this.impl.controls?this.impl.controls.setFOV(a):(this.impl.camera.fov=a,this.impl.syncCamera())};
Autodesk.Viewing.BaseViewer3D.prototype.getFocalLength=function(){if("getFocalLength"in this.impl.controls)return this.impl.controls.getFocalLength();var a=THREE.Math.degToRad(this.impl.camera.fov);return Math.round(12/Math.tan(0.5*a))};Autodesk.Viewing.BaseViewer3D.prototype.setFocalLength=function(a){"setFocalLength"in this.impl.controls?this.impl.controls.setFocalLength(a):(this.impl.camera.setLens(a),this.impl.syncCamera())};Autodesk.Viewing.BaseViewer3D.prototype.hideLines=function(a){this.impl.hideLines(a)};
Autodesk.Viewing.BaseViewer3D.prototype.applyCamera=function(a,b){this.impl.applyCamera(a,b)};
Autodesk.Viewing.BaseViewer3D.prototype.fitToView=function(a){var b=this,c=this.impl.controls.getLookAtPoint(),e=function(a){b.impl.controls.fitToView(!1,a);a=b.impl.controls.getLookAtPoint();return c.x!==a.x||c.y!==a.y||c.z!==a.z};if(0===a.length)return e(null);var d=new THREE.Box3,g=new THREE.Box3;a=this.impl.selector.getFragIdsFromObjectIds(a);for(var f=0;f<a.length;f++)if(void 0!==a[f]){var h=this.impl.getRenderProxy(this.model,a[f]);h.geometry.boundingBox.getTransformedBox(h.matrixWorld,g);d.union(g)}return e(d.empty()?
null:d)};AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.ErrorCodes={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.Viewer2D=function(a,b){Autodesk.Viewing.Viewer.call(this,a,b);b||(b={});b.domElement=this.container;this.impl=new Autodesk.Viewing.Private.Viewer2DImpl(this,b)};Autodesk.Viewing.Viewer2D.prototype=Object.create(Autodesk.Viewing.Viewer.prototype);Autodesk.Viewing.Viewer2D.prototype.constructor=Autodesk.Viewing.Viewer2D;Autodesk.Viewing.Viewer2D.prototype.initialize=function(){Autodesk.Viewing.Viewer.prototype.initialize.call(this);return this.impl.initialize()};
Autodesk.Viewing.Viewer2D.prototype.load=function(a,b,c,e){if(this.impl.load(a))return c&&c(),!0;e&&e();return!1};Autodesk.Viewing.Viewer2D.prototype.uninitialize=function(){this.impl.uninitialize();Autodesk.Viewing.Viewer.prototype.uninitialize.call(this)};Autodesk.Viewing.Viewer2D.prototype.resize=function(){Autodesk.Viewing.Viewer.prototype.resize.call(this);this.impl.resize()};Autodesk.Viewing.Viewer2D.prototype.setViewFromFile=function(){this.impl.goHome()};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.Document=function(a,b){function c(a){if(a){var b=a.children?a.children.length:0;if("geometry"===a.type&&"3d"===a.role&&b){for(var f=0,h=0;h<b;h++){var k=a.children[h];k&&"view"===k.type&&"3d"===k.role&&(e.myViewGeometry[k.guid]=a,f++)}e.myNumViews[a.guid]=f}else if("application/autodesk-db"==a.mime)e.myPropertyDb=a.urn.substr(0,a.urn.lastIndexOf("/")+1);else if(0<b)for(h=0;h<b;h++)c(a.children[h])}}this.myPath=b;this.myData=a;this.myViewGeometry={};this.myNumViews={};this.myPropertyDb=
null;var e=this;c(a)};Autodesk.Viewing.Document.prototype.constructor=Autodesk.Viewing.Document;
Autodesk.Viewing.Document.load=function(a,b,c,e){var d=function(a){if("http://"==a.substr(0,7)||"https://"==a.substr(0,8)||"file:///"==a.substr(0,8))return a;if(-1===a.indexOf("urn:"))return 0!==a.indexOf("/")&&(a="/"+a),window.location.protocol+"//"+window.location.host+a;a=a.substr(4);return VIEWING_URL+"/bubbles/"+a}(a);try{var g=new XMLHttpRequest;g.open("GET",d,!0);g.withCredentials=!0;g.setRequestHeader("Access-Control-Allow-Credentials",!0);g.setRequestHeader("Access-Control-Allow-Origin",
"*");g.onload=function(a){if(g.status&&200===g.status)a=g.response?g.response:g.responseText,/<[^>]*script/.test(g.responseText)?e&&e(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Malicious document content detected. Abort loading."):(a="string"===typeof a?JSON.parse(a):a,a=new Autodesk.Viewing.Document(a,d),c&&c(a));else if(e){a="Network error: "+g.status+" ("+g.statusText+")";var b=Autodesk.Viewing.Private.ErrorHandler.getErrorCode(g.status);e(b,a)}};g.onerror=function(a){if(e){a="Load error: "+g.status+
" ("+g.statusText+")";var b=Autodesk.Viewing.Private.ErrorHandler.getErrorCode(g.status);e(b,a)}};g.ontimeout=function(a){if(e){a="Timeout occured: "+g.status+" ("+g.statusText+")";var b=Autodesk.Viewing.Private.ErrorHandler.getErrorCode(g.status);e(b,a)}};g.send()}catch(f){e&&e(Autodesk.Viewing.ErrorCodes.UNKNOWN_FAILURE,"An exception occurred while loading the document: "+f.toString())}};
Autodesk.Viewing.Document.prototype.getFullPath=function(a){var b=a;0===a.indexOf("urn")?b=VIEWING_URL+"/items/"+a:0===a.indexOf("$file$")&&-1!==this.myPath.indexOf("/output/bubble.json")&&(b=this.myPath.replace("/output/bubble.json","")+a.replace("$file$",""));return b};Autodesk.Viewing.Document.prototype.getThumbnailPath=function(a,b,c){b=b?b:200;c=c?c:200;return VIEWING_URL+"/thumbnails/"+this.myData.urn+"?guid="+encodeURIComponent(a.guid)+"&width="+b+"&height="+c};
Autodesk.Viewing.Document.prototype.getViewablePath=function(a){if("geometry"===a.type){var b=[];"3d"===a.role?b=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{mime:"application/autodesk-svf"},!1):"2d"===a.role&&(b=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{role:"tileRoot"},!0));if(0<b.length)return this.getFullPath(b[0].urn)}else if("view"===a.type&&(a=this.getViewGeometry(a)))return this.getViewablePath(a);return""};Autodesk.Viewing.Document.prototype.getPropertyDbPath=function(){return this.myPropertyDb};
Autodesk.Viewing.Document.prototype.getRootItem=function(){return this.myData};Autodesk.Viewing.Document.prototype.getPath=function(){return this.myPath};Autodesk.Viewing.Document.prototype.getItemById=function(a){function b(c){if(!c)return null;for(var e in c){var d=c[e];if("guid"===e&&d===a)return c;if(null!==d&&"object"===typeof d&&(d=b(d)))return d}return null}return b(this.myData)};
Autodesk.Viewing.Document.getSubItemsWithProperties=function(a,b,c){var e=[];if(!a)return[];for(var d=a.children?a.children.length:0,g=0;g<d;g++){var f=a.children[g],h;a:{h=b;var k=void 0;for(k in h)if(!(k in f)||h[k]!==f[k]){h=!1;break a}h=!0}h&&e.push(f);c&&e.push.apply(e,Autodesk.Viewing.Document.getSubItemsWithProperties(f,b,c))}return e};Autodesk.Viewing.Document.prototype.getViewGeometry=function(a){return this.myViewGeometry[a.guid]};
Autodesk.Viewing.Document.prototype.getNumViews=function(a){return this.myNumViews[a.guid]||0};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.Model=function(a){this.myData=a;this.myLoader=this.propWorker=this.sharedPath=null};Autodesk.Viewing.Model.prototype=Object.create(THREE.EventDispatcher.prototype);Autodesk.Viewing.Model.prototype.constructor=Autodesk.Viewing.Model;Autodesk.Viewing.Model.prototype.setData=function(a){this.myData=a};Autodesk.Viewing.Model.prototype.getData=function(){return this.myData};Autodesk.Viewing.Model.prototype.setLoader=function(a){this.myLoader=a};
Autodesk.Viewing.Model.prototype.getRoot=function(){return this.myData?this.myData.instanceTree:null};Autodesk.Viewing.Model.prototype.getRootId=function(){return this.myData&&this.myData.instanceTree?this.myData.instanceTree.dbId:null};Autodesk.Viewing.Model.prototype.getBoundingBox=function(){return this.myData?this.myData.bbox:null};Autodesk.Viewing.Model.prototype.getBgColor=function(){return this.myData?this.myData.bgColor:4294967295};
Autodesk.Viewing.Model.prototype.getNodeById=function(a){function b(c){if(!c)return null;if(c.dbId&&c.dbId===a)return c;if(c.children&&0<c.children.length)for(var e=0;e<c.children.length;e++){var d=b(c.children[e]);if(d)return d}return null}return b(this.getRoot())};
Autodesk.Viewing.Model.prototype.getNodesByIds=function(a){function b(a,e,d){if(0===a.length)return d;var g=a.indexOf(e.dbId);-1!==g&&(d.push(e),a.splice(g,1));if(e.children)for(g=0;g<e.children.length;g++)b(a,e.children[g],d);return d}a=a.slice(0);return b(a,this.getRoot(),[])};
Autodesk.Viewing.Model.prototype.getDefaultCamera=function(){var a=this.myData;if(!a)return null;var b=null,c=a.cameras?a.cameras.length:0;if(0<c){var e=a.metadata&&a.metadata["default camera"]?a.metadata["default camera"].index:null;if(null!==e&&a.cameras[e])b=a.cameras[e];else{for(e=0;e<c;e++){var d=a.cameras[e];if(d.isPerspective){b=d;break}}b||(b=a.cameras[0])}}return b};
Autodesk.Viewing.Model.prototype.getUpVector=function(){if(!this.myData)return null;var a=this.myData.metadata;return a&&(a=a["world up vector"])?a.XYZ:null};Autodesk.Viewing.Model.prototype.geomPolyCount=function(){return this.myData?this.myData.geomPolyCount:null};Autodesk.Viewing.Model.prototype.instancePolyCount=function(){return this.myData?this.myData.instancePolyCount:null};Autodesk.Viewing.Model.prototype.getLayersList=function(){return this.myData?this.myData.layersList:null};
Autodesk.Viewing.Model.prototype.is2d=function(){return this.myData&&this.myData.is2d};Autodesk.Viewing.Model.prototype.isLoadDone=function(){return this.myData&&this.myData.loadDone};Autodesk.Viewing.Model.prototype.getProperties=function(a,b,c){this.myData&&this.myLoader&&this.myLoader.getProperties(a,b,c)};Autodesk.Viewing.Model.prototype.getObjectTree=function(a,b){this.myData&&this.myLoader&&this.myLoader.getObjectTree(a,b)};
Autodesk.Viewing.Model.prototype.search=function(a,b,c){var e=this;this.isLoadDone()?this.myLoader.searchProperties(a,b,c):this.getObjectTree(function(d){e.myLoader.searchProperties(a,b,c)})};/*
 Copyright (c) 2013 Autodesk Inc. */
var ADSKV=AutodeskNamespace("Autodesk.Viewing");ADSKV.ViewingApplication=function(a,b){this.appContainerId=a;this.container=document.getElementById(a);this.options=b;this.myRegisteredViewers={};this.urn=this.myCurrentViewer=this.myDocument=null};ADSKV.ViewingApplication.prototype.k3D="3D";ADSKV.ViewingApplication.prototype.k2D="2D";
ADSKV.ViewingApplication.prototype.registerViewer=function(a,b,c){this.myRegisteredViewers[a]={};this.myRegisteredViewers[a].class=b;this.myRegisteredViewers[a].config=c};ADSKV.ViewingApplication.prototype.getViewerClass=function(a){return this.myRegisteredViewers.hasOwnProperty(a)?this.myRegisteredViewers[a].class:null};ADSKV.ViewingApplication.prototype.getViewerContainer=function(){return document.getElementById(this.appContainerId)};
ADSKV.ViewingApplication.prototype.getViewer=function(a,b,c){if(a in this.myRegisteredViewers){this.setCurrentViewer(null);var e=this.myRegisteredViewers[a].class,d={};a=this.myRegisteredViewers[a].config;for(var g in a)a.hasOwnProperty(g)&&(d[g]=a[g]);for(g in b)b.hasOwnProperty(g)&&(d[g]=b[g]);for(b=this.getViewerContainer();b.hasChildNodes();)b.removeChild(b.lastChild);e=new e(b,d);d=e.initialize();if(0===d)return this.setCurrentViewer(e),e;c&&c(d,"Viewer failed to initialize.")}return null};
ADSKV.ViewingApplication.prototype.setCurrentViewer=function(a){this.myCurrentViewer&&this.myCurrentViewer.uninitialize();this.myCurrentViewer=a};ADSKV.ViewingApplication.prototype.getCurrentViewer=function(){return this.myCurrentViewer};ADSKV.ViewingApplication.prototype.loadDocument=function(a,b,c){var e=this;Autodesk.Viewing.Document.load(a,auth,function(a){e.myDocument=a;e.onDocumentLoaded(a);b&&b(a)},function(a,b){e.onDocumentFailedToLoad(a,b);c&&c(a,b)})};
ADSKV.ViewingApplication.prototype.onDocumentLoaded=function(a){console.log(a)};ADSKV.ViewingApplication.prototype.onDocumentFailedToLoad=function(a,b){console.log(a)};
ADSKV.ViewingApplication.prototype.selectItem=function(a,b,c){var e=this.myDocument.getViewablePath(a);if(e){var d,g,f;if("geometry"===a.type&&"3d"===a.role)d=this.k3D,f=a.name;else if("view"===a.type&&"3d"===a.role){g=a;d=this.k3D;var h=this.myDocument.getViewGeometry(a);h&&(f=h.name)}else"geometry"===a.type&&"2d"===a.role&&(d=this.k2D,f=a.name);if(d){var k=this,l=this.myCurrentViewer&&this.urn===e,h=null,h=g&&g.camera?function(){k.myCurrentViewer.setViewFromArray(g.camera);b&&b(k.myCurrentViewer,
a)}:l?function(){k.myCurrentViewer.setViewFromFile();b&&b(k.myCurrentViewer,a)}:function(){b&&b(k.myCurrentViewer,a)},m=!1;l?(h&&h(),m=!0):(this.urn=null,(d=this.getViewer(d,{defaultModelStructureTitle:f},c))&&d.load(this.myDocument.getFullPath(e),this.myDocument.getPropertyDbPath(),h,c)&&(this.urn=e,m=!0));if(m)return this.onItemSelected(a),!0}}return!1};
ADSKV.ViewingApplication.prototype.onItemSelected=function(a){console.log("Selected URL: http://"+location.host+location.pathname+"?document=urn:"+this.myDocument.getRootItem().guid+"&item="+encodeURIComponent(a.guid))};ADSKV.ViewingApplication.prototype.selectItemById=function(a,b,c){return(a=this.myDocument.getItemById(a))?this.selectItem(a,b,c):!1};/*
 Copyright (c) 2013 Autodesk Inc. */
AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.Initializer=function(a,b){initializeEnvironmentVariable(a);initializeServiceEndPoints();initializeAuth(b,a)};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.GuiViewer3D=function(a,b){Autodesk.Viewing.BaseViewer3D.call(this,a,b)};Autodesk.Viewing.Private.GuiViewer3D.prototype=Object.create(Autodesk.Viewing.BaseViewer3D.prototype);Autodesk.Viewing.Private.GuiViewer3D.prototype.constructor=Autodesk.Viewing.Private.GuiViewer3D;
Autodesk.Viewing.Private.GuiViewer3D.prototype.resize=function(){Autodesk.Viewing.BaseViewer3D.prototype.resize.call(this);600>this.container.clientWidth?this.toolBar.collapse(!0):this.toolBar.collapse(!1)};Autodesk.Viewing.Private.GuiViewer3D.kDefaultDocStructureConfig={click:{onObject:["isolate"]},clickCtrl:{onObject:["toggleVisibility"]}};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initialize=function(){var a=Autodesk.Viewing.BaseViewer3D.prototype.initialize.call(this);if(0<a)return a;var b=this,a=b.container;this.useLocalStorage=!0;this.toolBar=new Autodesk.Viewing.UI.ToolBar(a);var c=document.createElement("div");c.className="toolbarcentertop";a.appendChild(c);this.toolbar=document.createElement("div");this.toolbar.className="toolbar";c.appendChild(this.toolbar);this.initFocalLengthOverlay();this.initSettings();var e=this;this.addEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,
function(a){b.resizePanels({viewer:b});e.updateScreenModeButton(a.mode)});this.propertygrid=new Autodesk.Viewing.Private.PropertyPanel(b);this.addPanel(this.propertygrid);this.propertygrid.addVisibilityListener(function(a){e.setPropertiesButtonEnabled(a)});this.initMinTools();this.initNavTools();this.initCameraTools();this.initCameraStateMachine();this.initModelTools();ENABLE_DEBUG&&this.initDebugTools();this.initSearchBox();this.initContextMenu();this.progressbar=new Autodesk.Viewing.Private.ProgressBar(this.container);
this.addEventListener(Autodesk.Viewing.PROGRESS_UPDATE_EVENT,function(a){void 0!==a.percent&&b.progressbar.setPercent(a.percent)},!1);this.selectionActive=!1;this.addEventListener(Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(a){b.selectionActive=0<a.dbIdArray.length});this.initEscapeHandlers();this.updateScreenModeButton(this.getScreenMode());this.resize();return 0};
Autodesk.Viewing.Private.GuiViewer3D.prototype.uninitialize=function(){this.docstructure&&(this.docstructure.uninitialize(),this.docstructure=null);this.layersPanel&&(this.layersPanel.uninitialize(),this.layersPanel=null);this.propertygrid&&(this.propertygrid.uninitialize(),this.propertygrid=null);this.renderoptions&&(this.renderoptions.uninitialize(),this.renderoptions=null);Autodesk.Viewing.BaseViewer3D.prototype.uninitialize.call(this)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initContextMenu=function(){var a=this;this.objectContextMenu=new Autodesk.Viewing.Private.ObjectContextMenu(this.impl);this.canvas.addEventListener("mousedown",function(b){isRightClick(b)&&(a.startX=b.clientX,a.startY=b.clientY)});this.canvas.addEventListener("mouseup",function(b){if(isRightClick(b)&&b.clientX===a.startX&&b.clientY===a.startY){var c=a.impl.castRay(b.clientX,b.clientY);c.node&&(a.impl.selector.isSelectedOrParentIsSelected(c.node)||isMultiSelect(b)||
a.impl.selector.setSelection([c.node]));return a.objectContextMenu.show(b)}return!0},!1)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.addOptionToggle=function(a,b,c,e,d){var g=this,f=this.settings[d];c=null!==f?f:c;var f=document.createElement("li"),h=document.createElement("input");h.className="toolbar-submenu-checkbox";h.type="checkbox";h.id=b;f.appendChild(h);var k=document.createElement("label");k.innerHTML=b;k.setAttribute("for",b);f.appendChild(k);a.appendChild(f);h.checked=c;h.onchange=function(a){g.updateSetting(d,a.target.checked);e(a)};return h};
Autodesk.Viewing.Private.GuiViewer3D.prototype.addMenuButton=function(a,b,c,e){b=Autodesk.Viewing.UI.ToolBar.createMenuButton(b,c,e);this.toolBar.addToSubToolbar(a,b);return b};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initColorPicker=function(){function a(a,b,d,e){var r;if(7==a.length){for(b=1;b<a.length;b++)if(d=parseInt(a[b],16),0>d||16<d||d!==d)return;r=parseInt(a.slice(1),16);b=1*(r>>16&255);d=1*(r>>8&255);r=1*(r&255);e||(e=[b,d,r,0|0.6521739130434783*b,0|0.6521739130434783*d,0|0.6521739130434783*r],h.setBackgroundColor(e[0],e[1],e[2],e[3],e[4],e[5]),h.updateSetting("backgroundColorPreset",JSON.stringify(e)));c.style.background=a;f=g.value=a}}var b=document.createElement("li");
b.className="color-picker";var c=document.createElement("div");c.className="backgroundButton";var e=document.createElement("div");e.className="cp-small thecolorpicker";c.appendChild(e);b.appendChild(c);var d=this.impl.clearColorTop,d=255*d.x<<16|255*d.y<<8|255*d.z,g=document.createElement("input");g.className="backgroundColorText";g.type="text";g.value="#"+d.toString(16);b.appendChild(g);var f=g.value,h=this;g.addEventListener("change",function(){a(g.value);g.value=f});this.menuoptions.appendChild(b);
ColorPicker(e,a);c.style.background=g.value};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initFPSStats=function(){var a=this;this.addOptionToggle(this.debugMenu.subMenu,"FPS Statistics",!1,function(b){if(b.target.checked&&!a.impl.stats){var c=new Stats;c.setMode(1);c.domElement.style.position="absolute";c.domElement.style.bottom="0px";c.domElement.style.right="0px";c.domElement.style.visibility="hidden";c.domElement.style["z-index"]=1;a.container.appendChild(c.domElement);a.impl.stats=c}a.impl.stats.domElement.style.visibility=b.target.checked?
"visible":"hidden"})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initModelStats=function(){function a(a){var b=c.impl,g="",f=c.model;f&&(g+="Geom&nbsp;Polys:&nbsp;"+f.geomPolyCount()+"<br>",g+="Instance&nbsp;Polys:&nbsp;"+f.instancePolyCount()+"<br>",g+="Scenes:&nbsp;"+b.modelQueue.getSceneCount()+"<br>");c.modelStats.innerHTML=g+("# "+(a||""))}function b(){c.modelStats=document.createElement("div");c.modelStats.className="statspanel";c.container.appendChild(c.modelStats);c.addEventListener(Autodesk.Viewing.PROGRESS_UPDATE_EVENT,function(b){b.message&&
a(b.message)})}var c=this;this.addOptionToggle(this.debugMenu.subMenu,"Model Stats",!1,function(e){e.target.checked&&!c.modelStats&&(b(),a(""));c.modelStats.style.visibility=e.target.checked?"visible":"hidden"})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initExplodeSlider=function(a){var b=this,c=this.explodeslider=document.createElement("input");c.className="slider";c.type="range";c.min="0";c.max="100";c.value="0";c.width="200";this.toolbar.appendChild(c);c.addEventListener("input",function(a){b.explode(c.value/100)});c.addEventListener("change",function(a){b.explode(c.value/100)});this.explodebutton=this.addMenuButton(a,"toolbar-explodeButton","Explode Model",function(a){b.showExplodeSlider("hidden"==
c.style.visibility||""==c.style.visibility)});c.addEventListener("keyup",function(a){27===a.keyCode&&b.canvas.focus()})};Autodesk.Viewing.Private.GuiViewer3D.prototype.showExplodeSlider=function(a){a?(this.modelTools.deselect(this.explodebutton.id),this.explodeslider.style.visibility="visible"):(this.modelTools.select(this.explodebutton.id),this.explodeslider.style.visibility="hidden")};Autodesk.Viewing.Private.GuiViewer3D.prototype.showRenderingOptions=function(a){this.renderoptions.setVisible(a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.showLayerManager=function(a){this.layersPanel.setVisible(a)};Autodesk.Viewing.Private.GuiViewer3D.prototype.initMinTools=function(){if(this.canChangeScreenMode()){this.minTools=this.toolBar.addSubToolbar("minTools",!1);var a=this;this.minTools.minfullscreenbutton=this.addMenuButton("minTools","toolbar-minfullscreenButton","Full Screen",function(b){a.nextScreenMode()})}};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initNavTools=function(){var a=this;this.navigationMode=Autodesk.Viewing.NAVIGATION_MODE.ORBIT;this.navTools=this.toolBar.addSubToolbar("navTools",!0);this.navTools.orbitbutton=this.addMenuButton("navTools","toolbar-orbitButton","Orbit",function(b){a.setNavigationMode(Autodesk.Viewing.NAVIGATION_MODE.ORBIT)});this.navTools.panbutton=this.addMenuButton("navTools","toolbar-panButton","Pan",function(b){a.setNavigationMode(a.getNavigationMode()===Autodesk.Viewing.NAVIGATION_MODE.PAN?
Autodesk.Viewing.NAVIGATION_MODE.ORBIT:Autodesk.Viewing.NAVIGATION_MODE.PAN)});this.navTools.dollybutton=this.addMenuButton("navTools","toolbar-zoomButton","Zoom",function(b){a.setNavigationMode(a.getNavigationMode()===Autodesk.Viewing.NAVIGATION_MODE.DOLLY?Autodesk.Viewing.NAVIGATION_MODE.ORBIT:Autodesk.Viewing.NAVIGATION_MODE.DOLLY)});this.navTools.select(this.navTools.orbitbutton.id);a.canvas.style.cursor="url("+RESOURCE_ROOT+"icons/turntable_cur.cur), wait"};
Autodesk.Viewing.Private.GuiViewer3D.prototype.createCameraSubmenu=function(){var a=document.createElement("ul");a.style.paddingTop="4px";a.style.paddingBottom="4px";var b=this;this.cameraMenu.fittoviewbutton=Autodesk.Viewing.UI.ToolBar.createMenuButton("toolbar-fitToViewButton","Fit to View (F)",function(a){b.impl.controls.fitToView()});a.appendChild(this.cameraMenu.fittoviewbutton);this.cameraMenu.fovbutton=Autodesk.Viewing.UI.ToolBar.createMenuButton("toolbar-focalLengthButton","Focal Length  (CTRL+SHIFT - drag)",
function(a){b.setNavigationMode(b.getNavigationMode()===Autodesk.Viewing.NAVIGATION_MODE.FOV?Autodesk.Viewing.NAVIGATION_MODE.ORBIT:Autodesk.Viewing.NAVIGATION_MODE.FOV)});this.cameraMenu.fovbutton.style.opacity=0.4;a.appendChild(this.cameraMenu.fovbutton);this.cameraMenu.rollbutton=Autodesk.Viewing.UI.ToolBar.createMenuButton("toolbar-rollButton","Roll (ALT+SHIFT - drag)",function(a){b.setNavigationMode(b.getNavigationMode()===Autodesk.Viewing.NAVIGATION_MODE.ROLL?Autodesk.Viewing.NAVIGATION_MODE.ORBIT:
Autodesk.Viewing.NAVIGATION_MODE.ROLL)});this.cameraMenu.rollbutton.style.opacity=0.4;a.appendChild(this.cameraMenu.rollbutton);return a};Autodesk.Viewing.Private.GuiViewer3D.prototype.initCameraTools=function(){this.cameraMenu=this.toolBar.addSubToolbar("cameraTools",!1);var a=this.addMenuButton("cameraTools","toolbar-cameraSubmenuButton","Camera Interactions",null),b=this.createCameraSubmenu();this.toolBar.attachSubMenu(a,b)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initCameraStateMachine=function(){var a=this;a.addEventListener(Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,function(b){a.navTools.deselectAll();a.cameraMenu.fovbutton.style.opacity=0.4;a.cameraMenu.rollbutton.style.opacity=0.4;switch(b.value){case Autodesk.Viewing.NAVIGATION_MODE.ORBIT:a.navTools.select(a.navTools.orbitbutton.id);a.canvas.style.cursor="url("+RESOURCE_ROOT+"icons/turntable_cur.cur), wait";break;case Autodesk.Viewing.NAVIGATION_MODE.DOLLY:a.navTools.select(a.navTools.dollybutton.id);
a.canvas.style.cursor="url("+RESOURCE_ROOT+"icons/dolly_cur.cur), wait";break;case Autodesk.Viewing.NAVIGATION_MODE.PAN:a.navTools.panbutton.style.opacity=1;a.navTools.select(a.navTools.panbutton.id);a.canvas.style.cursor="url("+RESOURCE_ROOT+"icons/pan_cur.cur), wait";break;case Autodesk.Viewing.NAVIGATION_MODE.FOV:a.cameraMenu.fovbutton.style.opacity=1;a.canvas.style.cursor="url("+RESOURCE_ROOT+"icons/fov_cur.cur), wait";break;case Autodesk.Viewing.NAVIGATION_MODE.ROLL:a.cameraMenu.rollbutton.style.opacity=
1;a.canvas.style.cursor="auto";break;default:a.canvas.style.cursor="auto"}a.navigationMode=b.value;a.showFocalLengthOverlay(a.navigationMode===Autodesk.Viewing.NAVIGATION_MODE.FOV)})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initModelTools=function(){var a=this;this.modelTools=this.toolBar.addSubToolbar("modelTools",!1);this.modelTools.structurebutton=this.addMenuButton("modelTools","toolbar-modelStructureButton","Model Structure",function(b){a.docstructure&&a.showDocumentStructurePanel(!a.docstructure.isVisible())});this.initExplodeSlider("modelTools");this.addMenuButton("modelTools","toolbar-resetButton","Reset Model",function(b){a.explode(0);a.explodeslider.value=0;a.showAll()});
this.modelTools.propertiesbutton=this.addMenuButton("modelTools","toolbar-propertiesButton","Properties",function(b){a.propertygrid.isVisible()?(a.propertygrid.setVisible(!1),a.modelTools.select(a.modelTools.propertiesbutton.id)):(a.propertygrid.getNodeId()||a.propertygrid.setDefaultProperties(),a.propertygrid.setVisible(!0),a.modelTools.deselect(a.modelTools.propertiesbutton.id))});this.modelTools.setToolVisibility(this.modelTools.propertiesbutton.id,!1);var b=this.addMenuButton("modelTools","toolbar-optionsSubmenuButton",
"Options",null),c=this.createOptionsMenu();this.toolBar.attachSubMenu(b,c);if(ENABLE_DEBUG){var e=this.renderoptions=new Autodesk.Viewing.Private.RenderOptionsPanel(this);this.addPanel(e);this.addMenuButton("modelTools","toolbar-renderOptionsButton","Rendering Options",function(b){a.showRenderingOptions(!e.isVisible())})}this.canChangeScreenMode()&&(this.modelTools.fullscreenbutton=this.addMenuButton("modelTools","toolbar-fullscreenButton","Full Screen",function(b){a.nextScreenMode()}))};
Autodesk.Viewing.Private.GuiViewer3D.prototype.setPropertiesOnSelect=function(a){a?this.modelTools.setToolVisibility(this.modelTools.propertiesbutton.id,!1):this.modelTools.setToolVisibility(this.modelTools.propertiesbutton.id,!0);this.propertygrid.setOpenOnSelect(a)};Autodesk.Viewing.Private.GuiViewer3D.prototype.addHeader=function(a,b){var c=document.createElement("li");c.innerHTML=b;c.className="toolbar-submenu-header";a.appendChild(c);return c};
Autodesk.Viewing.Private.GuiViewer3D.prototype.addDivider=function(a){var b=document.createElement("li");b.className="toolbar-submenu-horizontal-divider";a.appendChild(b);return b};
Autodesk.Viewing.Private.GuiViewer3D.prototype.createOptionsMenu=function(){var a=this;this.menuoptions=document.createElement("ul");this.menuoptions.style.width="220px";this.menuoptions.style.paddingTop="4px";this.menuoptions.style.paddingBottom="4px";this.addHeader(this.menuoptions,"Background Color");this.initColorPicker();this.addDivider(this.menuoptions);this.initViewCube();this.modelTools.propertiesOnSelectCheckbox=this.addOptionToggle(this.menuoptions,"Open Properties on Select",!0,function(b){a.setPropertiesOnSelect(b.target.checked)},
"openPropertiesOnSelect");this.setPropertiesOnSelect(this.settings.openPropertiesOnSelect);this.addDivider(this.menuoptions);this.addHeader(this.menuoptions,"Performance and Quality");this.modelTools.propertiesOnSelectCheckbox.style.opacity=1;this.addOptionToggle(this.menuoptions,"Ghost Hidden Objects",!0,function(b){a.setGhosting(b.target.checked)},"ghosting");this.addOptionToggle(this.menuoptions,"Ambient Shadows",!this.isAndroid,function(b){a.setQualityLevel(b.target.checked,a.settings.antialiasing)},
"ambientShadows");this.addOptionToggle(this.menuoptions,"Antialiasing",!this.isAndroid,function(b){a.setQualityLevel(a.settings.ambientShadows,b.target.checked)},"antialiasing");this.addOptionToggle(this.menuoptions,"Progressive Model Display",!0,function(b){a.setProgressiveRendering(b.target.checked)},"progressiveRendering");this.addOptionToggle(this.menuoptions,"Display Lines",!0,function(b){a.hideLines(!b.target.checked)},"lineRendering");var b=this.addOptionToggle(this.menuoptions,"Environment Map",
!1,function(b){a.blockEvent||(b.target.checked?(a.impl.lastLightPreset?(a.updateSetting("lightPreset",a.impl.lastLightPreset),a.impl.setLightPreset(a.impl.lastLightPreset)):a.impl.setLightPreset(a.settings.lightPreset),a.renderoptions&&a.renderoptions.envSelect.setSelectedIndex(index)):a.impl.setLightPreset(0))},"environmentMap");a.addEventListener(Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,function(c){a.blockEvent=!0;b.checked=0!==a.impl.currentLightPreset;a.blockEvent=!1});this.addDivider(this.menuoptions);
var c=document.createElement("li"),e=document.createElement("img");e.src=RESOURCE_ROOT+"icons/help_icon.png";e.style.width="14px";e.style.height="14px";c.appendChild(e);e.style.padding="0px";e.style.marginRight="13px";e.style.marginLeft="4px";e.style.display="inline-block";e=document.createElement("label");e.innerHTML="Show Coachmarks";c.appendChild(e);c.addEventListener("click",function(){console.log("Coachmarks!")});c.style.opacity=1;this.menuoptions.appendChild(c);!0===this.settings.environmentMap?
this.impl.setLightPreset(this.settings.lightPreset):this.impl.setLightPreset(0);return this.menuoptions};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initDebugTools=function(){this.debugMenu=this.toolBar.addSubToolbar("debugTools",!1);var a=this,b=this.layersPanel=new Autodesk.Viewing.Private.LayersPanel(this);this.addPanel(b);this.addMenuButton("debugTools","toolbar-renderOptionsButtonXXX","Layer Manager",function(c){a.showLayerManager(!b.isVisible())});var c=this.addMenuButton("debugTools","toolbar-debugButton","Debug Menu",null);this.debugMenu.subMenu=document.createElement("ul");this.debugMenu.subMenu.style.width=
"180px";this.debugMenu.subMenu.style.paddingTop="4px";this.debugMenu.subMenu.style.paddingBottom="4px";this.initFPSStats();this.initModelStats();this.addOptionToggle(this.debugMenu.subMenu,"Show Search Bar",!1,function(b){a.searchMenu.setVisibility(b.target.checked)});this.toolBar.attachSubMenu(c,this.debugMenu.subMenu)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initEscapeHandlers=function(){var a=this;this.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,function(b){if(a.renderoptions&&a.renderoptions.isVisible())a.renderoptions.setVisible(!1);else if("hidden"!==a.explodeslider.style.visibility&&""!==a.explodeslider.style.visibility)a.showExplodeSlider(!1);else if(a.navigationMode!==Autodesk.Viewing.NAVIGATION_MODE.ORBIT)a.setNavigationMode(Autodesk.Viewing.NAVIGATION_MODE.ORBIT);else if(a.selectionActive)a.clearSelection();
else if(!a.areAllVisible())a.showAll();else if(!Autodesk.Viewing.Private.AlertBox.dismiss()){for(b=0;b<a.dockingPanels.length;++b){var c=a.dockingPanels[b];if("none"!==c.container.style.display&&""!==c.container.style.display){c.container===a.docstructure?a.showDocumentStructurePanel(!1):c.setVisible(!1);return}}a.escapeScreenMode()}})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initViewCube=function(){function a(a){b.viewcube||(b.viewcube=document.createElement("div"),b.viewcube.className="viewcube",b.container.appendChild(b.viewcube),ViewCube(b.viewcube,b),b.viewcube.style.display="none",b.impl.needsClear=!0);b.viewcube.style.display=a?"block":"none";b.homeViewContainer.style.width=a?b.viewcube.style.width:"auto"}var b=this,c=this.homeViewContainer=document.createElement("div");c.className="homeViewWrapper";var e=document.createElement("img");
e.className="homeView";e.src=RESOURCE_ROOT+"icons/resetview_icon.png";e.style.cursor="pointer";c.appendChild(e);c.style.width="auto";this.container.appendChild(c);e.addEventListener("click",function(){b.impl.controls.goHome()});this.addOptionToggle(this.menuoptions,"View Cube",!1,function(b){a(b.target.checked)},"viewCube");!0===this.settings.viewCube&&a(!0)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initSearchBox=function(){this.searchMenu=this.toolBar.addSubToolbar("searchBox",!1);this.searchMenu.setVisibility(!1);var a=document.createElement("li"),b=document.createElement("input");b.type="search";b.results=5;b.placeholder="Search";b.incremental="incremental";b.autosave=this.container.id+"search_autosave";a.appendChild(b);this.toolBar.addToSubToolbar("searchBox",a);var c=this;this.searchbox=b;b.addEventListener("change",function(a){stderr("search "+
b.value);c.search(b.value,function(a){c.isolateById(a)})});b.addEventListener("keypress",function(a){27===a.keyCode&&setTimeout(function(){""!==b.value&&(b.value="")},0)});this.toolBar.addEventListener("mouseleave",function(a){function d(){clearTimeout(g)}var g;c.toolBar.addEventListener("mouseenter",d);g=setTimeout(function(){c.toolBar.removeEventListener("mouseenter",d);document.activeElement===b&&c.canvas.focus()},2E3)})};
Autodesk.Viewing.Private.GuiViewer3D.prototype.setPropertiesButtonEnabled=function(a){a?this.modelTools.deselect(this.modelTools.propertiesbutton.id):this.modelTools.select(this.modelTools.propertiesbutton.id)};Autodesk.Viewing.Private.GuiViewer3D.prototype.setStructureButtonEnabled=function(a){a?this.modelTools.deselect(this.modelTools.structurebutton.id):this.modelTools.select(this.modelTools.structurebutton.id)};Autodesk.Viewing.Private.GuiViewer3D.prototype.showDocumentStructurePanel=function(a){this.docstructure.setVisible(a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.createDocumentStructurePanel=function(){this.docstructure&&(this.docstructure.setVisible(!1),this.removePanel(this.docstructure));var a=new Autodesk.Viewing.Private.DocumentStructurePanel(this);this.addPanel(a);a.setClickBehavior(this.config&&this.config.docStructureConfig?this.config.docStructureConfig:Autodesk.Viewing.Private.GuiViewer3D.kDefaultDocStructureConfig);this.docstructure=a;var b=this;this.docstructure.addVisibilityListener(function(a){if(a)b.onPanelVisible(b.docstructure,
b);b.setStructureButtonEnabled(a)})};Autodesk.Viewing.Private.GuiViewer3D.prototype.onPanelVisible=function(a,b){b||(b=this);b.dockingPanels.splice(b.dockingPanels.indexOf(a),1);b.dockingPanels.splice(0,0,a)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initFocalLengthOverlay=function(){var a=this.focallength=document.createElement("div");a.className="focallength";var b=document.createElement("table"),c=document.createElement("tbody");b.appendChild(c);a.appendChild(b);this.container.appendChild(a);var b=c.insertRow(-1),e=b.insertCell(0);e.textContent="Focal Length:";e=b.insertCell(1);e.textContent="";e.style.width="4em";e.style.textAlign="right";var d=0,g=this;this.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,
function(a){a=g.getFocalLength();d!==a&&(d=a,e.textContent=a.toString()+" mm")});a.style.visibility="hidden"};Autodesk.Viewing.Private.GuiViewer3D.prototype.showFocalLengthOverlay=function(a){this.focallength&&"hidden"!==this.focallength.style.visibility!==a&&(this.focallength.style.visibility=a?"visible":"hidden")};
Autodesk.Viewing.Private.GuiViewer3D.prototype.load=function(a,b,c,e){var d=this;return Autodesk.Viewing.BaseViewer3D.prototype.load.call(this,a,b,function(){d.createDocumentStructurePanel();c&&c()},e)};
Autodesk.Viewing.Private.GuiViewer3D.prototype.initSettings=function(){var a=window.navigator;this.settings={};this.isAndroid=-1!=a.platform.indexOf("armv")||a.appVersion&&-1!=a.appVersion.indexOf("Android");for(var a={ambientShadows:!this.isAndroid,antialiasing:!this.isAndroid,progressiveRendering:!0,environmentMap:!1,openPropertiesOnSelect:!0,ghosting:!0,viewCube:!1,lineRendering:!0,lightPreset:5,backgroundColorPreset:null},b=Object.keys(a),c=0;c<b.length;c++){var e=b[c],d=this._settingStore(e);
if("true"===d||"false"===d)d="true"===d;this.settings[e]=d}for(c=0;c<b.length;c++)e=this.settings[b[c]],this.settings[b[c]]=null!=e?e:a[b[c]];this.setQualityLevel(this.settings.ambientShadows,this.settings.antialiasing);this.setGhosting(this.settings.ghosting);this.setProgressiveRendering(this.settings.progressiveRendering);this.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,function(){this.hideLines(!this.settings.lineRendering)});if(a=this.settings.backgroundColorPreset){var g;try{g=JSON.parse(a),
this.impl.setClearColors(g[0],g[1],g[2],g[3],g[4],g[5])}catch(f){this.updateSetting("backgroundColorPreset",null)}}!0===this.settings.environmentMap?this.impl.setLightPreset(this.settings.lightPreset):this.impl.setLightPreset(0)};Autodesk.Viewing.Private.GuiViewer3D.prototype.updateSetting=function(a,b){this.settings[a]=b;this._settingStore(a,b)};
Autodesk.Viewing.Private.GuiViewer3D.prototype._settingStore=function(a,b){return this.useLocalStorage?"undefined"!==typeof localStorage&&"string"===typeof a?("undefined"!==typeof b?localStorage["Autodesk.Viewing.Private.GuiViewer3D.SavedSettings."+a]=b:b=localStorage["Autodesk.Viewing.Private.GuiViewer3D.SavedSettings."+a]||null,b):null:null};
Autodesk.Viewing.Private.GuiViewer3D.prototype.updateScreenModeButton=function(a){this.container.classList.remove("screenMode-kFullBrowser");this.container.classList.remove("screenMode-kFullScreen");var b;switch(a){case Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser)||(b="screenMode-kFullBrowser");break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:b=this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)?
"screenMode-kFullBrowser":"screenMode-kFullScreen";break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:b="screenMode-kFullScreen"}b&&this.container.classList.add(b)};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.GuiViewer2D=function(a,b){Autodesk.Viewing.Viewer2D.call(this,a,b)};Autodesk.Viewing.Private.GuiViewer2D.prototype=Object.create(Autodesk.Viewing.Viewer2D.prototype);Autodesk.Viewing.Private.GuiViewer2D.prototype.constructor=Autodesk.Viewing.Private.GuiViewer2D;
Autodesk.Viewing.Private.GuiViewer2D.prototype.initialize=function(){var a=Autodesk.Viewing.Viewer2D.prototype.initialize.call(this);if(0<a)return a;this.toolBar=new Autodesk.Viewing.UI.ToolBar(this.container);this.initNavTools();this.initModelTools();this.initEscapeHandlers();this.initHomeButton();var b=this;this.addEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,function(a){b.updateScreenModeButton(a.mode)});this.updateScreenModeButton(Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal);
return 0};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initNavTools=function(){var a=this;this.navTools=this.toolBar.addSubToolbar("navTools",!0);this.navTools.panbutton=this.addMenuButton("navTools","toolbar-panButton","Pan",function(b){a.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN)});this.navTools.dollybutton=this.addMenuButton("navTools","toolbar-zoomButton","Zoom",function(b){a.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.ZOOM)});this.navTools.select(this.navTools.panbutton.id);this.addEventListener(Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,function(b){a.navTools.deselectAll();
switch(b.value){case VIEWER2D_NAVIGATION_MODE.PAN:a.navTools.select(a.navTools.panbutton.id);a.impl.container.style.cursor="url("+RESOURCE_ROOT+"icons/pan_cur.cur), wait";break;case VIEWER2D_NAVIGATION_MODE.ZOOM:a.navTools.select(a.navTools.dollybutton.id);a.impl.container.style.cursor="url("+RESOURCE_ROOT+"icons/dolly_cur.cur), wait";break;default:a.impl.container.style.cursor="auto"}});this.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN)};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initModelTools=function(){if(this.canChangeScreenMode()){this.modelTools=this.toolBar.addSubToolbar("modelTools",!1);var a=this;this.modelTools.fullscreenbutton=this.addMenuButton("modelTools","toolbar-fullscreenButton","Full Screen",function(b){a.nextScreenMode()})}};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initEscapeHandlers=function(){var a=this;this.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,function(b){a.impl.setNavigationMode(VIEWER2D_NAVIGATION_MODE.PAN)||a.escapeScreenMode()},!1)};
Autodesk.Viewing.Private.GuiViewer2D.prototype.initHomeButton=function(){var a=this,b=this.homeViewContainer=document.createElement("div");b.className="homeViewWrapper";var c=document.createElement("img");c.className="homeView";c.src=RESOURCE_ROOT+"icons/resetview_icon.png";c.style.cursor="pointer";b.appendChild(c);b.style.width="auto";this.container.appendChild(b);c.addEventListener("click",function(){a.impl.goHome()})};
Autodesk.Viewing.Private.GuiViewer2D.prototype.addMenuButton=function(a,b,c,e){b=Autodesk.Viewing.UI.ToolBar.createMenuButton(b,c,e);this.toolBar.addToSubToolbar(a,b);return b};
Autodesk.Viewing.Private.GuiViewer2D.prototype.updateScreenModeButton=function(a){this.container.classList.remove("screenMode-kFullBrowser");this.container.classList.remove("screenMode-kFullScreen");var b;switch(a){case Autodesk.Viewing.Viewer.prototype.ScreenMode.kNormal:this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser)||(b="screenMode-kFullBrowser");break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullBrowser:b=this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen)?
"screenMode-kFullBrowser":"screenMode-kFullScreen";break;case Autodesk.Viewing.Viewer.prototype.ScreenMode.kFullScreen:b="screenMode-kFullScreen"}b&&this.container.classList.add(b)};var auth=null,env,VIEWING_URL,SEARCH_URL,RESOURCE_ROOT="",USE_OAUTH_NONE=!0,USE_OAUTH_ZERO=!1,USE_OAUTH_ONE=!1,USE_OAUTH_TWO=!1,SHOULD_SET_TOKEN=!0,EnvironmentConfigurations={Local:{RESOURCE:"",VIEWING:"https://viewing-dev.api.autodesk.com/viewingservice/v1",SEARCH:"https://search-dev.api.autodesk.com/search/v1"},Development:{RESOURCE:"https://viewing-dev.api.autodesk.com/viewingservice/v1/viewers/",VIEWING:"https://viewing-dev.api.autodesk.com/viewingservice/v1",SEARCH:"https://search-dev.api.autodesk.com/search/v1"},
Staging:{RESOURCE:"https://viewing-staging.api.autodesk.com/viewingservice/v1/viewers/",VIEWING:"https://viewing-staging.api.autodesk.com/viewingservice/v1",SEARCH:"https://search-staging.api.autodesk.com/search/v1"},Production:{RESOURCE:"https://viewing.api.autodesk.com/viewingservice/v1/viewers/",VIEWING:"https://viewing.api.autodesk.com/viewingservice/v1",SEARCH:"https://search.api.autodesk.com/search/v1"},ApigeeDevelopment:{RESOURCE:"https://developer-dev.api.autodesk.com/viewingservice/v1/viewers/",
VIEWING:"https://developer-dev.api.autodesk.com/viewingservice/v1",SEARCH:"https://search-dev.api.autodesk.com/search/v1"},ApigeeStaging:{RESOURCE:"https://developer-stg.api.autodesk.com/viewingservice/v1/viewers/",VIEWING:"https://developer-stg.api.autodesk.com/viewingservice/v1",SEARCH:"https://search-staging.api.autodesk.com/search/v1"},ApigeeProd:{RESOURCE:"https://developer.api.autodesk.com/viewingservice/v1/viewers/",VIEWING:"https://developer.api.autodesk.com/viewingservice/v1",SEARCH:"https://search.api.autodesk.com/search/v1"}};
function setAuthTokenInCookie(a,b){var c={oauth:{token:""}};c.oauth.token=a;var e=new XMLHttpRequest;e.open("POST",VIEWING_URL+"/token",!0);e.setRequestHeader("Content-Type","application/json");e.withCredentials=!0;b&&(e.onload=b);e.send(JSON.stringify(c))}
function setApigeeTokenInCookie(a,b){var c=new XMLHttpRequest,e=VIEWING_URL.substring(0,VIEWING_URL.indexOf("/viewingservice"));c.open("POST",e+"/utility/v1/settoken",!0);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");c.withCredentials=!0;b&&(c.onload=b);c.send("access-token="+a)}
function initializeEnvironmentVariable(a){if(a&&a.env)env=a.env;else switch(window.location.hostname){case "viewing-dev.api.autodesk.com":env="Development";break;case "viewing-staging.api.autodesk.com":env="Staging";break;case "viewing.api.autodesk.com":env="Production";break;case "developer-dev.api.autodesk.com":env="ApigeeDev";break;case "developer-stg.api.autodesk.com":env="ApigeeStaging";break;case "developer.api.autodesk.com":env="ApigeeProd";break;default:env="Local"}console.log("Host name : "+
window.location.hostname);console.log("Environment initialized as : "+env)}function initializeServiceEndPoints(){VIEWING_URL=EnvironmentConfigurations[env].VIEWING;SEARCH_URL=EnvironmentConfigurations[env].SEARCH;RESOURCE_ROOT=EnvironmentConfigurations[env].RESOURCE}
function initializeAuth(a,b){auth=!0;var c;c=b?b.getAccessToken?b.getAccessToken():b.accessToken?b.accessToken:getParameterByName("accessToken"):getParameterByName("accessToken");c||(c="3AzZ0cfGq+MEtLPJvmoQo+Ig+0Q=",console.log("Warning : no access token is provided. Use built in token : "+c));SHOULD_SET_TOKEN&&(0==env.indexOf("Apigee")?setApigeeTokenInCookie(c,a):setAuthTokenInCookie(c,a));return auth}function getAuthObject(){return auth}
function getParameterByName(a){return getParameterByNameFromPath(a,window.location.href)}function getParameterByNameFromPath(a,b){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=RegExp("[\\?&]"+a+"=([^&#]*)").exec(b);return null==c?"":decodeURIComponent(c[1].replace(/\+/g," "))}
function getQueryParameters(a,b){var c=[];b||(b=window.location.href);a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");for(var e=RegExp(a+"=([^&#]+)","ig");;){var d=e.exec(b);if(d&&d[1])c.push(d[1]);else break}return c.length?1==c.length?c[0]:c:null}
function getDemoDocumentURN(){var a;switch(env){case "Development":a="urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbmAvUkMgQ2FyLmR3Zg";break;case "Staging":a="urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbicvTU0zNTAwQXNzZW1ibHkuZHdm";break;case "Production":a="FIXME";break;default:a="urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbmAvUkMgQ2FyLmR3Zg"}return a}
function stderr(a){ENABLE_TRACE&&console.log(a)};
